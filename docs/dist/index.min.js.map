{"version":3,"sources":["webpack://jueying/webpack/universalModuleDefinition","webpack://jueying/webpack/bootstrap","webpack://jueying/external \"React\"","webpack://jueying/./out/errors.js","webpack://jueying/./out/style.js","webpack://jueying/./out/component.js","webpack://jueying/./out/propt-display-names.js","webpack://jueying/./node_modules/maishu-toolkit/out/index.js","webpack://jueying/./out/components/master-page.js","webpack://jueying/./out/components/common.js","webpack://jueying/./out/components/index.js","webpack://jueying/./out/component-panel.js","webpack://jueying/./out/prop-editor.js","webpack://jueying/./node_modules/maishu-toolkit/out/callback.js","webpack://jueying/./out/component-data-handler.js","webpack://jueying/./node_modules/maishu-jueying-core/dist/index.js","webpack://jueying/./node_modules/maishu-jueying-core/decorators.js","webpack://jueying/./out/property-editor.js","webpack://jueying/./out/editor-panel.js","webpack://jueying/./out/component-wrapper.js","webpack://jueying/./out/page-designer.js","webpack://jueying/external \"$\"","webpack://jueying/./out/index.js","webpack://jueying/./out/jquery.js","webpack://jueying/./lib/jquery.event.drag-2.2.js","webpack://jueying/./lib/jquery.event.drag.live-2.2.js","webpack://jueying/./lib/jquery.event.drop-2.2.js","webpack://jueying/./lib/jquery.event.drop.live-2.2.js","webpack://jueying/./node_modules/maishu-toolkit/out/guid.js","webpack://jueying/./node_modules/maishu-toolkit/out/path.js","webpack://jueying/./node_modules/maishu-toolkit/out/errors.js","webpack://jueying/./node_modules/maishu-toolkit/out/data.js","webpack://jueying/./node_modules/maishu-toolkit/out/Errors.js","webpack://jueying/(webpack)/buildin/global.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__15__","enumerable","get","getter","value","key","bind","Object","prototype","hasOwnProperty","call","object","property","Errors","Error","fileName","argumentName","pluginId","componentId","componentName","fieldName","classNames","componentSelected","emptyTemplates","loadingTemplates","templateSelected","templateDialog","emptyDocument","component","componentWrapper","componentPanel","componentIcon","placeholder","editorPanel","designer","moveDown","element","document","createElement","appendClassName","addonClassName","argumentNull","sourceClassName","className","console","assert","indexOf","type","setAttribute","innerHTML","head","appendChild","ComponentWrapperContext","Component","typename","attr","componentAttributes","name","assign","defaultComponentAttribute","componentData","componentType","result","propEditorInfo","this","componentPropEditors","i","length","propName","display","componentPropEditorDisplay","push","controlClassName","getPropEditorByArray","propNames","filter","o","componentTypeOrOptions","editorType","group","editorDisplay","options","displayName","split","classProps","join","defaultComponentFactory","componentTypes","Fragment","container","movable","showHandler","resize","c","children","map","props","proptDisplayNames","defineProperty","guid_1","guid","path_1","pathContact","errors_1","errors","callback_1","Callback","data_1","DataSource","DataSourceSelectArguments","MasterPageContext","master","super","childComponents","state","Provider","register","ComponentTypes","Text","PageView","PlaceHolder","constants","componentsDir","connectorElementClassName","componentTypeName","componentPosition","ComponentPanel","componets","toolbarElement","toolItemElement","draggable","addEventListener","ev","dataTransfer","setData","JSON","stringify","x","offsetX","y","offsetY","setState","str","getData","parse","empty","ref","e","componentIndexName","icon","style","fontSize","color","ctrl","componentDraggable","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","done","then","apply","PropEditor","items","valueType","itemsPromise","textValues","Array","isArray","text","getOwnPropertyNames","onChange","textValue","target","floatRegex","test","parseInt","parseFloat","updateComponentProp","dropdown","TextInput","funcs","func","args","forEach","ComponentDataHandler","_components","create","componentRemoved","componentAppend","componentUpdated","pageDataChanged","_pageData","initComponentData","fillComponent","setComponetRefProp","arr","stack","item","pop","selected","child","selectedComponents","id","fire","parentId","childComponentIndex","findComponentData","pageData","removeComponentFrom","appendComponent","componentProps","componentDatas","navPropsNames","obj","pageDataIsNull","travelComponentData","controlId","collection","controlIndex","shift","splice","r","componentIndex","parentControl","selectComponents","namedComponents","num","components","componentIds","itemRef","names","ids","isSelectedControl","selectedComponentIds","removeComponents","position","setComponentsPosition","positions","toUpdateProps","left","top","updateComponentProps","size","height","width","__WEBPACK_EXTERNAL_MODULE_react__","modules","installedModules","__webpack_require__","moduleId","l","m","d","Symbol","toStringTag","t","mode","__esModule","ns","n","p","s","React","CompoenntFactory","compoenntTypes","context","_createComponent","createErrorElement","err","createViewComponent","message","typeName","compoenntType","componentNotExists","pathFieldRequired","canntFindModule","path","component_factory_1","constructor","_element","groupedEditors","add","editors","getEditors","commonFlatProps","commonPropEditorInfos","propEditorInfos","getPropEditors","propInfo1","propInfo2","propName1","propName2","control","controlProps","editorProps","propValue","editComponents","editor","prop","customRender","groupEditorsArray","groupEditors","g","error","info","_designer","getAttribute","handler","enableAppendDroppable","onclick","invokeOnClick","event","preventDefault","stopPropagation","dropEffect","log","arguments","getComponentData","pos","mouseInnerPosition","startPos","rect","dragStart","$","drag","is","dd","sourceElement","Date","now","drop","Math","max","deltaX","deltaY","setLeft","setTop","setPosition","isResizeHandleClassName","css","click","interval","isDrag","transform","setComponentPosition","setComponentSize","elementID","ctrlKey","selectComponent","selectedControlIds","source","designtimeBehavior","renderWidthoutWrapper","visibility","wrapperProps","move_handle","showResizeHandle","createRawElement","tagName","emtpy","designTimeEmptyElement","designTimeText","initPageData","focus","targetComponentIndex","moveComponent","keyCode","argumentFieldCanntNull","attr1","attr2","elementTag","componentFactory","defaultProps","fn","arg","opts","isFunction","trigger","$event","$special","special","defaults","which","distance","not","handle","relative","datakey","noBubble","data","related","each","def","undefined","remove","setup","extend","init","attachEvent","dontstart","teardown","removeData","textselect","detachEvent","touched","results","closest","currentTarget","propagates","mousedown","interactions","interaction","pageX","pageY","dragging","hijack","flatten","live","elem","offset","callback","droppable","pow","getTime","ia","orig","originalEvent","len","isNaN","cancelled","properties","subject","isPropagationStopped","dispatch","proxy","update","startX","startY","originalX","originalY","slice","available","jquery","nodeType","member","makeArray","bool","unselectable","locate","$dispatch","touchHooks","fixHooks","touchstart","touchmove","touchend","touchcancel","touches","changedTouches","draginit","dragstart","dragend","jQuery","origadd","origteardown","livekey","selector","delegate","elems","events","origType","origHandler","inArray","multi","Infinity","delay","tolerance","targets","active","anyactive","winner","location","grep","$targets","timer","tolerate","clearTimeout","index","$elem","posi","outerHeight","outerWidth","right","bottom","contains","modes","overlap","min","sort","a","b","drp","drg","end","xy","last","setTimeout","dropinit","dropstart","dropend","find","concat","s4","floor","random","toString","substring","paths","replace","expectedType","Errors_1","dataSourceCanntInsert","dataSourceCanntDelete","dataSourceCanntUpdate","primaryKeyNull","inserting","inserted","deleting","deleted","updating","updated","selecting","primaryKeys","delete","insert","select","canInsert","sender","dataItem","executeInsert","catch","exc","processError","canDelete","checkPrimaryKeys","executeDelete","canUpdate","executeUpdate","theItem","otherItem","pk","selectArguments","executeSelect","dataItems","totalRowCount","queryResultTypeError","selectResult","method","handled","startRowIndex","maximumRows","ArrayDataSource","sortExpression","Function"],"mappings":";;;;;;;;;;;;;;;;CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,EAAQG,QAAQ,SAAUA,QAAQ,MAC1B,mBAAXC,QAAyBA,OAAOC,IAC9CD,OAAO,CAAC,QAAS,KAAMJ,GACG,iBAAZC,QACdA,QAAiB,QAAID,EAAQG,QAAQ,SAAUA,QAAQ,MAEvDJ,EAAc,QAAIC,EAAQD,EAAY,MAAGA,EAAQ,GARnD,CASGO,QAAQ,SAASC,EAAgCC,GACpD,O,YCTA,SAGA,cAGA,QACA,oBAGA,YACA,IACA,KACA,YAUA,OANA,mCAGA,OAGA,UA0DA,OArDA,MAGA,MAGA,oBACA,UACA,2BAA2CC,YAAY,EAAMC,IAAKC,KAKlE,gBACA,gDACA,4CAAyDC,MAAO,WAEhE,sCAAkDA,OAAO,KAQzD,kBAEA,GADA,cACA,aACA,qDACA,0BAGA,GAFA,OACA,mCAA0CH,YAAY,EAAMG,MAAOA,IACnE,2DAAiH,OAAOA,EAAMC,IAAQC,KAAK,KAAMD,IACjJ,UAIA,gBACA,sBACA,WAA4B,OAAOX,EAAgB,SACnD,WAAkC,OAAOA,GAEzC,OADA,aACA,GAIA,kBAAuD,OAAOa,OAAOC,UAAUC,eAAeC,KAAKC,EAAQC,IAG3G,OAIA,U,gBClFAlB,EAAOD,QAAUM,G,6BCAjB,kCAAO,MAAMc,EACT,2BAEI,OAAO,IAAIC,MADD,oDAGd,qBAAqBC,GACjB,OAAO,IAAID,MAAM,SAASC,qBAE9B,oBAAoBC,GAChB,OAAO,IAAIF,MAAM,YAAYE,uBAEjC,0BAA0BA,GACtB,OAAO,IAAIF,MAAM,YAAYE,kBAEjC,wBACI,OAAO,IAAIF,MAAM,sBAErB,4BACI,OAAO,IAAIA,MAAM,+BAErB,sBAAsBG,GAClB,OAAO,IAAIH,MAAM,gBAAgBG,YAErC,oBACI,OAAO,IAAIH,MAAM,4BAErB,2BAA2BI,GACvB,OAAO,IAAIJ,MAAM,oDAAoDI,MAEzE,qBAAqBC,EAAeP,GAEhC,OAAO,IAAIE,MADD,GAAGK,cAA0BP,6BAG3C,8BAA8BQ,EAAWJ,GAErC,OAAO,IAAIF,MADD,GAAGM,iBAAyBJ,gC,6BClC9C,+EACO,IAAIK,EAAa,CACpBC,kBAAmB,qBACnBC,eAAgB,kBAChBC,iBAAkB,oBAClBC,iBAAkB,oBAClBC,eAAgB,kBAChBC,cAAe,iBACfC,UAAW,YACXC,iBAAkB,oBAClBC,eAAgB,kBAChBC,cAAe,iBACfC,YAAa,cACbC,YAAa,eACbC,SAAU,WACVC,SAAU,aAEVT,EACY,GADZA,EAEU,GAEVU,EAAUC,SAASC,cAAc,SA0K9B,SAASC,EAAgBH,EAASI,GACrC,GAAe,MAAXJ,EACA,MAAM,IAAOK,aAAa,WAC9B,IAAKD,EACD,MAAM,IAAOC,aAAa,kBAC9B,IAAIC,EAOJ,GALIA,EADkB,iBAAXN,EACWA,EAEAA,EAAQO,UAC9BD,EAAkBA,GAAmB,GACrCE,QAAQC,OAAOL,GACXE,EAAgBI,QAAQN,IAAmB,EAC3C,OAAOE,EACX,IAAIC,EAAY,GAAGD,KAAmBF,IAGtC,MAFsB,iBAAXJ,IACPA,EAAQO,UAAYA,GACjBA,EA1LXP,EAAQW,KAAO,WACfX,EAAQY,aAAa,YAAa,WAClCZ,EAAQa,UAAY,kBACL5B,EAAWC,0GAGXD,EAAWC,4GAGTD,EAAWC,mPAOXD,EAAWC,4SASXD,EAAWC,0CACXD,EAAWC,0CACXD,EAAWC,wFAGXD,EAAWC,0CACXD,EAAWC,0CACXD,EAAWC,0FAGXD,EAAWC,0CACXD,EAAWC,yCACXD,EAAWC,2FAGXD,EAAWC,0CACXD,EAAWC,0CACXD,EAAWC,yFAGXD,EAAWC,0CACXD,EAAWC,gGAGXD,EAAWC,0CACXD,EAAWC,gGAGXD,EAAWC,0CACXD,EAAWC,+JAKXD,EAAWC,0CACXD,EAAWC,2JAKbD,EAAWE,uHAIXF,EAAWG,yHAIXH,EAAWI,oHAGXJ,EAAWK,wDACKA,iCACLA,oCACGA,sLAMdL,EAAWK,2FAGXL,EAAWM,wHAIXN,EAAWO,kCACXP,EAAWO,kCACXP,EAAWO,kCACXP,EAAWO,kCACXP,EAAWO,kCACXP,EAAWO,kCACXP,EAAWO,kCACXP,EAAWO,kFAGXP,EAAWC,oDACXD,EAAWC,oDACXD,EAAWC,oDACXD,EAAWC,oDACXD,EAAWC,oDACXD,EAAWC,oDACXD,EAAWC,oDACXD,EAAWC,qGAGXD,EAAWW,+GAIXX,EAAWW,qCACXX,EAAWQ,0CACXR,EAAWQ,oBAAoBR,EAAWC,qGAG1CD,EAAWY,8QASXZ,EAAWY,4NAOXZ,EAAWY,4FAGXZ,EAAWY,+HAIXZ,EAAWa,kCACXb,EAAWY,kFAGXZ,EAAWS,yRASXT,EAAWS,qGAGXT,EAAWS,wHAIXT,EAAWQ,oBAAoBR,EAAWc,iDAIzDE,SAASa,KAAKC,YAAYf,I,6BC9L1B,+HAKO,MAAMgB,EAA0B,gBAAoB,MACpD,MAAMC,EAMT,oBAAoBC,EAAUC,GAC1BF,EAAUG,oBAAoBF,GAAYC,EAM9C,oBAAoBR,GAChB,IAAIO,EAA0B,iBAARP,EAAmBA,EAAOA,EAAKU,KACjDF,EAAOF,EAAUG,oBAAoBF,GACzC,OAAO/C,OAAOmD,OAAO,CAAEX,QAAQM,EAAUM,0BAA2BJ,GAAQ,IAEhF,sBAAsBK,GAClB,IAAIC,EAAgBD,EAAcb,KAC9Be,EAAS,GACTC,EAAiBC,KAAKC,qBAAqBJ,IAAkB,GACjE,IAAK,IAAIK,EAAI,EAAGA,EAAIH,EAAeI,OAAQD,IAAK,CAC5C,IAAIE,EAAWL,EAAeG,GAAGE,SAC7BC,EAAUhB,EAAUiB,2BAA2B,GAAGT,KAAiBO,KACxD,MAAXC,GAA6C,GAA1BA,EAAQT,IAE/BE,EAAOS,KAAKR,EAAeG,IAE/B,OAAOJ,EAKX,qBAAqBU,EAAkBJ,GACnC,OAAOJ,KAAKS,qBAAqBD,EAAkBJ,GAGvD,4BAA4BI,EAAkBE,GAG1C,OAFmBV,KAAKC,qBAAqBO,IAAqB,IACxCG,OAAOC,GAAKA,EAAER,UAAYM,GAAW,GAGnE,qBAAqBG,EAAwBT,EAAUU,EAAYC,GAC/D,IAAIlB,EACAmB,EACJ,GAAqC,iBAA1BH,EAAoC,CAC3C,IAAII,EAAUJ,EACdhB,EAAgBoB,EAAQpB,cACxBO,EAAWa,EAAQb,SACnBU,EAAaG,EAAQH,WACrBC,EAAQE,EAAQF,MAChBC,EAAgBC,EAAQZ,QACG,MAAvBY,EAAQC,cACR,IAAkBd,GAAYa,EAAQC,kBAI1CrB,EAAgBgB,EAEpBE,EAAQA,GAAS,GAEjB,IAAIL,EAAYN,EAASe,MAAM,KAC3BxC,EAAoC,iBAAjBkB,EAA4BA,EAAgBA,EAAcrD,UAAU8C,UAAYO,EAAcJ,KACrHJ,EAAUiB,2BAA2B,GAAG3B,KAAayB,KAAcY,EACnE,IAAII,EAAa/B,EAAUY,qBAAqBtB,GAAaU,EAAUY,qBAAqBtB,IAAc,GAC1G,IAAK,IAAIuB,EAAI,EAAGA,EAAIkB,EAAWjB,OAAQD,IAAK,CAGxC,GAFgBkB,EAAWlB,GAAGE,UACdM,EAAUW,KAAK,KAG3B,YADAD,EAAWlB,GAAGY,WAAaA,GAInCM,EAAWb,KAAK,CAAEH,WAAUU,aAAYC,UAE5C,qBAAqBnB,GAEjB,OAAO0B,EAAwB1B,GAEnC,gBAAgBzC,EAAe0C,EAAeN,GAM1C,GALqB,MAAjBM,GAAiD,mBAAjB1C,IAEhCA,GADA0C,EAAgB1C,GACcsC,KAC9BI,EAA6B,cAAI1C,IAEhCA,EACD,MAAM,IAAOsB,aAAa,iBAC9B,IAAKoB,EACD,MAAM,IAAOpB,aAAa,iBAC9BY,EAAUkC,eAAepE,GAAiB0C,EACtCN,GACAF,EAAUL,aAAa7B,EAAeoC,IAKlDF,EAAUmC,SAAW,GAErBnC,EAAUM,0BAA4B,CAClC8B,WAAW,EAAOC,SAAS,EAAOC,aAAa,EAAOC,QAAQ,GAElEvC,EAAUG,oBAAsB,CAC5B,IAAO,CAAEiC,WAAW,EAAMC,SAAS,EAAMC,aAAa,EAAMC,QAAQ,GACpE,IAAO,CAAEH,WAAW,EAAOC,SAAS,EAAME,QAAQ,GAClD,MAAS,CAAEF,SAAS,GACpB,GAAM,CAAED,WAAW,EAAOC,SAAS,EAAMC,aAAa,EAAMC,QAAQ,GACpE,GAAM,CAAEH,WAAW,EAAMC,SAAS,GAClC,MAAS,CAAED,WAAW,EAAOC,SAAS,EAAMC,aAAa,EAAMC,QAAQ,GACvE,MAAS,CAAEH,WAAW,EAAOC,SAAS,GACtC,MAAS,CAAED,WAAW,EAAOC,SAAS,GACtC,MAAS,CAAED,WAAW,EAAOC,SAAS,GACtC,GAAM,CAAED,WAAW,EAAOC,SAAS,GACnC,GAAM,CAAED,WAAW,EAAMC,SAAS,IAEtCrC,EAAUY,qBAAuB,GACjCZ,EAAUiB,2BAA6B,GAqEvCjB,EAAUkC,eAAiB,GACpB,IAAID,EAA2BO,IAClC,IAAIC,GAAYD,EAAEC,UAAY,IAAIC,IAAIF,GAAiB,iBAALA,EAAgBA,EAAIP,EAAwBO,IAC1F9C,EAAOM,EAAUkC,eAAeM,EAAE9C,OAAS8C,EAAE9C,KAEjD,OADQ,gBAAoBA,EAAM8C,EAAEG,OAAS,MAAOF,K,6BCnMxD,kCAAO,IAAIG,EAAoB,I,6BCC/B1F,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IACtD,IAAI+F,EAAS,EAAQ,IACrB1G,EAAQ2G,KAAOD,EAAOC,KACtB,IAAIC,EAAS,EAAQ,IACrB5G,EAAQ6G,YAAcD,EAAOC,YAC7B,IAAIC,EAAW,EAAQ,IACvB9G,EAAQoB,OAAS0F,EAAS1F,OAC1BpB,EAAQ+G,OAASD,EAASC,OAC1B,IAAIC,EAAa,EAAQ,GACzBhH,EAAQiH,SAAWD,EAAWC,SAC9B,IAAIC,EAAS,EAAQ,IACrBlH,EAAQmH,WAAaD,EAAOC,WAC5BnH,EAAQoH,0BAA4BF,EAAOE,2B,+CCXpC,MACMC,EAAoB,gBAAoB,CAAEC,OAAQ,OACxD,MAAM,UAAmB,YAC5B,YAAYf,GACRgB,MAAMhB,GACNhC,KAAKiD,gBAAkB,GAEvBjD,KAAKkD,MAAQ,GAiBjB,SAUItE,QAAQC,OAAiB,MADZmB,MAEb,IAAI8B,EAAW9B,KAAKgC,MAAMF,SAC1B,OAAO,gBAAoBgB,EAAkBK,SAAU,CAAE/G,MAAO,CAAE2G,OAHrD/C,OAGiE8B,IAGtF,IAAUsB,SAvCoB,aAuCK,EAAY,CAAE3B,WAAW,I,KCzCrD,MAAM4B,EAAiB,CAC1BC,KAAM,OACNC,SAAU,WACVC,YAAa,eAEV,IAAIC,EAAY,CACnBC,cAAe,aACfC,0BAA2B,sBAC3BC,kBAAmB,sBACnBhE,cAAe,iBACfiE,kBAAmB,sBCVvB,4BFE8B,gBEF9B,yI,6BCAA,2DAGO,MAAMC,UAAuB,YAChC,YAAY9B,GACRgB,MAAMhB,GACNhC,KAAKkD,MAAQ,CAAEa,UAAW,IAC1B/D,KAAK9B,SAAW8B,KAAKgC,MAAM9D,SAE/B,cACI,OAAO8B,KAAKgE,eAEhB,mBAAmBC,EAAiBrE,GAChChB,QAAQC,OAA0B,MAAnBoF,GACfA,EAAgBC,WAAY,EAC5BD,EAAgBE,iBAAiB,aAAa,SAAUC,GACpDxE,EAAcoC,MAAQpC,EAAcoC,OAAS,GAC7CoC,EAAGC,aAAaC,QAAQ,IAAU1E,cAAe2E,KAAKC,UAAU5E,IAChEwE,EAAGC,aAAaC,QAAQ,gBAAiBC,KAAKC,UAAU,CAAEC,EAAGL,EAAGM,QAASC,EAAGP,EAAGQ,cAGvF,aAAab,GACT/D,KAAK6E,SAAS,CAAEd,cAEpB,wBAAwBM,GACpB,IAAIS,EAAMT,EAAaU,QAAQ,IAAUnF,eACzC,GAAKkF,EAEL,OAAOP,KAAKS,MAAMF,GAGtB,0BAA0BT,GACtB,IAAIS,EAAMT,EAAaU,QAAQ,iBAC/B,GAAKD,EAEL,OAAOP,KAAKS,MAAMF,GAEtB,SACI,IAAIG,EAAQjF,KAAKgC,MAAMiD,OAAS,gBAAoB,MAAO,CAAEtG,UAAW,SAAW,UAC/EqD,EAAQzF,OAAOmD,OAAO,GAAIM,KAAKgC,OAC/B+B,EAAY/D,KAAKkD,MAAMa,WAAa,GACxC,OAAO,gBAAoB,KAAMxH,OAAOmD,OAAO,GAAIsC,EAAO,CAAErD,UAAW,GAAG,IAAWb,kBAAkBkC,KAAKgC,MAAMrD,WAAa,KAAMuG,IAAMC,GAAMnF,KAAKgE,eAAiBhE,KAAKgE,gBAAkBmB,IAA0B,GAApBpB,EAAU5D,OAAc8E,EAAQlB,EAAUhC,IAAI,CAACF,EAAG3B,KAClP,IAAI8B,EAAQ,CAAE3F,IAAK6D,GAEnB,OADA8B,EAAM8B,EAAesB,oBAAsB,GAAGlF,IACvC,gBAAoB,KAAM3D,OAAOmD,OAAO,GAAIsC,EAAO,CAAErD,UAAW,IAAWZ,gBAC9E,gBAAoB,MAAO,CAAEY,UAAW,YACpC,gBAAoB,IAAK,CAAEA,UAAWkD,EAAEwD,KAAMC,MAAO,CAAEC,SAAU,GAAIC,MAAO,SAAWN,IAAKC,IACpF,IAAKA,EACD,OACJ,IAAIM,EAAO5D,EAAEjC,cACbI,KAAK0F,mBAAmBP,EAAGM,OAEvC,gBAAoB,MAAO,KAAM5D,EAAEX,kBAInD4C,EAAesB,mBAAqB,wB,6BCxDpC,+EAAIO,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAU/J,GAAS,IAAMgK,EAAKL,EAAUM,KAAKjK,IAAW,MAAO+I,GAAKe,EAAOf,IACpF,SAASmB,EAASlK,GAAS,IAAMgK,EAAKL,EAAiB,MAAE3J,IAAW,MAAO+I,GAAKe,EAAOf,IACvF,SAASiB,EAAKtG,GAAUA,EAAOyG,KAAON,EAAQnG,EAAO1D,OAAS,IAAI0J,GAAE,SAAUG,GAAWA,EAAQnG,EAAO1D,UAAWoK,KAAKL,EAAWG,GACnIF,GAAML,EAAYA,EAAUU,MAAMb,EAASC,GAAc,KAAKQ,YAI/D,MAAMK,UAAmB,YAC5B,YAAY1E,GACRgB,MAAMhB,GAEV,gBAAgB2E,EAAOC,GACnB,OAeR,SAAkBD,EAAOC,GACrB,IAAIC,EACAC,EAAa,GACjB,GAAiB,MAAbF,GAAqBG,MAAMC,QAAQL,GAAQ,CAC3CC,EAAYD,EAAMxG,OAAS,GAAwB,iBAAZwG,EAAM,GAAiB,SAAW,SACzE,IAAK,IAAIzG,EAAI,EAAGA,EAAIyG,EAAMxG,OAAQD,IAC9B4G,EAAW5G,GAAK,CAAE+G,KAAMN,EAAMzG,GAAI9D,MAAOuK,EAAMzG,SAGlD,GAAiB,MAAb0G,EAAmB,CACxBA,EAAY,SACZ,IAAIlG,EAAYnE,OAAO2K,oBAAoBP,GAC3C,IAAK,IAAIzG,EAAI,EAAGA,EAAIQ,EAAUP,OAAQD,IAClC4G,EAAW5G,GAAK,CAAE+G,KAAMN,EAAMjG,EAAUR,IAAK9D,MAAOsE,EAAUR,SAG7D6G,MAAMC,QAAQL,GACnBG,EAAaH,EAGbE,EAAeF,EAsCnB,OApCA,cAAuBD,EACnB,YAAY1E,GACRgB,MAAMhB,GACNhC,KAAKkD,MAAQ,GAEjB,oBACI,OAAOyC,EAAU3F,UAAM,OAAQ,GAAQ,YACnC,GAAI6G,EAAc,CACd,IAAIF,QAAcE,EAClB7G,KAAK6E,SAAS,CAAE8B,cAI5B,SACI,IAAI,MAAEA,GAAU3G,KAAKkD,OACjB,MAAE9G,GAAU4D,KAAKgC,MAErB,OADA2E,EAAQA,GAASG,EACV,gBAAoB,SAAU,CAAEnI,UAAW,eAAgBvC,MAAgB,MAATA,EAAgB,GAAKA,EAAO+K,SAAUhC,IACvG,IAAIiC,EAAYjC,EAAEkC,OAAOjL,MACzB,GAAiB,UAAbwK,EAAuB,CACvB,IACIU,EAAa,qBAEblL,EAHe,QAEFmL,KAAKH,GACVI,SAASJ,GACZE,EAAWC,KAAKH,GACbK,WAAWL,GAEX,UAGZhL,EAAQgL,EAEZpH,KAAKgC,MAAM0F,oBAAoBtL,KAC9BuK,EAAM5E,IAAInB,GAAK,gBAAoB,SAAU,CAAEvE,IAAKuE,EAAExE,MAAOA,MAAOwE,EAAExE,OAASwE,EAAEqG,UAtEvFU,CAAShB,EAAOC,GAE3B,mBACI,OAAOgB,GAGR,MAAMA,UAAkBlB,EAC3B,SACI,IAAI,MAAEtK,GAAU4D,KAAKgC,MACrB,OAAO,gBAAoB,QAAS,CAAErD,UAAW,eAAgBvC,MAAOA,GAAS,GAAI+K,SAAUhC,IAEvFnF,KAAKgC,MAAM0F,oBAAoBvC,EAAEkC,OAAOjL,a,6BCxBxDG,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IACtD,MAAMsG,EACF,cACI1C,KAAK6H,MAAQ,IAAId,MAErB,IAAIe,GACA9H,KAAK6H,MAAMtH,KAAKuH,GAEpB,OAAOA,GACH9H,KAAK6H,MAAQ7H,KAAK6H,MAAMlH,OAAOC,GAAKA,GAAKkH,GAE7C,KAAKC,GACD/H,KAAK6H,MAAMG,QAAQpH,GAAKA,EAAEmH,IAE9B,gBACI,OAAO,IAAIrF,GAGnBjH,EAAQiH,SAAWA,G,6BCnBnB,oDAEO,MAAMuF,EACT,YAAYrI,GACRI,KAAKkI,YAAc,GACnBlI,KAAK1C,kBAAoB,WAAS6K,SAClCnI,KAAKoI,iBAAmB,WAASD,SACjCnI,KAAKqI,gBAAkB,WAASF,SAChCnI,KAAKsI,iBAAmB,WAASH,SACjCnI,KAAKuI,gBAAkB,WAASJ,SAChCnI,KAAKwI,UAAY5I,EACjBI,KAAKyI,kBAAkBzI,KAAKwI,WAGhC,kBAAkB5I,GACO,MAAjBA,IAGJA,EAAckC,SAAWlC,EAAckC,UAAY,GACnDmG,EAAqBS,cAAc9I,GACnCqI,EAAqBU,mBAAmB/I,EAAeI,KAAKkI,cAGhE,yBACI,IAAIU,EAAM,IAAI7B,MACV8B,EAAQ,IAAI9B,MAEhB,IADA8B,EAAMtI,KAAKP,KAAKwI,WACTK,EAAM1I,OAAS,GAAG,CACrB,IAAI2I,EAAOD,EAAME,MACC,MAAdD,EAAK9G,OAAkC,GAAjB8G,EAAKE,UAC3BJ,EAAIrI,KAAKuI,GACbA,EAAKhH,SAASkG,QAAQiB,IAClB,GAAoB,iBAATA,EACP,OAAO,EACXJ,EAAMtI,KAAK0I,KAGnB,OAAOL,EAGX,2BACI,OAAO5I,KAAKkJ,mBAAmBnH,IAAInB,GAAKA,EAAEuI,IAG9C,iBACI,OAAOnJ,KAAKkI,YAEhB,eACI,OAAOlI,KAAKwI,UAEhB,aAAapM,GACT4D,KAAKwI,UAAYpM,EACjB4D,KAAKyI,kBAAkBrM,GACvB4D,KAAKuI,gBAAgBa,KAAKhN,GAQ9B,cAAcc,EAAamM,EAAUC,GACjC,IAAI1L,EAAYoC,KAAKuJ,kBAAkBrM,GACvC,GAAiB,MAAbU,EACA,MAAM,IAAId,MAAM,8BAA8BI,KAClD0B,QAAQC,OAAoB,MAAbjB,EAAmB,8BAA8BV,KAChE,IAAIsM,EAAWxJ,KAAKwJ,SACpB5K,QAAQC,OAA4B,MAArB2K,EAAS1H,UACxB,IAAIA,EAAW0H,EAAS1H,SACxB9B,KAAKyJ,oBAAoBvM,EAAa4E,GACtC9B,KAAK0J,gBAAgBL,EAAUzL,EAAW0L,GAE9C,qBAAqBK,GACjB,IAAIC,EAAiB,GACrB,IAAK,IAAI1J,EAAI,EAAGA,EAAIyJ,EAAexJ,OAAQD,IAAK,CAC5C,IAAI,YAAEhD,EAAW,SAAEkD,EAAQ,MAAEhE,GAAUuN,EAAezJ,GAClDN,EAAgBI,KAAKuJ,kBAAkBrM,GAC3C,GAAqB,MAAjB0C,EACA,SACJ,IAAIiK,EAAgBzJ,EAASe,MAAM,KACnCvC,QAAQC,OAAwB,MAAjBe,GACfhB,QAAQC,OAAwB,MAAjBgL,EAAuB,iBACtCjK,EAAcoC,MAAQpC,EAAcoC,OAAS,GAC7C,IAAI8H,EAAMlK,EAAcoC,MACxB,IAAK,IAAI9B,EAAI,EAAGA,EAAI2J,EAAc1J,OAAS,EAAGD,IAC1C4J,EAAMA,EAAID,EAAc3J,IAAM4J,EAAID,EAAc3J,KAAO,GAE3D4J,EAAID,EAAcA,EAAc1J,OAAS,IAAM/D,EAC/CwN,EAAerJ,KAAKX,GAExBI,KAAKsI,iBAAiBc,KAAKQ,GAE/B,kBAAkB1M,GACd,IAAIsM,EAAWxJ,KAAKwI,UACpB,IAAKgB,EACD,MAAM,IAAOO,iBAajB,OADqB9B,EAAqB+B,oBAAoBR,EAAWV,GAASA,EAAKK,IAAMjM,GACvE,GAE1B,oBAAoB+M,EAAWC,GAC3B,IAAIC,EAAe,KACnB,IAAK,IAAIjK,EAAI,EAAGA,EAAIgK,EAAW/J,OAAQD,IAAK,CACxC,IAAI+I,EAAQiB,EAAWhK,GACvB,GAAoB,iBAAT+I,GAEPgB,GAAahB,EAAME,GAAI,CACvBgB,EAAejK,EACf,OAGR,GAAoB,MAAhBiK,EAAsB,CACtB,IAAK,IAAIjK,EAAI,EAAGA,EAAIgK,EAAW/J,OAAQD,IAAK,CACxC,IAAIU,EAAIsJ,EAAWhK,GACnB,GAAgB,iBAALU,EACP,SACJ,IAAIkB,EAAWlB,EAAEkB,SACjB,GAAIA,GAAYA,EAAS3B,OAAS,EAAG,CAEjC,GADgBH,KAAKyJ,oBAAoBQ,EAAWnI,GAEhD,OAAO,GAInB,OAAO,EAWX,OAToB,GAAhBqI,EACAD,EAAWE,QAEND,GAAgBD,EAAW/J,OAAS,EACzC+J,EAAWnB,MAGXmB,EAAWG,OAAOF,EAAc,IAE7B,EAEX,2BAA2BX,EAAU7I,GACjC,IAAIkI,EAAQ,IAAI9B,MAChB8B,EAAMtI,KAAKiJ,GACX,IAAIc,EAAI,GAGR,IADA3J,EAASA,GAAU,MAAO,GACnBkI,EAAM1I,OAAS,GAAG,CACrB,IAAI2I,EAAOD,EAAMuB,QACbzJ,EAAOmI,IACPwB,EAAE/J,KAAKuI,GAIX,IAAIhH,GAAYgH,EAAKhH,UAAY,IAAInB,OAAOC,GAAiB,iBAALA,GAExDiI,EAAMtI,QAAQuB,GAElB,OAAOwI,EAQX,gBAAgBjB,EAAUzJ,EAAe2K,GACrC,IAAKlB,EACD,MAAM,IAAO5K,aAAa,YAC9B,IAAKmB,EACD,MAAM,IAAOnB,aAAa,kBAC9BuB,KAAKyI,kBAAkB7I,GACvB,IAAI4K,EAAgBxK,KAAKuJ,kBAAkBF,GAC3C,GAAqB,MAAjBmB,EACA,MAAM,IAAI1N,MAAM,wBACpB8B,QAAQC,OAAwB,MAAjB2L,GACfA,EAAc1I,SAAW0I,EAAc1I,UAAY,GAC7B,MAAlByI,EACAC,EAAc1I,SAASuI,OAAOE,EAAgB,EAAG3K,GAGjD4K,EAAc1I,SAASvB,KAAKX,GAEhCI,KAAKyK,iBAAiB7K,EAAcuJ,IACpCnJ,KAAKqI,gBAAgBe,KAAKpJ,MAM9B,qBAAqBpC,GACjB,IAAI8M,EAAkB,GAwBtB,IAAK9M,EAAU6B,KAAM,CACjB,IACIA,EADAkL,EAAM,EAEV,GACIA,GAAY,EACZlL,EAAO,GAAG7B,EAAUmB,OAAO4L,UACtBD,EAAgBjL,IACzBiL,EAAgBjL,GAAQ7B,EACxBA,EAAU6B,KAAOA,EAEhB7B,EAAUuL,KACXvL,EAAUuL,GAAK,kBACnBvL,EAAUkE,SAAWlE,EAAUkE,UAAY,GACtClE,EAAUkE,UAAyC,GAA7BlE,EAAUkE,SAAS3B,QAG9CvC,EAAUkE,SAASkG,QAAQiB,IACvB,GAAoB,iBAATA,EACP,OAAO,EACXhB,EAAqBS,cAAcO,KAG3C,0BAA0BO,EAAUoB,GAGhC,IAAIC,EAAe,GAEnB5C,EAAqB+B,oBAAoBR,GAAUxB,QAAQc,IACvDlK,QAAQC,OAAqB,MAAdiK,EAAK9G,OAA4B,MAAX8G,EAAKK,IAC1C0B,EAAa/B,EAAK/J,MAAQ8L,EAAa/B,EAAK/J,OAAS,GACrD8L,EAAa/B,EAAK/J,MAAMwB,KAAKuI,EAAK9G,MAAU,IAC5C,IAAI8I,EAAUhC,EAAK9G,MAAMkD,IACzB4D,EAAK9G,MAAMkD,IAAOC,IACL,MAALA,IACAyF,EAAW9B,EAAK/J,MAAQ6L,EAAW9B,EAAK/J,OAAS,GACjD6L,EAAW9B,EAAK/J,MAAMwB,KAAK4E,IAET,mBAAX2F,GACPA,EAAQ3F,MAKpB,IAAI4F,EAAQxO,OAAO2K,oBAAoB0D,GACvC,IAAK,IAAI1K,EAAI,EAAGA,EAAI6K,EAAM5K,OAAQD,IAAK,CACnC,IAAIZ,EAAWyL,EAAM7K,GACjB8K,EAAMH,EAAavL,IAAa,GACpCsL,EAAWtL,IAAasL,EAAWtL,IAAa,IAAIqB,OAAOC,GAAKoK,EAAIlM,QAAQ8B,EAAM,IAAKA,EAAEoB,MAAU,KAAM,IAQjH,gBAAgB9E,GACZ,OAAO8C,KAAKyK,iBAAiBvN,GAMjC,iBAAiB2N,GACc,iBAAhBA,IACPA,EAAe,CAACA,IACpB,IAAIhC,EAAQ,GAEZ,IADAA,EAAMtI,KAAKP,KAAKwI,WACTK,EAAM1I,OAAS,GAAG,CACrB,IAAI2I,EAAOD,EAAME,MACbkC,EAAoBJ,EAAa/L,QAAQgK,EAAKK,KAAO,EACzDL,EAAKE,SAAWiC,EAChBnC,EAAKhH,SAASkG,QAAQiB,IAClB,GAAoB,iBAATA,EACP,OAAO,EACXJ,EAAMtI,KAAK0I,KAGnBjJ,KAAK1C,kBAAkB8L,KAAKpJ,KAAKkL,sBAErC,gBAAgBhO,GACZ,OAAO8C,KAAKmL,iBAAiB,CAACjO,IAGlC,iBAAiB2N,GACb,IAAIrB,EAAWxJ,KAAKwJ,SACpB,IAAKA,IAAaA,EAAS1H,UAAwC,GAA5B0H,EAAS1H,SAAS3B,OACrD,OACJ,IAAI2B,EAAW0H,EAAS1H,SACxB+I,EAAa7C,QAAQiC,IACjBjK,KAAKyJ,oBAAoBQ,EAAWnI,KAExC9B,KAAKoI,iBAAiBgB,KAAKyB,GAE/B,qBAAqB3N,EAAakO,GAC9B,OAAOpL,KAAKqL,sBAAsB,CAAC,CAAEnO,cAAakO,cAEtD,sBAAsBE,GAClB,IAAIC,EAAgB,GACpBD,EAAUtD,QAAQpH,IACd,IAAI,YAAE1D,GAAgB0D,GAClB,KAAE4K,EAAI,IAAEC,GAAQ7K,EAAEwK,SAClBxL,EAAgBI,KAAKuJ,kBAAkBrM,GAC3C,IAAK0C,EACD,MAAM,IAAI9C,MAAM,WAAWI,mBAC/B,IAAIoI,EAAQ1F,EAAcoC,MAAMsD,MAAS1F,EAAcoC,MAAMsD,OAAS,GAClEkG,IACAlG,EAAMkG,KAAOA,GACbC,IACAnG,EAAMmG,IAAMA,GAChBF,EAAchL,KAAK,CAAErD,cAAakD,SAAU,QAAShE,MAAOkJ,MAEhEtF,KAAK0L,qBAAqBH,GAO9B,iBAAiBrO,EAAayO,GAC1B/M,QAAQC,OAAsB,MAAf3B,GACf0B,QAAQC,OAAe,MAAR8M,GACf,IAAI/L,EAAgBI,KAAKuJ,kBAAkBrM,GAC3C,IAAK0C,EACD,MAAM,IAAI9C,MAAM,WAAWI,mBAC/B,IAAIoI,EAAQ1F,EAAcoC,MAAMsD,MAAS1F,EAAcoC,MAAMsD,OAAS,GAClEqG,EAAKC,SACLtG,EAAMsG,OAASD,EAAKC,QACpBD,EAAKE,QACLvG,EAAMuG,MAAQF,EAAKE,OAEvB7L,KAAK0L,qBAAqB,CAAC,CAAExO,cAAakD,SAAU,QAAShE,MAAOkJ,Q,iBC/V5E;;;;;;;;;AAQA,IAAiD9J,EAS5B,oBAAXM,QAAkCA,OATKN,EASG,SAASsQ,GAC7D,OAAgB,SAAUC,GAEhB,IAAIC,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUzQ,QAGnC,IAAIC,EAASsQ,EAAiBE,GAAY,CACzChM,EAAGgM,EACHC,GAAG,EACH1Q,QAAS,IAUV,OANAsQ,EAAQG,GAAUxP,KAAKhB,EAAOD,QAASC,EAAQA,EAAOD,QAASwQ,GAG/DvQ,EAAOyQ,GAAI,EAGJzQ,EAAOD,QA0Df,OArDAwQ,EAAoBG,EAAIL,EAGxBE,EAAoBpK,EAAImK,EAGxBC,EAAoBI,EAAI,SAAS5Q,EAASgE,EAAMtD,GAC3C8P,EAAoBrL,EAAEnF,EAASgE,IAClClD,OAAO2F,eAAezG,EAASgE,EAAM,CAAExD,YAAY,EAAMC,IAAKC,KAKhE8P,EAAoB3B,EAAI,SAAS7O,GACX,oBAAX6Q,QAA0BA,OAAOC,aAC1ChQ,OAAO2F,eAAezG,EAAS6Q,OAAOC,YAAa,CAAEnQ,MAAO,WAE7DG,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,KAQvD6P,EAAoBO,EAAI,SAASpQ,EAAOqQ,GAEvC,GADU,EAAPA,IAAUrQ,EAAQ6P,EAAoB7P,IAC/B,EAAPqQ,EAAU,OAAOrQ,EACpB,GAAW,EAAPqQ,GAA8B,iBAAVrQ,GAAsBA,GAASA,EAAMsQ,WAAY,OAAOtQ,EAChF,IAAIuQ,EAAKpQ,OAAO4L,OAAO,MAGvB,GAFA8D,EAAoB3B,EAAEqC,GACtBpQ,OAAO2F,eAAeyK,EAAI,UAAW,CAAE1Q,YAAY,EAAMG,MAAOA,IACtD,EAAPqQ,GAA4B,iBAATrQ,EAAmB,IAAI,IAAIC,KAAOD,EAAO6P,EAAoBI,EAAEM,EAAItQ,EAAK,SAASA,GAAO,OAAOD,EAAMC,IAAQC,KAAK,KAAMD,IAC9I,OAAOsQ,GAIRV,EAAoBW,EAAI,SAASlR,GAChC,IAAIS,EAAST,GAAUA,EAAOgR,WAC7B,WAAwB,OAAOhR,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAuQ,EAAoBI,EAAElQ,EAAQ,IAAKA,GAC5BA,GAIR8P,EAAoBrL,EAAI,SAASjE,EAAQC,GAAY,OAAOL,OAAOC,UAAUC,eAAeC,KAAKC,EAAQC,IAGzGqP,EAAoBY,EAAI,GAIjBZ,EAAoBA,EAAoBa,EAAI,kBAnF7C,CAsFN,CAEJ;;;;8BAKA,SAAUpR,EAAQD,EAASwQ,GAEjC,aAEA1P,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IACtD,MAAM2Q,EAAQd,cAAiC,SACzC1J,EAAW0J,iBAAoC,mBAuCrDxQ,EAAQuR,iBAtCR,MACI,YAAYC,GACRjN,KAAKiN,eAAiBA,EAE1B,gBAAgBrN,EAAesN,GAC3B,IACI,OAAOlN,KAAKmN,iBAAiBvN,EAAesN,GAEhD,MAAO/H,GACH,OAAOnF,KAAKoN,mBAAmBjI,IAIvC,oBAAoBnD,KAAUF,GAC1B,OAAOiL,EAAMzO,cAAc,MAAO0D,KAAUF,GAEhD,mBAAmBuL,GAKf,OAAOrN,KAAKsN,oBAAoBtN,KAAKsN,oBAAoB,UAAWtN,KAAKsN,oBAAoBD,EAAIE,UAErG,iBAAiB3N,EAAesN,GAC5B,GAA4B,iBAAjBtN,EACP,OAAOA,EACX,IAAIkC,GAAYlC,EAAckC,UAAY,IAAIC,IAAIF,GAAK7B,KAAKmN,iBAAiBtL,IACzEG,EAASpC,EAAcoC,OAAS,GAEhCvC,EAAOG,EAAc4N,SACrBC,EAAgBzN,KAAKiN,eAAexN,GACxC,GAAqB,MAAjBgO,EACA,MAAMlL,EAASC,OAAOkL,mBAAmBjO,GAG7C,OADQsN,EAAMzO,cAAcmP,EAAezL,EAAOF,MASpD;;;;8BAKA,SAAUpG,EAAQD,EAASwQ,GAEjC,aAEA1P,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IACtDX,EAAQ+G,OAAS,CACbmL,kBAAkBlO,GAEP,IAAI3C,MADD,kBAAkB2C,iDAGhCmO,gBAAe,CAACnO,EAAMoO,IAEX,IAAI/Q,MADD,2BAA2B2C,sCAAyCoO,OAGlFH,mBAAmBjO,GAER,IAAI3C,MADD,cAAc2C,oBAQ1B;;;;8BAKA,SAAU/D,EAAQD,EAASwQ,GAEjC,aAEA1P,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IACtD,IAAI0R,EAAsB7B,4BAA+C,8BACzExQ,EAAQuR,iBAAmBc,EAAoBd,kBAKzC;;;;8BAKA,SAAUtR,EAAQD,GAExBC,EAAOD,QAAUqQ,MA1MfpQ,EAAOD,QAAUD,EAAQ,EAAQ,M;;;;;;;;;ACFnC,IAAiDA,EAS9CM,OAT8CN,EAStC,WACX,OAAgB,SAAUuQ,GAEhB,IAAIC,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUzQ,QAGnC,IAAIC,EAASsQ,EAAiBE,GAAY,CACzChM,EAAGgM,EACHC,GAAG,EACH1Q,QAAS,IAUV,OANAsQ,EAAQG,GAAUxP,KAAKhB,EAAOD,QAASC,EAAQA,EAAOD,QAASwQ,GAG/DvQ,EAAOyQ,GAAI,EAGJzQ,EAAOD,QA0Df,OArDAwQ,EAAoBG,EAAIL,EAGxBE,EAAoBpK,EAAImK,EAGxBC,EAAoBI,EAAI,SAAS5Q,EAASgE,EAAMtD,GAC3C8P,EAAoBrL,EAAEnF,EAASgE,IAClClD,OAAO2F,eAAezG,EAASgE,EAAM,CAAExD,YAAY,EAAMC,IAAKC,KAKhE8P,EAAoB3B,EAAI,SAAS7O,GACX,oBAAX6Q,QAA0BA,OAAOC,aAC1ChQ,OAAO2F,eAAezG,EAAS6Q,OAAOC,YAAa,CAAEnQ,MAAO,WAE7DG,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,KAQvD6P,EAAoBO,EAAI,SAASpQ,EAAOqQ,GAEvC,GADU,EAAPA,IAAUrQ,EAAQ6P,EAAoB7P,IAC/B,EAAPqQ,EAAU,OAAOrQ,EACpB,GAAW,EAAPqQ,GAA8B,iBAAVrQ,GAAsBA,GAASA,EAAMsQ,WAAY,OAAOtQ,EAChF,IAAIuQ,EAAKpQ,OAAO4L,OAAO,MAGvB,GAFA8D,EAAoB3B,EAAEqC,GACtBpQ,OAAO2F,eAAeyK,EAAI,UAAW,CAAE1Q,YAAY,EAAMG,MAAOA,IACtD,EAAPqQ,GAA4B,iBAATrQ,EAAmB,IAAI,IAAIC,KAAOD,EAAO6P,EAAoBI,EAAEM,EAAItQ,EAAK,SAASA,GAAO,OAAOD,EAAMC,IAAQC,KAAK,KAAMD,IAC9I,OAAOsQ,GAIRV,EAAoBW,EAAI,SAASlR,GAChC,IAAIS,EAAST,GAAUA,EAAOgR,WAC7B,WAAwB,OAAOhR,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAuQ,EAAoBI,EAAElQ,EAAQ,IAAKA,GAC5BA,GAIR8P,EAAoBrL,EAAI,SAASjE,EAAQC,GAAY,OAAOL,OAAOC,UAAUC,eAAeC,KAAKC,EAAQC,IAGzGqP,EAAoBY,EAAI,GAIjBZ,EAAoBA,EAAoBa,EAAI,uBAnF7C,CAsFN,CAEJ;;;;8BAKA,SAAUpR,EAAQD,EAASwQ,GAEjC,aAEA1P,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IAMtDX,EAAQmC,UAJR,SAAmBqD,GACf,OAAO,SAAwB8M,UA5GjCrS,EAAOD,QAAUD,K,6DCNZ,MAAM,UAAuB,YAChC,YAAYwG,GACRgB,MAAMhB,GACNhC,KAAKgO,SAAW,KAChBhO,KAAKkD,MAAQ,CAAE+K,eAAgB,IAC/BjO,KAAKgC,MAAM9D,SAASZ,kBAAkB4Q,IAAI,KACtC,IAAIC,EAAUnO,KAAKoO,WAAWpO,KAAKgC,MAAM9D,UACzC8B,KAAK6E,SAAS,CAAEoJ,eAAgBE,MAMxC,WAAWjQ,GACP,GAAgB,MAAZA,EACA,MAAO,GAGX,IAuBImQ,EAvBAC,EAAwB,GACxBpF,EAAqBhL,EAASgL,mBAClC,IAAK,IAAIhJ,EAAI,EAAGA,EAAIgJ,EAAmB/I,OAAQD,IAAK,CAChD,IAAIN,EAAgBsJ,EAAmBhJ,GACnCqO,EAAkB,IAAUC,eAAe5O,GAC/C,GAAS,GAALM,EACAoO,EAAwBC,GAAmB,OAE1C,CACD,IAAI5H,EAAQ,GACZ2H,EAAsBtG,QAAQyG,IAC1BF,EAAgBvG,QAAQ0G,IACpB,IAAIC,EAAYF,EAAUrO,SACtBwO,EAAYF,EAAUtO,SACtBqO,EAAU3N,YAAc4N,EAAU5N,YAAc6N,GAAaC,GAC7DjI,EAAMpG,KAAKkO,OAIvBH,EAAwB3H,GAKhC,IAAK,IAAIzG,EAAI,EAAGA,EAAIgJ,EAAmB/I,OAAQD,IAAK,CAChD,IAAI2O,EAAU3F,EAAmBhJ,GAC7B4O,EAAevS,OAAOmD,OAAO,GAAImP,EAAQ7M,OAG7C,UAFO8M,EAAahN,SAEX,GAAL5B,EACAmO,EAAkBS,MAEjB,CACD,IAAIhF,EAAM,GACV,IAAK,IAAIzN,KAAOgS,EACRA,EAAgBhS,IAAQyS,EAAazS,KACrCyN,EAAIzN,GAAOyS,EAAazS,IAEhCgS,EAAkBvE,GAG1B,IAAIqE,EAAU,GACd,IAAK,IAAIjO,EAAI,EAAGA,EAAIoO,EAAsBnO,OAAQD,IAAK,CACnD,IAAIH,EAAiBuO,EAAsBpO,GACvCE,EAAWL,EAAeK,SAE1BU,EAAaf,EAAee,WAE5BiO,EAAc,CACd3S,MAFQ4D,KAAKgP,UAAU5O,EAAUiO,GAGjCY,eAAgB/F,EAChBxB,oBAAsBtL,IAClB,IAAIuN,EAAiBT,EAAmBnH,IAAInB,IAAK,CAC7C1D,YAAa0D,EAAEuI,GAAI/I,SAAUL,EAAeK,SAAUhE,WAE1D8B,EAASwN,qBAAqB/B,KAGlCuF,EAAS,gBAAoBpO,EAAYiO,GAC7CZ,EAAQ5N,KAAK,CAAE4O,KAAMpP,EAAeK,SAAU8O,SAAQnO,MAAOhB,EAAegB,QAEhF,OAAOoN,EAEX,UAAU/N,EAAU4B,GAChB,IAAK5B,EACD,MAAM,IAAO3B,aAAa,YAC9B,IAAKuD,EACD,MAAM,IAAOvD,aAAa,SAC9B,IAAIoL,EAAgBzJ,EAASe,MAAM,KAC/B2I,EAAM9H,EACV,IAAK,IAAI9B,EAAI,EAAGA,EAAI2J,EAAc1J,OAAQD,IAEtC,GADA4J,EAAMA,EAAID,EAAc3J,IACb,MAAP4J,EACA,OAAO,KAEf,OAAOA,EAEX,SACI,IAAI,SAAE5L,GAAa8B,KAAKgC,MACpBmM,EAAUnO,KAAKkD,MAAM+K,eACzB,GAAsB,GAAlBE,EAAQhO,OAAa,CACrB,IAAI8E,EAAQjF,KAAKgC,MAAMiD,MACvB,OAAO,gBAAoB,MAAO,CAAEtG,UAAW,eAAiBsG,GAEpE,GAAIjF,KAAKgC,MAAMoN,aAAc,CACzB,IAAIzI,EAAQwH,EAAQpM,IAAInB,GAAKrE,OAAOmD,OAAO,CAAEwB,YAAa,IAAkBN,EAAEuO,OAASvO,EAAEuO,MAAQvO,IAC7F0J,EAAItK,KAAKgC,MAAMoN,aAAalR,EAASgL,mBAAoBvC,GAC7D,GAAS,MAAL2D,EACA,OAAOA,EAGf,IAAI+E,EAAoB,GACxB,IAAK,IAAInP,EAAI,EAAGA,EAAIiO,EAAQhO,OAAQD,IAAK,CACrC,IAAIa,EAAQoN,EAAQjO,GAAGa,OAAS,GAC5BuO,EAAeD,EAAkB1O,OAAOC,GAAKA,EAAEG,OAASA,GAAO,GAC/C,MAAhBuO,IACAA,EAAe,CAAEvO,MAAOoN,EAAQjO,GAAGa,MAAOoN,QAAS,IACnDkB,EAAkB9O,KAAK+O,IAE3BA,EAAanB,QAAQ5N,KAAK,CAAE4O,KAAMhB,EAAQjO,GAAGiP,KAAMD,OAAQf,EAAQjO,GAAGgP,SAE1E,OAAO,gBAAoB,WAAgB,KAAMG,EAAkBtN,IAAKwN,GAAM,gBAAoB,MAAO,CAAElT,IAAKkT,EAAExO,MAAOpC,UAAW,uBAChI4Q,EAAExO,MAAQ,gBAAoB,MAAO,CAAEpC,UAAW,iBAAmB,IAAkB4Q,EAAExO,QAAUwO,EAAExO,OAAS,KAC9G,gBAAoB,MAAO,CAAEpC,UAAW,cAAgB4Q,EAAEpB,QAAQpM,IAAI,CAACnB,EAAGV,IAAM,gBAAoB,MAAO,CAAE7D,IAAKuE,EAAEuO,KAAMxQ,UAAW,uBACjI,gBAAoB,QAAS,KAAM,IAAkBiC,EAAEuO,OAASvO,EAAEuO,MAClE,gBAAoB,MAAO,CAAExQ,UAAW,WACpC,gBAAoB,EAAe,KAAMiC,EAAEsO,eAE3D,cACI,OAAOlP,KAAKgO,UAGb,MAAM,UAAsB,YAC/B,YAAYhM,GACRgB,MAAMhB,GACNhC,KAAKkD,MAAQ,GAEjB,kBAAkBsM,EAAOC,GAErBzP,KAAK6E,SAAS,CAAE2K,UAKpB,SACI,IAAI,MAAEA,GAAUxP,KAAKkD,OAAS,GAC9B,OAAIsM,EAEO,gBAAoB,MAAO,CAAE7Q,UAAW,SAC3C,gBAAoB,MAAO,KAAM6Q,EAAMjC,SACvC,gBAAoB,MAAO,KAAMiC,EAAM3G,QAExC7I,KAAKgC,MAAMF,U,WC1J1B,kCAGO,MAAM,UAAoB,YAE7B,YAAYE,GACRgB,MAAMhB,GACNhC,KAAKkD,MAAQ,CAAE0G,eAAgB,IAMnC,eACI,OAAO5J,KAAK0P,UAkBhB,SACI,IAAI,MAAEzK,GAAUjF,KAAKgC,MACrBiD,EAAQA,GAAS,gBAAoB,MAAO,CAAEtG,UAAW,SAAW,WACpE,IAAI,SAAET,GAAa8B,KAAKgC,MACxB,OAAO,gBAAoB,MAAO,CAAErD,UAAW,GAAG,IAAWV,eAAe+B,KAAKgC,MAAMrD,WAAa,KAAMuG,IAAMC,GAAMnF,KAAK5B,QAAU+G,GAAKnF,KAAK5B,SAC3I,gBAAoB,EAAgB,CAAEF,SAAUA,EAAUgH,IAAKC,GAAKnF,KAAKkP,OAAS/J,GAAKnF,KAAKkP,OAAQjK,MAAOA,EAAOmK,aAAcpP,KAAKgC,MAAMoN,mB,2EC1BhJ,MAAM,UAAyB,YAClC,YAAYpN,GACRgB,MAAMhB,GAEV,kBAAkBwN,EAAOC,GAErBzP,KAAK6E,SAAS,CAAE2K,UAKpB,mBAAmBpR,EAASmB,GACxB,IAAKnB,EACD,MAAM,IAAOK,aAAa,WAC9B,IAAKc,EACD,MAAM,IAAOd,aAAa,QAC9B,GAAIL,EAAQuR,aAAa,iBACrB,OAEJvR,EAAQY,aAAa,gBAAiB,YACtC,IAAId,EAAW8B,KAAKgC,MAAM4N,QAC1BhR,QAAQC,OAAyB,MAAlBU,EAAKkC,WACpB7C,QAAQC,OAAuB,MAAhBU,EAAKmC,SAChBnC,EAAKkC,WACL,EAAiBoO,sBAAsBzR,EAASF,GAEhDqB,EAAKmC,SACL9C,QAAQC,OAAkB,MAAXT,GACf,EAAiB8F,UAAUhG,EAAUE,GACjB,MAAhB4B,KAAK4P,SACL,EAAiB1L,UAAUhG,EAAUE,EAAS4B,KAAK4P,UAGvDxR,EAAQ0R,QAAW1L,GAAO,EAAiB2L,cAAc3L,EAAIlG,EAAUE,GAM/E,6BAA6BA,EAASF,GAClCU,QAAQC,OAAkB,MAAXT,GACfA,EAAQ+F,iBAAiB,YAAY,SAAU6L,GAC3CA,EAAMC,iBACND,EAAME,kBACN,IAAI/S,EAAgB6S,EAAM3L,aAAaU,QAAQ,IAAUnF,eAErDoQ,EAAM3L,aAAa8L,WADnBhT,EACgC,OAEA,OACpCyB,QAAQwR,IAAI,kBAAkBJ,EAAc,cAASA,EAAc,aAEvE5R,EAAQ+F,iBAAiB,QAAQ,SAAU6L,GACvCA,EAAMC,iBACND,EAAME,kBACMG,UAAU,GACtB,IAAKL,EAAM3L,aACP,OACJ,IAAIoB,EAAO,IAAe6K,iBAAiBN,EAAM3L,cACjD,IAAKoB,EACD,OACJA,EAAKzD,MAAMsD,MAAQG,EAAKzD,MAAMsD,OAAS,GACvCpH,EAASsL,SAASxH,MAAMsD,MAAQpH,EAASsL,SAASxH,MAAMsD,OAAS,GAC5DG,EAAKzD,MAAMsD,MAAM8F,WAClB3F,EAAKzD,MAAMsD,MAAM8F,SAAWlN,EAASsL,SAASxH,MAAMsD,MAAM8F,UAE9D,IAAImF,EAAM,IAAeC,mBAAmBR,EAAM3L,cAClDzF,QAAQC,OAAc,MAAP0R,GACkB,YAA7B9K,EAAKzD,MAAMsD,MAAM8F,WACjB3F,EAAKzD,MAAMsD,MAAMkG,KAAOwE,EAAc,OAAIO,EAAI9L,EAC9CgB,EAAKzD,MAAMsD,MAAMmG,IAAMuE,EAAc,OAAIO,EAAI5L,GAEjDzG,EAASwL,gBAAgBtL,EAAQ+K,GAAI1D,MAG7C,+BAA+B9G,GAM3B,MALiB,CACb,mBAAoB,mBAAoB,mBACxC,mBAAoB,mBAAoB,mBACxC,mBAAoB,oBAENG,QAAQH,IAAc,EAE5C,iBAAiBT,EAAUE,EAASwR,GAChC,IAAK1R,EACD,MAAM,IAAOO,aAAa,YAC9B,IAAKL,EACD,MAAM,IAAOK,aAAa,WAC9BG,QAAQC,OAAqB,IAAdT,EAAQ+K,IACvByG,EAAUA,GAAWxR,EACrB,IAEIqS,EACAC,EACAC,EAJAzT,EAAckB,EAAQ+K,GAC1BvK,QAAQC,OAAsB,IAAf3B,GAIf0T,EAAEhB,GACGiB,KAAK,QAAQ,SAAUzM,GAExB,GADAqM,EAAWG,EAAExS,GAASgN,WAClBwF,EAAE5Q,MAAM8Q,GAAG,IAAI,IAAWxT,qBAC1B,OAAOsT,EAAE,IAAI,IAAWtT,wBAE3BuT,KAAK,SAAS,SAAUzM,EAAI2M,GAC7BA,EAAGxR,KAAOqR,EAAExM,EAAGiD,QAAQ8H,KAAK,aAC5B4B,EAAGlF,MAAQ+E,EAAE5Q,MAAM6L,QACnBkF,EAAGnF,OAASgF,EAAE5Q,MAAM4L,SACpBmF,EAAGC,cAAgB5S,EACnBuS,EAAYM,KAAKC,SAEhBL,MAAK,SAAUzM,EAAI2M,GACpB3M,EAAG6L,iBACH7L,EAAG8L,kBACHtR,QAAQwR,IAAI,SACZxR,QAAQwR,IAAIW,EAAGI,MACfT,EAAO,GACHK,EAAGxR,KAAKT,QAAQ,MAAQ,IACxB4R,EAAK7E,MAAQuF,KAAKC,IAAI,GAAIN,EAAGlF,MAAQkF,EAAGO,SAExCP,EAAGxR,KAAKT,QAAQ,MAAQ,IACxB4R,EAAK9E,OAASwF,KAAKC,IAAI,GAAIN,EAAGnF,OAASmF,EAAGQ,SAE1CR,EAAGxR,KAAKT,QAAQ,MAAQ,IACxB4R,EAAK7E,MAAQuF,KAAKC,IAAI,GAAIN,EAAGlF,MAAQkF,EAAGO,QACxCE,EAAQT,IAERA,EAAGxR,KAAKT,QAAQ,MAAQ,IACxB4R,EAAK9E,OAASwF,KAAKC,IAAI,GAAIN,EAAGnF,OAASmF,EAAGQ,QAC1CE,EAAOV,IAEPA,EAAGxR,KAAKT,QAAQ,OAAS,GACzB0S,EAAQT,IACRA,EAAGxR,KAAKT,QAAQ,OAAS,GAAKiS,EAAGxR,KAAKT,QAAQ,OAAS,GAAKiS,EAAGxR,KAAKT,QAAQ,OAAS,IACrF4S,EAAYX,GACZA,EAAGxR,KAAKT,QAAQ,OAAS,GACzB2S,EAAOV,GACPA,EAAGxR,KAAKT,QAAQ,SAAW,IAC3B4R,EAAKjF,IAAMsF,EAAGnM,QACd8L,EAAKlF,KAAOuF,EAAGrM,SAEd,EAAiBiN,wBAAwBZ,EAAGxR,OAC7CmS,EAAYX,GAEZA,EAAGxR,MACHqR,EAAE5Q,MAAM4R,IAAIlB,KACjB,CAAEmB,OAAO,IACPhB,KAAK,OAAO,SAAUzM,EAAI2M,GAC3B,IAAIe,EAAWb,KAAKC,MAAQP,EAE5B,GADA,EAAiBoB,OAASD,GAAY,IACjC,EAAiBH,wBAAwBZ,EAAGxR,MAM5C,CACD,IAAIiM,EAAMC,EACNsF,EAAGxR,KAAKT,QAAQ,MAAQ,IACxB0M,EAAOiF,EAASjF,KAAOuF,EAAGO,QAC1BP,EAAGxR,KAAKT,QAAQ,MAAQ,IACxB2M,EAAMgF,EAAShF,IAAMsF,EAAGQ,QAC5BnT,EAAQkH,MAAM0M,UAAY,GAC1B9T,EAAS+T,qBAAqB7T,EAAQ+K,GAAI,CAAEqC,OAAMC,QAClDvN,EAASgU,iBAAiBhV,EAAawT,OAda,CACpD,IAAIlF,EAAOiF,EAASjF,KAAOuF,EAAGO,OAC1B7F,EAAMgF,EAAShF,IAAMsF,EAAGQ,OAC5BrT,EAAS+T,qBAAqB7T,EAAQ+K,GAAI,CAAEqC,OAAMC,QAClDrN,EAAQkH,MAAM0M,UAAY,OAa7BH,MAAOzN,IACR,EAAiB2L,cAAc3L,EAAIlG,EAAUE,KAEjD,IAAIsT,EAAeX,IACfnS,QAAQwR,IAAI,CAAC,yBAA0BW,EAAGrM,QAASqM,EAAGnM,UACtDhG,QAAQwR,IAAIW,GACZ3S,EAAQkH,MAAM0M,UAAY,aAAajB,EAAGO,YAAYP,EAAGQ,aAEzDE,EAAUV,IACV3S,EAAQkH,MAAM0M,UAAY,cAAcjB,EAAGQ,aAE3CC,EAAWT,IACX3S,EAAQkH,MAAM0M,UAAY,cAAcjB,EAAGO,aAGnD,qBAAqBlN,EAAIlG,EAAUE,GAG/B,GAFAgG,EAAG6L,iBACH7L,EAAG8L,kBACC,EAAiB6B,OAEjB,YADA,EAAiBA,QAAS,GAG9B,IAAII,EAAY/T,EAAQ+K,GACxB,IAAK/E,EAAGgO,QAEJ,YADAlU,EAASmU,gBAAgBjU,EAAQ+K,IAGrC,IAAImJ,EAAqBpU,EAASgN,qBAClCtM,QAAQC,OAAoB,IAAbsT,GACXG,EAAmBxT,QAAQqT,IAAc,EACzCG,EAAqBA,EAAmB3R,OAAOC,GAAKA,GAAKuR,GAGzDG,EAAmB/R,KAAK4R,GAE5BjU,EAASuM,iBAAiB6H,GAE9B,oBACI,IAAKtS,KAAK5B,QACN,OAEJ,IAAImB,EAAOS,KAAKgC,MAAMuQ,OAAOhT,KAC7BS,KAAKwS,mBAAmBxS,KAAK5B,QAASmB,GAE1C,SACI,IAAI,MAAEiQ,GAAUxP,KAAKkD,OAAS,GAC9B,GAAIsM,EACA,OAAO,gBAAoB,MAAO,CAAE7Q,UAAW,SAC3C,gBAAoB,MAAO,KAAM6Q,EAAMjC,SACvC,gBAAoB,MAAO,KAAMiC,EAAM3G,QAE/C,IAAItJ,EAAOS,KAAKgC,MAAMuQ,OAAOhT,KAE7B,KADoBA,EAAKqC,QAA4C,iBAA1B5B,KAAKgC,MAAMuQ,OAAOxT,MAAoBiB,KAAKgC,MAAMuQ,OAAOxT,MAAQ,KAEvG,OAAOiB,KAAKyS,wBAEhB,IAAIzQ,EAAQhC,KAAKgC,MAAMuQ,OAAOvQ,MAC1BsD,EAAQtD,EAAMsD,MAAQf,KAAKS,MAAMT,KAAKC,UAAUxC,EAAMsD,OAAS,MAC/D,IAAEmG,EAAG,KAAED,EAAI,SAAEJ,EAAQ,MAAES,EAAK,OAAED,EAAM,QAAEvL,EAAO,WAAEqS,GAAepN,EAC9D3G,EAAY,YAAgBqD,EAAMrD,WAAa,GAAI,IAAWd,kBAClEc,EAAYqD,EAAMgH,SAAW,YAAgBrK,EAAW,IAAWrB,mBAAqBqB,EACxF,IAAIgU,EAAe,CACfxJ,GAAInH,EAAMmH,GACVxK,YACA2G,MAAO,CAAEmG,MAAKD,OAAMJ,WAAUS,QAAOD,SAAQvL,UAASqS,cACtDxN,IAAMC,GAAMnF,KAAK5B,QAAU+G,GAAKnF,KAAK5B,SAErCwU,EAAc5Q,EAAMgH,UAAYzJ,EAAKoC,YAAc,gBAAoB,MAAO,CAAEhD,UAAW,cAAe2G,MAAO,GAAIJ,IAAKC,GAAKnF,KAAK4P,QAAUzK,GAAKnF,KAAK4P,UAAa,KACrKiD,EAAmBtT,EAAKqC,QAAkC,YAAxBI,EAAMsD,MAAM8F,UAA0BpJ,EAAMgH,SAC9EuJ,EAASvS,KAAKgC,MAAMuQ,OAYxB,OAXIvQ,EAAMsD,eACCtD,EAAMsD,MAAMkG,YACZxJ,EAAMsD,MAAMmG,WACZzJ,EAAMsD,MAAM8F,SACfuH,EAAarN,MAAMuG,OAAqC,SAA5B8G,EAAarN,MAAMuG,QAC/C7J,EAAMsD,MAAMuG,MAAQ,QACpB8G,EAAarN,MAAMsG,QAAuC,SAA7B+G,EAAarN,MAAMsG,SAChD5J,EAAMsD,MAAMsG,OAAS,SAItB,gBAAoB,IAAwBzI,SAAU,CAAE/G,MAAO4D,MAClE,gBAAoB,MAAOzD,OAAOmD,OAAO,GAAIiT,GACzCC,EACAC,EACI,gBAAoB,WAAgB,KAChC,gBAAoB,MAAO,CAAElU,UAAW,qBACxC,gBAAoB,MAAO,CAAEA,UAAW,qBACxC,gBAAoB,MAAO,CAAEA,UAAW,qBACxC,gBAAoB,MAAO,CAAEA,UAAW,qBACxC,gBAAoB,MAAO,CAAEA,UAAW,qBACxC,gBAAoB,MAAO,CAAEA,UAAW,qBACxC,gBAAoB,MAAO,CAAEA,UAAW,qBACxC,gBAAoB,MAAO,CAAEA,UAAW,sBAAyB,KACzEqB,KAAK8S,iBAAiBP,EAAOxT,KAAMwT,EAAOvQ,MAAOuQ,EAAOzQ,YAEpE,wBACI,IAAI,KAAE/C,EAAI,MAAEiD,EAAK,SAAEF,GAAa9B,KAAKgC,MAAMuQ,OACvCrN,EAAMlD,EAAMkD,IAChBlD,EAAMkD,IAAOC,IAGT,GAFkB,mBAAPD,GACPA,EAAIC,GACHA,EAEL,GAAIA,EAAE4N,QAAN,CACI,IAAIxT,EAAOS,KAAKgC,MAAMuQ,OAAOhT,KAC7BS,KAAKwS,mBAAmBrN,EAAG5F,UAI/ByC,EAAMgH,WACNhH,EAAMrD,UAAY,YAAgBqD,EAAMrD,WAAa,GAAI,IAAWrB,oBAExE,IAAIc,EAAU4B,KAAK8S,iBAAiB/T,EAAMiD,EAAOF,GACjD,OAAO,gBAAoB,IAAwBqB,SAAU,CAAE/G,MAAO4D,MAAQ5B,GAElF,iBAAiBW,EAAMiD,EAAOF,GAE1B,GADgD,IAA1BA,GAAY,IAAI3B,OAClB,CAChB,IAAI6S,EAAQhT,KAAKiT,uBAAuBlU,EAAMiD,GACjC,MAATgR,IACAlR,EAAW,CAACkR,IAEpB,OAAO,gBAAoBjU,EAAMiD,KAAUF,GAE/C,uBAAuB/C,EAAMiD,GACzB,GAAY,SAARjD,GAA2B,OAARA,GAAyB,QAARA,GAA0B,QAARA,EACtD,OAAO,KACX,IAAIO,EAA0B,iBAARP,EAAmBA,EAAOA,EAAKU,KAErD,OADWO,KAAKkT,eAAe5T,EAAU0C,GAG7C,eAAejD,EAAMiD,GACjB,IAAIiF,EAAOjF,EAAMiF,KACjB,OAAIA,IAGJA,EAAOA,GAAQjF,EAAMvC,MAAQV,EACtBkI,IAGf,EAAiB8K,QAAS,EC3T1B,kCAKO,MAAM,UAAqB,YAC9B,YAAY/P,GACRgB,MAAMhB,GACNhC,KAAK4K,WAAa,GAClB,IAAIpB,EAAWxJ,KAAKgC,MAAM4N,QAAQpG,SAClCxJ,KAAKmT,aAAa3J,GAClBxJ,KAAKkD,MAAQ,CAAEsG,YACfxJ,KAAKgC,MAAM4N,QAAQtS,kBAAkB4Q,IAAInG,IAErC/H,KAAK6E,SAAS,CAAE2E,SAAUxJ,KAAKgC,MAAM4N,QAAQpG,aAEjDxJ,KAAKgC,MAAM4N,QAAQxH,iBAAiB8F,IAAInG,IAEpC/H,KAAK6E,SAAS,CAAE2E,SAAUxJ,KAAKgC,MAAM4N,QAAQpG,aAEjDxJ,KAAKgC,MAAM4N,QAAQtH,iBAAiB4F,IAAInG,IAEpC/H,KAAK6E,SAAS,CAAE2E,SAAUxJ,KAAKgC,MAAM4N,QAAQpG,aAEjDxJ,KAAKgC,MAAM4N,QAAQrH,gBAAgB2F,IAAInG,IACnC/H,KAAK6E,SAAS,CAAE2E,SAAUzB,MAKlC,mBAAmByB,GAGf,IAAIqB,EAAe,GAEnB,EAAab,oBAAoBR,GAAUxB,QAAQc,IAC/ClK,QAAQC,OAAqB,MAAdiK,EAAK9G,OAA4B,MAAX8G,EAAKK,IAC1C0B,EAAa/B,EAAK/J,MAAQ8L,EAAa/B,EAAK/J,OAAS,GACrD8L,EAAa/B,EAAK/J,MAAMwB,KAAKuI,EAAK9G,MAAU,IAC5C,IAAI8I,EAAUhC,EAAK9G,MAAMkD,IACzB4D,EAAK9G,MAAMkD,IAAOC,IACL,MAALA,IACAnF,KAAK4K,WAAW9B,EAAK/J,MAAQiB,KAAK4K,WAAW9B,EAAK/J,OAAS,GAC3DiB,KAAK4K,WAAW9B,EAAK/J,MAAMwB,KAAK4E,IAEd,mBAAX2F,GACPA,EAAQ3F,MAKpB,IAAI4F,EAAQxO,OAAO2K,oBAAoBlH,KAAK4K,YAC5C,IAAK,IAAI1K,EAAI,EAAGA,EAAI6K,EAAM5K,OAAQD,IAAK,CACnC,IAAIZ,EAAWyL,EAAM7K,GACjB8K,EAAMH,EAAavL,IAAa,GACpCU,KAAK4K,WAAWtL,IAAaU,KAAK4K,WAAWtL,IAAa,IAAIqB,OAAOC,GAAKoK,EAAIlM,QAAQ8B,EAAM,IAAKA,EAAEoB,MAAU,KAAM,IAI3H,aAAawH,GACO,MAAZA,IAGJA,EAAS1H,SAAW0H,EAAS1H,UAAY,GAEzC9B,KAAK2I,mBAAmBa,IAE5B,gBACI,IAAIc,EAAI,GACR,IAAK,IAAIjO,KAAO2D,KAAK4K,WACjBN,EAAE/J,QAAQP,KAAK4K,WAAWvO,IAE9B,OAAOiO,EAGX,eACI,OAAOtK,KAAKkD,MAAMsG,SAGtB,2BACI,OAAOxJ,KAAKkJ,mBAAmBnH,IAAInB,GAAKA,EAAEuI,IAG9C,yBACI,OAAOnJ,KAAKgC,MAAM4N,QAAQ1G,mBAE9B,cACI,OAAOlJ,KAAKgO,SAEhB,oBAAoB9Q,EAAakD,EAAUhE,GACvC,OAAO4D,KAAK0L,qBAAqB,CAAExO,cAAakD,WAAUhE,UAE9D,wBAAwBuN,GACpB3J,KAAKgC,MAAM4N,QAAQlE,qBAAqB/B,GAoC5C,gBAAgBN,EAAUzJ,EAAe2K,GACrCvK,KAAKgC,MAAM4N,QAAQlG,gBAAgBL,EAAUzJ,EAAe2K,GAOhE,qBAAqBrN,EAAakO,GAC9B,OAAOpL,KAAKqL,sBAAsB,CAAC,CAAEnO,cAAakO,cAOtD,iBAAiBlO,EAAayO,GAC1B/M,QAAQC,OAAsB,MAAf3B,GACf0B,QAAQC,OAAe,MAAR8M,GACf,IAAI/L,EAAgBI,KAAKuJ,kBAAkBrM,GAC3C,IAAK0C,EACD,MAAM,IAAI9C,MAAM,WAAWI,mBAC/B,IAAIoI,EAAQ1F,EAAcoC,MAAMsD,MAAS1F,EAAcoC,MAAMsD,OAAS,GAClEqG,EAAKC,SACLtG,EAAMsG,OAASD,EAAKC,QACpBD,EAAKE,QACLvG,EAAMuG,MAAQF,EAAKE,OACvB,IAAI,SAAErC,GAAaxJ,KAAKkD,MACxBlD,KAAK6E,SAAS,CAAE2E,aAGpB,sBAAsB8B,GAClB,IAAIC,EAAgB,GACpBD,EAAUtD,QAAQpH,IACd,IAAI,YAAE1D,GAAgB0D,GAClB,KAAE4K,EAAI,IAAEC,GAAQ7K,EAAEwK,SAClBxL,EAAgBI,KAAKgC,MAAM4N,QAAQrG,kBAAkBrM,GACzD,IAAK0C,EACD,MAAM,IAAI9C,MAAM,WAAWI,mBAC/B,IAAIoI,EAAQ1F,EAAcoC,MAAMsD,MAAS1F,EAAcoC,MAAMsD,OAAS,GAClEkG,IACAlG,EAAMkG,KAAOA,GACbC,IACAnG,EAAMmG,IAAMA,GAChBF,EAAchL,KAAK,CAAErD,cAAakD,SAAU,QAAShE,MAAOkJ,MAEhEtF,KAAKgC,MAAM4N,QAAQlE,qBAAqBH,GAM5C,gBAAgBV,GACZ7K,KAAKgC,MAAM4N,QAAQnF,iBAAiBI,GAGhC7K,KAAKgO,UACLhO,KAAKgO,SAASoF,QAItB,mBAAmBvI,GACf7K,KAAKgC,MAAM4N,QAAQzE,iBAAiBN,GAQxC,cAAc3N,EAAamM,EAAUgK,GACjC,OAAOrT,KAAKgC,MAAM4N,QAAQ0D,cAAcpW,EAAamM,EAAUgK,GAEnE,oBAAoBpJ,EAAWC,GAC3B,IAAIC,EAAe,KACnB,IAAK,IAAIjK,EAAI,EAAGA,EAAIgK,EAAW/J,OAAQD,IAAK,CACxC,IAAI+I,EAAQiB,EAAWhK,GACvB,GAAoB,iBAAT+I,GAEPgB,GAAahB,EAAME,GAAI,CACvBgB,EAAejK,EACf,OAGR,GAAoB,MAAhBiK,EAAsB,CACtB,IAAK,IAAIjK,EAAI,EAAGA,EAAIgK,EAAW/J,OAAQD,IAAK,CACxC,IAAIU,EAAIsJ,EAAWhK,GACnB,GAAgB,iBAALU,EACP,SACJ,IAAIkB,EAAWlB,EAAEkB,UAAY,GAC7BA,EAASkG,QAAQiB,IACb,GAAoB,iBAATA,EACP,OAAO,EAEX,QADgBjJ,KAAKyJ,oBAAoBQ,EAAWnI,SACpD,IAKR,OAAO,EAWX,OAToB,GAAhBqI,EACAD,EAAWE,QAEND,GAAgBD,EAAW/J,OAAS,EACzC+J,EAAWnB,MAGXmB,EAAWG,OAAOF,EAAc,IAE7B,EAEX,2BAA2BX,EAAU7I,GACjC,IAAIkI,EAAQ,IAAI9B,MAChB8B,EAAMtI,KAAKiJ,GACX,IAAIc,EAAI,GAGR,IADA3J,EAASA,GAAU,MAAO,GACnBkI,EAAM1I,OAAS,GAAG,CACrB,IAAI2I,EAAOD,EAAMuB,QACbzJ,EAAOmI,IACPwB,EAAE/J,KAAKuI,GAIX,IAAIhH,GAAYgH,EAAKhH,UAAY,IAAInB,OAAOC,GAAiB,iBAALA,GAExDiI,EAAMtI,QAAQuB,GAElB,OAAOwI,EAEX,kBAAkBpN,GACd,OAAO8C,KAAKgC,MAAM4N,QAAQrG,kBAAkBrM,GAEhD,UAAUiI,GAEN,GADwB,IACpBA,EAAEoO,QAA4B,CAC9B,GAAsC,GAAlCvT,KAAKkJ,mBAAmB/I,OACxB,OACJH,KAAKgC,MAAM4N,QAAQzE,iBAAiBnL,KAAKkL,uBAGjD,wBAAwBtL,GAEpB,IAAI,KAAEb,EAAI,MAAEiD,EAAK,SAAEF,GAAalC,EAChC,GAAY,MAARb,EACA,MAAM,IAAOyU,uBAAuB,gBAAiB,QACzD,GAAa,MAATxR,EACA,MAAM,IAAOvD,aAAa,SAC9B,GAAwB,MAApBmB,EAAcuJ,GACd,MAAM,IAAOqK,uBAAuB,KAAM,iBAC9C5U,QAAQC,OAA2B,MAApBe,EAAcuJ,IACL,MAApBvJ,EAAcuJ,KACdnH,EAAM3F,IAAMuD,EAAcuJ,IAG9B,IAAIsK,EAAQ,IAAU9D,aAAa5Q,GACnCH,QAAQC,OAAgB,MAAT4U,GACf,IAAIC,EAAQ9T,EAAcL,MAAQ,GAC9BA,EAAOhD,OAAOmD,OAAO,GAAI+T,EAAOC,GAGhC/U,EAAYiB,EAAcoJ,SAAW,YAAgBhH,EAAMrD,WAAa,GAAI,IAAWrB,mBAAqB0E,EAAMrD,UAClHgU,EAAepW,OAAOmD,OAAO,GAAIsC,GAKrC,cAJO2Q,EAAazN,IACpByN,EAAahU,UAAYA,EAGlB,gBAAoB,EAAkBpC,OAAOmD,OAAO,GAAIiT,EAAc,CAAE/C,QAAS5P,KAAKgC,MAAM4N,QAAS2C,OAAQ,CAAExT,KAAMA,EAAMQ,OAAMyC,QAAOF,eAEnJ,gCAAgCE,EAAOkB,GACnC,MAAO,CAAEsG,SAAUxH,EAAM4N,QAAQpG,UAErC,wBAAwBgE,GACpBxN,KAAK4K,WAAW4C,GAEpB,SACI,IAAI,SAAEhE,GAAaxJ,KAAKkD,MACZlD,KAAKgC,MAAMsD,MACNtF,KAAKgC,MAAM2R,WAY5B,OAAO3T,KAAKgC,MAAM4R,iBAAiBpK,IAG3C,EAAaqK,aAAe,CAAEjE,QAAS,KAAMgE,iBAAkB,M,cCnU/DlY,EAAOD,QAAUO,G,6BCAjB,wuC,6BCAA,YAOc,OADDF,OAAU,GAAKA,OAAe,UAEvCA,OAAU,EAAIA,OAAe,OAAI,I,eCCpC,SAAW8U,GAGZA,EAAEkD,GAAGjD,KAAO,SAAU/L,EAAKiP,EAAKC,GAE/B,IAAIjV,EAAqB,iBAAP+F,EAAkBA,EAAM,GAE1CgP,EAAKlD,EAAEqD,WAAYnP,GAAQA,EAAM8L,EAAEqD,WAAYF,GAAQA,EAAM,KAO7D,OAL8B,IAAzBhV,EAAKD,QAAQ,UACjBC,EAAO,OAAQA,GAEhBiV,GAASlP,GAAOgP,EAAKC,EAAMC,IAAU,GAE9BF,EAAK9T,KAAK1D,KAAMyC,EAAMiV,EAAMF,GAAO9T,KAAKkU,QAASnV,IAIzD,IAAIoV,EAASvD,EAAEZ,MACfoE,EAAWD,EAAOE,QAElBxD,EAAOuD,EAASvD,KAAO,CAGtByD,SAAU,CACTC,MAAO,EACPC,SAAU,EACVC,IAAK,SACLC,OAAQ,KACRC,UAAU,EACVxD,MAAM,EACNU,OAAO,GAIR+C,QAAS,WAGTC,UAAU,EAGV3G,IAAK,SAAUpE,GAEd,IAAIgL,EAAOlE,EAAEkE,KAAM9U,KAAM6Q,EAAK+D,SAE9BZ,EAAOlK,EAAIgL,MAAQ,GAEnBA,EAAKC,SAAW,EAGhBnE,EAAEoE,KAAMnE,EAAKyD,UAAU,SAAUjY,EAAK4Y,QAChBC,IAAhBlB,EAAM3X,KACVyY,EAAMzY,GAAQ2X,EAAM3X,QAKvB8Y,OAAQ,WACPvE,EAAEkE,KAAM9U,KAAM6Q,EAAK+D,SAAUG,SAAW,GAIzCK,MAAO,WAEN,IAAKxE,EAAEkE,KAAM9U,KAAM6Q,EAAK+D,SAAxB,CAGA,IAAIE,EAAOlE,EAAEyE,OAAO,CAAEN,QAAQ,GAAKlE,EAAKyD,UAExC1D,EAAEkE,KAAM9U,KAAM6Q,EAAK+D,QAASE,GAE5BX,EAAOjG,IAAKlO,KAAM,uBAAwB6Q,EAAKyE,KAAMR,GAEhD9U,KAAKuV,aACTvV,KAAKuV,YAAY,cAAe1E,EAAK2E,aAIvCC,SAAU,YACE7E,EAAEkE,KAAM9U,KAAM6Q,EAAK+D,UAAa,IAEjCG,UAGVnE,EAAE8E,WAAY1V,KAAM6Q,EAAK+D,SAEzBT,EAAOgB,OAAQnV,KAAM,uBAAwB6Q,EAAKyE,MAElDzE,EAAK8E,YAAY,GAEZ3V,KAAK4V,aACT5V,KAAK4V,YAAY,cAAe/E,EAAK2E,aAIvCF,KAAM,SAAUtF,GAEf,IAAKa,EAAKgF,QAAV,CAGA,IAAqBC,EAAjB/E,EAAKf,EAAM8E,KAEf,KAAoB,GAAf9E,EAAMuE,OAAcxD,EAAGwD,MAAQ,GAAKvE,EAAMuE,OAASxD,EAAGwD,SAGtD3D,EAAGZ,EAAM3I,QAASyJ,GAAIC,EAAG0D,QAGzB1D,EAAG2D,QAAW9D,EAAGZ,EAAM3I,QAAS0O,QAAShF,EAAG2D,OAAQ1E,EAAMgG,eAAgB7V,UAG/E0Q,EAAKgF,QAAwB,cAAd7F,EAAMjR,KAAuBiB,KAAO,KACnD+Q,EAAGkF,WAAa,EAChBlF,EAAGmF,UAAYlW,KACf+Q,EAAGoF,aAAe,CAAEtF,EAAKuF,YAAapW,KAAM+Q,IAC5CA,EAAG1J,OAAS2I,EAAM3I,OAClB0J,EAAGsF,MAAQrG,EAAMqG,MACjBtF,EAAGuF,MAAQtG,EAAMsG,MACjBvF,EAAGwF,SAAW,KAEdT,EAAUjF,EAAK2F,OAAQxG,EAAO,WAAYe,GAEpCA,EAAGkF,YAwBT,OArBAH,EAAUjF,EAAK4F,QAASX,KAERA,EAAQ3V,SACvB4Q,EAAGoF,aAAe,GAClBvF,EAAEoE,KAAMc,GAAS,WAChB/E,EAAGoF,aAAa5V,KAAMsQ,EAAKuF,YAAapW,KAAM+Q,QAIhDA,EAAGkF,WAAalF,EAAGoF,aAAahW,QAEf,IAAZ4Q,EAAGI,MAAkBiD,EAASjD,MAClCiD,EAASjD,KAAKvB,QAASI,EAAOe,GAE/BF,EAAK8E,YAAY,GAEZ9E,EAAKgF,QACT1B,EAAOjG,IAAK2C,EAAKgF,QAAS,qBAAsBhF,EAAKjB,QAASmB,GAE9DoD,EAAOjG,IAAK7P,SAAU,oBAAqBwS,EAAKjB,QAASmB,MAEpDF,EAAKgF,SAAW9E,EAAG2F,YAAzB,IAKDN,YAAa,SAAUO,EAAM5F,GAC5B,IAAI6F,EAAShG,EAAG+F,GAAQ5F,EAAG4D,SAAW,WAAa,aAAgB,CAAElJ,IAAI,EAAGD,KAAK,GACjF,MAAO,CACNqF,KAAM8F,EACNE,SAAU,IAAIhG,EAAKgG,SACnBC,UAAW,GACXF,OAAQA,IAKVhH,QAAS,SAAUI,GAElB,IAAIe,EAAKf,EAAM8E,KAEf,OAAS9E,EAAMjR,MAEd,KAAMgS,EAAGwF,UAAY,YACpBvG,EAAMC,iBACP,KAAMc,EAAGwF,UAAY,YAEpB,GAAKnF,KAAK2F,IAAM/G,EAAMqG,MAAMtF,EAAGsF,MAAO,GAAMjF,KAAK2F,IAAM/G,EAAMsG,MAAMvF,EAAGuF,MAAO,GAAMlF,KAAK2F,IAAKhG,EAAGyD,SAAU,GACzG,MACDxE,EAAM3I,OAAS0J,EAAG1J,OAClBwJ,EAAK2F,OAAQxG,EAAO,YAAae,GAC5BA,EAAGkF,aACPlF,EAAGwF,UAAW,GAEhB,IAAK,YACJvG,EAAMC,iBACP,IAAK,YACJ,GAAKc,EAAGwF,SAAU,CAGjB,GADA1F,EAAK2F,OAAQxG,EAAO,OAAQe,GACvBA,EAAGkF,WAAY,EAEF,IAAZlF,EAAGI,MAAkBiD,EAASjD,MAClCiD,EAASjD,KAAKvB,QAASI,EAAOe,GAC/B,MAEDf,EAAMjR,KAAO,UAGf,IAAK,WACL,IAAK,UACL,QACM8R,EAAKgF,QACT1B,EAAOgB,OAAQtE,EAAKgF,QAAS,qBAAsBhF,EAAKjB,SAExDuE,EAAOgB,OAAQ9W,SAAU,oBAAqBwS,EAAKjB,SAC/CmB,EAAGwF,YACU,IAAZxF,EAAGI,MAAkBiD,EAASjD,MAClCiD,EAASjD,KAAKvB,QAASI,EAAOe,GAC/BF,EAAK2F,OAAQxG,EAAO,UAAWe,IAEhCF,EAAK8E,YAAY,IAEC,IAAb5E,EAAGc,OAAmBd,EAAGwF,UAC7B3F,EAAEkE,KAAM/D,EAAGmF,UAAW,kBAAkB,IAAIjF,MAAO+F,UAAY,GAChEjG,EAAGwF,SAAW1F,EAAKgF,SAAU,IAMhCW,OAAQ,SAAUxG,EAAOjR,EAAMgS,EAAItM,EAAGkS,GAErC,GAAM5F,EAAN,CAGA,IAIAjR,EAAoBmX,EAAYJ,EAJ5BK,EAAO,CAAElH,MAAMA,EAAMmH,cAAepY,KAAKiR,EAAMjR,MAEnD0N,EAAO1N,EAAKD,QAAQ,QAAU,OAAS,OAE/BoB,EAAIuE,GAAK,EACjB2S,EAAOC,MAAO5S,GAAUsM,EAAGoF,aAAahW,OAApBsE,EAEpBuL,EAAMjR,KAAOA,EAEbiR,EAAMmH,cAAgB,KAEtBpG,EAAG+E,QAAU,GAEb,GAAG,GAAKmB,EAAKlG,EAAGoF,aAAcjW,GAAK,CAElC,GAAc,YAATnB,GAAsBkY,EAAGK,UAC7B,SAEDT,EAAWhG,EAAK0G,WAAYvH,EAAOe,EAAIkG,GAEvCA,EAAGnB,QAAU,GAEblF,EAAG+F,GAAQM,EAAIxK,IAAUsE,EAAG+F,WAAY9B,MAAK,SAAUnI,EAAG2K,GA4BzD,GA1BAX,EAASxP,OAASmQ,EAElBxH,EAAMyH,qBAAuB,WAAY,OAAO,IAIhC,KAFhB3X,EAAS0X,EAAUrD,EAAOuD,SAAShb,KAAM8a,EAASxH,EAAO6G,GAAa,OAGxD,QAARpK,IACJwK,EAAGK,WAAY,EACfvG,EAAGkF,YAAc,GAEL,QAARlX,IACJkY,EAAIxK,GAAOI,GAAK,OAIA,YAAR9N,GACTkY,EAAGH,UAAUvW,KAAMsQ,EAAKzS,QAAS0B,IAAY0X,GAEjC,aAARzY,IACJkY,EAAGU,MAAQ/G,EAAGC,EAAKzS,QAAS0B,IAAYmX,EAAGpG,MAAO,IAEnDoG,EAAGnB,QAAQvV,KAAMT,UAEVkQ,EAAMlQ,OAEC,aAATf,EACJ,OAAOe,KAGTiR,EAAG+E,QAAS5V,GAAM2Q,EAAK4F,QAASQ,EAAGnB,SAEtB,YAAR/W,IACJkY,EAAGH,UAAYjG,EAAK4F,QAASQ,EAAGH,YAEpB,aAAR/X,GAAwBkY,EAAGK,WAC/BT,EAASe,kBAED1X,EAAIkX,GAKd,OAHApH,EAAMjR,KAAOmY,EAAKnY,KAClBiR,EAAMmH,cAAgBD,EAAKlH,MAEpBa,EAAK4F,QAAS1F,EAAG+E,WAIzByB,WAAY,SAAUvH,EAAOe,EAAIkG,GAChC,IAAInN,EAAMmN,EAAGJ,SAmBb,OAjBA/M,EAAI+G,KAAOoG,EAAGpG,KACd/G,EAAI6N,MAAQV,EAAGU,OAASV,EAAGpG,KAE3B/G,EAAI+N,OAAS9G,EAAGsF,MAChBvM,EAAIgO,OAAS/G,EAAGuF,MAEhBxM,EAAIwH,OAAStB,EAAMqG,MAAQtF,EAAGsF,MAC9BvM,EAAIyH,OAASvB,EAAMsG,MAAQvF,EAAGuF,MAE9BxM,EAAIiO,UAAYd,EAAGL,OAAOpL,KAC1B1B,EAAIkO,UAAYf,EAAGL,OAAOnL,IAE1B3B,EAAIpF,QAAUoF,EAAIiO,UAAYjO,EAAIwH,OAClCxH,EAAIlF,QAAUkF,EAAIkO,UAAYlO,EAAIyH,OAElCzH,EAAIqH,KAAON,EAAK4F,SAAWQ,EAAG9F,MAAQ,IAAK8G,SAC3CnO,EAAIoO,UAAYrH,EAAK4F,SAAWQ,EAAGH,WAAa,IAAKmB,SAC9CnO,GAIR1L,QAAS,SAAU2V,GAClB,GAAKA,IAASA,EAAIoE,QAA0B,GAAhBpE,EAAIqE,UAC/B,OAAOrE,GAIT0C,QAAS,SAAU7N,GAClB,OAAOgI,EAAE7O,IAAK6G,GAAK,SAAUyP,GAC5B,OAAOA,GAAUA,EAAOF,OAASvH,EAAE0H,UAAWD,GAC7CA,GAAUA,EAAOlY,OAAS0Q,EAAK4F,QAAS4B,GAAWA,MAKtD1C,WAAY,SAAU4C,GACrB3H,EAAGvS,UAAYka,EAAO,SAAW,QAAS,cAAe1H,EAAK2E,WAC5D5D,IAAI,gBAAiB2G,EAAO,GAAK,QAEnCla,SAASma,aAAeD,EAAO,MAAQ,MAIxC/C,UAAW,WACV,OAAO,GAIRqB,SAAU,cAKXhG,EAAKgG,SAASra,UAAY,CACzBob,OAAQ,WACFxD,EAASjD,MAAQnR,KAAKkY,UAAU/X,QACpCyQ,EAAEoE,KAAMhV,KAAKkY,WAAW,SAAUhY,GACjCkU,EAASjD,KAAKsH,OAAQzY,KAAME,QAMhC,IAAIwY,EAAYvE,EAAOuD,SACvBvD,EAAOuD,SAAW,SAAU1H,GAC3B,KAAKY,EAAEkE,KAAM9U,KAAM,YAAagQ,EAAMjR,OAAS,IAAIkS,MAAO+F,UAAY,GAItE,OAAO0B,EAAUjS,MAAOzG,KAAMqQ,WAH7BO,EAAE8E,WAAY1V,KAAM,YAAagQ,EAAMjR,OAOzC,IAAI4Z,EACJxE,EAAOyE,SAASC,WAChB1E,EAAOyE,SAASE,UAChB3E,EAAOyE,SAASG,SAChB5E,EAAOyE,SAASI,YAAc,CAC7BhX,MAAO,8CAA8Cb,MAAO,KAC5DR,OAAQ,SAAUqP,EAAOkH,GACxB,GAAKA,EAAM,CACV,IAAIrB,EAAYqB,EAAK+B,SAAW/B,EAAK+B,QAAQ,IACvC/B,EAAKgC,gBAAkBhC,EAAKgC,eAAe,IAC7C,KAECrD,GACJjF,EAAEoE,KAAM2D,EAAW3W,OAAO,SAAU9B,EAAGiP,GACtCa,EAAOb,GAAS0G,EAAS1G,MAG5B,OAAOa,IAKToE,EAAS+E,SAAW/E,EAASgF,UAAYhF,EAASiF,QAAUxI,EAtY3D,CAwYGyI,S,eCxYH,SAAW1I,GAGZ,IAAIuD,EAASvD,EAAEZ,MAEfa,EAAOsD,EAAOE,QAAQxD,KAEtB0I,EAAU1I,EAAK3C,IAEfsL,EAAe3I,EAAK4E,SAGpB5E,EAAKgE,UAAW,EAGhBhE,EAAK4I,QAAU,WAGf5I,EAAK3C,IAAM,SAAUpE,GAEpByP,EAAQ9S,MAAOzG,KAAMqQ,WAErB,IAAIyE,EAAOlE,EAAEkE,KAAM9U,KAAM6Q,EAAK+D,UAExBE,EAAK4B,MAAQ5M,EAAI4P,WACtB5E,EAAK4B,MAAO,EACZvC,EAAOjG,IAAKlO,KAAM,YAAa6Q,EAAK4I,QAAS5I,EAAK8I,YAKpD9I,EAAK4E,SAAW,WAEf+D,EAAa/S,MAAOzG,KAAMqQ,WAE1B,IAAIyE,EAAOlE,EAAEkE,KAAM9U,KAAM6Q,EAAK+D,UAAa,GAEtCE,EAAK4B,OAETvC,EAAOgB,OAAQnV,KAAM,YAAa6Q,EAAK4I,QAAS5I,EAAK8I,UACrD7E,EAAK4B,MAAO,IAKd7F,EAAK8I,SAAW,SAAU3J,GAEzB,IAAgB3I,EAAZuS,EAAQ,GAEZC,EAASjJ,EAAEkE,KAAM9U,KAAM,WAAc,GAoBrC,OAlBA4Q,EAAEoE,KAAM6E,GAAU,IAAI,SAAUxd,EAAKuM,GAEP,IAAxBvM,EAAIyC,QAAQ,SAEjB8R,EAAEoE,KAAMpM,GAAO,IAAI,SAAU1I,EAAG4J,IAE/BzC,EAASuJ,EAAGZ,EAAM3I,QAAS0O,QAASjM,EAAI4P,SAAU1J,EAAMgG,eAAgB,MAKxE7B,EAAOjG,IAAK7G,EAAQyC,EAAIgQ,SAAS,IAAIjJ,EAAK4I,QAAS3P,EAAIiQ,aAAejQ,EAAI8F,QAAS9F,EAAIgL,MAElFlE,EAAEoJ,QAAS3S,EAAQuS,GAAU,GACjCA,EAAMrZ,KAAM8G,YAITuS,EAAMzZ,QAGLyQ,EAAGgJ,GAAQtd,KAAK,WAAYuU,EAAK4I,SAAS,WAChDtF,EAAOgB,OAAQnV,KAAM,IAAK6Q,EAAK4I,aAzEhC,CA6EGH,S,eC7EH,SAAU1I,GAKXA,EAAEkD,GAAG3C,KAAO,SAAUrM,EAAKiP,EAAKC,GAE/B,IAAIjV,EAAqB,iBAAP+F,EAAkBA,EAAM,GAE1CgP,EAAKlD,EAAEqD,WAAYnP,GAAQA,EAAM8L,EAAEqD,WAAYF,GAAQA,EAAM,KAO7D,OAL8B,IAAzBhV,EAAKD,QAAQ,UACjBC,EAAO,OAAQA,GAEhBiV,GAASlP,GAAOgP,EAAKC,EAAMC,IAAU,GAE9BF,EAAK9T,KAAK1D,KAAMyC,EAAMiV,EAAMF,GAAO9T,KAAKkU,QAASnV,IAKzD6R,EAAEO,KAAO,SAAU6C,GAClBA,EAAOA,GAAQ,GAEf7C,EAAK8I,OAAuB,IAAfjG,EAAKiG,MAAiBC,KACnB,IAAflG,EAAKiG,MAAkB,EAAK5C,MAAOrD,EAAKiG,OAAuB9I,EAAK8I,MAAlBjG,EAAKiG,MACxD9I,EAAKgJ,MAAQnG,EAAKmG,OAAShJ,EAAKgJ,MAChChJ,EAAKiJ,UAAYxJ,EAAEqD,WAAYD,EAAKoG,WAAcpG,EAAKoG,UACnC,OAAnBpG,EAAKoG,UAAqB,KAAOjJ,EAAKiJ,UACvCjJ,EAAK1E,KAAOuH,EAAKvH,MAAQ0E,EAAK1E,MAAQ,aAIvC,IACA2H,EADaxD,EAAEZ,MACGqE,QAElBlD,EAAOP,EAAEZ,MAAMqE,QAAQlD,KAAO,CAG7B8I,MAAO,EACPE,MAAO,GACP1N,KAAM,UAGN4N,QAAS,GAGTzF,QAAS,WAGTC,UAAU,EAGV3G,IAAK,SAAUpE,GAEH8G,EAAEkE,KAAM9U,KAAMmR,EAAKyD,SAEzBG,SAAW,GAIjBI,OAAQ,WACPvE,EAAEkE,KAAM9U,KAAMmR,EAAKyD,SAAUG,SAAW,GAIzCK,MAAO,WAEN,IAAKxE,EAAEkE,KAAM9U,KAAMmR,EAAKyD,SAAxB,CAWAhE,EAAEkE,KAAM9U,KAAMmR,EAAKyD,QARR,CACVG,QAAS,EACTuF,OAAQ,GACRC,UAAW,EACXC,OAAQ,EACRC,SAAU,KAKXtJ,EAAKkJ,QAAQ9Z,KAAMP,QAIpByV,SAAU,WAGT,KAFW7E,EAAEkE,KAAM9U,KAAMmR,EAAKyD,UAAa,IAEjCG,QAAV,CAGAnE,EAAE8E,WAAY1V,KAAMmR,EAAKyD,SAEzB,IAAIxW,EAAU4B,KAEdmR,EAAKkJ,QAAUzJ,EAAE8J,KAAMvJ,EAAKkJ,SAAS,SAAUhT,GAC9C,OAASA,IAAWjJ,OAKtBwR,QAAS,SAAUI,EAAOe,GAEzB,IAAa4J,EAEb,GAAM5J,EAGN,OAASf,EAAMjR,MAEd,IAAK,YACL,IAAK,aAEJ4b,EAAY/J,EAAGO,EAAKkJ,SACG,iBAAXtJ,EAAGI,OACdwJ,EAAWA,EAASha,OAAQoQ,EAAGI,OAEhCwJ,EAAS3F,MAAK,WACb,IAAIF,EAAOlE,EAAEkE,KAAM9U,KAAMmR,EAAKyD,SAC9BE,EAAKwF,OAAS,GACdxF,EAAKyF,UAAY,EACjBzF,EAAK0F,OAAS,KAGfzJ,EAAG+F,UAAY6D,EAEfvG,EAASvD,KAAK2F,OAAQxG,EAAO,WAAYe,GACzC,MAED,IAAK,YACL,IAAK,YACJI,EAAKnB,MAAQA,EACPmB,EAAKyJ,OAEVzJ,EAAK0J,SAAU9J,GAChB,MAED,IAAK,UACL,IAAK,WACJI,EAAKyJ,MAAQE,aAAc3J,EAAKyJ,OAC3B7J,EAAGkF,aACP7B,EAASvD,KAAK2F,OAAQxG,EAAO,OAAQe,GACrCqD,EAASvD,KAAK2F,OAAQxG,EAAO,UAAWe,MAQ5C0H,OAAQ,SAAU9B,EAAMoE,GACvB,IAAIjG,EAAOlE,EAAEkE,KAAM6B,EAAMxF,EAAKyD,SAC9BoG,EAAQpK,EAAG+F,GACXsE,EAAOD,EAAMpE,UAAY,GACzBhL,EAASoP,EAAME,cACfrP,EAAQmP,EAAMG,aACdV,EAAW,CACV9D,KAAMA,EACN9K,MAAOA,EACPD,OAAQA,EACRH,IAAKwP,EAAKxP,IACVD,KAAMyP,EAAKzP,KACX4P,MAAOH,EAAKzP,KAAOK,EACnBwP,OAAQJ,EAAKxP,IAAMG,GAQpB,OALKkJ,IACJA,EAAK2F,SAAWA,EAChB3F,EAAKiG,MAAQA,EACbjG,EAAK6B,KAAOA,GAEN8D,GAIRa,SAAU,SAAUjU,EAAQE,GAC3B,OAAWA,EAAK,IAAMA,EAAKiE,OAAUnE,EAAOmE,OAAUjE,EAAK,IAAMA,EAAK6T,QAAW/T,EAAO+T,QAClF7T,EAAK,IAAMA,EAAKkE,MAASpE,EAAOoE,MAASlE,EAAK,IAAMA,EAAK8T,SAAYhU,EAAOgU,QAInFE,MAAO,CAEN,UAAa,SAAUvL,EAAO2H,EAAOtQ,GACpC,OAAOrH,KAAKsb,SAAUjU,EAAQ,CAAE2I,EAAMqG,MAAOrG,EAAMsG,QAClD,IAAMtW,KAAKub,MAAMC,QAAQ/U,MAAOzG,KAAMqQ,YAGxC,QAAW,SAAUL,EAAO2H,EAAOtQ,GAElC,OAAO+J,KAAKC,IAAK,EAAGD,KAAKqK,IAAKpU,EAAOgU,OAAQ1D,EAAM0D,QAAWjK,KAAKC,IAAKhK,EAAOoE,IAAKkM,EAAMlM,MACvF2F,KAAKC,IAAK,EAAGD,KAAKqK,IAAKpU,EAAO+T,MAAOzD,EAAMyD,OAAUhK,KAAKC,IAAKhK,EAAOmE,KAAMmM,EAAMnM,QAGtF,IAAO,SAAUwE,EAAO2H,EAAOtQ,GAC9B,OAAOrH,KAAKsb,SAAUjU,EAAQsQ,GAAU,EAAI,GAG7C,OAAU,SAAU3H,EAAO2H,EAAOtQ,GACjC,OAAOrH,KAAKsb,SAAUjU,EAAQ,CAAEsQ,EAAMnM,KAAqB,GAAdmM,EAAM9L,MAAY8L,EAAMlM,IAAqB,GAAfkM,EAAM/L,SAAkB,EAAI,IAKzG8P,KAAM,SAAUC,EAAGC,GAClB,OAASA,EAAEpB,OAASmB,EAAEnB,QAAcmB,EAAEZ,MAAQa,EAAEb,OAIjDF,SAAU,SAAU9J,GAEnB,IAAI7Q,EAAG2b,EAAKC,EAAKhH,EAAMlM,EAAKwO,EAAKT,EAE1BM,EAAPxS,EAAI,EAAOsX,EAAMhL,EAAGoF,aAAahW,OAEjC6b,EAAK,CAAE7K,EAAKnB,MAAMqG,MAAOlF,EAAKnB,MAAMsG,OAEpC8D,EAAYjJ,EAAKiJ,WAAajJ,EAAKoK,MAAOpK,EAAK1E,MAE/C,GAAG,GAAKwK,EAAKlG,EAAGoF,aAAa1R,GAAI,CAEhC,IAAMwS,EACL,OAEDA,EAAG9F,KAAO,GAEVvI,EAAM,GACNwO,EAAMH,EAAGH,UAAU3W,OAEdia,IACJ0B,EAAM3K,EAAKsH,OAAQxB,EAAGU,QAEvBzX,EAAI,EAEJ,GAAG,GAAKyW,EAAOM,EAAGH,UAAU5W,GAAI,CAG/B,KADA2b,GADA/G,EAAOlE,EAAEkE,KAAM6B,EAAMxF,EAAKyD,UACf6F,UACC,SAEZ3F,EAAK0F,OAASJ,EAAYA,EAAU1d,KAAMyU,EAAMA,EAAKnB,MAAO8L,EAAKD,GAE9D1K,EAAKmK,SAAUO,EAAKG,GAAO,EAAI,EAClCpT,EAAIrI,KAAMuU,YACC5U,EAAIkX,GAEhBxO,EAAI8S,KAAMvK,EAAKuK,MAEfxb,EAAI,EAEJ,IAAQ4U,EAAOlM,EAAK1I,MAEd4U,EAAK0F,QAAUvD,EAAG9F,KAAKhR,OAASgR,EAAK8I,OAEnCnF,EAAKwF,OAAO7V,IAAOqQ,EAAKyF,aAEiD,IAAzEnG,EAASvD,KAAK2F,OAAQrF,EAAKnB,MAAO,YAAae,EAAItM,EAAGqQ,EAAK6B,MAAO,IACtE7B,EAAKwF,OAAO7V,GAAK,EACjBqQ,EAAKyF,WAAa,GAIlBzF,EAAK0F,OAAS,GAGX1F,EAAK0F,QACTvD,EAAG9F,KAAK5Q,KAAMuU,EAAK6B,OAGX7B,EAAKwF,OAAO7V,IAAwB,GAAlBqQ,EAAKyF,YAEhCnG,EAASvD,KAAK2F,OAAQrF,EAAKnB,MAAO,UAAWe,EAAItM,EAAGqQ,EAAK6B,MACzD7B,EAAKwF,OAAO7V,GAAK,EACjBqQ,EAAKyF,WAAa,YAERra,EAAIkX,YACL3S,EAAIsX,GAEX5K,EAAK8K,MAAQD,EAAG,IAAM7K,EAAK8K,KAAK5F,OAAS2F,EAAG,IAAM7K,EAAK8K,KAAK3F,aACzDnF,EAAKyJ,MAEZzJ,EAAKyJ,MAAQsB,YAAW,WACvB/K,EAAK0J,SAAU9J,KACbI,EAAKgJ,OAEThJ,EAAK8K,KAAO9K,EAAKnB,QAMnBoE,EAAS+H,SAAW/H,EAASgI,UAAYhI,EAASiI,QAAUlL,EAlS3D,CAoSEmI,S,eCpSF,SAAU1I,GAGX,IAAIuD,EAASvD,EAAEZ,MAEfmB,EAAOgD,EAAOE,QAAQlD,KAEtBoI,EAAUpI,EAAKjD,IAEfsL,EAAerI,EAAKsE,SAGpBtE,EAAK0D,UAAW,EAGhB1D,EAAKsI,QAAU,WAGftI,EAAKjD,IAAM,SAAUpE,GAEpByP,EAAQ9S,MAAOzG,KAAMqQ,WAErB,IAAIyE,EAAOlE,EAAEkE,KAAM9U,KAAMmR,EAAKyD,UAExBE,EAAK4B,MAAQ5M,EAAI4P,WACtB5E,EAAK4B,MAAO,EACZvC,EAAOjG,IAAKlO,KAAM,YAAamR,EAAKsI,QAAStI,EAAKwI,YAKpDxI,EAAKsE,SAAW,WAEf+D,EAAa/S,MAAOzG,KAAMqQ,WAE1B,IAAIyE,EAAOlE,EAAEkE,KAAM9U,KAAMmR,EAAKyD,UAAa,GAEtCE,EAAK4B,OAETvC,EAAOgB,OAAQnV,KAAM,WAAYmR,EAAKwI,UACtC7E,EAAK4B,MAAO,IAKdvF,EAAKwI,SAAW,SAAU3J,EAAOe,GAEhC,IAAgB4J,EAAZf,EAAQ,GAEZC,EAASjJ,EAAEkE,KAAM9U,KAAM,WAAc,GA+BrC,OA7BA4Q,EAAEoE,KAAM6E,GAAU,IAAI,SAAUxd,EAAKuM,GAEP,IAAxBvM,EAAIyC,QAAQ,SAEjB8R,EAAEoE,KAAMpM,GAAK,SAAU1I,EAAG4J,IAEzB6Q,EAAW/J,EAAGZ,EAAMgG,eAAgBsG,KAAMxS,EAAI4P,WAE/BvZ,QAGfwa,EAAS3F,MAAK,WAEbb,EAAOjG,IAAKlO,KAAM8J,EAAIgQ,SAAU,IAAK3I,EAAKsI,QAAS3P,EAAIiQ,aAAejQ,EAAI8F,QAAS9F,EAAIgL,MAElFlE,EAAEoJ,QAASha,KAAM4Z,GAAU,GAC/BA,EAAMrZ,KAAMP,eAKX+Q,GAEJoD,EAAOjG,IAAK6C,EAAGF,KAAM,WAAWM,EAAKsI,SAAS,WAC7C7I,EAAEoE,KAAM4E,EAAM2C,OAAQvc,OAAQ,WAC7BmU,EAAOgB,OAAQnV,KAAM,IAAKmR,EAAKsI,iBAI3BG,EAAMzZ,QAASyQ,EAAGgJ,IAhFzB,CAmFGN,S,6BC3FJ/c,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IAUtDX,EAAQ2G,KATR,WACI,SAASoa,IACL,OAAOpL,KAAKqL,MAA4B,OAArB,EAAIrL,KAAKsL,WACvBC,SAAS,IACTC,UAAU,GAEnB,OAAOJ,IAAOA,IAAO,IAAMA,IAAO,IAAMA,IAAO,IAC3CA,IAAO,IAAMA,IAAOA,IAAOA,M,6BCRnCjgB,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IActDX,EAAQ6G,YAZR,YAAwBua,GAEpB,GAAoB,IADpBA,EAAQA,GAAS,IACP1c,OACN,MAAO,GACX,GAAoB,GAAhB0c,EAAM1c,OACN,OAAO0c,EAAM,GAEjB,IAAI/X,EAAM+X,EAAMxb,KAAK,IAGrB,OADAyD,EAAMA,EAAIgY,QAAQ,OAAQ,KACnBhY,I,6BCZXvI,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IACtD,MAAMS,EACF,aAAaG,GACT,IAAIwS,EAAQ,IAAI1S,MAAM,YAAYE,6BAGlC,OADAwS,EAAM/P,KADK,eAEJ+P,EAEX,mBAAmBpS,GACf,IACIoS,EAAQ,IAAI1S,MADN,OAAOM,wCAIjB,OADAoS,EAAM/P,KADK,qBAEJ+P,EAEX,kBAAkBpS,EAAWJ,GACzB,IACIwS,EAAQ,IAAI1S,MADN,OAAOM,cAAsBJ,oBAIvC,OADAwS,EAAM/P,KADK,oBAEJ+P,EAEX,sBAAsBxS,EAAc+f,GAChC,IACIvN,EAAQ,IAAI1S,MADN,YAAYE,kCAA6C+f,MAInE,OADAvN,EAAM/P,KADK,wBAEJ+P,EAEX,uBAEI,OAAO,IAAI1S,MADD,6EAIlBrB,EAAQoB,OAASA,EACjBpB,EAAQ+G,OAAS,IAAI3F,G,6BCnCrB,IAAI8I,EAAa3F,MAAQA,KAAK2F,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAU/J,GAAS,IAAMgK,EAAKL,EAAUM,KAAKjK,IAAW,MAAO+I,GAAKe,EAAOf,IACpF,SAASmB,EAASlK,GAAS,IAAMgK,EAAKL,EAAiB,MAAE3J,IAAW,MAAO+I,GAAKe,EAAOf,IACvF,SAASiB,EAAKtG,GAJlB,IAAe1D,EAIa0D,EAAOyG,KAAON,EAAQnG,EAAO1D,QAJ1CA,EAIyD0D,EAAO1D,MAJhDA,aAAiB0J,EAAI1J,EAAQ,IAAI0J,GAAE,SAAUG,GAAWA,EAAQ7J,OAIToK,KAAKL,EAAWG,GAClGF,GAAML,EAAYA,EAAUU,MAAMb,EAASC,GAAc,KAAKQ,YAGtE9J,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IACtD,MAAM4gB,EAAW,EAAQ,IACnBva,EAAa,EAAQ,GAC3B,IAAID,EAASjG,OAAOmD,OAAOsd,EAASxa,OAAQ,CACxCya,sBAAqB,IACV,IAAIngB,MAAM,8BAErBogB,sBAAqB,IACV,IAAIpgB,MAAM,8BAErBqgB,sBAAqB,IACV,IAAIrgB,MAAM,8BAErBsgB,eAAe/gB,GAEJ,IAAIS,MADD,sBAAsBT,uBAIxC,MAAMuG,EACF,YAAYmF,GACR/H,KAAKqd,UAAY,IAAI5a,EAAWC,SAChC1C,KAAKsd,SAAW,IAAI7a,EAAWC,SAC/B1C,KAAKud,SAAW,IAAI9a,EAAWC,SAC/B1C,KAAKwd,QAAU,IAAI/a,EAAWC,SAC9B1C,KAAKyd,SAAW,IAAIhb,EAAWC,SAC/B1C,KAAK0d,QAAU,IAAIjb,EAAWC,SAC9B1C,KAAK2d,UAAY,IAAIlb,EAAWC,SAChC1C,KAAKgJ,SAAW,IAAIvG,EAAWC,SAC/B1C,KAAKwP,MAAQ,IAAI/M,EAAWC,SAC5B1C,KAAK+H,KAAOA,EACZ/H,KAAK4d,YAAc7V,EAAK6V,aAAe,GAG3C,gBACI,OAA2B,MAApB5d,KAAK+H,KAAK8V,QAAkB7d,KAAK4d,YAAYzd,OAAS,EAEjE,gBACI,OAA2B,MAApBH,KAAK+H,KAAK+V,QAAkB9d,KAAK4d,YAAYzd,OAAS,EAEjE,gBACI,OAA2B,MAApBH,KAAK+H,KAAK6P,QAAkB5X,KAAK4d,YAAYzd,OAAS,EAEjE,cAAc2I,EAAMf,GAChB,OAAO/H,KAAK+H,KAAK+V,OAAOhV,EAAMf,GAElC,cAAce,EAAMf,GAChB,OAAO/H,KAAK+H,KAAK8V,OAAO/U,EAAMf,GAElC,cAAce,EAAMf,GAChB,OAAO/H,KAAK+H,KAAK6P,OAAO9O,EAAMf,GAElC,cAAcA,GAEV,OADAA,EAAOA,GAAQ,GACR/H,KAAK+H,KAAKgW,OAAOhW,GAE5B,OAAOe,EAAMf,EAAMgT,GACf,IAAK/a,KAAKge,UACN,MAAMxb,EAAOya,wBACjB,IAAKnU,EACD,MAAMtG,EAAO/D,aAAa,QAM9B,MALmB,iBAARsJ,IACPgT,EAAQhT,EACRA,EAAO,MAEX/H,KAAKqd,UAAUjU,KAAK,CAAE6U,OAAQje,KAAMke,SAAUpV,EAAMiS,UAC7C/a,KAAKme,cAAcrV,EAAMf,GAAMvB,KAAMsO,IACxCvY,OAAOmD,OAAOoJ,EAAMgM,GACpB9U,KAAKsd,SAASlU,KAAK,CAAE6U,OAAQje,KAAMke,SAAUpV,EAAMiS,UAC5CjG,IACRsJ,MAAMC,IAEL,MADAre,KAAKse,aAAaD,EAAK,UACjBA,IAGd,OAAOvV,EAAMf,GACT,IAAK/H,KAAKue,UACN,MAAM/b,EAAO0a,wBACjB,IAAKpU,EACD,MAAMtG,EAAO/D,aAAa,QAG9B,OAFAuB,KAAKwe,iBAAiB1V,GACtB9I,KAAKud,SAASnU,KAAK,CAAE6U,OAAQje,KAAMke,SAAUpV,IACtC9I,KAAKye,cAAc3V,EAAMf,GAAMvB,KAAMsO,IACxC9U,KAAKwd,QAAQpU,KAAK,CAAE6U,OAAQje,KAAMke,SAAUpV,IACrCgM,IACRsJ,MAAMC,IAEL,MADAre,KAAKse,aAAaD,EAAK,UACjBA,IAGd,OAAOvV,EAAMf,GACT,IAAK/H,KAAK0e,UACN,MAAMlc,EAAO2a,wBACjB,IAAKrU,EACD,MAAMtG,EAAO/D,aAAa,QAG9B,OAFAuB,KAAKwe,iBAAiB1V,GACtB9I,KAAKyd,SAASrU,KAAK,CAAE6U,OAAQje,KAAMke,SAAUpV,IACtC9I,KAAK2e,cAAc7V,EAAMf,GAAMvB,KAAMsO,IACxCvY,OAAOmD,OAAOoJ,EAAMgM,GACpB9U,KAAK0d,QAAQtU,KAAK,CAAE6U,OAAQje,KAAMke,SAAUpV,IACrCgM,IACRsJ,MAAOC,IAEN,MADAre,KAAKse,aAAaD,EAAK,UACjBA,IAGd,WAAWO,EAASC,GAChB,GAAe,MAAXD,EACA,MAAMpc,EAAO/D,aAAa,WAC9B,GAAiB,MAAbogB,EACA,MAAMrc,EAAO/D,aAAa,aAC9B,GAA+B,GAA3BuB,KAAK4d,YAAYzd,OACjB,OAAOye,GAAWC,EACtB7e,KAAKwe,iBAAiBI,GACtB5e,KAAKwe,iBAAiBK,GACtB,IAAK,IAAIC,KAAM9e,KAAK4d,YAChB,GAAIgB,EAAQE,IAAOD,EAAUC,GACzB,OAAO,EAEf,OAAO,EAEX,iBAAiBhW,GACb,IAAK,IAAIzM,KAAOyM,EACZ,GAAiB,MAAbA,EAAKzM,IAAgB2D,KAAK4d,YAAY9e,QAAQzC,IAAQ,EACtD,MAAMmG,EAAO4a,eAAe/gB,GAGxC,OAAO0L,GAIH,OAHAA,EAAOA,GAAQ,GAEf/H,KAAK2d,UAAUvU,KAAK,CAAE6U,OAAQje,KAAM+e,gBAAiBhX,IAC9C/H,KAAKgf,cAAcjX,GAAMvB,KAAMsO,IAClC,IAAImK,EACAC,EACJ,GAAInY,MAAMC,QAAQ8N,GACdmK,EAAYnK,EACZoK,EAAgBpK,EAAK3U,WAEpB,SAAuB+U,IAAnBJ,EAAKmK,gBAAkD/J,IAAvBJ,EAAKoK,cAK1C,MAAM1c,EAAO2c,uBAJbF,EAAYnK,EAAKmK,UACjBC,EAAgBpK,EAAKoK,cAMzB,OADAlf,KAAKgJ,SAASI,KAAK,CAAE6U,OAAQje,KAAMof,aAAc,CAAEF,gBAAeD,eAC3D,CAAEC,gBAAeD,eACzBb,MAAMC,IAEL,MADAre,KAAKse,aAAaD,EAAK,UACjBA,IAGd,aAAaA,EAAKgB,GAGd,GAFAhB,EAAIgB,OAASA,EACbrf,KAAKwP,MAAMpG,KAAK,CAAE6U,OAAQje,KAAMwP,MAAO6O,KAClCA,EAAIiB,QACL,MAAMjB,GAGlB5iB,EAAQmH,WAAaA,EAOrBnH,EAAQoH,0BANR,MACI,cACI7C,KAAKuf,cAAgB,EACrBvf,KAAKwf,YAAc,aAmB3B/jB,EAAQgkB,gBAfR,cAA8B7c,EAC1B,YAAY+D,GACR3D,MAAM,CACF,OAAO+E,GACH,OAAOpC,EAAU3F,UAAM,OAAQ,GAAQ,YAKnC,OAJI+H,EAAK2X,eAGI,CAAET,UADCtY,EAAMsR,MAAMlQ,EAAKwX,cAAexX,EAAKwX,cAAgBxX,EAAKyX,aAChDN,cAAevY,EAAMxG,iB,6BCvLnE5D,OAAO2F,eAAezG,EAAS,aAAc,CAAEW,OAAO,IACtD,MAAMS,EACF,aAAaG,GACT,IAAIwS,EAAQ,IAAI1S,MAAM,YAAYE,6BAGlC,OADAwS,EAAM/P,KADK,eAEJ+P,EAEX,mBAAmBpS,GACf,IACIoS,EAAQ,IAAI1S,MADN,OAAOM,wCAIjB,OADAoS,EAAM/P,KADK,qBAEJ+P,EAEX,kBAAkBpS,EAAWJ,GACzB,IACIwS,EAAQ,IAAI1S,MADN,OAAOM,cAAsBJ,oBAIvC,OADAwS,EAAM/P,KADK,oBAEJ+P,EAEX,sBAAsBxS,EAAc+f,GAChC,IACIvN,EAAQ,IAAI1S,MADN,YAAYE,kCAA6C+f,MAInE,OADAvN,EAAM/P,KADK,wBAEJ+P,EAEX,uBAEI,OAAO,IAAI1S,MADD,6EAIlBrB,EAAQoB,OAASA,EACjBpB,EAAQ+G,OAAS,IAAI3F,G,cCpCrB,IAAI0S,EAGJA,EAAI,WACH,OAAOvP,KADJ,GAIJ,IAECuP,EAAIA,GAAK,IAAIoQ,SAAS,cAAb,GACR,MAAOxa,GAEc,iBAAXrJ,SAAqByT,EAAIzT,QAOrCJ,EAAOD,QAAU8T","file":"index.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"React\"), require(\"$\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"React\", \"$\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"jueying\"] = factory(require(\"React\"), require(\"$\"));\n\telse\n\t\troot[\"jueying\"] = factory(root[\"React\"], root[\"$\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__15__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","export class Errors {\r\n    static placeHolderIdNull() {\r\n        let msg = `Place holder property id cannt be null or empty.`;\r\n        return new Error(msg);\r\n    }\r\n    static fileNotExists(fileName) {\r\n        return new Error(`File '${fileName}' is not exists.`);\r\n    }\r\n    static argumentNull(argumentName) {\r\n        return new Error(`Argument ${argumentName} is null or empty.`);\r\n    }\r\n    static argumentRangeError(argumentName) {\r\n        return new Error(`Argument ${argumentName} range error.`);\r\n    }\r\n    static pageDataIsNull() {\r\n        return new Error(`Page data is null.`);\r\n    }\r\n    static toolbarRequiredKey() {\r\n        return new Error(`Toolbar has not a key prop.`);\r\n    }\r\n    static loadPluginFail(pluginId) {\r\n        return new Error(`Load plugin '${pluginId}' fail.`);\r\n    }\r\n    static idRequired() {\r\n        return new Error(`Property id is required.`);\r\n    }\r\n    static canntFindMasterPage(componentId) {\r\n        return new Error(`Can not find master page for component container ${componentId}.`);\r\n    }\r\n    static propCanntNull(componentName, property) {\r\n        let msg = `${componentName} property ${property} cannt be null or empty.`;\r\n        return new Error(msg);\r\n    }\r\n    static argumentFieldCanntNull(fieldName, argumentName) {\r\n        let msg = `${fieldName} of argument ${argumentName} cannt be null or empty.`;\r\n        return new Error(msg);\r\n    }\r\n}\r\n//# sourceMappingURL=errors.js.map","import { Errors } from \"./errors\";\r\nexport let classNames = {\r\n    componentSelected: `component-selected`,\r\n    emptyTemplates: `empty-templates`,\r\n    loadingTemplates: `loading-templates`,\r\n    templateSelected: `template-selected`,\r\n    templateDialog: `template-dialog`,\r\n    emptyDocument: `empty-document`,\r\n    component: 'component',\r\n    componentWrapper: 'component-wrapper',\r\n    componentPanel: 'component-panel',\r\n    componentIcon: 'component-icon',\r\n    placeholder: 'placeholder',\r\n    editorPanel: 'editor-panel',\r\n    designer: 'designer',\r\n    moveDown: 'move-down',\r\n};\r\nlet templateDialog = {\r\n    nameHeight: 40,\r\n    fontSize: 22\r\n};\r\nlet element = document.createElement('style');\r\nelement.type = 'text/css';\r\nelement.setAttribute(\"data-name\", \"jueying\");\r\nelement.innerHTML = `\r\n            .${classNames.componentSelected} {\r\n                border: solid 1px #337ab7!important;\r\n            }\r\n            .${classNames.componentSelected} > :first-child {\r\n                border-color: blue;\r\n              }\r\n              .${classNames.componentSelected} .resize_handle {\r\n                position: absolute;\r\n                height: 6px;\r\n                width: 6px;\r\n                border: 1px solid #89B;\r\n                background: #9AC;\r\n              }\r\n              .${classNames.componentSelected} .move_handle {\r\n                height: 12px;\r\n                width: 12px;\r\n                top: 6px;\r\n                left: 8px;\r\n                border: solid 1px black;\r\n                position: relative;\r\n                margin-top: -12px;\r\n              }\r\n              .${classNames.componentSelected} .NW,\r\n              .${classNames.componentSelected} .NN,\r\n              .${classNames.componentSelected} .NE {\r\n                top: -4px;\r\n              }\r\n              .${classNames.componentSelected} .NE,\r\n              .${classNames.componentSelected} .EE,\r\n              .${classNames.componentSelected} .SE {\r\n                right: -4px;\r\n              }\r\n              .${classNames.componentSelected} .SW,\r\n              .${classNames.componentSelected}.SS,\r\n              .${classNames.componentSelected} .SE {\r\n                bottom: -4px;\r\n              }\r\n              .${classNames.componentSelected} .NW,\r\n              .${classNames.componentSelected} .WW,\r\n              .${classNames.componentSelected} .SW {\r\n                left: -4px;\r\n              }\r\n              .${classNames.componentSelected} .SE,\r\n              .${classNames.componentSelected} .NW {\r\n                cursor: nw-resize;\r\n              }\r\n              .${classNames.componentSelected} .SW,\r\n              .${classNames.componentSelected} .NE {\r\n                cursor: ne-resize;\r\n              }\r\n              .${classNames.componentSelected} .NN,\r\n              .${classNames.componentSelected} .SS {\r\n                cursor: n-resize;\r\n                left: 50%;\r\n                margin-left: -4px;\r\n              }\r\n              .${classNames.componentSelected} .EE,\r\n              .${classNames.componentSelected} .WW {\r\n                cursor: e-resize;\r\n                top: 50%;\r\n                margin-top: -4px;\r\n              }\r\n            .${classNames.emptyTemplates} {\r\n                padding:50px 0;\r\n                text-align: center;\r\n            }\r\n            .${classNames.loadingTemplates} {\r\n                padding:50px 0;\r\n                text-align: center;\r\n            }\r\n            .${classNames.templateSelected} .page-view {\r\n                border: solid 1px #337ab7!important;\r\n            }\r\n            .${classNames.templateDialog} .name {\r\n                margin-top: -${templateDialog.nameHeight}px;\r\n                height: ${templateDialog.nameHeight}px;\r\n                font-size: ${templateDialog.fontSize}px;\r\n                text-align: center;\r\n                padding-top: 6px;\r\n                background-color: black;\r\n                opacity: 0.5;\r\n            }\r\n            .${classNames.templateDialog} .name span {\r\n                color: white;\r\n            }\r\n            .${classNames.emptyDocument} {\r\n                text-align: center;\r\n                padding: 100px 0;\r\n            }\r\n            .${classNames.component} > .NW,\r\n            .${classNames.component} > .NN,\r\n            .${classNames.component} > .NE,\r\n            .${classNames.component} > .EE,\r\n            .${classNames.component} > .SE,\r\n            .${classNames.component} > .SW,\r\n            .${classNames.component} > .SS,\r\n            .${classNames.component} > .WW {\r\n                display: none;\r\n            }\r\n            .${classNames.componentSelected}.component > .NW,\r\n            .${classNames.componentSelected}.component > .NN,\r\n            .${classNames.componentSelected}.component > .NE,\r\n            .${classNames.componentSelected}.component > .EE,\r\n            .${classNames.componentSelected}.component > .SE,\r\n            .${classNames.componentSelected}.component > .SW,\r\n            .${classNames.componentSelected}.component > .SS,\r\n            .${classNames.componentSelected}.component > .WW {\r\n                display: block;\r\n            }\r\n            .${classNames.placeholder} {\r\n                min-height: 40px;\r\n                width: 100%;\r\n            }\r\n            .${classNames.placeholder}.active,\r\n            .${classNames.componentWrapper}.active,\r\n            .${classNames.componentWrapper}.${classNames.componentSelected}.active {\r\n                border: 1px solid green;\r\n            }\r\n            .${classNames.editorPanel} {\r\n                width: 300px;\r\n                background: white;\r\n                color: black;\r\n                margin: 0;\r\n                font-size: 14px;\r\n                z-index: 100;\r\n                overflow: auto;\r\n            }\r\n            .${classNames.editorPanel} label {\r\n                width: 80px;\r\n                float: left;\r\n                padding: 4px;\r\n                text-overflow: ellipsis;\r\n                overflow: hidden;\r\n            }\r\n            .${classNames.editorPanel} .control {\r\n                padding-left: 90px;\r\n            }\r\n            .${classNames.editorPanel} .empty {\r\n                padding-top: 200px;\r\n                text-align: center;\r\n            }\r\n            .${classNames.designer} .error,\r\n            .${classNames.editorPanel} .error {\r\n                color: red;\r\n            }\r\n            .${classNames.componentPanel} {\r\n                background: white;\r\n                color: black;\r\n                font-size: 14px;\r\n                z-index: 100;\r\n                list-style: none;\r\n                padding: 0;\r\n                text-align: center\r\n            }\r\n            .${classNames.componentPanel} .panel-heading {\r\n                text-align: center;\r\n            }\r\n            .${classNames.componentPanel} li {\r\n                text-align: center;\r\n                padding: 8px;\r\n            }\r\n            .${classNames.componentWrapper}.${classNames.moveDown} {\r\n         \r\n            }\r\n        `;\r\ndocument.head.appendChild(element);\r\nexport function appendClassName(element, addonClassName) {\r\n    if (element == null)\r\n        throw Errors.argumentNull('element');\r\n    if (!addonClassName)\r\n        throw Errors.argumentNull('addonClassName');\r\n    let sourceClassName;\r\n    if (typeof element == 'string')\r\n        sourceClassName = element;\r\n    else\r\n        sourceClassName = element.className;\r\n    sourceClassName = sourceClassName || '';\r\n    console.assert(addonClassName);\r\n    if (sourceClassName.indexOf(addonClassName) >= 0)\r\n        return sourceClassName;\r\n    let className = `${sourceClassName} ${addonClassName}`;\r\n    if (typeof element != 'string')\r\n        element.className = className;\r\n    return className;\r\n}\r\nexport function removeClassName(element, targetClassName) {\r\n    let sourceClassName;\r\n    if (typeof element == 'string')\r\n        sourceClassName = element;\r\n    else\r\n        sourceClassName = element.className || '';\r\n    if (sourceClassName.indexOf(targetClassName) < 0)\r\n        return sourceClassName;\r\n    sourceClassName = sourceClassName || '';\r\n    sourceClassName = sourceClassName.replace(new RegExp(targetClassName, 'g'), '');\r\n    sourceClassName = sourceClassName.trim();\r\n    if (typeof element != 'string')\r\n        element.className = sourceClassName;\r\n    return sourceClassName;\r\n}\r\n//# sourceMappingURL=style.js.map","import * as React from \"react\";\r\nimport { Errors } from \"./errors\";\r\nimport { proptDisplayNames } from \"./propt-display-names\";\r\n// type DesignerContextValue = { designer: ComponentDataHandler | null };\r\n// export const DesignerContext = React.createContext<DesignerContextValue>({ designer: null });\r\nexport const ComponentWrapperContext = React.createContext(null);\r\nexport class Component {\r\n    /**\r\n     * 设置组件特性\r\n     * @param typename 组件类型名称\r\n     * @param attr 组件特性\r\n     */\r\n    static setAttribute(typename, attr) {\r\n        Component.componentAttributes[typename] = attr;\r\n    }\r\n    /**\r\n     * 获取组件特性\r\n     * @param typename 组件类型名称\r\n     */\r\n    static getAttribute(type) {\r\n        let typename = typeof type == 'string' ? type : type.name;\r\n        let attr = Component.componentAttributes[typename];\r\n        return Object.assign({ type }, Component.defaultComponentAttribute, attr || {});\r\n    }\r\n    static getPropEditors(componentData) {\r\n        let componentType = componentData.type;\r\n        let result = [];\r\n        let propEditorInfo = this.componentPropEditors[componentType] || [];\r\n        for (let i = 0; i < propEditorInfo.length; i++) {\r\n            let propName = propEditorInfo[i].propName;\r\n            let display = Component.componentPropEditorDisplay[`${componentType}.${propName}`];\r\n            if (display != null && display(componentData) == false)\r\n                continue;\r\n            result.push(propEditorInfo[i]);\r\n        }\r\n        return result;\r\n        // let classEditors = this.componentPropEditors[componentType] || []\r\n        // Component.componentPropEditorDisplay[`${className}.${propName}`] = editorDisplay;\r\n        // return classEditors\r\n    }\r\n    static getPropEditor(controlClassName, propName) {\r\n        return this.getPropEditorByArray(controlClassName, propName);\r\n    }\r\n    /** 通过属性数组获取属性的编辑器 */\r\n    static getPropEditorByArray(controlClassName, propNames) {\r\n        let classEditors = this.componentPropEditors[controlClassName] || [];\r\n        let editor = classEditors.filter(o => o.propName == propNames)[0];\r\n        return editor;\r\n    }\r\n    static setPropEditor(componentTypeOrOptions, propName, editorType, group) {\r\n        let componentType;\r\n        let editorDisplay;\r\n        if (typeof componentTypeOrOptions == \"object\") {\r\n            let options = componentTypeOrOptions;\r\n            componentType = options.componentType;\r\n            propName = options.propName;\r\n            editorType = options.editorType;\r\n            group = options.group;\r\n            editorDisplay = options.display;\r\n            if (options.displayName != null) {\r\n                proptDisplayNames[propName] = options.displayName;\r\n            }\r\n        }\r\n        else {\r\n            componentType = componentTypeOrOptions;\r\n        }\r\n        group = group || '';\r\n        // 属性可能为导航属性,例如 style.width\r\n        let propNames = propName.split('.');\r\n        let className = typeof componentType == 'string' ? componentType : componentType.prototype.typename || componentType.name;\r\n        Component.componentPropEditorDisplay[`${className}.${propName}`] = editorDisplay;\r\n        let classProps = Component.componentPropEditors[className] = Component.componentPropEditors[className] || [];\r\n        for (let i = 0; i < classProps.length; i++) {\r\n            let propName1 = classProps[i].propName; //classProps[i].propNames.join('.')\r\n            let propName2 = propNames.join('.');\r\n            if (propName1 == propName2) {\r\n                classProps[i].editorType = editorType;\r\n                return;\r\n            }\r\n        }\r\n        classProps.push({ propName, editorType, group });\r\n    }\r\n    static createElement(componentData) {\r\n        // return Component._createElement(componentData, { components: [], componentTypes: [] }, h);\r\n        return defaultComponentFactory(componentData);\r\n    }\r\n    static register(componentName, componentType, attr) {\r\n        if (componentType == null && typeof componentName == 'function') {\r\n            componentType = componentName;\r\n            componentName = componentType.name;\r\n            componentType['componentName'] = componentName;\r\n        }\r\n        if (!componentName)\r\n            throw Errors.argumentNull('componentName');\r\n        if (!componentType)\r\n            throw Errors.argumentNull('componentType');\r\n        Component.componentTypes[componentName] = componentType;\r\n        if (attr)\r\n            Component.setAttribute(componentName, attr);\r\n    }\r\n}\r\n//==========================================\r\n// 用于创建 React 的 React.Fragment \r\nComponent.Fragment = \"\";\r\n//==========================================\r\nComponent.defaultComponentAttribute = {\r\n    container: false, movable: false, showHandler: false, resize: false\r\n};\r\nComponent.componentAttributes = {\r\n    'div': { container: true, movable: true, showHandler: true, resize: true },\r\n    'img': { container: false, movable: true, resize: true },\r\n    'label': { movable: true },\r\n    'ul': { container: false, movable: true, showHandler: true, resize: false },\r\n    'li': { container: true, movable: false, },\r\n    'table': { container: false, movable: true, showHandler: true, resize: true },\r\n    'thead': { container: false, movable: false },\r\n    'tbody': { container: false, movable: false },\r\n    'tfoot': { container: false, movable: false },\r\n    'tr': { container: false, movable: false },\r\n    'td': { container: true, movable: false },\r\n};\r\nComponent.componentPropEditors = {};\r\nComponent.componentPropEditorDisplay = {};\r\n// /**\r\n//  * 将持久化的元素数据转换为 ReactElement\r\n//  * @param componentData 元素数据\r\n//  */\r\n// private static _createElement(componentData: ComponentData, context: CreateElementContext, h?: ComponentFactory): React.ReactElement<any> | null {\r\n//     if (!componentData) throw Errors.argumentNull('componentData')\r\n//     h = h || defaultComponentFactory;\r\n//     try {\r\n//         let type: string | React.ComponentClass | React.ComponentType = componentData.type;\r\n//         let componentName = componentData.type;\r\n//         let controlType = Component.componentTypes[componentName];\r\n//         if (controlType) {\r\n//             type = controlType;\r\n//         }\r\n//         let children: (React.ReactElement<any> | string)[] = [];\r\n//         for (let i = 0; i < componentData.children.length; i++) {\r\n//             let child = componentData.children[i];\r\n//             if (typeof child == \"string\")\r\n//                 children.push(child);\r\n//             else\r\n//                 children.push(Component._createElement(child, context, h));\r\n//         }\r\n//         //componentData.children ? componentData.children.map(o => Component._createElement(o, context, h)) : [];\r\n//         let props: ComponentProps<any> = componentData.props == null ? {} : Object.assign({}, componentData.props);//JSON.parse(JSON.stringify(componentData.props));\r\n//         if (controlType != null && controlType[\"defaultProps\"]) {\r\n//             props = Object.assign({}, controlType[\"defaultProps\"], props);\r\n//         }\r\n//         let result: JSX.Element\r\n//         if (typeof type == 'string') {\r\n//             if (props.text) {\r\n//                 children.push(props.text)\r\n//             }\r\n//             //=========================================\r\n//             // props.text 非 DOM 的 prop，并且已经使用完\r\n//             // delete props.text\r\n//             // if (h == React.createElement) {\r\n//             //     delete props.attr\r\n//             // }\r\n//             //=========================================\r\n//         }\r\n//         let masterPage: MasterPage;\r\n//         type = type == Component.Fragment ? React.Fragment : type\r\n//         let ref = props.ref;\r\n//         props.ref = function (e: any) {\r\n//             if (typeof ref == \"function\")\r\n//                 ref(e);\r\n//             if (e instanceof MasterPage) {\r\n//                 masterPage = e;\r\n//                 for (let i = 0; i < context.componentTypes.length; i++) {\r\n//                     let typeName = context.componentTypes[i];\r\n//                     let childComponents = masterPage.childComponents[typeName] = masterPage.childComponents[typeName] || [];\r\n//                     childComponents.push(context.components[i]);\r\n//                 }\r\n//             }\r\n//             else if (e != null) {\r\n//                 context.components.push(e);\r\n//                 context.componentTypes.push(typeof type == \"string\" ? type : type.name);\r\n//                 // masterPage.componentCreated.fire({ component: e, type: typeof type == \"string\" ? type : type.name });\r\n//             }\r\n//         };\r\n//         result = h(componentData);\r\n//         return result\r\n//     }\r\n//     catch (e) {\r\n//         console.error(e);\r\n//         return null;\r\n//     }\r\n// }\r\nComponent.componentTypes = {};\r\nexport let defaultComponentFactory = (c) => {\r\n    let children = (c.children || []).map(c => typeof c == \"string\" ? c : defaultComponentFactory(c));\r\n    let type = Component.componentTypes[c.type] || c.type;\r\n    let e = React.createElement(type, c.props || {}, ...children);\r\n    return e;\r\n};\r\n//# sourceMappingURL=component.js.map","export let proptDisplayNames = {};\r\n//# sourceMappingURL=propt-display-names.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar guid_1 = require(\"./guid\");\r\nexports.guid = guid_1.guid;\r\nvar path_1 = require(\"./path\");\r\nexports.pathContact = path_1.pathContact;\r\nvar errors_1 = require(\"./errors\");\r\nexports.Errors = errors_1.Errors;\r\nexports.errors = errors_1.errors;\r\nvar callback_1 = require(\"./callback\");\r\nexports.Callback = callback_1.Callback;\r\nvar data_1 = require(\"./data\");\r\nexports.DataSource = data_1.DataSource;\r\nexports.DataSourceSelectArguments = data_1.DataSourceSelectArguments;\r\n","import * as React from \"react\";\r\nimport { Component } from \"../component\";\r\nexport const MasterPageName = 'MasterPage';\r\nexport const MasterPageContext = React.createContext({ master: null });\r\nexport class MasterPage extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.childComponents = {};\r\n        // let children: React.ReactElement<ComponentProps<any>>[] = MasterPage.children(props)\r\n        this.state = {};\r\n    }\r\n    // private static children(props: ComponentProps): React.ReactElement<ComponentProps<any>>[] {\r\n    //     let arr = props.children == null ? [] :\r\n    //         Array.isArray(props.children) ? props.children : [props.children];\r\n    //     let children: React.ReactElement<ComponentProps<any>>[] = []\r\n    //     arr.forEach(o => {\r\n    //         if (!React.isValidElement(o))\r\n    //             return\r\n    //         children.push(o as React.ReactElement<ComponentProps<any>>)\r\n    //     })\r\n    //     return children\r\n    // }\r\n    // static getDerivedStateFromProps(props: ComponentProps) {\r\n    //     let children: React.ReactElement<ComponentProps<any>>[] = MasterPage.children(props)\r\n    //     return { children } as MasterPage[\"state\"];\r\n    // }\r\n    render() {\r\n        // let props = {} as any\r\n        // for (let key in this.props) {\r\n        //     if (key == 'ref' || key == 'id')\r\n        //         continue\r\n        //     props[key] = this.props[key]\r\n        // }\r\n        // props.style = Object.assign({ minHeight: 40 }, props.style)\r\n        // let children = this.state.children.filter(o => o.props.parentId == null);\r\n        let master = this;\r\n        console.assert(master != null);\r\n        let children = this.props.children;\r\n        return React.createElement(MasterPageContext.Provider, { value: { master } }, children);\r\n    }\r\n}\r\nComponent.register(MasterPageName, MasterPage, { container: false });\r\n//# sourceMappingURL=master-page.js.map","export const ComponentTypes = {\r\n    Text: \"Text\",\r\n    PageView: \"PageView\",\r\n    PlaceHolder: \"PlaceHolder\"\r\n};\r\nexport let constants = {\r\n    componentsDir: 'components',\r\n    connectorElementClassName: 'component-container',\r\n    componentTypeName: 'data-component-name',\r\n    componentData: 'component-data',\r\n    componentPosition: \"component-position\"\r\n};\r\nexport { guid } from \"maishu-toolkit\";\r\n//# sourceMappingURL=common.js.map","export * from \"./master-page\";\r\n// export * from \"./place-holder\";\r\n// export * from \"./text\";\r\nexport { ComponentTypes, constants } from \"./common\";\r\n//# sourceMappingURL=index.js.map","import * as React from \"react\";\r\nimport { constants } from \"./components/index\";\r\nimport { classNames } from \"./style\";\r\nexport class ComponentPanel extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { componets: [] };\r\n        this.designer = this.props.designer;\r\n    }\r\n    get element() {\r\n        return this.toolbarElement;\r\n    }\r\n    componentDraggable(toolItemElement, componentData) {\r\n        console.assert(toolItemElement != null);\r\n        toolItemElement.draggable = true;\r\n        toolItemElement.addEventListener('dragstart', function (ev) {\r\n            componentData.props = componentData.props || {};\r\n            ev.dataTransfer.setData(constants.componentData, JSON.stringify(componentData));\r\n            ev.dataTransfer.setData('mousePosition', JSON.stringify({ x: ev.offsetX, y: ev.offsetY }));\r\n        });\r\n    }\r\n    setComponets(componets) {\r\n        this.setState({ componets });\r\n    }\r\n    static getComponentData(dataTransfer) {\r\n        var str = dataTransfer.getData(constants.componentData);\r\n        if (!str)\r\n            return;\r\n        return JSON.parse(str);\r\n    }\r\n    /** 获取光标在图标内的位置 */\r\n    static mouseInnerPosition(dataTransfer) {\r\n        let str = dataTransfer.getData('mousePosition');\r\n        if (!str)\r\n            return;\r\n        return JSON.parse(str);\r\n    }\r\n    render() {\r\n        let empty = this.props.empty || React.createElement(\"div\", { className: \"empty\" }, \"\\u6682\\u65E0\\u53EF\\u7528\\u7EC4\\u4EF6\");\r\n        let props = Object.assign({}, this.props);\r\n        let componets = this.state.componets || [];\r\n        return React.createElement(\"ul\", Object.assign({}, props, { className: `${classNames.componentPanel} ${this.props.className || \"\"}`, ref: (e) => this.toolbarElement = this.toolbarElement || e }), componets.length == 0 ? empty : componets.map((c, i) => {\r\n            let props = { key: i };\r\n            props[ComponentPanel.componentIndexName] = `${i}`;\r\n            return React.createElement(\"li\", Object.assign({}, props, { className: classNames.componentIcon }),\r\n                React.createElement(\"div\", { className: \"btn-link\" },\r\n                    React.createElement(\"i\", { className: c.icon, style: { fontSize: 44, color: 'black' }, ref: e => {\r\n                            if (!e)\r\n                                return;\r\n                            let ctrl = c.componentData;\r\n                            this.componentDraggable(e, ctrl);\r\n                        } })),\r\n                React.createElement(\"div\", null, c.displayName));\r\n        }));\r\n    }\r\n}\r\nComponentPanel.componentIndexName = \"data-component-index\";\r\n//# sourceMappingURL=component-panel.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as React from \"react\";\r\nexport class PropEditor extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n    }\r\n    static dropdown(items, valueType) {\r\n        return dropdown(items, valueType);\r\n    }\r\n    static textInput() {\r\n        return TextInput;\r\n    }\r\n}\r\nexport class TextInput extends PropEditor {\r\n    render() {\r\n        let { value } = this.props;\r\n        return React.createElement(\"input\", { className: 'form-control', value: value || '', onChange: e => {\r\n                // this.setState({ value: e.target.value })\r\n                this.props.updateComponentProp(e.target.value);\r\n            } });\r\n    }\r\n}\r\nfunction dropdown(items, valueType) {\r\n    let itemsPromise;\r\n    let textValues = [];\r\n    if (valueType == null && Array.isArray(items)) {\r\n        valueType = items.length > 0 && typeof items[0] == \"number\" ? \"number\" : \"string\";\r\n        for (let i = 0; i < items.length; i++) {\r\n            textValues[i] = { text: items[i], value: items[i] };\r\n        }\r\n    }\r\n    else if (valueType == null) {\r\n        valueType = \"string\";\r\n        let propNames = Object.getOwnPropertyNames(items);\r\n        for (let i = 0; i < propNames.length; i++) {\r\n            textValues[i] = { text: items[propNames[i]], value: propNames[i] };\r\n        }\r\n    }\r\n    else if (Array.isArray(items)) {\r\n        textValues = items;\r\n    }\r\n    else {\r\n        itemsPromise = items;\r\n    }\r\n    class Dropdown extends PropEditor {\r\n        constructor(props) {\r\n            super(props);\r\n            this.state = {};\r\n        }\r\n        componentDidMount() {\r\n            return __awaiter(this, void 0, void 0, function* () {\r\n                if (itemsPromise) {\r\n                    let items = yield itemsPromise;\r\n                    this.setState({ items });\r\n                }\r\n            });\r\n        }\r\n        render() {\r\n            let { items } = this.state;\r\n            let { value } = this.props;\r\n            items = items || textValues;\r\n            return React.createElement(\"select\", { className: 'form-control', value: value == null ? \"\" : value, onChange: e => {\r\n                    let textValue = e.target.value;\r\n                    if (valueType == \"number\") {\r\n                        let integerRegex = /^\\d+$/;\r\n                        let floatRegex = /^[+-]?\\d+(\\.\\d+)?$/;\r\n                        if (integerRegex.test(textValue))\r\n                            value = parseInt(textValue);\r\n                        else if (floatRegex.test(textValue))\r\n                            value = parseFloat(textValue);\r\n                        else\r\n                            value = null;\r\n                    }\r\n                    else {\r\n                        value = textValue;\r\n                    }\r\n                    this.props.updateComponentProp(value);\r\n                } }, items.map(o => React.createElement(\"option\", { key: o.value, value: o.value }, o.text)));\r\n        }\r\n    }\r\n    return Dropdown;\r\n}\r\n//# sourceMappingURL=prop-editor.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass Callback {\r\n    constructor() {\r\n        this.funcs = new Array();\r\n    }\r\n    add(func) {\r\n        this.funcs.push(func);\r\n    }\r\n    remove(func) {\r\n        this.funcs = this.funcs.filter(o => o != func);\r\n    }\r\n    fire(args) {\r\n        this.funcs.forEach(o => o(args));\r\n    }\r\n    static create() {\r\n        return new Callback();\r\n    }\r\n}\r\nexports.Callback = Callback;\r\n","import { Errors } from \"./errors\";\r\nimport { Callback, guid } from \"maishu-toolkit\";\r\nexport class ComponentDataHandler {\r\n    constructor(componentData) {\r\n        this._components = {};\r\n        this.componentSelected = Callback.create();\r\n        this.componentRemoved = Callback.create();\r\n        this.componentAppend = Callback.create();\r\n        this.componentUpdated = Callback.create();\r\n        this.pageDataChanged = Callback.create();\r\n        this._pageData = componentData;\r\n        this.initComponentData(this._pageData);\r\n    }\r\n    /** 对 pageData 字段补全 */\r\n    initComponentData(componentData) {\r\n        if (componentData == null) {\r\n            return;\r\n        }\r\n        componentData.children = componentData.children || [];\r\n        ComponentDataHandler.fillComponent(componentData);\r\n        ComponentDataHandler.setComponetRefProp(componentData, this._components);\r\n    }\r\n    /** 获取已选择了的组件 */\r\n    get selectedComponents() {\r\n        let arr = new Array();\r\n        let stack = new Array();\r\n        stack.push(this._pageData);\r\n        while (stack.length > 0) {\r\n            let item = stack.pop();\r\n            if (item.props != null && item.selected == true)\r\n                arr.push(item);\r\n            item.children.forEach(child => {\r\n                if (typeof child == \"string\")\r\n                    return true;\r\n                stack.push(child);\r\n            });\r\n        }\r\n        return arr;\r\n    }\r\n    /** 获取已选择了的组件编号 */\r\n    get selectedComponentIds() {\r\n        return this.selectedComponents.map(o => o.id);\r\n    }\r\n    /**  */\r\n    get components() {\r\n        return this._components;\r\n    }\r\n    get pageData() {\r\n        return this._pageData;\r\n    }\r\n    set pageData(value) {\r\n        this._pageData = value;\r\n        this.initComponentData(value);\r\n        this.pageDataChanged.fire(value);\r\n    }\r\n    /**\r\n     * 移动控件到另外一个控件容器\r\n     * @param componentId 要移动的组件编号\r\n     * @param parentId 目标组件编号\r\n     * @param beforeChildId 组件的前一个子组件编号\r\n     */\r\n    moveComponent(componentId, parentId, childComponentIndex) {\r\n        let component = this.findComponentData(componentId);\r\n        if (component == null)\r\n            throw new Error(`Cannt find component by id ${componentId}`);\r\n        console.assert(component != null, `Cannt find component by id ${componentId}`);\r\n        let pageData = this.pageData;\r\n        console.assert(pageData.children != null);\r\n        let children = pageData.children; //translateComponentDataChildren(pageData.children);\r\n        this.removeComponentFrom(componentId, children);\r\n        this.appendComponent(parentId, component, childComponentIndex);\r\n    }\r\n    updateComponentProps(componentProps) {\r\n        let componentDatas = [];\r\n        for (let i = 0; i < componentProps.length; i++) {\r\n            let { componentId, propName, value } = componentProps[i];\r\n            let componentData = this.findComponentData(componentId);\r\n            if (componentData == null)\r\n                continue;\r\n            let navPropsNames = propName.split(\".\");\r\n            console.assert(componentData != null);\r\n            console.assert(navPropsNames != null, 'props is null');\r\n            componentData.props = componentData.props || {};\r\n            let obj = componentData.props;\r\n            for (let i = 0; i < navPropsNames.length - 1; i++) {\r\n                obj = obj[navPropsNames[i]] = obj[navPropsNames[i]] || {};\r\n            }\r\n            obj[navPropsNames[navPropsNames.length - 1]] = value;\r\n            componentDatas.push(componentData);\r\n        }\r\n        this.componentUpdated.fire(componentDatas);\r\n    }\r\n    findComponentData(componentId) {\r\n        let pageData = this._pageData;\r\n        if (!pageData)\r\n            throw Errors.pageDataIsNull();\r\n        // let stack = new Array<ComponentData>();\r\n        // stack.push(pageData);\r\n        // while (stack.length > 0) {\r\n        //     let item = stack.pop();\r\n        //     if (item == null)\r\n        //         continue\r\n        //     if (item.props.id == componentId)\r\n        //         return item;\r\n        //     let children = (item.children || []).filter(o => typeof o == 'object') as ComponentData[]\r\n        //     stack.push(...children);\r\n        // }\r\n        let componentDatas = ComponentDataHandler.travelComponentData(pageData, (item) => item.id == componentId);\r\n        return componentDatas[0];\r\n    }\r\n    removeComponentFrom(controlId, collection) {\r\n        let controlIndex = null;\r\n        for (let i = 0; i < collection.length; i++) {\r\n            let child = collection[i];\r\n            if (typeof child == \"string\")\r\n                continue;\r\n            if (controlId == child.id) {\r\n                controlIndex = i;\r\n                break;\r\n            }\r\n        }\r\n        if (controlIndex == null) {\r\n            for (let i = 0; i < collection.length; i++) {\r\n                let o = collection[i];\r\n                if (typeof o == \"string\")\r\n                    continue;\r\n                let children = o.children;\r\n                if (children && children.length > 0) {\r\n                    let isRemoved = this.removeComponentFrom(controlId, children);\r\n                    if (isRemoved) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        if (controlIndex == 0) {\r\n            collection.shift();\r\n        }\r\n        else if (controlIndex == collection.length - 1) {\r\n            collection.pop();\r\n        }\r\n        else {\r\n            collection.splice(controlIndex, 1);\r\n        }\r\n        return true;\r\n    }\r\n    static travelComponentData(pageData, filter) {\r\n        let stack = new Array();\r\n        stack.push(pageData);\r\n        let r = [];\r\n        // return new Promise((resolve, reject) => {\r\n        filter = filter || (() => true);\r\n        while (stack.length > 0) {\r\n            let item = stack.shift();\r\n            if (filter(item)) {\r\n                r.push(item);\r\n            }\r\n            //===============================================\r\n            // 子元素有可能为字符串, 过滤出对象\r\n            let children = (item.children || []).filter(o => typeof o == 'object');\r\n            //===============================================\r\n            stack.push(...children);\r\n        }\r\n        return r;\r\n    }\r\n    /**\r\n     * 添加控件\r\n     * @param parentId 父控件编号\r\n     * @param componentData 控件数据\r\n     * @param componentIndex 新添加组件在子组件中的次序\r\n     */\r\n    appendComponent(parentId, componentData, componentIndex) {\r\n        if (!parentId)\r\n            throw Errors.argumentNull('parentId');\r\n        if (!componentData)\r\n            throw Errors.argumentNull('childComponent');\r\n        this.initComponentData(componentData);\r\n        let parentControl = this.findComponentData(parentId);\r\n        if (parentControl == null)\r\n            throw new Error('Parent is not exists');\r\n        console.assert(parentControl != null);\r\n        parentControl.children = parentControl.children || [];\r\n        if (componentIndex != null) {\r\n            parentControl.children.splice(componentIndex, 0, componentData);\r\n        }\r\n        else {\r\n            parentControl.children.push(componentData);\r\n        }\r\n        this.selectComponents(componentData.id);\r\n        this.componentAppend.fire(this);\r\n    }\r\n    /**\r\n     * 对组件及其子控件进行命名\r\n     * @param component\r\n     */\r\n    static fillComponent(component) {\r\n        let namedComponents = {};\r\n        // let props: any = component.props = component.props || {};\r\n        //==================================================\r\n        // 兼容旧版本代码\r\n        // if (props.id) {\r\n        //     component.id = props.id;\r\n        //     delete props.id;\r\n        // }\r\n        // if (props.parentId) {\r\n        //     component.parentId = props.parentId;\r\n        //     delete component.parentId;\r\n        // }\r\n        // if (props.selected) {\r\n        //     component.selected = props.selected;\r\n        // }\r\n        // if (props.name) {\r\n        //     component.name = props.name;\r\n        //     delete props.name;\r\n        // }\r\n        // if (props.attr) {\r\n        //     component.attr = props.attr;\r\n        //     delete props.attr;\r\n        // }\r\n        //==================================================\r\n        if (!component.name) {\r\n            let num = 0;\r\n            let name;\r\n            do {\r\n                num = num + 1;\r\n                name = `${component.type}${num}`;\r\n            } while (namedComponents[name]);\r\n            namedComponents[name] = component;\r\n            component.name = name;\r\n        }\r\n        if (!component.id)\r\n            component.id = guid();\r\n        component.children = component.children || [];\r\n        if (!component.children || component.children.length == 0) {\r\n            return;\r\n        }\r\n        component.children.forEach(child => {\r\n            if (typeof child == \"string\")\r\n                return true;\r\n            ComponentDataHandler.fillComponent(child);\r\n        });\r\n    }\r\n    static setComponetRefProp(pageData, components) {\r\n        //=========================================================\r\n        // 纪录当前 pageData 控件 ID\r\n        let componentIds = {};\r\n        //=========================================================\r\n        ComponentDataHandler.travelComponentData(pageData).forEach(item => {\r\n            console.assert(item.props != null && item.id != null);\r\n            componentIds[item.type] = componentIds[item.type] || [];\r\n            componentIds[item.type].push(item.props[\"id\"]);\r\n            let itemRef = item.props.ref;\r\n            item.props.ref = (e) => {\r\n                if (e != null) {\r\n                    components[item.type] = components[item.type] || [];\r\n                    components[item.type].push(e);\r\n                }\r\n                if (typeof itemRef == \"function\")\r\n                    itemRef(e);\r\n            };\r\n        });\r\n        //=========================================================\r\n        // 仅保留 componentIds 中的控件 \r\n        let names = Object.getOwnPropertyNames(components);\r\n        for (let i = 0; i < names.length; i++) {\r\n            let typename = names[i];\r\n            let ids = componentIds[typename] || [];\r\n            components[typename] = (components[typename] || []).filter(o => ids.indexOf(o[\"id\"] || o.props[\"id\"]) >= 0);\r\n        }\r\n        //=========================================================\r\n    }\r\n    /**\r\n     * 选择指定的控件\r\n     * @param control 指定的控件\r\n     */\r\n    selectComponent(componentId) {\r\n        return this.selectComponents(componentId);\r\n    }\r\n    /**\r\n     * 选择指定的控件，一个或多个\r\n     * @param control 指定的控件\r\n     */\r\n    selectComponents(componentIds) {\r\n        if (typeof componentIds == 'string')\r\n            componentIds = [componentIds];\r\n        var stack = [];\r\n        stack.push(this._pageData);\r\n        while (stack.length > 0) {\r\n            let item = stack.pop();\r\n            let isSelectedControl = componentIds.indexOf(item.id) >= 0;\r\n            item.selected = isSelectedControl;\r\n            item.children.forEach(child => {\r\n                if (typeof child == \"string\")\r\n                    return true;\r\n                stack.push(child);\r\n            });\r\n        }\r\n        this.componentSelected.fire(this.selectedComponentIds);\r\n    }\r\n    removeComponent(componentId) {\r\n        return this.removeComponents([componentId]);\r\n    }\r\n    /** 移除控件 */\r\n    removeComponents(componentIds) {\r\n        let pageData = this.pageData;\r\n        if (!pageData || !pageData.children || pageData.children.length == 0)\r\n            return;\r\n        let children = pageData.children;\r\n        componentIds.forEach(controlId => {\r\n            this.removeComponentFrom(controlId, children);\r\n        });\r\n        this.componentRemoved.fire(componentIds);\r\n    }\r\n    setComponentPosition(componentId, position) {\r\n        return this.setComponentsPosition([{ componentId, position }]);\r\n    }\r\n    setComponentsPosition(positions) {\r\n        let toUpdateProps = [];\r\n        positions.forEach(o => {\r\n            let { componentId } = o;\r\n            let { left, top } = o.position;\r\n            let componentData = this.findComponentData(componentId);\r\n            if (!componentData)\r\n                throw new Error(`Control ${componentId} is not exits.`);\r\n            let style = componentData.props.style = (componentData.props.style || {});\r\n            if (left)\r\n                style.left = left;\r\n            if (top)\r\n                style.top = top;\r\n            toUpdateProps.push({ componentId, propName: \"style\", value: style });\r\n        });\r\n        this.updateComponentProps(toUpdateProps);\r\n    }\r\n    /**\r\n * 设置控件大小\r\n * @param componentId 组件编号\r\n * @param size 组件大小\r\n */\r\n    setComponentSize(componentId, size) {\r\n        console.assert(componentId != null);\r\n        console.assert(size != null);\r\n        let componentData = this.findComponentData(componentId);\r\n        if (!componentData)\r\n            throw new Error(`Control ${componentId} is not exits.`);\r\n        let style = componentData.props.style = (componentData.props.style || {});\r\n        if (size.height)\r\n            style.height = size.height;\r\n        if (size.width)\r\n            style.width = size.width;\r\n        // this.componentUpdated.fire([componentData])\r\n        this.updateComponentProps([{ componentId, propName: \"style\", value: style }]);\r\n    }\r\n}\r\n//# sourceMappingURL=component-data-handler.js.map","/*!\n * ~\n *  jueying-core v1.0.2\n * \n *  Copyright (c) 2016-2018, mais.shu <ansiboy@163.com>\n *  Licensed under the MIT License.\n * \n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"react\")) : factory(root[\"react\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(typeof window === 'undefined' ? global : window, function(__WEBPACK_EXTERNAL_MODULE_react__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./out/index.js\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./out/component-factory.js\":\n/*!**********************************!*\\\n  !*** ./out/component-factory.js ***!\n  \\**********************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = __webpack_require__(/*! react */ \"react\");\nconst errors_1 = __webpack_require__(/*! ./errors */ \"./out/errors.js\");\nclass CompoenntFactory {\n    constructor(compoenntTypes) {\n        this.compoenntTypes = compoenntTypes;\n    }\n    createComponent(componentData, context) {\n        try {\n            return this._createComponent(componentData, context);\n        }\n        catch (e) {\n            return this.createErrorElement(e);\n        }\n    }\n    /** 创建视图组件 */\n    createViewComponent(props, ...children) {\n        return React.createElement(\"div\", props, ...children);\n    }\n    createErrorElement(err) {\n        // return <div>\n        //     <div>Error:</div>\n        //     <div>{err.message}</div>\n        // </div>\n        return this.createViewComponent(this.createViewComponent(\"Error:\"), this.createViewComponent(err.message));\n    }\n    _createComponent(componentData, context) {\n        if (typeof componentData == \"string\")\n            return componentData;\n        let children = (componentData.children || []).map(c => this._createComponent(c));\n        let props = (componentData.props || {});\n        let defaultProps = { factory: this, context };\n        let name = componentData.typeName;\n        let compoenntType = this.compoenntTypes[name];\n        if (compoenntType == null) {\n            throw errors_1.errors.componentNotExists(name);\n        }\n        let r = React.createElement(compoenntType, props, children);\n        return r;\n    }\n}\nexports.CompoenntFactory = CompoenntFactory;\n//# sourceMappingURL=component-factory.js.map\n\n/***/ }),\n\n/***/ \"./out/errors.js\":\n/*!***********************!*\\\n  !*** ./out/errors.js ***!\n  \\***********************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.errors = {\n    pathFieldRequired(name) {\n        let msg = `Path field of '${name}' component config can not be null or empty.`;\n        return new Error(msg);\n    },\n    canntFindModule(name, path) {\n        let msg = `Can not find component '${name}' in the module, module path is: '${path}'.`;\n        return new Error(msg);\n    },\n    componentNotExists(name) {\n        let msg = `Component '${name}' not exists.`;\n        return new Error(msg);\n    }\n};\n//# sourceMappingURL=errors.js.map\n\n/***/ }),\n\n/***/ \"./out/index.js\":\n/*!**********************!*\\\n  !*** ./out/index.js ***!\n  \\**********************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar component_factory_1 = __webpack_require__(/*! ./component-factory */ \"./out/component-factory.js\");\nexports.CompoenntFactory = component_factory_1.CompoenntFactory;\n//# sourceMappingURL=index.js.map\n\n/***/ }),\n\n/***/ \"react\":\n/*!************************!*\\\n  !*** external \"react\" ***!\n  \\************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_react__;\n\n/***/ })\n\n/******/ });\n});\n//# sourceMappingURL=index.js.map","/*!\n * ~\n *  maishu-jueying-core v1.1.4\n * \n *  Copyright (c) 2016-2018, mais.shu <ansiboy@163.com>\n *  Licensed under the MIT License.\n * \n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./out/decorators.js\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./out/decorators.js\":\n/*!***************************!*\\\n  !*** ./out/decorators.js ***!\n  \\***************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/** 组件标记，用于将指定的组件标记为可被外部加载 */\nfunction component(options) {\n    return function classDecorator(constructor) {\n    };\n}\nexports.component = component;\n//# sourceMappingURL=decorators.js.map\n\n/***/ })\n\n/******/ });\n});\n//# sourceMappingURL=decorators.js.map","import * as React from \"react\";\r\nimport { Component } from \"./component\";\r\nimport { proptDisplayNames } from \"./propt-display-names\";\r\nimport { Errors } from \"./errors\";\r\nexport class PropertyEditor extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this._element = null;\r\n        this.state = { groupedEditors: [] };\r\n        this.props.designer.componentSelected.add(() => {\r\n            let editors = this.getEditors(this.props.designer);\r\n            this.setState({ groupedEditors: editors });\r\n        });\r\n    }\r\n    // static getDerivedStateFromProps(props: EditorProps, state: EditorState): Partial<EditorState> {\r\n    //     return { designer: props.designer };\r\n    // }\r\n    getEditors(designer) {\r\n        if (designer == null) {\r\n            return [];\r\n        }\r\n        // 各个控件相同的编辑器\r\n        let commonPropEditorInfos = [];\r\n        let selectedComponents = designer.selectedComponents;\r\n        for (let i = 0; i < selectedComponents.length; i++) {\r\n            let componentData = selectedComponents[i];\r\n            let propEditorInfos = Component.getPropEditors(componentData);\r\n            if (i == 0) {\r\n                commonPropEditorInfos = propEditorInfos || [];\r\n            }\r\n            else {\r\n                let items = [];\r\n                commonPropEditorInfos.forEach(propInfo1 => {\r\n                    propEditorInfos.forEach(propInfo2 => {\r\n                        let propName1 = propInfo1.propName; //propInfo1.propNames.join('.')\r\n                        let propName2 = propInfo2.propName; //propInfo2.propNames.join('.')\r\n                        if (propInfo1.editorType == propInfo2.editorType && propName1 == propName2) {\r\n                            items.push(propInfo1);\r\n                        }\r\n                    });\r\n                });\r\n                commonPropEditorInfos = items;\r\n            }\r\n        }\r\n        // 各个控件相同的属性值\r\n        let commonFlatProps;\r\n        for (let i = 0; i < selectedComponents.length; i++) {\r\n            let control = selectedComponents[i];\r\n            let controlProps = Object.assign({}, control.props);\r\n            delete controlProps.children;\r\n            // controlProps = this.flatProps(controlProps)\r\n            if (i == 0) {\r\n                commonFlatProps = controlProps;\r\n            }\r\n            else {\r\n                let obj = {};\r\n                for (let key in commonFlatProps) {\r\n                    if (commonFlatProps[key] == controlProps[key])\r\n                        obj[key] = controlProps[key];\r\n                }\r\n                commonFlatProps = obj;\r\n            }\r\n        }\r\n        let editors = [];\r\n        for (let i = 0; i < commonPropEditorInfos.length; i++) {\r\n            let propEditorInfo = commonPropEditorInfos[i];\r\n            let propName = propEditorInfo.propName;\r\n            ;\r\n            let editorType = propEditorInfo.editorType;\r\n            let value = this.propValue(propName, commonFlatProps);\r\n            let editorProps = {\r\n                value: value,\r\n                editComponents: selectedComponents,\r\n                updateComponentProp: (value) => {\r\n                    let componentProps = selectedComponents.map(o => ({\r\n                        componentId: o.id, propName: propEditorInfo.propName, value\r\n                    }));\r\n                    designer.updateComponentProps(componentProps);\r\n                }\r\n            };\r\n            let editor = React.createElement(editorType, editorProps);\r\n            editors.push({ prop: propEditorInfo.propName, editor, group: propEditorInfo.group });\r\n        }\r\n        return editors;\r\n    }\r\n    propValue(propName, props) {\r\n        if (!propName)\r\n            throw Errors.argumentNull(\"propName\");\r\n        if (!props)\r\n            throw Errors.argumentNull(\"props\");\r\n        let navPropsNames = propName.split(\".\");\r\n        let obj = props;\r\n        for (let i = 0; i < navPropsNames.length; i++) {\r\n            obj = obj[navPropsNames[i]];\r\n            if (obj == null)\r\n                return null;\r\n        }\r\n        return obj;\r\n    }\r\n    render() {\r\n        let { designer } = this.props;\r\n        let editors = this.state.groupedEditors; //this.getEditors(designer)\r\n        if (editors.length == 0) {\r\n            let empty = this.props.empty;\r\n            return React.createElement(\"div\", { className: \"text-center\" }, empty);\r\n        }\r\n        if (this.props.customRender) {\r\n            let items = editors.map(o => Object.assign({ displayName: proptDisplayNames[o.prop] || o.prop }, o));\r\n            let r = this.props.customRender(designer.selectedComponents, items);\r\n            if (r != null) {\r\n                return r;\r\n            }\r\n        }\r\n        let groupEditorsArray = [];\r\n        for (let i = 0; i < editors.length; i++) {\r\n            let group = editors[i].group || '';\r\n            let groupEditors = groupEditorsArray.filter(o => o.group == group)[0];\r\n            if (groupEditors == null) {\r\n                groupEditors = { group: editors[i].group, editors: [] };\r\n                groupEditorsArray.push(groupEditors);\r\n            }\r\n            groupEditors.editors.push({ prop: editors[i].prop, editor: editors[i].editor });\r\n        }\r\n        return React.createElement(React.Fragment, null, groupEditorsArray.map((g) => React.createElement(\"div\", { key: g.group, className: \"panel panel-default\" },\r\n            g.group ? React.createElement(\"div\", { className: \"panel-heading\" }, proptDisplayNames[g.group] || g.group) : null,\r\n            React.createElement(\"div\", { className: \"panel-body\" }, g.editors.map((o, i) => React.createElement(\"div\", { key: o.prop, className: \"form-group clearfix\" },\r\n                React.createElement(\"label\", null, proptDisplayNames[o.prop] || o.prop),\r\n                React.createElement(\"div\", { className: \"control\" },\r\n                    React.createElement(ErrorBoundary, null, o.editor))))))));\r\n    }\r\n    get element() {\r\n        return this._element;\r\n    }\r\n}\r\nexport class ErrorBoundary extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {};\r\n    }\r\n    componentDidCatch(error, info) {\r\n        // Display fallback UI\r\n        this.setState({ error });\r\n        // You can also log the error to an error reporting service\r\n        //   logErrorToMyService(error, info);\r\n        debugger;\r\n    }\r\n    render() {\r\n        let { error } = this.state || {};\r\n        if (error) {\r\n            // You can render any custom fallback UI\r\n            return React.createElement(\"div\", { className: \"error\" },\r\n                React.createElement(\"div\", null, error.message),\r\n                React.createElement(\"div\", null, error.stack));\r\n        }\r\n        return this.props.children;\r\n    }\r\n}\r\n//# sourceMappingURL=property-editor.js.map","import * as React from \"react\";\r\nimport { PropertyEditor } from \"./property-editor\";\r\nimport { classNames } from \"./style\";\r\nexport class EditorPanel extends React.Component {\r\n    // private designerComponentChanged: (args: any) => void\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { componentDatas: [] };\r\n        // this.designerComponentChanged = () => {\r\n        //     console.assert(this.designer != null)\r\n        //     this.setState({ designer: this.designer })\r\n        // }\r\n    }\r\n    get designer() {\r\n        return this._designer;\r\n    }\r\n    // set designer(value) {\r\n    //     if (this._designer) {\r\n    //         this._designer.componentRemoved.remove(this.designerComponentChanged)\r\n    //         this._designer.componentAppend.remove(this.designerComponentChanged)\r\n    //         this._designer.componentUpdated.remove(this.designerComponentChanged)\r\n    //         this._designer.componentSelected.remove(this.designerComponentChanged)\r\n    //     }\r\n    //     if (value) {\r\n    //         value.componentRemoved.add(this.designerComponentChanged)\r\n    //         value.componentAppend.add(this.designerComponentChanged)\r\n    //         value.componentUpdated.add(this.designerComponentChanged)\r\n    //         value.componentSelected.add(this.designerComponentChanged)\r\n    //     }\r\n    //     this._designer = value;\r\n    //     this.setState({ designer: value });\r\n    // }\r\n    render() {\r\n        let { empty } = this.props;\r\n        empty = empty || React.createElement(\"div\", { className: \"empty\" }, \"\\u6682\\u65E0\\u53EF\\u7528\\u7684\\u5C5E\\u6027\");\r\n        let { designer } = this.props;\r\n        return React.createElement(\"div\", { className: `${classNames.editorPanel} ${this.props.className || \"\"}`, ref: (e) => this.element = e || this.element },\r\n            React.createElement(PropertyEditor, { designer: designer, ref: e => this.editor = e || this.editor, empty: empty, customRender: this.props.customRender }));\r\n    }\r\n}\r\n//# sourceMappingURL=editor-panel.js.map","import * as React from \"react\";\r\nimport { Errors } from \"./errors\";\r\nimport { ComponentPanel } from \"./component-panel\";\r\nimport { classNames, appendClassName } from \"./style\";\r\nimport { ComponentWrapperContext } from \"./component\";\r\nimport { MasterPage, constants } from \"./components/index\";\r\n/**\r\n * 组件包装器，对组件进行包装，实现组件设计时的行为。\r\n * 1. 组件的移动\r\n * 2. 组件的拖放\r\n */\r\nexport class ComponentWrapper extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n    }\r\n    componentDidCatch(error, info) {\r\n        // Display fallback UI\r\n        this.setState({ error });\r\n        // You can also log the error to an error reporting service\r\n        //   logErrorToMyService(error, info);\r\n        debugger;\r\n    }\r\n    designtimeBehavior(element, attr) {\r\n        if (!element)\r\n            throw Errors.argumentNull('element');\r\n        if (!attr)\r\n            throw Errors.argumentNull('args');\r\n        if (element.getAttribute('data-behavior')) {\r\n            return;\r\n        }\r\n        element.setAttribute('data-behavior', 'behavior');\r\n        let designer = this.props.handler;\r\n        console.assert(attr.container != null);\r\n        console.assert(attr.movable != null);\r\n        if (attr.container) {\r\n            ComponentWrapper.enableAppendDroppable(element, designer);\r\n        }\r\n        if (attr.movable) {\r\n            console.assert(element != null);\r\n            ComponentWrapper.draggable(designer, element);\r\n            if (this.handler != null)\r\n                ComponentWrapper.draggable(designer, element, this.handler);\r\n        }\r\n        else {\r\n            element.onclick = (ev) => ComponentWrapper.invokeOnClick(ev, designer, element);\r\n        }\r\n    }\r\n    /**\r\n     * 启用拖放操作，以便通过拖放图标添加控件\r\n     */\r\n    static enableAppendDroppable(element, designer) {\r\n        console.assert(element != null);\r\n        element.addEventListener('dragover', function (event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            let componentName = event.dataTransfer.getData(constants.componentData);\r\n            if (componentName)\r\n                event.dataTransfer.dropEffect = \"copy\";\r\n            else\r\n                event.dataTransfer.dropEffect = \"move\";\r\n            console.log(`dragover: left:${event['layerX']} top:${event['layerX']}`);\r\n        });\r\n        element.addEventListener(\"drop\", function (event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            let args1 = arguments[1];\r\n            if (!event.dataTransfer)\r\n                return;\r\n            let ctrl = ComponentPanel.getComponentData(event.dataTransfer);\r\n            if (!ctrl)\r\n                return;\r\n            ctrl.props.style = ctrl.props.style || {};\r\n            designer.pageData.props.style = designer.pageData.props.style || {};\r\n            if (!ctrl.props.style.position) {\r\n                ctrl.props.style.position = designer.pageData.props.style.position;\r\n            }\r\n            let pos = ComponentPanel.mouseInnerPosition(event.dataTransfer);\r\n            console.assert(pos != null);\r\n            if (ctrl.props.style.position == 'absolute') {\r\n                ctrl.props.style.left = event['layerX'] - pos.x;\r\n                ctrl.props.style.top = event['layerY'] - pos.y;\r\n            }\r\n            designer.appendComponent(element.id, ctrl);\r\n        });\r\n    }\r\n    static isResizeHandleClassName(className) {\r\n        let classNames = [\r\n            'resize_handle NE', 'resize_handle NN', 'resize_handle NW',\r\n            'resize_handle WW', 'resize_handle EE', 'resize_handle SW',\r\n            'resize_handle SS', 'resize_handle SE',\r\n        ];\r\n        return classNames.indexOf(className) >= 0;\r\n    }\r\n    static draggable(designer, element, handler) {\r\n        if (!designer)\r\n            throw Errors.argumentNull('designer');\r\n        if (!element)\r\n            throw Errors.argumentNull('element');\r\n        console.assert(element.id != \"\");\r\n        handler = handler || element;\r\n        let componentId = element.id;\r\n        console.assert(componentId != \"\");\r\n        let startPos;\r\n        let rect;\r\n        let dragStart;\r\n        $(handler)\r\n            .drag(\"init\", function (ev) {\r\n            startPos = $(element).position();\r\n            if ($(this).is(`.${classNames.componentSelected}`))\r\n                return $(`.${classNames.componentSelected}`);\r\n        })\r\n            .drag('start', function (ev, dd) {\r\n            dd.attr = $(ev.target).prop(\"className\");\r\n            dd.width = $(this).width();\r\n            dd.height = $(this).height();\r\n            dd.sourceElement = element;\r\n            dragStart = Date.now();\r\n        })\r\n            .drag(function (ev, dd) {\r\n            ev.preventDefault();\r\n            ev.stopPropagation();\r\n            console.log(`drop:`);\r\n            console.log(dd.drop);\r\n            rect = {};\r\n            if (dd.attr.indexOf(\"E\") > -1) {\r\n                rect.width = Math.max(32, dd.width + dd.deltaX);\r\n            }\r\n            if (dd.attr.indexOf(\"S\") > -1) {\r\n                rect.height = Math.max(32, dd.height + dd.deltaY);\r\n            }\r\n            if (dd.attr.indexOf(\"W\") > -1) {\r\n                rect.width = Math.max(32, dd.width - dd.deltaX);\r\n                setLeft(dd);\r\n            }\r\n            if (dd.attr.indexOf(\"N\") > -1) {\r\n                rect.height = Math.max(32, dd.height - dd.deltaY);\r\n                setTop(dd);\r\n            }\r\n            if (dd.attr.indexOf(\"WW\") >= 0)\r\n                setLeft(dd);\r\n            if (dd.attr.indexOf(\"NE\") >= 0 || dd.attr.indexOf(\"NW\") >= 0 || dd.attr.indexOf(\"SW\") >= 0)\r\n                setPosition(dd);\r\n            if (dd.attr.indexOf(\"NN\") >= 0)\r\n                setTop(dd);\r\n            if (dd.attr.indexOf(\"drag\") > -1) {\r\n                rect.top = dd.offsetY;\r\n                rect.left = dd.offsetX;\r\n            }\r\n            if (!ComponentWrapper.isResizeHandleClassName(dd.attr)) {\r\n                setPosition(dd);\r\n            }\r\n            if (dd.attr)\r\n                $(this).css(rect);\r\n        }, { click: true })\r\n            .drag('end', function (ev, dd) {\r\n            let interval = Date.now() - dragStart;\r\n            ComponentWrapper.isDrag = interval >= 300;\r\n            if (!ComponentWrapper.isResizeHandleClassName(dd.attr)) {\r\n                let left = startPos.left + dd.deltaX;\r\n                let top = startPos.top + dd.deltaY;\r\n                designer.setComponentPosition(element.id, { left, top });\r\n                element.style.transform = '';\r\n            }\r\n            else {\r\n                let left, top;\r\n                if (dd.attr.indexOf(\"W\") > -1)\r\n                    left = startPos.left + dd.deltaX;\r\n                if (dd.attr.indexOf(\"N\") > -1)\r\n                    top = startPos.top + dd.deltaY;\r\n                element.style.transform = '';\r\n                designer.setComponentPosition(element.id, { left, top });\r\n                designer.setComponentSize(componentId, rect);\r\n            }\r\n        })\r\n            .click((ev) => {\r\n            ComponentWrapper.invokeOnClick(ev, designer, element);\r\n        });\r\n        let setPosition = (dd) => {\r\n            console.log(['dd.offsetX, dd.offsetY', dd.offsetX, dd.offsetY]);\r\n            console.log(dd);\r\n            element.style.transform = `translate(${dd.deltaX}px,${dd.deltaY}px)`;\r\n        };\r\n        let setTop = (dd) => {\r\n            element.style.transform = `translateY(${dd.deltaY}px)`;\r\n        };\r\n        let setLeft = (dd) => {\r\n            element.style.transform = `translateX(${dd.deltaX}px)`;\r\n        };\r\n    }\r\n    static invokeOnClick(ev, designer, element) {\r\n        ev.preventDefault();\r\n        ev.stopPropagation();\r\n        if (ComponentWrapper.isDrag) {\r\n            ComponentWrapper.isDrag = false;\r\n            return;\r\n        }\r\n        let elementID = element.id;\r\n        if (!ev.ctrlKey) {\r\n            designer.selectComponent(element.id);\r\n            return;\r\n        }\r\n        let selectedControlIds = designer.selectedComponentIds;\r\n        console.assert(elementID != \"\");\r\n        if (selectedControlIds.indexOf(elementID) >= 0) {\r\n            selectedControlIds = selectedControlIds.filter(o => o != elementID);\r\n        }\r\n        else {\r\n            selectedControlIds.push(elementID);\r\n        }\r\n        designer.selectComponents(selectedControlIds);\r\n    }\r\n    componentDidMount() {\r\n        if (!this.element) {\r\n            return;\r\n        }\r\n        let attr = this.props.source.attr;\r\n        this.designtimeBehavior(this.element, attr);\r\n    }\r\n    render() {\r\n        let { error } = this.state || {};\r\n        if (error) {\r\n            return React.createElement(\"div\", { className: \"error\" },\r\n                React.createElement(\"div\", null, error.message),\r\n                React.createElement(\"div\", null, error.stack));\r\n        }\r\n        let attr = this.props.source.attr;\r\n        let shouldWrapper = attr.resize || (typeof this.props.source.type != 'string' && this.props.source.type != MasterPage);\r\n        if (!shouldWrapper) {\r\n            return this.renderWidthoutWrapper();\r\n        }\r\n        let props = this.props.source.props;\r\n        let style = props.style = JSON.parse(JSON.stringify(props.style || {})); // 深复制 style\r\n        let { top, left, position, width, height, display, visibility } = style;\r\n        let className = appendClassName(props.className || '', classNames.componentWrapper);\r\n        className = props.selected ? appendClassName(className, classNames.componentSelected) : className;\r\n        let wrapperProps = {\r\n            id: props.id,\r\n            className,\r\n            style: { top, left, position, width, height, display, visibility },\r\n            ref: (e) => this.element = e || this.element\r\n        };\r\n        let move_handle = props.selected && attr.showHandler ? React.createElement(\"div\", { className: \"move_handle\", style: {}, ref: e => this.handler = e || this.handler }) : null;\r\n        let showResizeHandle = attr.resize && props.style.position == 'absolute' && props.selected;\r\n        let source = this.props.source;\r\n        if (props.style) {\r\n            delete props.style.left;\r\n            delete props.style.top;\r\n            delete props.style.position;\r\n            if (wrapperProps.style.width && wrapperProps.style.width != 'unset')\r\n                props.style.width = '100%';\r\n            if (wrapperProps.style.height && wrapperProps.style.height != 'unset')\r\n                props.style.height = '100%';\r\n        }\r\n        // source.props.ref = function (e) {\r\n        // };\r\n        return React.createElement(ComponentWrapperContext.Provider, { value: this },\r\n            React.createElement(\"div\", Object.assign({}, wrapperProps),\r\n                move_handle,\r\n                showResizeHandle ?\r\n                    React.createElement(React.Fragment, null,\r\n                        React.createElement(\"div\", { className: \"resize_handle NE\" }),\r\n                        React.createElement(\"div\", { className: \"resize_handle NN\" }),\r\n                        React.createElement(\"div\", { className: \"resize_handle NW\" }),\r\n                        React.createElement(\"div\", { className: \"resize_handle WW\" }),\r\n                        React.createElement(\"div\", { className: \"resize_handle EE\" }),\r\n                        React.createElement(\"div\", { className: \"resize_handle SW\" }),\r\n                        React.createElement(\"div\", { className: \"resize_handle SS\" }),\r\n                        React.createElement(\"div\", { className: \"resize_handle SE\" })) : null,\r\n                this.createRawElement(source.type, source.props, source.children)));\r\n    }\r\n    renderWidthoutWrapper() {\r\n        let { type, props, children } = this.props.source;\r\n        let ref = props.ref;\r\n        props.ref = (e) => {\r\n            if (typeof ref == \"function\")\r\n                ref(e);\r\n            if (!e)\r\n                return;\r\n            if (e.tagName) {\r\n                let attr = this.props.source.attr;\r\n                this.designtimeBehavior(e, attr);\r\n                return;\r\n            }\r\n        };\r\n        if (props.selected) {\r\n            props.className = appendClassName(props.className || '', classNames.componentSelected);\r\n        }\r\n        let element = this.createRawElement(type, props, children);\r\n        return React.createElement(ComponentWrapperContext.Provider, { value: this }, element);\r\n    }\r\n    createRawElement(type, props, children) {\r\n        let isEmptyElement = (children || []).length == 0;\r\n        if (isEmptyElement) {\r\n            let emtpy = this.designTimeEmptyElement(type, props);\r\n            if (emtpy != null)\r\n                children = [emtpy];\r\n        }\r\n        return React.createElement(type, props, ...children);\r\n    }\r\n    designTimeEmptyElement(type, props) {\r\n        if (type == 'input' || type == 'img' || type == 'meta' || type == 'link')\r\n            return null;\r\n        let typename = typeof type == 'string' ? type : type.name;\r\n        let text = this.designTimeText(typename, props);\r\n        return text;\r\n    }\r\n    designTimeText(type, props) {\r\n        let text = props.text;\r\n        if (text) {\r\n            return text;\r\n        }\r\n        text = text || props.name || type;\r\n        return text;\r\n    }\r\n}\r\nComponentWrapper.isDrag = false;\r\n// export interface ComponentAttribute {\r\n//     /** 表示组件为容器，可以添加组件 */\r\n//     container?: boolean,\r\n//     /** 表示组件可移动 */\r\n//     movable?: boolean,\r\n//     showHandler?: boolean,\r\n//     resize?: boolean,\r\n// }\r\n//# sourceMappingURL=component-wrapper.js.map","import * as React from \"react\";\r\nimport { Errors } from \"./errors\";\r\nimport { Component, defaultComponentFactory, } from \"./component\";\r\nimport { appendClassName, classNames } from \"./style\";\r\nimport { ComponentWrapper } from \"./component-wrapper\";\r\nexport class PageDesigner extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.components = {};\r\n        let pageData = this.props.handler.pageData;\r\n        this.initPageData(pageData);\r\n        this.state = { pageData };\r\n        this.props.handler.componentSelected.add(args => {\r\n            // this.componentSelected.fire(args);\r\n            this.setState({ pageData: this.props.handler.pageData });\r\n        });\r\n        this.props.handler.componentRemoved.add(args => {\r\n            // this.componentRemoved.fire(args);\r\n            this.setState({ pageData: this.props.handler.pageData });\r\n        });\r\n        this.props.handler.componentUpdated.add(args => {\r\n            // this.componentUpdated.fire(args);\r\n            this.setState({ pageData: this.props.handler.pageData });\r\n        });\r\n        this.props.handler.pageDataChanged.add(args => {\r\n            this.setState({ pageData: args });\r\n        });\r\n        // this.componentAppend = Callback.create();\r\n        // this.props.componentDataHandler.componentAppend.add(() => this.componentAppend.fire(this));\r\n    }\r\n    setComponetRefProp(pageData) {\r\n        //=========================================================\r\n        // 纪录当前 pageData 控件 ID\r\n        let componentIds = {};\r\n        //=========================================================\r\n        PageDesigner.travelComponentData(pageData).forEach(item => {\r\n            console.assert(item.props != null && item.id != null);\r\n            componentIds[item.type] = componentIds[item.type] || [];\r\n            componentIds[item.type].push(item.props[\"id\"]);\r\n            let itemRef = item.props.ref;\r\n            item.props.ref = (e) => {\r\n                if (e != null) {\r\n                    this.components[item.type] = this.components[item.type] || [];\r\n                    this.components[item.type].push(e);\r\n                }\r\n                if (typeof itemRef == \"function\")\r\n                    itemRef(e);\r\n            };\r\n        });\r\n        //=========================================================\r\n        // 仅保留 componentIds 中的控件 \r\n        let names = Object.getOwnPropertyNames(this.components);\r\n        for (let i = 0; i < names.length; i++) {\r\n            let typename = names[i];\r\n            let ids = componentIds[typename] || [];\r\n            this.components[typename] = (this.components[typename] || []).filter(o => ids.indexOf(o[\"id\"] || o.props[\"id\"]) >= 0);\r\n        }\r\n        //=========================================================\r\n    }\r\n    initPageData(pageData) {\r\n        if (pageData == null) {\r\n            return;\r\n        }\r\n        pageData.children = pageData.children || [];\r\n        // PageDesigner.nameComponent(pageData);\r\n        this.setComponetRefProp(pageData);\r\n    }\r\n    allComponents() {\r\n        let r = [];\r\n        for (let key in this.components) {\r\n            r.push(...this.components[key]);\r\n        }\r\n        return r;\r\n    }\r\n    /** 页面数据 */\r\n    get pageData() {\r\n        return this.state.pageData;\r\n    }\r\n    /** 获取已选择了的组件编号 */\r\n    get selectedComponentIds() {\r\n        return this.selectedComponents.map(o => o.id);\r\n    }\r\n    /** 获取已选择了的组件 */\r\n    get selectedComponents() {\r\n        return this.props.handler.selectedComponents;\r\n    }\r\n    get element() {\r\n        return this._element;\r\n    }\r\n    updateComponentProp(componentId, propName, value) {\r\n        return this.updateComponentProps({ componentId, propName, value });\r\n    }\r\n    updateComponentProps(...componentProps) {\r\n        this.props.handler.updateComponentProps(componentProps);\r\n    }\r\n    // /**\r\n    //  * 对组件及其子控件进行命名\r\n    //  * @param component \r\n    //  */\r\n    // private static nameComponent(component: ComponentData) {\r\n    //     let namedComponents: { [key: string]: ComponentData } = {}\r\n    //     let props = component.props = component.props || {};\r\n    //     if (!props.name) {\r\n    //         let num = 0;\r\n    //         let name: string;\r\n    //         do {\r\n    //             num = num + 1;\r\n    //             name = `${component.type}${num}`;\r\n    //         } while (namedComponents[name]);\r\n    //         namedComponents[name] = component\r\n    //         props.name = name;\r\n    //     }\r\n    //     if (!props.id)\r\n    //         props.id = guid();\r\n    //     if (!component.children || component.children.length == 0) {\r\n    //         return;\r\n    //     }\r\n    //     component.children.forEach(child => {\r\n    //         if (typeof child == \"string\")\r\n    //             return true;\r\n    //         PageDesigner.nameComponent(child);\r\n    //     })\r\n    // }\r\n    /**\r\n     * 添加控件\r\n     * @param parentId 父控件编号\r\n     * @param componentData 控件数据\r\n     * @param componentIndex 新添加组件在子组件中的次序\r\n     */\r\n    appendComponent(parentId, componentData, componentIndex) {\r\n        this.props.handler.appendComponent(parentId, componentData, componentIndex);\r\n    }\r\n    /**\r\n     * 设置控件位置\r\n     * @param componentId 组件编号\r\n     * @param position 组件位置\r\n     */\r\n    setComponentPosition(componentId, position) {\r\n        return this.setComponentsPosition([{ componentId, position }]);\r\n    }\r\n    /**\r\n     * 设置控件大小\r\n     * @param componentId 组件编号\r\n     * @param size 组件大小\r\n     */\r\n    setComponentSize(componentId, size) {\r\n        console.assert(componentId != null);\r\n        console.assert(size != null);\r\n        let componentData = this.findComponentData(componentId);\r\n        if (!componentData)\r\n            throw new Error(`Control ${componentId} is not exits.`);\r\n        let style = componentData.props.style = (componentData.props.style || {});\r\n        if (size.height)\r\n            style.height = size.height;\r\n        if (size.width)\r\n            style.width = size.width;\r\n        let { pageData } = this.state;\r\n        this.setState({ pageData });\r\n        // this.componentUpdated.fire([componentData])\r\n    }\r\n    setComponentsPosition(positions) {\r\n        let toUpdateProps = [];\r\n        positions.forEach(o => {\r\n            let { componentId } = o;\r\n            let { left, top } = o.position;\r\n            let componentData = this.props.handler.findComponentData(componentId);\r\n            if (!componentData)\r\n                throw new Error(`Control ${componentId} is not exits.`);\r\n            let style = componentData.props.style = (componentData.props.style || {});\r\n            if (left)\r\n                style.left = left;\r\n            if (top)\r\n                style.top = top;\r\n            toUpdateProps.push({ componentId, propName: \"style\", value: style });\r\n        });\r\n        this.props.handler.updateComponentProps(toUpdateProps);\r\n    }\r\n    /**\r\n     * 选择指定的控件\r\n     * @param control 指定的控件\r\n     */\r\n    selectComponent(componentIds) {\r\n        this.props.handler.selectComponents(componentIds);\r\n        //====================================================\r\n        // 设置焦点，以便获取键盘事件\r\n        if (this._element)\r\n            this._element.focus();\r\n        //====================================================\r\n    }\r\n    /** 移除控件 */\r\n    removeComponent(...componentIds) {\r\n        this.props.handler.removeComponents(componentIds);\r\n    }\r\n    /**\r\n     * 移动控件到另外一个控件容器\r\n     * @param componentId 要移动的组件编号\r\n     * @param parentId 目标组件编号\r\n     * @param targetComponentIndex 组件位置\r\n     */\r\n    moveComponent(componentId, parentId, targetComponentIndex) {\r\n        return this.props.handler.moveComponent(componentId, parentId, targetComponentIndex);\r\n    }\r\n    removeComponentFrom(controlId, collection) {\r\n        let controlIndex = null;\r\n        for (let i = 0; i < collection.length; i++) {\r\n            let child = collection[i];\r\n            if (typeof child == \"string\")\r\n                continue;\r\n            if (controlId == child.id) {\r\n                controlIndex = i;\r\n                break;\r\n            }\r\n        }\r\n        if (controlIndex == null) {\r\n            for (let i = 0; i < collection.length; i++) {\r\n                let o = collection[i];\r\n                if (typeof o == \"string\")\r\n                    continue;\r\n                let children = o.children || [];\r\n                children.forEach(child => {\r\n                    if (typeof child == \"string\")\r\n                        return true;\r\n                    let isRemoved = this.removeComponentFrom(controlId, children);\r\n                    if (isRemoved) {\r\n                        return true;\r\n                    }\r\n                });\r\n            }\r\n            return false;\r\n        }\r\n        if (controlIndex == 0) {\r\n            collection.shift();\r\n        }\r\n        else if (controlIndex == collection.length - 1) {\r\n            collection.pop();\r\n        }\r\n        else {\r\n            collection.splice(controlIndex, 1);\r\n        }\r\n        return true;\r\n    }\r\n    static travelComponentData(pageData, filter) {\r\n        let stack = new Array();\r\n        stack.push(pageData);\r\n        let r = [];\r\n        // return new Promise((resolve, reject) => {\r\n        filter = filter || (() => true);\r\n        while (stack.length > 0) {\r\n            let item = stack.shift();\r\n            if (filter(item)) {\r\n                r.push(item);\r\n            }\r\n            //===============================================\r\n            // 子元素有可能为字符串, 过滤出对象\r\n            let children = (item.children || []).filter(o => typeof o == 'object');\r\n            //===============================================\r\n            stack.push(...children);\r\n        }\r\n        return r;\r\n    }\r\n    findComponentData(componentId) {\r\n        return this.props.handler.findComponentData(componentId);\r\n    }\r\n    onKeyDown(e) {\r\n        const DELETE_KEY_CODE = 46;\r\n        if (e.keyCode == DELETE_KEY_CODE) {\r\n            if (this.selectedComponents.length == 0)\r\n                return;\r\n            this.props.handler.removeComponents(this.selectedComponentIds);\r\n        }\r\n    }\r\n    createDesignTimeElement(componentData) {\r\n        //type: string | React.ComponentClass<any>, props: ComponentProps<any>, ...children: any[]\r\n        let { type, props, children } = componentData;\r\n        if (type == null)\r\n            throw Errors.argumentFieldCanntNull(\"componentData\", 'type');\r\n        if (props == null)\r\n            throw Errors.argumentNull('props');\r\n        if (componentData.id == null)\r\n            throw Errors.argumentFieldCanntNull('id', 'componentData');\r\n        console.assert(componentData.id != null);\r\n        if (componentData.id != null)\r\n            props.key = componentData.id;\r\n        //===================================================\r\n        // 获取对象的 ComponentAttribute ，以从对象 props 中获取的为准\r\n        let attr1 = Component.getAttribute(type);\r\n        console.assert(attr1 != null);\r\n        let attr2 = componentData.attr || {};\r\n        let attr = Object.assign({}, attr1, attr2);\r\n        // delete props.attr\r\n        //===================================================\r\n        let className = componentData.selected ? appendClassName(props.className || '', classNames.componentSelected) : props.className;\r\n        let wrapperProps = Object.assign({}, props);\r\n        delete wrapperProps.ref;\r\n        wrapperProps.className = className;\r\n        // let context: Context = this.props.handler;\r\n        // console.assert(context.handler != null);\r\n        return React.createElement(ComponentWrapper, Object.assign({}, wrapperProps, { handler: this.props.handler, source: { type: type, attr, props, children } }));\r\n    }\r\n    static getDerivedStateFromProps(props, state) {\r\n        return { pageData: props.handler.pageData };\r\n    }\r\n    findComponetsByTypeName(typeName) {\r\n        this.components[typeName];\r\n    }\r\n    render() {\r\n        let { pageData } = this.state;\r\n        let style = this.props.style;\r\n        let elementTag = this.props.elementTag || \"div\";\r\n        // let result = React.createElement(elementTag, {\r\n        //     className: classNames.designer, tabIndex: 1, style,\r\n        //     ref: (e: HTMLElement) => {\r\n        //         if (!e) return;\r\n        //         this._element = e || this._element;\r\n        //         let c = this.props.componentFactory(pageData) //.renderDesignTimeComponent(pageData, e, { handler: this.props.componentDataHandler });\r\n        //         ReactDOM.render(c, e);\r\n        //     },\r\n        //     onKeyDown: (t) => this.onKeyDown(t)\r\n        // })\r\n        // return result;\r\n        return this.props.componentFactory(pageData);\r\n    }\r\n}\r\nPageDesigner.defaultProps = { handler: null, componentFactory: defaultComponentFactory };\r\n//# sourceMappingURL=page-designer.js.map","module.exports = __WEBPACK_EXTERNAL_MODULE__15__;","import './jquery';\r\nimport '../lib/jquery.event.drag-2.2';\r\nimport '../lib/jquery.event.drag.live-2.2';\r\nimport '../lib/jquery.event.drop-2.2';\r\nimport '../lib/jquery.event.drop.live-2.2';\r\nexport { proptDisplayNames as strings, proptDisplayNames } from \"./propt-display-names\";\r\nexport { Component } from \"./component\";\r\nexport { ComponentPanel } from \"./component-panel\";\r\nexport { EditorPanel } from \"./editor-panel\";\r\nexport { PageDesigner } from \"./page-designer\";\r\nexport { PropEditor, TextInput, } from \"./prop-editor\";\r\nexport { classNames } from \"./style\";\r\nexport { ComponentDataHandler } from \"./component-data-handler\";\r\nexport * from \"./components/index\";\r\nexport * from \"maishu-jueying-core\";\r\nexport { component } from \"maishu-jueying-core/decorators\";\r\n//# sourceMappingURL=index.js.map","// import * as j from '../lib/jquery-2.1.3'\r\n// let jquery = window['$'] || window['jQuery'];\r\n// if (jquery == null) {\r\n//     window['$'] = window['jQuery'] = j\r\n// }\r\nimport * as j from \"jquery\";\r\nlet jquery = window['$'] || window['jQuery'];\r\nif (jquery == null) {\r\n    window['$'] = window['jQuery'] = j;\r\n}\r\n//# sourceMappingURL=jquery.js.map","/*! \r\n * jquery.event.drag - v 2.2\r\n * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com\r\n * Open Source MIT License - http://threedubmedia.com/code/license\r\n */\r\n// Created: 2008-06-04 \r\n// Updated: 2012-05-21\r\n// REQUIRES: jquery 1.7.x\r\n\r\n;(function( $ ){\r\n\r\n// add the jquery instance method\r\n$.fn.drag = function( str, arg, opts ){\r\n\t// figure out the event type\r\n\tvar type = typeof str == \"string\" ? str : \"\",\r\n\t// figure out the event handler...\r\n\tfn = $.isFunction( str ) ? str : $.isFunction( arg ) ? arg : null;\r\n\t// fix the event type\r\n\tif ( type.indexOf(\"drag\") !== 0 ) \r\n\t\ttype = \"drag\"+ type;\r\n\t// were options passed\r\n\topts = ( str == fn ? arg : opts ) || {};\r\n\t// trigger or bind event handler\r\n\treturn fn ? this.bind( type, opts, fn ) : this.trigger( type );\r\n};\r\n\r\n// local refs (increase compression)\r\nvar $event = $.event, \r\n$special = $event.special,\r\n// configure the drag special event \r\ndrag = $special.drag = {\r\n\t\r\n\t// these are the default settings\r\n\tdefaults: {\r\n\t\twhich: 1, // mouse button pressed to start drag sequence\r\n\t\tdistance: 0, // distance dragged before dragstart\r\n\t\tnot: ':input', // selector to suppress dragging on target elements\r\n\t\thandle: null, // selector to match handle target elements\r\n\t\trelative: false, // true to use \"position\", false to use \"offset\"\r\n\t\tdrop: true, // false to suppress drop events, true or selector to allow\r\n\t\tclick: false // false to suppress click events after dragend (no proxy)\r\n\t},\r\n\t\r\n\t// the key name for stored drag data\r\n\tdatakey: \"dragdata\",\r\n\t\r\n\t// prevent bubbling for better performance\r\n\tnoBubble: true,\r\n\t\r\n\t// count bound related events\r\n\tadd: function( obj ){ \r\n\t\t// read the interaction data\r\n\t\tvar data = $.data( this, drag.datakey ),\r\n\t\t// read any passed options \r\n\t\topts = obj.data || {};\r\n\t\t// count another realted event\r\n\t\tdata.related += 1;\r\n\t\t// extend data options bound with this event\r\n\t\t// don't iterate \"opts\" in case it is a node \r\n\t\t$.each( drag.defaults, function( key, def ){\r\n\t\t\tif ( opts[ key ] !== undefined )\r\n\t\t\t\tdata[ key ] = opts[ key ];\r\n\t\t});\r\n\t},\r\n\t\r\n\t// forget unbound related events\r\n\tremove: function(){\r\n\t\t$.data( this, drag.datakey ).related -= 1;\r\n\t},\r\n\t\r\n\t// configure interaction, capture settings\r\n\tsetup: function(){\r\n\t\t// check for related events\r\n\t\tif ( $.data( this, drag.datakey ) ) \r\n\t\t\treturn;\r\n\t\t// initialize the drag data with copied defaults\r\n\t\tvar data = $.extend({ related:0 }, drag.defaults );\r\n\t\t// store the interaction data\r\n\t\t$.data( this, drag.datakey, data );\r\n\t\t// bind the mousedown event, which starts drag interactions\r\n\t\t$event.add( this, \"touchstart mousedown\", drag.init, data );\r\n\t\t// prevent image dragging in IE...\r\n\t\tif ( this.attachEvent ) \r\n\t\t\tthis.attachEvent(\"ondragstart\", drag.dontstart ); \r\n\t},\r\n\t\r\n\t// destroy configured interaction\r\n\tteardown: function(){\r\n\t\tvar data = $.data( this, drag.datakey ) || {};\r\n\t\t// check for related events\r\n\t\tif ( data.related ) \r\n\t\t\treturn;\r\n\t\t// remove the stored data\r\n\t\t$.removeData( this, drag.datakey );\r\n\t\t// remove the mousedown event\r\n\t\t$event.remove( this, \"touchstart mousedown\", drag.init );\r\n\t\t// enable text selection\r\n\t\tdrag.textselect( true ); \r\n\t\t// un-prevent image dragging in IE...\r\n\t\tif ( this.detachEvent ) \r\n\t\t\tthis.detachEvent(\"ondragstart\", drag.dontstart ); \r\n\t},\r\n\t\t\r\n\t// initialize the interaction\r\n\tinit: function( event ){ \r\n\t\t// sorry, only one touch at a time\r\n\t\tif ( drag.touched ) \r\n\t\t\treturn;\r\n\t\t// the drag/drop interaction data\r\n\t\tvar dd = event.data, results;\r\n\t\t// check the which directive\r\n\t\tif ( event.which != 0 && dd.which > 0 && event.which != dd.which ) \r\n\t\t\treturn; \r\n\t\t// check for suppressed selector\r\n\t\tif ( $( event.target ).is( dd.not ) ) \r\n\t\t\treturn;\r\n\t\t// check for handle selector\r\n\t\tif ( dd.handle && !$( event.target ).closest( dd.handle, event.currentTarget ).length ) \r\n\t\t\treturn;\r\n\r\n\t\tdrag.touched = event.type == 'touchstart' ? this : null;\r\n\t\tdd.propagates = 1;\r\n\t\tdd.mousedown = this;\r\n\t\tdd.interactions = [ drag.interaction( this, dd ) ];\r\n\t\tdd.target = event.target;\r\n\t\tdd.pageX = event.pageX;\r\n\t\tdd.pageY = event.pageY;\r\n\t\tdd.dragging = null;\r\n\t\t// handle draginit event... \r\n\t\tresults = drag.hijack( event, \"draginit\", dd );\r\n\t\t// early cancel\r\n\t\tif ( !dd.propagates )\r\n\t\t\treturn;\r\n\t\t// flatten the result set\r\n\t\tresults = drag.flatten( results );\r\n\t\t// insert new interaction elements\r\n\t\tif ( results && results.length ){\r\n\t\t\tdd.interactions = [];\r\n\t\t\t$.each( results, function(){\r\n\t\t\t\tdd.interactions.push( drag.interaction( this, dd ) );\r\n\t\t\t});\r\n\t\t}\r\n\t\t// remember how many interactions are propagating\r\n\t\tdd.propagates = dd.interactions.length;\r\n\t\t// locate and init the drop targets\r\n\t\tif ( dd.drop !== false && $special.drop ) \r\n\t\t\t$special.drop.handler( event, dd );\r\n\t\t// disable text selection\r\n\t\tdrag.textselect( false ); \r\n\t\t// bind additional events...\r\n\t\tif ( drag.touched )\r\n\t\t\t$event.add( drag.touched, \"touchmove touchend\", drag.handler, dd );\r\n\t\telse \r\n\t\t\t$event.add( document, \"mousemove mouseup\", drag.handler, dd );\r\n\t\t// helps prevent text selection or scrolling\r\n\t\tif ( !drag.touched || dd.live )\r\n\t\t\treturn false;\r\n\t},\t\r\n\t\r\n\t// returns an interaction object\r\n\tinteraction: function( elem, dd ){\r\n\t\tvar offset = $( elem )[ dd.relative ? \"position\" : \"offset\" ]() || { top:0, left:0 };\r\n\t\treturn {\r\n\t\t\tdrag: elem, \r\n\t\t\tcallback: new drag.callback(), \r\n\t\t\tdroppable: [],\r\n\t\t\toffset: offset\r\n\t\t};\r\n\t},\r\n\t\r\n\t// handle drag-releatd DOM events\r\n\thandler: function( event ){ \r\n\t\t// read the data before hijacking anything\r\n\t\tvar dd = event.data;\t\r\n\t\t// handle various events\r\n\t\tswitch ( event.type ){\r\n\t\t\t// mousemove, check distance, start dragging\r\n\t\t\tcase !dd.dragging && 'touchmove': \r\n\t\t\t\tevent.preventDefault();\r\n\t\t\tcase !dd.dragging && 'mousemove':\r\n\t\t\t\t//  drag tolerance, x� + y� = distance�\r\n\t\t\t\tif ( Math.pow(  event.pageX-dd.pageX, 2 ) + Math.pow(  event.pageY-dd.pageY, 2 ) < Math.pow( dd.distance, 2 ) ) \r\n\t\t\t\t\tbreak; // distance tolerance not reached\r\n\t\t\t\tevent.target = dd.target; // force target from \"mousedown\" event (fix distance issue)\r\n\t\t\t\tdrag.hijack( event, \"dragstart\", dd ); // trigger \"dragstart\"\r\n\t\t\t\tif ( dd.propagates ) // \"dragstart\" not rejected\r\n\t\t\t\t\tdd.dragging = true; // activate interaction\r\n\t\t\t// mousemove, dragging\r\n\t\t\tcase 'touchmove':\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\tcase 'mousemove':\r\n\t\t\t\tif ( dd.dragging ){\r\n\t\t\t\t\t// trigger \"drag\"\t\t\r\n\t\t\t\t\tdrag.hijack( event, \"drag\", dd );\r\n\t\t\t\t\tif ( dd.propagates ){\r\n\t\t\t\t\t\t// manage drop events\r\n\t\t\t\t\t\tif ( dd.drop !== false && $special.drop )\r\n\t\t\t\t\t\t\t$special.drop.handler( event, dd ); // \"dropstart\", \"dropend\"\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tbreak; // \"drag\" not rejected, stop\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.type = \"mouseup\"; // helps \"drop\" handler behave\r\n\t\t\t\t}\r\n\t\t\t// mouseup, stop dragging\r\n\t\t\tcase 'touchend': \r\n\t\t\tcase 'mouseup': \r\n\t\t\tdefault:\r\n\t\t\t\tif ( drag.touched )\r\n\t\t\t\t\t$event.remove( drag.touched, \"touchmove touchend\", drag.handler ); // remove touch events\r\n\t\t\t\telse \r\n\t\t\t\t\t$event.remove( document, \"mousemove mouseup\", drag.handler ); // remove page events\t\r\n\t\t\t\tif ( dd.dragging ){\r\n\t\t\t\t\tif ( dd.drop !== false && $special.drop )\r\n\t\t\t\t\t\t$special.drop.handler( event, dd ); // \"drop\"\r\n\t\t\t\t\tdrag.hijack( event, \"dragend\", dd ); // trigger \"dragend\"\t\r\n\t\t\t\t}\r\n\t\t\t\tdrag.textselect( true ); // enable text selection\r\n\t\t\t\t// if suppressing click events...\r\n\t\t\t\tif ( dd.click === false && dd.dragging )\r\n\t\t\t\t\t$.data( dd.mousedown, \"suppress.click\", new Date().getTime() + 5 );\r\n\t\t\t\tdd.dragging = drag.touched = false; // deactivate element\t\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t},\r\n\t\t\r\n\t// re-use event object for custom events\r\n\thijack: function( event, type, dd, x, elem ){\r\n\t\t// not configured\r\n\t\tif ( !dd ) \r\n\t\t\treturn;\r\n\t\t// remember the original event and type\r\n\t\tvar orig = { event:event.originalEvent, type:event.type },\r\n\t\t// is the event drag related or drog related?\r\n\t\tmode = type.indexOf(\"drop\") ? \"drag\" : \"drop\",\r\n\t\t// iteration vars\r\n\t\tresult, i = x || 0, ia, $elems, callback,\r\n\t\tlen = !isNaN( x ) ? x : dd.interactions.length;\r\n\t\t// modify the event type\r\n\t\tevent.type = type;\r\n\t\t// remove the original event\r\n\t\tevent.originalEvent = null;\r\n\t\t// initialize the results\r\n\t\tdd.results = [];\r\n\t\t// handle each interacted element\r\n\t\tdo if ( ia = dd.interactions[ i ] ){\r\n\t\t\t// validate the interaction\r\n\t\t\tif ( type !== \"dragend\" && ia.cancelled )\r\n\t\t\t\tcontinue;\r\n\t\t\t// set the dragdrop properties on the event object\r\n\t\t\tcallback = drag.properties( event, dd, ia );\r\n\t\t\t// prepare for more results\r\n\t\t\tia.results = [];\r\n\t\t\t// handle each element\r\n\t\t\t$( elem || ia[ mode ] || dd.droppable ).each(function( p, subject ){\r\n\t\t\t\t// identify drag or drop targets individually\r\n\t\t\t\tcallback.target = subject;\r\n\t\t\t\t// force propagtion of the custom event\r\n\t\t\t\tevent.isPropagationStopped = function(){ return false; };\r\n\t\t\t\t// handle the event\t\r\n\t\t\t\tresult = subject ? $event.dispatch.call( subject, event, callback ) : null;\r\n\t\t\t\t// stop the drag interaction for this element\r\n\t\t\t\tif ( result === false ){\r\n\t\t\t\t\tif ( mode == \"drag\" ){\r\n\t\t\t\t\t\tia.cancelled = true;\r\n\t\t\t\t\t\tdd.propagates -= 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( type == \"drop\" ){\r\n\t\t\t\t\t\tia[ mode ][p] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// assign any dropinit elements\r\n\t\t\t\telse if ( type == \"dropinit\" )\r\n\t\t\t\t\tia.droppable.push( drag.element( result ) || subject );\r\n\t\t\t\t// accept a returned proxy element \r\n\t\t\t\tif ( type == \"dragstart\" )\r\n\t\t\t\t\tia.proxy = $( drag.element( result ) || ia.drag )[0];\r\n\t\t\t\t// remember this result\t\r\n\t\t\t\tia.results.push( result );\r\n\t\t\t\t// forget the event result, for recycling\r\n\t\t\t\tdelete event.result;\r\n\t\t\t\t// break on cancelled handler\r\n\t\t\t\tif ( type !== \"dropinit\" )\r\n\t\t\t\t\treturn result;\r\n\t\t\t});\t\r\n\t\t\t// flatten the results\t\r\n\t\t\tdd.results[ i ] = drag.flatten( ia.results );\t\r\n\t\t\t// accept a set of valid drop targets\r\n\t\t\tif ( type == \"dropinit\" )\r\n\t\t\t\tia.droppable = drag.flatten( ia.droppable );\r\n\t\t\t// locate drop targets\r\n\t\t\tif ( type == \"dragstart\" && !ia.cancelled )\r\n\t\t\t\tcallback.update(); \r\n\t\t}\r\n\t\twhile ( ++i < len )\r\n\t\t// restore the original event & type\r\n\t\tevent.type = orig.type;\r\n\t\tevent.originalEvent = orig.event;\r\n\t\t// return all handler results\r\n\t\treturn drag.flatten( dd.results );\r\n\t},\r\n\t\t\r\n\t// extend the callback object with drag/drop properties...\r\n\tproperties: function( event, dd, ia ){\t\t\r\n\t\tvar obj = ia.callback;\r\n\t\t// elements\r\n\t\tobj.drag = ia.drag;\r\n\t\tobj.proxy = ia.proxy || ia.drag;\r\n\t\t// starting mouse position\r\n\t\tobj.startX = dd.pageX;\r\n\t\tobj.startY = dd.pageY;\r\n\t\t// current distance dragged\r\n\t\tobj.deltaX = event.pageX - dd.pageX;\r\n\t\tobj.deltaY = event.pageY - dd.pageY;\r\n\t\t// original element position\r\n\t\tobj.originalX = ia.offset.left;\r\n\t\tobj.originalY = ia.offset.top;\r\n\t\t// adjusted element position\r\n\t\tobj.offsetX = obj.originalX + obj.deltaX; \r\n\t\tobj.offsetY = obj.originalY + obj.deltaY;\r\n\t\t// assign the drop targets information\r\n\t\tobj.drop = drag.flatten( ( ia.drop || [] ).slice() );\r\n\t\tobj.available = drag.flatten( ( ia.droppable || [] ).slice() );\r\n\t\treturn obj;\t\r\n\t},\r\n\t\r\n\t// determine is the argument is an element or jquery instance\r\n\telement: function( arg ){\r\n\t\tif ( arg && ( arg.jquery || arg.nodeType == 1 ) )\r\n\t\t\treturn arg;\r\n\t},\r\n\t\r\n\t// flatten nested jquery objects and arrays into a single dimension array\r\n\tflatten: function( arr ){\r\n\t\treturn $.map( arr, function( member ){\r\n\t\t\treturn member && member.jquery ? $.makeArray( member ) : \r\n\t\t\t\tmember && member.length ? drag.flatten( member ) : member;\r\n\t\t});\r\n\t},\r\n\t\r\n\t// toggles text selection attributes ON (true) or OFF (false)\r\n\ttextselect: function( bool ){ \r\n\t\t$( document )[ bool ? \"unbind\" : \"bind\" ](\"selectstart\", drag.dontstart )\r\n\t\t\t.css(\"MozUserSelect\", bool ? \"\" : \"none\" );\r\n\t\t// .attr(\"unselectable\", bool ? \"off\" : \"on\" )\r\n\t\tdocument.unselectable = bool ? \"off\" : \"on\"; \r\n\t},\r\n\t\r\n\t// suppress \"selectstart\" and \"ondragstart\" events\r\n\tdontstart: function(){ \r\n\t\treturn false; \r\n\t},\r\n\t\r\n\t// a callback instance contructor\r\n\tcallback: function(){}\r\n\t\r\n};\r\n\r\n// callback methods\r\ndrag.callback.prototype = {\r\n\tupdate: function(){\r\n\t\tif ( $special.drop && this.available.length )\r\n\t\t\t$.each( this.available, function( i ){\r\n\t\t\t\t$special.drop.locate( this, i );\r\n\t\t\t});\r\n\t}\r\n};\r\n\r\n// patch $.event.$dispatch to allow suppressing clicks\r\nvar $dispatch = $event.dispatch;\r\n$event.dispatch = function( event ){\r\n\tif ( $.data( this, \"suppress.\"+ event.type ) - new Date().getTime() > 0 ){\r\n\t\t$.removeData( this, \"suppress.\"+ event.type );\r\n\t\treturn;\r\n\t}\r\n\treturn $dispatch.apply( this, arguments );\r\n};\r\n\r\n// event fix hooks for touch events...\r\nvar touchHooks = \r\n$event.fixHooks.touchstart = \r\n$event.fixHooks.touchmove = \r\n$event.fixHooks.touchend =\r\n$event.fixHooks.touchcancel = {\r\n\tprops: \"clientX clientY pageX pageY screenX screenY\".split( \" \" ),\r\n\tfilter: function( event, orig ) {\r\n\t\tif ( orig ){\r\n\t\t\tvar touched = ( orig.touches && orig.touches[0] )\r\n\t\t\t\t|| ( orig.changedTouches && orig.changedTouches[0] )\r\n\t\t\t\t|| null; \r\n\t\t\t// iOS webkit: touchstart, touchmove, touchend\r\n\t\t\tif ( touched ) \r\n\t\t\t\t$.each( touchHooks.props, function( i, prop ){\r\n\t\t\t\t\tevent[ prop ] = touched[ prop ];\r\n\t\t\t\t});\r\n\t\t}\r\n\t\treturn event;\r\n\t}\r\n};\r\n\r\n// share the same special event configuration with related events...\r\n$special.draginit = $special.dragstart = $special.dragend = drag;\r\n\r\n})( jQuery );","/*! \r\n * jquery.event.drag.live - v 2.2\r\n * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com\r\n * Open Source MIT License - http://threedubmedia.com/code/license\r\n */\r\n// Created: 2010-06-07\r\n// Updated: 2012-05-21\r\n// REQUIRES: jquery 1.7.x, event.drag 2.2\r\n\r\n;(function( $ ){\r\n\t\r\n// local refs (increase compression)\r\nvar $event = $.event,\r\n// ref the special event config\r\ndrag = $event.special.drag,\r\n// old drag event add method\r\norigadd = drag.add,\r\n// old drag event teradown method\r\norigteardown = drag.teardown;\r\n\r\n// allow events to bubble for delegation\r\ndrag.noBubble = false;\r\n\r\n// the namespace for internal live events\r\ndrag.livekey = \"livedrag\";\r\n\r\n// new drop event add method\r\ndrag.add = function( obj ){ \r\n\t// call the old method\r\n\torigadd.apply( this, arguments );\r\n\t// read the data\r\n\tvar data = $.data( this, drag.datakey );\r\n\t// bind the live \"draginit\" delegator\r\n\tif ( !data.live && obj.selector ){\r\n\t\tdata.live = true;\r\n\t\t$event.add( this, \"draginit.\"+ drag.livekey, drag.delegate );\r\n\t}\r\n};\r\n\r\n// new drop event teardown method\r\ndrag.teardown = function(){ \r\n\t// call the old method\r\n\torigteardown.apply( this, arguments );\r\n\t// read the data\r\n\tvar data = $.data( this, drag.datakey ) || {};\r\n\t// bind the live \"draginit\" delegator\r\n\tif ( data.live ){\r\n\t\t// remove the \"live\" delegation\r\n\t\t$event.remove( this, \"draginit.\"+ drag.livekey, drag.delegate );\r\n\t\tdata.live = false;\r\n\t}\r\n};\r\n\r\n// identify potential delegate elements\r\ndrag.delegate = function( event ){\r\n\t// local refs\r\n\tvar elems = [], target, \r\n\t// element event structure\r\n\tevents = $.data( this, \"events\" ) || {};\r\n\t// query live events\r\n\t$.each( events || [], function( key, arr ){\r\n\t\t// no event type matches\r\n\t\tif ( key.indexOf(\"drag\") !== 0 )\r\n\t\t\treturn;\r\n\t\t$.each( arr || [], function( i, obj ){\r\n\t\t\t// locate the element to delegate\r\n\t\t\ttarget = $( event.target ).closest( obj.selector, event.currentTarget )[0];\r\n\t\t\t// no element found\r\n\t\t\tif ( !target ) \r\n\t\t\t\treturn;\r\n\t\t\t// add an event handler\r\n\t\t\t$event.add( target, obj.origType+'.'+drag.livekey, obj.origHandler || obj.handler, obj.data );\r\n\t\t\t// remember new elements\r\n\t\t\tif ( $.inArray( target, elems ) < 0 )\r\n\t\t\t\telems.push( target );\t\t\r\n\t\t});\r\n\t});\r\n\t// if there are no elements, break\r\n\tif ( !elems.length ) \r\n\t\treturn false;\r\n\t// return the matched results, and clenup when complete\t\t\r\n\treturn $( elems ).bind(\"dragend.\"+ drag.livekey, function(){\r\n\t\t$event.remove( this, \".\"+ drag.livekey ); // cleanup delegation\r\n\t});\r\n};\r\n\t\r\n})( jQuery );","/*! \n * jquery.event.drop - v 2.2\n * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com\n * Open Source MIT License - http://threedubmedia.com/code/license\n */\n// Created: 2008-06-04 \n// Updated: 2012-05-21\n// REQUIRES: jquery 1.7.x, event.drag 2.2\n\n;(function($){ // secure $ jQuery alias\n\n// Events: drop, dropstart, dropend\n\n// add the jquery instance method\n$.fn.drop = function( str, arg, opts ){\n\t// figure out the event type\n\tvar type = typeof str == \"string\" ? str : \"\",\n\t// figure out the event handler...\n\tfn = $.isFunction( str ) ? str : $.isFunction( arg ) ? arg : null;\n\t// fix the event type\n\tif ( type.indexOf(\"drop\") !== 0 ) \n\t\ttype = \"drop\"+ type;\n\t// were options passed\n\topts = ( str == fn ? arg : opts ) || {};\n\t// trigger or bind event handler\n\treturn fn ? this.bind( type, opts, fn ) : this.trigger( type );\n};\n\n// DROP MANAGEMENT UTILITY\n// returns filtered drop target elements, caches their positions\n$.drop = function( opts ){ \n\topts = opts || {};\n\t// safely set new options...\n\tdrop.multi = opts.multi === true ? Infinity : \n\t\topts.multi === false ? 1 : !isNaN( opts.multi ) ? opts.multi : drop.multi;\n\tdrop.delay = opts.delay || drop.delay;\n\tdrop.tolerance = $.isFunction( opts.tolerance ) ? opts.tolerance : \n\t\topts.tolerance === null ? null : drop.tolerance;\n\tdrop.mode = opts.mode || drop.mode || 'intersect';\n};\n\n// local refs (increase compression)\nvar $event = $.event, \n$special = $event.special,\n// configure the drop special event\ndrop = $.event.special.drop = {\n\n\t// these are the default settings\n\tmulti: 1, // allow multiple drop winners per dragged element\n\tdelay: 20, // async timeout delay\n\tmode: 'overlap', // drop tolerance mode\n\t\t\n\t// internal cache\n\ttargets: [], \n\t\n\t// the key name for stored drop data\n\tdatakey: \"dropdata\",\n\t\t\n\t// prevent bubbling for better performance\n\tnoBubble: true,\n\t\n\t// count bound related events\n\tadd: function( obj ){ \n\t\t// read the interaction data\n\t\tvar data = $.data( this, drop.datakey );\n\t\t// count another realted event\n\t\tdata.related += 1;\n\t},\n\t\n\t// forget unbound related events\n\tremove: function(){\n\t\t$.data( this, drop.datakey ).related -= 1;\n\t},\n\t\n\t// configure the interactions\n\tsetup: function(){\n\t\t// check for related events\n\t\tif ( $.data( this, drop.datakey ) ) \n\t\t\treturn;\n\t\t// initialize the drop element data\n\t\tvar data = { \n\t\t\trelated: 0,\n\t\t\tactive: [],\n\t\t\tanyactive: 0,\n\t\t\twinner: 0,\n\t\t\tlocation: {}\n\t\t};\n\t\t// store the drop data on the element\n\t\t$.data( this, drop.datakey, data );\n\t\t// store the drop target in internal cache\n\t\tdrop.targets.push( this );\n\t},\n\t\n\t// destroy the configure interaction\t\n\tteardown: function(){ \n\t\tvar data = $.data( this, drop.datakey ) || {};\n\t\t// check for related events\n\t\tif ( data.related ) \n\t\t\treturn;\n\t\t// remove the stored data\n\t\t$.removeData( this, drop.datakey );\n\t\t// reference the targeted element\n\t\tvar element = this;\n\t\t// remove from the internal cache\n\t\tdrop.targets = $.grep( drop.targets, function( target ){ \n\t\t\treturn ( target !== element ); \n\t\t});\n\t},\n\t\n\t// shared event handler\n\thandler: function( event, dd ){ \n\t\t// local vars\n\t\tvar results, $targets;\n\t\t// make sure the right data is available\n\t\tif ( !dd ) \n\t\t\treturn;\n\t\t// handle various events\n\t\tswitch ( event.type ){\n\t\t\t// draginit, from $.event.special.drag\n\t\t\tcase 'mousedown': // DROPINIT >>\n\t\t\tcase 'touchstart': // DROPINIT >>\n\t\t\t\t// collect and assign the drop targets\n\t\t\t\t$targets =  $( drop.targets );\n\t\t\t\tif ( typeof dd.drop == \"string\" )\n\t\t\t\t\t$targets = $targets.filter( dd.drop );\n\t\t\t\t// reset drop data winner properties\n\t\t\t\t$targets.each(function(){\n\t\t\t\t\tvar data = $.data( this, drop.datakey );\n\t\t\t\t\tdata.active = [];\n\t\t\t\t\tdata.anyactive = 0;\n\t\t\t\t\tdata.winner = 0;\n\t\t\t\t});\n\t\t\t\t// set available target elements\n\t\t\t\tdd.droppable = $targets;\n\t\t\t\t// activate drop targets for the initial element being dragged\n\t\t\t\t$special.drag.hijack( event, \"dropinit\", dd ); \n\t\t\t\tbreak;\n\t\t\t// drag, from $.event.special.drag\n\t\t\tcase 'mousemove': // TOLERATE >>\n\t\t\tcase 'touchmove': // TOLERATE >>\n\t\t\t\tdrop.event = event; // store the mousemove event\n\t\t\t\tif ( !drop.timer )\n\t\t\t\t\t// monitor drop targets\n\t\t\t\t\tdrop.tolerate( dd ); \n\t\t\t\tbreak;\n\t\t\t// dragend, from $.event.special.drag\n\t\t\tcase 'mouseup': // DROP >> DROPEND >>\n\t\t\tcase 'touchend': // DROP >> DROPEND >>\n\t\t\t\tdrop.timer = clearTimeout( drop.timer ); // delete timer\t\n\t\t\t\tif ( dd.propagates ){\n\t\t\t\t\t$special.drag.hijack( event, \"drop\", dd ); \n\t\t\t\t\t$special.drag.hijack( event, \"dropend\", dd ); \n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t}\n\t},\n\t\t\n\t// returns the location positions of an element\n\tlocate: function( elem, index ){ \n\t\tvar data = $.data( elem, drop.datakey ),\n\t\t$elem = $( elem ), \n\t\tposi = $elem.offset() || {}, \n\t\theight = $elem.outerHeight(), \n\t\twidth = $elem.outerWidth(),\n\t\tlocation = { \n\t\t\telem: elem, \n\t\t\twidth: width, \n\t\t\theight: height,\n\t\t\ttop: posi.top, \n\t\t\tleft: posi.left, \n\t\t\tright: posi.left + width, \n\t\t\tbottom: posi.top + height\n\t\t};\n\t\t// drag elements might not have dropdata\n\t\tif ( data ){\n\t\t\tdata.location = location;\n\t\t\tdata.index = index;\n\t\t\tdata.elem = elem;\n\t\t}\n\t\treturn location;\n\t},\n\t\n\t// test the location positions of an element against another OR an X,Y coord\n\tcontains: function( target, test ){ // target { location } contains test [x,y] or { location }\n\t\treturn ( ( test[0] || test.left ) >= target.left && ( test[0] || test.right ) <= target.right\n\t\t\t&& ( test[1] || test.top ) >= target.top && ( test[1] || test.bottom ) <= target.bottom ); \n\t},\n\t\n\t// stored tolerance modes\n\tmodes: { // fn scope: \"$.event.special.drop\" object \n\t\t// target with mouse wins, else target with most overlap wins\n\t\t'intersect': function( event, proxy, target ){\n\t\t\treturn this.contains( target, [ event.pageX, event.pageY ] ) ? // check cursor\n\t\t\t\t1e9 : this.modes.overlap.apply( this, arguments ); // check overlap\n\t\t},\n\t\t// target with most overlap wins\t\n\t\t'overlap': function( event, proxy, target ){\n\t\t\t// calculate the area of overlap...\n\t\t\treturn Math.max( 0, Math.min( target.bottom, proxy.bottom ) - Math.max( target.top, proxy.top ) )\n\t\t\t\t* Math.max( 0, Math.min( target.right, proxy.right ) - Math.max( target.left, proxy.left ) );\n\t\t},\n\t\t// proxy is completely contained within target bounds\t\n\t\t'fit': function( event, proxy, target ){\n\t\t\treturn this.contains( target, proxy ) ? 1 : 0;\n\t\t},\n\t\t// center of the proxy is contained within target bounds\t\n\t\t'middle': function( event, proxy, target ){\n\t\t\treturn this.contains( target, [ proxy.left + proxy.width * .5, proxy.top + proxy.height * .5 ] ) ? 1 : 0;\n\t\t}\n\t},\t\n\t\n\t// sort drop target cache by by winner (dsc), then index (asc)\n\tsort: function( a, b ){\n\t\treturn ( b.winner - a.winner ) || ( a.index - b.index );\n\t},\n\t\t\n\t// async, recursive tolerance execution\n\ttolerate: function( dd ){\t\t\n\t\t// declare local refs\n\t\tvar i, drp, drg, data, arr, len, elem,\n\t\t// interaction iteration variables\n\t\tx = 0, ia, end = dd.interactions.length,\n\t\t// determine the mouse coords\n\t\txy = [ drop.event.pageX, drop.event.pageY ],\n\t\t// custom or stored tolerance fn\n\t\ttolerance = drop.tolerance || drop.modes[ drop.mode ];\n\t\t// go through each passed interaction...\n\t\tdo if ( ia = dd.interactions[x] ){\n\t\t\t// check valid interaction\n\t\t\tif ( !ia )\n\t\t\t\treturn; \n\t\t\t// initialize or clear the drop data\n\t\t\tia.drop = [];\n\t\t\t// holds the drop elements\n\t\t\tarr = []; \n\t\t\tlen = ia.droppable.length;\n\t\t\t// determine the proxy location, if needed\n\t\t\tif ( tolerance )\n\t\t\t\tdrg = drop.locate( ia.proxy ); \n\t\t\t// reset the loop\n\t\t\ti = 0;\n\t\t\t// loop each stored drop target\n\t\t\tdo if ( elem = ia.droppable[i] ){ \n\t\t\t\tdata = $.data( elem, drop.datakey );\n\t\t\t\tdrp = data.location;\n\t\t\t\tif ( !drp ) continue;\n\t\t\t\t// find a winner: tolerance function is defined, call it\n\t\t\t\tdata.winner = tolerance ? tolerance.call( drop, drop.event, drg, drp ) \n\t\t\t\t\t// mouse position is always the fallback\n\t\t\t\t\t: drop.contains( drp, xy ) ? 1 : 0; \n\t\t\t\tarr.push( data );\t\n\t\t\t} while ( ++i < len ); // loop \n\t\t\t// sort the drop targets\n\t\t\tarr.sort( drop.sort );\t\t\t\n\t\t\t// reset the loop\n\t\t\ti = 0;\n\t\t\t// loop through all of the targets again\n\t\t\tdo if ( data = arr[ i ] ){\n\t\t\t\t// winners...\n\t\t\t\tif ( data.winner && ia.drop.length < drop.multi ){\n\t\t\t\t\t// new winner... dropstart\n\t\t\t\t\tif ( !data.active[x] && !data.anyactive ){\n\t\t\t\t\t\t// check to make sure that this is not prevented\n\t\t\t\t\t\tif ( $special.drag.hijack( drop.event, \"dropstart\", dd, x, data.elem )[0] !== false ){ \t\n\t\t\t\t\t\t\tdata.active[x] = 1;\n\t\t\t\t\t\t\tdata.anyactive += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// if false, it is not a winner\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tdata.winner = 0;\n\t\t\t\t\t}\n\t\t\t\t\t// if it is still a winner\n\t\t\t\t\tif ( data.winner )\n\t\t\t\t\t\tia.drop.push( data.elem );\n\t\t\t\t}\n\t\t\t\t// losers... \n\t\t\t\telse if ( data.active[x] && data.anyactive == 1 ){\n\t\t\t\t\t// former winner... dropend\n\t\t\t\t\t$special.drag.hijack( drop.event, \"dropend\", dd, x, data.elem ); \n\t\t\t\t\tdata.active[x] = 0;\n\t\t\t\t\tdata.anyactive -= 1;\n\t\t\t\t}\n\t\t\t} while ( ++i < len ); // loop \t\t\n\t\t} while ( ++x < end ) // loop\n\t\t// check if the mouse is still moving or is idle\n\t\tif ( drop.last && xy[0] == drop.last.pageX && xy[1] == drop.last.pageY ) \n\t\t\tdelete drop.timer; // idle, don't recurse\n\t\telse  // recurse\n\t\t\tdrop.timer = setTimeout(function(){ \n\t\t\t\tdrop.tolerate( dd ); \n\t\t\t}, drop.delay );\n\t\t// remember event, to compare idleness\n\t\tdrop.last = drop.event; \n\t}\n\t\n};\n\n// share the same special event configuration with related events...\n$special.dropinit = $special.dropstart = $special.dropend = drop;\n\n})(jQuery); // confine scope\t","/*! \n * jquery.event.drop.live - v 2.2\n * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com\n * Open Source MIT License - http://threedubmedia.com/code/license\n */\n// Created: 2010-06-07\n// Updated: 2012-05-21\n// REQUIRES: jquery 1.7.x, event.drag 2.2, event.drop 2.2\n\n;(function($){ // secure $ jQuery alias\n\n// local refs (increase compression)\nvar $event = $.event,\n// ref the drop special event config\ndrop = $event.special.drop,\n// old drop event add method\norigadd = drop.add,\n// old drop event teradown method\norigteardown = drop.teardown;\n\n// allow events to bubble for delegation\ndrop.noBubble = false;\n\n// the namespace for internal live events\ndrop.livekey = \"livedrop\";\n\n// new drop event add method\ndrop.add = function( obj ){ \n\t// call the old method\n\torigadd.apply( this, arguments );\n\t// read the data\n\tvar data = $.data( this, drop.datakey );\n\t// bind the live \"dropinit\" delegator\n\tif ( !data.live && obj.selector ){\n\t\tdata.live = true;\n\t\t$event.add( this, \"dropinit.\"+ drop.livekey, drop.delegate );\n\t}\n};\n\n// new drop event teardown method\ndrop.teardown = function(){ \n\t// call the old method\n\torigteardown.apply( this, arguments );\n\t// read the data\n\tvar data = $.data( this, drop.datakey ) || {};\n\t// remove the live \"dropinit\" delegator\n\tif ( data.live ){\n\t\t// remove the \"live\" delegation\n\t\t$event.remove( this, \"dropinit\", drop.delegate );\n\t\tdata.live = false;\n\t}\n};\n\n// identify potential delegate elements\ndrop.delegate = function( event, dd ){\n\t// local refs\n\tvar elems = [], $targets, \n\t// element event structure\n\tevents = $.data( this, \"events\" ) || {};\n\t// query live events\n\t$.each( events || [], function( key, arr ){\n\t\t// no event type matches\n\t\tif ( key.indexOf(\"drop\") !== 0 )\n\t\t\treturn;\n\t\t$.each( arr, function( i, obj ){\n\t\t\t// locate the elements to delegate\n\t\t\t$targets = $( event.currentTarget ).find( obj.selector );\n\t\t\t// no element found\n\t\t\tif ( !$targets.length ) \n\t\t\t\treturn;\n\t\t\t// take each target...\n\t\t\t$targets.each(function(){\n\t\t\t\t// add an event handler\n\t\t\t\t$event.add( this, obj.origType +'.'+ drop.livekey, obj.origHandler || obj.handler, obj.data );\n\t\t\t\t// remember new elements\n\t\t\t\tif ( $.inArray( this, elems ) < 0 )\n\t\t\t\t\telems.push( this );\t\n\t\t\t});\t\n\t\t});\n\t});\n\t// may not exist when artifically triggering dropinit event\n\tif ( dd )\n\t\t// clean-up after the interaction ends\n\t\t$event.add( dd.drag, \"dragend.\"+drop.livekey, function(){\n\t\t\t$.each( elems.concat( this ), function(){\n\t\t\t\t$event.remove( this, '.'+ drop.livekey );\t\t\t\t\t\t\t\n\t\t\t});\n\t\t});\n\t//drop.delegates.push( elems );\n\treturn elems.length ? $( elems ) : false;\n};\n\n})( jQuery ); // confine scope\t","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction guid() {\r\n    function s4() {\r\n        return Math.floor((1 + Math.random()) * 0x10000)\r\n            .toString(16)\r\n            .substring(1);\r\n    }\r\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\r\n        s4() + '-' + s4() + s4() + s4();\r\n}\r\nexports.guid = guid;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/** 连接多个路径 */\r\nfunction pathContact(...paths) {\r\n    paths = paths || [];\r\n    if (paths.length == 0)\r\n        return \"\";\r\n    if (paths.length == 1) {\r\n        return paths[0];\r\n    }\r\n    let str = paths.join(\"\");\r\n    // 将一个或多个的 / 变为一个 /，例如：/shop/test// 转换为 /shop/test/\r\n    str = str.replace(/\\/+/g, '/');\r\n    return str;\r\n}\r\nexports.pathContact = pathContact;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass Errors {\r\n    argumentNull(argumentName) {\r\n        let error = new Error(`Argument ${argumentName} cannt be null or emtpy.`);\r\n        let name = \"argumentNull\";\r\n        error.name = name;\r\n        return error;\r\n    }\r\n    routeDataFieldNull(fieldName) {\r\n        let msg = `The ${fieldName} field of route data cannt be null.`;\r\n        let error = new Error(msg);\r\n        let name = \"routeDataFieldNull\";\r\n        error.name = name;\r\n        return error;\r\n    }\r\n    argumentFieldNull(fieldName, argumentName) {\r\n        let msg = `The ${fieldName} field of ${argumentName} cannt be null.`;\r\n        let error = new Error(msg);\r\n        let name = \"argumentFieldNull\";\r\n        error.name = name;\r\n        return error;\r\n    }\r\n    argumentTypeIncorrect(argumentName, expectedType) {\r\n        let msg = `Argument ${argumentName} type error, expected type is ${expectedType}.`;\r\n        let error = new Error(msg);\r\n        let name = \"argumentTypeIncorrect\";\r\n        error.name = name;\r\n        return error;\r\n    }\r\n    queryResultTypeError() {\r\n        let msg = 'Type of the query result is expected as Array or DataSourceSelectResult.';\r\n        return new Error(msg);\r\n    }\r\n}\r\nexports.Errors = Errors;\r\nexports.errors = new Errors();\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Errors_1 = require(\"./Errors\");\r\nconst callback_1 = require(\"./callback\");\r\nlet errors = Object.assign(Errors_1.errors, {\r\n    dataSourceCanntInsert() {\r\n        return new Error(\"DataSource can not insert.\");\r\n    },\r\n    dataSourceCanntDelete() {\r\n        return new Error(\"DataSource can not delete.\");\r\n    },\r\n    dataSourceCanntUpdate() {\r\n        return new Error(\"DataSource can not update.\");\r\n    },\r\n    primaryKeyNull(key) {\r\n        let msg = `Primary key named '${key}' value is null.`;\r\n        return new Error(msg);\r\n    }\r\n});\r\nclass DataSource {\r\n    constructor(args) {\r\n        this.inserting = new callback_1.Callback(); //callbacks1<DataSource<T>, T, number>();\r\n        this.inserted = new callback_1.Callback();\r\n        this.deleting = new callback_1.Callback(); //callbacks<DataSource<T>, T>();\r\n        this.deleted = new callback_1.Callback(); //callbacks<DataSource<T>, T>();\r\n        this.updating = new callback_1.Callback();\r\n        this.updated = new callback_1.Callback();\r\n        this.selecting = new callback_1.Callback();\r\n        this.selected = new callback_1.Callback(); //callbacks<DataSource<T>, DataSourceSelectResult<T>>();\r\n        this.error = new callback_1.Callback(); //callbacks<this, DataSourceError>();\r\n        this.args = args;\r\n        this.primaryKeys = args.primaryKeys || [];\r\n    }\r\n    ; //callbacks<DataSource<T>, DataSourceSelectArguments>();\r\n    get canDelete() {\r\n        return this.args.delete != null && this.primaryKeys.length > 0;\r\n    }\r\n    get canInsert() {\r\n        return this.args.insert != null && this.primaryKeys.length > 0;\r\n    }\r\n    get canUpdate() {\r\n        return this.args.update != null && this.primaryKeys.length > 0;\r\n    }\r\n    executeInsert(item, args) {\r\n        return this.args.insert(item, args);\r\n    }\r\n    executeDelete(item, args) {\r\n        return this.args.delete(item, args);\r\n    }\r\n    executeUpdate(item, args) {\r\n        return this.args.update(item, args);\r\n    }\r\n    executeSelect(args) {\r\n        args = args || {};\r\n        return this.args.select(args);\r\n    }\r\n    insert(item, args, index) {\r\n        if (!this.canInsert)\r\n            throw errors.dataSourceCanntInsert();\r\n        if (!item)\r\n            throw errors.argumentNull(\"item\");\r\n        if (typeof args == 'number') {\r\n            index = args;\r\n            args = null;\r\n        }\r\n        this.inserting.fire({ sender: this, dataItem: item, index });\r\n        return this.executeInsert(item, args).then((data) => {\r\n            Object.assign(item, data);\r\n            this.inserted.fire({ sender: this, dataItem: item, index });\r\n            return data;\r\n        }).catch(exc => {\r\n            this.processError(exc, 'insert');\r\n            throw exc;\r\n        });\r\n    }\r\n    delete(item, args) {\r\n        if (!this.canDelete)\r\n            throw errors.dataSourceCanntDelete();\r\n        if (!item)\r\n            throw errors.argumentNull(\"item\");\r\n        this.checkPrimaryKeys(item);\r\n        this.deleting.fire({ sender: this, dataItem: item });\r\n        return this.executeDelete(item, args).then((data) => {\r\n            this.deleted.fire({ sender: this, dataItem: item });\r\n            return data;\r\n        }).catch(exc => {\r\n            this.processError(exc, 'delete');\r\n            throw exc;\r\n        });\r\n    }\r\n    update(item, args) {\r\n        if (!this.canUpdate)\r\n            throw errors.dataSourceCanntUpdate();\r\n        if (!item)\r\n            throw errors.argumentNull(\"item\");\r\n        this.checkPrimaryKeys(item);\r\n        this.updating.fire({ sender: this, dataItem: item });\r\n        return this.executeUpdate(item, args).then((data) => {\r\n            Object.assign(item, data);\r\n            this.updated.fire({ sender: this, dataItem: item });\r\n            return data;\r\n        }).catch((exc) => {\r\n            this.processError(exc, 'update');\r\n            throw exc;\r\n        });\r\n    }\r\n    isSameItem(theItem, otherItem) {\r\n        if (theItem == null)\r\n            throw errors.argumentNull('theItem');\r\n        if (otherItem == null)\r\n            throw errors.argumentNull('otherItem');\r\n        if (this.primaryKeys.length == 0)\r\n            return theItem == otherItem;\r\n        this.checkPrimaryKeys(theItem);\r\n        this.checkPrimaryKeys(otherItem);\r\n        for (let pk of this.primaryKeys) {\r\n            if (theItem[pk] != otherItem[pk])\r\n                return false;\r\n        }\r\n        return true;\r\n    }\r\n    checkPrimaryKeys(item) {\r\n        for (let key in item) {\r\n            if (item[key] == null && this.primaryKeys.indexOf(key) >= 0)\r\n                throw errors.primaryKeyNull(key);\r\n        }\r\n    }\r\n    select(args) {\r\n        args = args || {};\r\n        // fireCallback(this.selecting, this, args);\r\n        this.selecting.fire({ sender: this, selectArguments: args });\r\n        return this.executeSelect(args).then((data) => {\r\n            let dataItems;\r\n            let totalRowCount;\r\n            if (Array.isArray(data)) {\r\n                dataItems = data;\r\n                totalRowCount = data.length;\r\n            }\r\n            else if (data.dataItems !== undefined && data.totalRowCount !== undefined) {\r\n                dataItems = data.dataItems;\r\n                totalRowCount = data.totalRowCount;\r\n            }\r\n            else {\r\n                throw errors.queryResultTypeError();\r\n            }\r\n            this.selected.fire({ sender: this, selectResult: { totalRowCount, dataItems } });\r\n            return { totalRowCount, dataItems };\r\n        }).catch(exc => {\r\n            this.processError(exc, 'select');\r\n            throw exc;\r\n        });\r\n    }\r\n    processError(exc, method) {\r\n        exc.method = method;\r\n        this.error.fire({ sender: this, error: exc });\r\n        if (!exc.handled)\r\n            throw exc;\r\n    }\r\n}\r\nexports.DataSource = DataSource;\r\nclass DataSourceSelectArguments {\r\n    constructor() {\r\n        this.startRowIndex = 0;\r\n        this.maximumRows = 2147483647;\r\n    }\r\n}\r\nexports.DataSourceSelectArguments = DataSourceSelectArguments;\r\nclass ArrayDataSource extends DataSource {\r\n    constructor(items) {\r\n        super({\r\n            select(args) {\r\n                return __awaiter(this, void 0, void 0, function* () {\r\n                    if (args.sortExpression) {\r\n                    }\r\n                    let dataItems = items.slice(args.startRowIndex, args.startRowIndex + args.maximumRows);\r\n                    let result = { dataItems, totalRowCount: items.length };\r\n                    return result;\r\n                });\r\n            }\r\n        });\r\n    }\r\n}\r\nexports.ArrayDataSource = ArrayDataSource;\r\n// }\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass Errors {\r\n    argumentNull(argumentName) {\r\n        let error = new Error(`Argument ${argumentName} cannt be null or emtpy.`);\r\n        let name = \"argumentNull\";\r\n        error.name = name;\r\n        return error;\r\n    }\r\n    routeDataFieldNull(fieldName) {\r\n        let msg = `The ${fieldName} field of route data cannt be null.`;\r\n        let error = new Error(msg);\r\n        let name = \"routeDataFieldNull\";\r\n        error.name = name;\r\n        return error;\r\n    }\r\n    argumentFieldNull(fieldName, argumentName) {\r\n        let msg = `The ${fieldName} field of ${argumentName} cannt be null.`;\r\n        let error = new Error(msg);\r\n        let name = \"argumentFieldNull\";\r\n        error.name = name;\r\n        return error;\r\n    }\r\n    argumentTypeIncorrect(argumentName, expectedType) {\r\n        let msg = `Argument ${argumentName} type error, expected type is ${expectedType}.`;\r\n        let error = new Error(msg);\r\n        let name = \"argumentTypeIncorrect\";\r\n        error.name = name;\r\n        return error;\r\n    }\r\n    queryResultTypeError() {\r\n        let msg = 'Type of the query result is expected as Array or DataSourceSelectResult.';\r\n        return new Error(msg);\r\n    }\r\n}\r\nexports.Errors = Errors;\r\nexports.errors = new Errors();\r\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}