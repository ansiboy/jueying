{"version":3,"sources":["webpack://jueying/webpack/universalModuleDefinition","webpack://jueying/webpack/bootstrap","webpack://jueying/external \"react\"","webpack://jueying/./out/errors.js","webpack://jueying/./out/common.js","webpack://jueying/./out/component.js","webpack://jueying/./out/property-editor.js","webpack://jueying/./out/page-designer.js","webpack://jueying/external \"maishu-toolkit\"","webpack://jueying/./out/style.js","webpack://jueying/./out/index.js","webpack://jueying/external \"maishu-dilu\"","webpack://jueying/external \"maishu-jueying-core\"","webpack://jueying/./out/editor-panel.js","webpack://jueying/./out/prop-editor.js","webpack://jueying/./out/component-data-handler.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__6__","__WEBPACK_EXTERNAL_MODULE__9__","__WEBPACK_EXTERNAL_MODULE__10__","enumerable","get","getter","value","key","bind","Object","prototype","hasOwnProperty","call","object","property","defineProperty","Errors","Error","fileName","argumentName","pluginId","componentId","componentName","fieldName","Callback","guid","groupDisplayNames","proptDisplayNames","constants","componentsDir","connectorElementClassName","componentTypeName","componentData","componentPosition","s4","Math","floor","random","toString","substring","this","funcs","Array","func","push","filter","o","args","forEach","Component","property_editor_1","maishu_jueying_core_1","componentType","type","result","propEditorInfo","componentPropEditors","i","length","propName","display","componentPropEditorDisplay","controlClassName","getPropEditorByArray","propNames","options","editorType","editorDisplay","group","displayName","defaultValue","validation","defaultGroupName","split","className","typename","name","classProps","join","typeName","registerComponent","Fragment","ErrorBoundary","PropertyEditor","React","component_1","errors_1","page_designer_1","common_1","maishu_dilu_1","props","super","state","designer","commonPropEditorInfos","selectedComponents","propEditorInfos","getPropEditors","items","propInfo1","propInfo2","propName1","propName2","commonFlatProps","control","controlProps","assign","children","obj","editors","propValue","editorProps","editComponents","updateComponentProp","componentProps","map","id","_validator","_validateFields","FormValidator","element","checkElement","updateComponentProps","editor","createElement","prop","argumentNull","navPropsNames","DesignerContext","Consumer","getEditors","empty","customRender","r","ref","e","_element","groupEditorsArray","groupEditors","g","contextType","error","info","setState","message","stack","PageDesigner","maishu_toolkit_1","createContext","components","pageData","initPageData","componentIds","travelComponentData","item","console","assert","itemRef","fillComponent","setComponetRefProp","component","namedComponents","num","child","ids","getOwnPropertyNames","arr","pop","selected","componentDatas","findComponentData","parentId","componentIndex","parentControl","splice","selectComponents","focus","selectedComponentIds","isSame","isSelectedControl","indexOf","arr1","arr2","removeComponents","controlId","removeComponentFrom","childComponentIndex","appendComponent","collection","controlIndex","shift","pageDataIsNull","keyCode","tabIndex","onKeyDown","style","Provider","removeClassName","appendClassName","classNames","componentSelected","emptyTemplates","loadingTemplates","templateSelected","templateDialog","emptyDocument","componentWrapper","componentPanel","componentIcon","placeholder","editorPanel","moveDown","document","setAttribute","innerHTML","head","appendChild","addonClassName","sourceClassName","targetClassName","replace","RegExp","trim","ComponentDataHandler","TextInput","PropEditor","EditorPanel","editor_panel_1","prop_editor_1","style_1","component_data_handler_1","validator","checkAsync","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","done","then","apply","valueType","itemsPromise","textValues","isArray","text","onChange","textValue","target","floatRegex","test","parseInt","parseFloat","dropdown","_components","create","componentRemoved","componentAppend","componentUpdated","pageDataChanged","_pageData","initComponentData","fire","itemProps","names"],"mappings":"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","file":"index.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"), require(\"maishu-toolkit\"), require(\"maishu-dilu\"), require(\"maishu-jueying-core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\", \"maishu-toolkit\", \"maishu-dilu\", \"maishu-jueying-core\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"jueying\"] = factory(require(\"react\"), require(\"maishu-toolkit\"), require(\"maishu-dilu\"), require(\"maishu-jueying-core\"));\n\telse\n\t\troot[\"jueying\"] = factory(root[\"react\"], root[\"maishu-toolkit\"], root[\"maishu-dilu\"], root[\"maishu-jueying-core\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__6__, __WEBPACK_EXTERNAL_MODULE__9__, __WEBPACK_EXTERNAL_MODULE__10__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Errors = void 0;\r\nclass Errors {\r\n    static placeHolderIdNull() {\r\n        let msg = `Place holder property id cannt be null or empty.`;\r\n        return new Error(msg);\r\n    }\r\n    static fileNotExists(fileName) {\r\n        return new Error(`File '${fileName}' is not exists.`);\r\n    }\r\n    static argumentNull(argumentName) {\r\n        return new Error(`Argument ${argumentName} is null or empty.`);\r\n    }\r\n    static argumentRangeError(argumentName) {\r\n        return new Error(`Argument ${argumentName} range error.`);\r\n    }\r\n    static pageDataIsNull() {\r\n        return new Error(`Page data is null.`);\r\n    }\r\n    static toolbarRequiredKey() {\r\n        return new Error(`Toolbar has not a key prop.`);\r\n    }\r\n    static loadPluginFail(pluginId) {\r\n        return new Error(`Load plugin '${pluginId}' fail.`);\r\n    }\r\n    static idRequired() {\r\n        return new Error(`Property id is required.`);\r\n    }\r\n    static canntFindMasterPage(componentId) {\r\n        return new Error(`Can not find master page for component container ${componentId}.`);\r\n    }\r\n    static propCanntNull(componentName, property) {\r\n        let msg = `${componentName} property ${property} cannt be null or empty.`;\r\n        return new Error(msg);\r\n    }\r\n    static argumentFieldCanntNull(fieldName, argumentName) {\r\n        let msg = `${fieldName} of argument ${argumentName} cannt be null or empty.`;\r\n        return new Error(msg);\r\n    }\r\n}\r\nexports.Errors = Errors;\r\n//# sourceMappingURL=errors.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Callback = exports.guid = exports.groupDisplayNames = exports.proptDisplayNames = exports.constants = void 0;\r\nexports.constants = {\r\n    componentsDir: 'components',\r\n    connectorElementClassName: 'component-container',\r\n    componentTypeName: 'data-component-name',\r\n    componentData: 'component-data',\r\n    componentPosition: \"component-position\"\r\n};\r\nexports.proptDisplayNames = {};\r\nexports.groupDisplayNames = {};\r\nfunction guid() {\r\n    function s4() {\r\n        return Math.floor((1 + Math.random()) * 0x10000)\r\n            .toString(16)\r\n            .substring(1);\r\n    }\r\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\r\n        s4() + '-' + s4() + s4() + s4();\r\n}\r\nexports.guid = guid;\r\nclass Callback {\r\n    constructor() {\r\n        this.funcs = new Array();\r\n    }\r\n    add(func) {\r\n        this.funcs.push(func);\r\n    }\r\n    remove(func) {\r\n        this.funcs = this.funcs.filter(o => o != func);\r\n    }\r\n    fire(args) {\r\n        this.funcs.forEach(o => o(args));\r\n    }\r\n    static create() {\r\n        return new Callback();\r\n    }\r\n}\r\nexports.Callback = Callback;\r\n//# sourceMappingURL=common.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Component = void 0;\r\nconst property_editor_1 = require(\"./property-editor\");\r\nconst maishu_jueying_core_1 = require(\"maishu-jueying-core\");\r\n// type CreateElementContext = { components: React.Component[], componentTypes: string[] };\r\n// let defaultGroup: GroupedEditor[\"group\"] = { prop: \"\", displayName: \"\" };\r\nclass Component {\r\n    static getPropEditors(componentData) {\r\n        let componentType = componentData.type;\r\n        let result = [];\r\n        let propEditorInfo = this.componentPropEditors[componentType] || [];\r\n        for (let i = 0; i < propEditorInfo.length; i++) {\r\n            let propName = propEditorInfo[i].propName;\r\n            let display = Component.componentPropEditorDisplay[`${componentType}.${propName}`];\r\n            if (display != null && display(componentData) == false)\r\n                continue;\r\n            result.push(propEditorInfo[i]);\r\n        }\r\n        return result;\r\n    }\r\n    static getPropEditor(controlClassName, propName) {\r\n        return this.getPropEditorByArray(controlClassName, propName);\r\n    }\r\n    /** 通过属性数组获取属性的编辑器 */\r\n    static getPropEditorByArray(controlClassName, propNames) {\r\n        let classEditors = this.componentPropEditors[controlClassName] || [];\r\n        let editor = classEditors.filter(o => o.propName == propNames)[0];\r\n        return editor;\r\n    }\r\n    static setPropEditor(options) {\r\n        let { componentType, editorType, display: editorDisplay, group, propName, displayName, defaultValue, validation, } = options;\r\n        group = group || property_editor_1.defaultGroupName;\r\n        propName = propName || \"\";\r\n        displayName = displayName || propName;\r\n        // 属性可能为导航属性,例如 style.width\r\n        let propNames = propName.split('.');\r\n        let className = typeof componentType == 'string' ? componentType : componentType.prototype.typename || componentType.name;\r\n        Component.componentPropEditorDisplay[`${className}.${propName}`] = editorDisplay;\r\n        let classProps = Component.componentPropEditors[className] = Component.componentPropEditors[className] || [];\r\n        for (let i = 0; i < classProps.length; i++) {\r\n            let propName1 = classProps[i].propName;\r\n            let propName2 = propNames.join('.');\r\n            if (propName1 == propName2) {\r\n                classProps[i].editorType = editorType;\r\n                return;\r\n            }\r\n        }\r\n        classProps.push({\r\n            propName, displayName,\r\n            editorType: editorType,\r\n            group, defaultValue, validation\r\n        });\r\n    }\r\n    static register(typeName, componentType) {\r\n        return maishu_jueying_core_1.registerComponent(typeName, componentType);\r\n    }\r\n}\r\nexports.Component = Component;\r\n//==========================================\r\n// 用于创建 React 的 React.Fragment \r\nComponent.Fragment = \"\";\r\n//==========================================\r\nComponent.componentPropEditors = {};\r\nComponent.componentPropEditorDisplay = {};\r\n//# sourceMappingURL=component.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ErrorBoundary = exports.PropertyEditor = exports.defaultGroupName = void 0;\r\nconst React = require(\"react\");\r\nconst component_1 = require(\"./component\");\r\nconst errors_1 = require(\"./errors\");\r\nconst page_designer_1 = require(\"./page-designer\");\r\nconst common_1 = require(\"./common\");\r\nconst maishu_dilu_1 = require(\"maishu-dilu\");\r\nexports.defaultGroupName = \"\";\r\nclass PropertyEditor extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {};\r\n    }\r\n    getEditors(designer) {\r\n        if (designer == null) {\r\n            return [];\r\n        }\r\n        // 各个控件相同的编辑器\r\n        let commonPropEditorInfos = [];\r\n        let selectedComponents = designer.selectedComponents;\r\n        for (let i = 0; i < selectedComponents.length; i++) {\r\n            let componentData = selectedComponents[i];\r\n            let propEditorInfos = component_1.Component.getPropEditors(componentData);\r\n            if (i == 0) {\r\n                commonPropEditorInfos = propEditorInfos || [];\r\n            }\r\n            else {\r\n                let items = [];\r\n                commonPropEditorInfos.forEach(propInfo1 => {\r\n                    propEditorInfos.forEach(propInfo2 => {\r\n                        let propName1 = propInfo1.propName; //propInfo1.propNames.join('.')\r\n                        let propName2 = propInfo2.propName; //propInfo2.propNames.join('.')\r\n                        if (propInfo1.editorType == propInfo2.editorType && propName1 == propName2) {\r\n                            items.push(propInfo1);\r\n                        }\r\n                    });\r\n                });\r\n                commonPropEditorInfos = items;\r\n            }\r\n        }\r\n        // 各个控件相同的属性值\r\n        let commonFlatProps = {};\r\n        for (let i = 0; i < selectedComponents.length; i++) {\r\n            let control = selectedComponents[i];\r\n            let controlProps = Object.assign({}, control.props);\r\n            delete controlProps.children;\r\n            if (i == 0) {\r\n                commonFlatProps = controlProps;\r\n            }\r\n            else {\r\n                let obj = {};\r\n                for (let key in commonFlatProps) {\r\n                    if (commonFlatProps[key] == controlProps[key])\r\n                        obj[key] = controlProps[key];\r\n                }\r\n                commonFlatProps = obj;\r\n            }\r\n        }\r\n        let editors = [];\r\n        for (let i = 0; i < commonPropEditorInfos.length; i++) {\r\n            let propEditorInfo = commonPropEditorInfos[i];\r\n            let propName = propEditorInfo.propName;\r\n            ;\r\n            let editorType = propEditorInfo.editorType;\r\n            let value = this.propValue(propName, commonFlatProps);\r\n            if (value == null)\r\n                value = propEditorInfo.defaultValue;\r\n            let editorProps = {\r\n                value: value,\r\n                editComponents: selectedComponents,\r\n                updateComponentProp: (value) => {\r\n                    let componentProps = selectedComponents.map(o => ({\r\n                        componentId: o.id, propName: propEditorInfo.propName, value\r\n                    }));\r\n                    if (this._validator == null) {\r\n                        this._validateFields = commonPropEditorInfos.filter(o => o.validation != null)\r\n                            .map(o => Object.assign(o.validation, { name: o.propName }));\r\n                        this._validator = new maishu_dilu_1.FormValidator(this.element, ...this._validateFields);\r\n                    }\r\n                    if (this._validateFields.filter(o => o.name == propEditorInfo.propName).length > 0)\r\n                        this._validator.checkElement(propEditorInfo.propName);\r\n                    designer.updateComponentProps(componentProps);\r\n                }\r\n            };\r\n            let editor = React.createElement(editorType, editorProps);\r\n            editors.push({ prop: propEditorInfo.propName, displayName: propEditorInfo.displayName, editor, group: propEditorInfo.group });\r\n        }\r\n        return editors;\r\n    }\r\n    propValue(propName, props) {\r\n        if (!propName)\r\n            throw errors_1.Errors.argumentNull(\"propName\");\r\n        if (!props)\r\n            throw errors_1.Errors.argumentNull(\"props\");\r\n        let navPropsNames = propName.split(\".\");\r\n        let obj = props;\r\n        for (let i = 0; i < navPropsNames.length; i++) {\r\n            obj = obj[navPropsNames[i]];\r\n            if (obj == null)\r\n                return null;\r\n        }\r\n        return obj;\r\n    }\r\n    render() {\r\n        return React.createElement(page_designer_1.DesignerContext.Consumer, null, args => {\r\n            let designer = args.designer;\r\n            if (designer == null)\r\n                return null;\r\n            let editors = this.getEditors(designer);\r\n            if (editors.length == 0) {\r\n                let empty = this.props.empty;\r\n                return React.createElement(\"div\", { className: \"text-center\" }, empty);\r\n            }\r\n            if (this.props.customRender) {\r\n                let items = editors.map(o => Object.assign({ displayName: o.displayName }, o));\r\n                let r = this.props.customRender(designer.selectedComponents, items);\r\n                if (r != null) {\r\n                    return React.createElement(\"div\", { ref: e => this._element = e || this._element }, r);\r\n                }\r\n            }\r\n            let groupEditorsArray = [];\r\n            for (let i = 0; i < editors.length; i++) {\r\n                let group = editors[i].group || exports.defaultGroupName;\r\n                let groupEditors = groupEditorsArray.filter(o => o.group == group)[0];\r\n                if (groupEditors == null) {\r\n                    groupEditors = { group: editors[i].group, editors: [] };\r\n                    groupEditorsArray.push(groupEditors);\r\n                }\r\n                groupEditors.editors.push({ prop: editors[i].prop, displayName: editors[i].displayName, editor: editors[i].editor });\r\n            }\r\n            return groupEditorsArray.map((g) => React.createElement(\"div\", { key: g.group, className: \"panel panel-default\", ref: e => this._element = e || this._element },\r\n                g.group ? React.createElement(\"div\", { className: \"panel-heading\" }, common_1.groupDisplayNames[g.group] || g.group) : null,\r\n                React.createElement(\"div\", { className: \"panel-body\" }, g.editors.map((o, i) => React.createElement(\"div\", { key: o.prop, className: \"form-group clearfix\" },\r\n                    React.createElement(\"label\", null, o.displayName),\r\n                    React.createElement(\"div\", { className: \"control\" },\r\n                        React.createElement(ErrorBoundary, null, o.editor)))))));\r\n        });\r\n    }\r\n    get element() {\r\n        return this._element;\r\n    }\r\n    get validator() {\r\n        return this._validator;\r\n    }\r\n}\r\nexports.PropertyEditor = PropertyEditor;\r\nPropertyEditor.contextType = page_designer_1.DesignerContext;\r\nclass ErrorBoundary extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {};\r\n    }\r\n    componentDidCatch(error, info) {\r\n        // Display fallback UI\r\n        this.setState({ error });\r\n        // You can also log the error to an error reporting service\r\n        //   logErrorToMyService(error, info);\r\n    }\r\n    render() {\r\n        let { error } = this.state || {};\r\n        if (error) {\r\n            return React.createElement(\"div\", { className: \"error\" },\r\n                React.createElement(\"div\", null, error.message),\r\n                React.createElement(\"div\", null, error.stack));\r\n        }\r\n        return this.props.children;\r\n    }\r\n}\r\nexports.ErrorBoundary = ErrorBoundary;\r\n//# sourceMappingURL=property-editor.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PageDesigner = exports.DesignerContext = void 0;\r\nconst React = require(\"react\");\r\nconst errors_1 = require(\"./errors\");\r\nconst maishu_toolkit_1 = require(\"maishu-toolkit\");\r\nexports.DesignerContext = React.createContext({ designer: null });\r\nclass PageDesigner extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.components = {};\r\n        let pageData = this.props.pageData;\r\n        this.initPageData(pageData);\r\n        this.state = { pageData };\r\n    }\r\n    setComponetRefProp(pageData) {\r\n        //=========================================================\r\n        // 记录当前 pageData 控件 ID\r\n        let componentIds = {};\r\n        //=========================================================\r\n        PageDesigner.travelComponentData(pageData).forEach(item => {\r\n            console.assert(item.props != null && item.id != null);\r\n            componentIds[item.type] = componentIds[item.type] || [];\r\n            componentIds[item.type].push(item.id);\r\n            let itemRef = item.props.ref;\r\n            item.props.ref = (e) => {\r\n                if (e != null) {\r\n                    this.components[item.type] = this.components[item.type] || {};\r\n                    this.components[item.type][item.id] = e;\r\n                }\r\n                if (typeof itemRef == \"function\")\r\n                    itemRef(e);\r\n            };\r\n        });\r\n    }\r\n    initPageData(pageData) {\r\n        if (pageData == null) {\r\n            return;\r\n        }\r\n        pageData.children = pageData.children || [];\r\n        this.fillComponent(pageData);\r\n        this.setComponetRefProp(pageData);\r\n    }\r\n    /**\r\n     * 对组件及其子控件进行命名\r\n     * @param component\r\n     */\r\n    fillComponent(component) {\r\n        let namedComponents = {};\r\n        if (!component[\"name\"]) {\r\n            let num = 0;\r\n            let name;\r\n            do {\r\n                num = num + 1;\r\n                name = `${component.type}${num}`;\r\n            } while (namedComponents[name]);\r\n            namedComponents[name] = component;\r\n            component[\"name\"] = name;\r\n        }\r\n        if (!component.id)\r\n            component.id = maishu_toolkit_1.guid();\r\n        component.children = component.children || [];\r\n        if (!component.children || component.children.length == 0) {\r\n            return;\r\n        }\r\n        component.children.forEach(child => {\r\n            if (typeof child == \"string\")\r\n                return true;\r\n            this.fillComponent(child);\r\n        });\r\n    }\r\n    allComponents() {\r\n        let r = [];\r\n        for (let key in this.components) {\r\n            let ids = Object.getOwnPropertyNames(this.components[key]);\r\n            r.push(...ids.map(id => this.components[key][id]));\r\n        }\r\n        return r;\r\n    }\r\n    /** 页面数据 */\r\n    get pageData() {\r\n        return this.state.pageData;\r\n    }\r\n    /** 获取已选择了的组件编号 */\r\n    get selectedComponentIds() {\r\n        return this.selectedComponents.map(o => o.id);\r\n    }\r\n    /** 获取已选择了的组件 */\r\n    get selectedComponents() {\r\n        let arr = new Array();\r\n        let stack = new Array();\r\n        stack.push(this.pageData);\r\n        while (stack.length > 0) {\r\n            let item = stack.pop();\r\n            if (item.props != null && item.selected == true)\r\n                arr.push(item);\r\n            (item.children || []).forEach(child => {\r\n                if (typeof child == \"string\")\r\n                    return true;\r\n                stack.push(child);\r\n            });\r\n        }\r\n        return arr;\r\n    }\r\n    get element() {\r\n        return this._element;\r\n    }\r\n    updateComponentProp(componentId, propName, value) {\r\n        return this.updateComponentProps([{ componentId, propName, value }]);\r\n    }\r\n    updateComponentProps(componentProps) {\r\n        let componentDatas = [];\r\n        for (let i = 0; i < componentProps.length; i++) {\r\n            let { componentId, propName, value } = componentProps[i];\r\n            let componentData = this.findComponentData(componentId);\r\n            if (componentData == null)\r\n                continue;\r\n            let navPropsNames = propName.split(\".\");\r\n            console.assert(componentData != null);\r\n            console.assert(navPropsNames != null, 'props is null');\r\n            componentData.props = componentData.props || {};\r\n            let obj = componentData.props;\r\n            for (let i = 0; i < navPropsNames.length - 1; i++) {\r\n                obj = obj[navPropsNames[i]] = obj[navPropsNames[i]] || {};\r\n            }\r\n            obj[navPropsNames[navPropsNames.length - 1]] = value;\r\n            componentDatas.push(componentData);\r\n        }\r\n        this.setState({ pageData: this.pageData });\r\n    }\r\n    /**\r\n     * 添加控件\r\n     * @param parentId 父控件编号\r\n     * @param componentData 控件数据\r\n     * @param componentIndex 新添加组件在子组件中的次序\r\n     */\r\n    appendComponent(parentId, componentData, componentIndex) {\r\n        if (!parentId)\r\n            throw errors_1.Errors.argumentNull('parentId');\r\n        if (!componentData)\r\n            throw errors_1.Errors.argumentNull('childComponent');\r\n        this.initPageData(componentData);\r\n        let parentControl = this.findComponentData(parentId);\r\n        if (parentControl == null)\r\n            throw new Error('Parent is not exists');\r\n        console.assert(parentControl != null);\r\n        parentControl.children = parentControl.children || [];\r\n        if (componentIndex != null) {\r\n            parentControl.children.splice(componentIndex, 0, componentData);\r\n        }\r\n        else {\r\n            parentControl.children.push(componentData);\r\n        }\r\n        this.selectComponents(componentData.id);\r\n    }\r\n    /**\r\n     * 选择指定的控件\r\n     * @param control 指定的控件\r\n     */\r\n    selectComponent(componentIds) {\r\n        this.selectComponents(componentIds);\r\n        //====================================================\r\n        // 设置焦点，以便获取键盘事件\r\n        if (this._element)\r\n            this._element.focus();\r\n        //====================================================\r\n    }\r\n    /**\r\n     * 选择指定的控件，一个或多个。已经选择的控件取消选择。\r\n     * @param control 指定的控件\r\n     */\r\n    selectComponents(componentIds) {\r\n        if (typeof componentIds == 'string')\r\n            componentIds = [componentIds];\r\n        let selectedComponentIds = this.selectedComponentIds;\r\n        if (this.isSame(componentIds, selectedComponentIds))\r\n            return;\r\n        var stack = [];\r\n        stack.push(this.pageData);\r\n        while (stack.length > 0) {\r\n            let item = stack.pop();\r\n            let isSelectedControl = componentIds.indexOf(item.id) >= 0;\r\n            item.selected = isSelectedControl;\r\n            (item.children || []).forEach(child => {\r\n                if (typeof child == \"string\")\r\n                    return true;\r\n                stack.push(child);\r\n            });\r\n        }\r\n        this.setState({ pageData: this.pageData });\r\n    }\r\n    /** 判断两个字符串数组是否相等 */\r\n    isSame(arr1, arr2) {\r\n        if (arr1.length != arr2.length)\r\n            return false;\r\n        for (let i = 0; i < arr1.length; i++) {\r\n            if (arr2.indexOf(arr1[i]) < 0)\r\n                return false;\r\n        }\r\n        return true;\r\n    }\r\n    /** 移除控件 */\r\n    removeComponent(...componentIds) {\r\n        this.removeComponents(componentIds);\r\n    }\r\n    removeComponents(componentIds) {\r\n        let pageData = this.pageData;\r\n        if (!pageData || !pageData.children || pageData.children.length == 0)\r\n            return;\r\n        let children = pageData.children;\r\n        componentIds.forEach(controlId => {\r\n            this.removeComponentFrom(controlId, children);\r\n        });\r\n        this.setState({ pageData });\r\n    }\r\n    /**\r\n     * 移动控件到另外一个控件容器\r\n     * @param componentId 要移动的组件编号\r\n     * @param parentId 目标组件编号\r\n     * @param childComponentIndex 组件位置\r\n     */\r\n    moveComponent(componentId, parentId, childComponentIndex) {\r\n        let component = this.findComponentData(componentId);\r\n        if (component == null)\r\n            throw new Error(`Cannt find component by id ${componentId}`);\r\n        console.assert(component != null, `Cannt find component by id ${componentId}`);\r\n        let pageData = this.pageData;\r\n        console.assert(pageData.children != null);\r\n        let children = pageData.children;\r\n        this.removeComponentFrom(componentId, children);\r\n        this.appendComponent(parentId, component, childComponentIndex);\r\n    }\r\n    removeComponentFrom(controlId, collection) {\r\n        let controlIndex = null;\r\n        collection = collection || [];\r\n        for (let i = 0; i < collection.length; i++) {\r\n            let child = collection[i];\r\n            if (typeof child == \"string\")\r\n                continue;\r\n            if (controlId == child.id) {\r\n                controlIndex = i;\r\n                break;\r\n            }\r\n        }\r\n        if (controlIndex == null) {\r\n            for (let i = 0; i < collection.length; i++) {\r\n                let o = collection[i];\r\n                if (typeof o == \"string\")\r\n                    continue;\r\n                let children = o.children || [];\r\n                children.forEach(child => {\r\n                    if (typeof child == \"string\")\r\n                        return true;\r\n                    let isRemoved = this.removeComponentFrom(controlId, children);\r\n                    if (isRemoved) {\r\n                        return true;\r\n                    }\r\n                });\r\n            }\r\n            return false;\r\n        }\r\n        if (controlIndex == 0) {\r\n            collection.shift();\r\n        }\r\n        else if (controlIndex == collection.length - 1) {\r\n            collection.pop();\r\n        }\r\n        else {\r\n            collection.splice(controlIndex, 1);\r\n        }\r\n        return true;\r\n    }\r\n    static travelComponentData(pageData, filter) {\r\n        let stack = new Array();\r\n        stack.push(pageData);\r\n        let r = [];\r\n        filter = filter || (() => true);\r\n        while (stack.length > 0) {\r\n            let item = stack.shift();\r\n            if (filter(item)) {\r\n                r.push(item);\r\n            }\r\n            //===============================================\r\n            // 子元素有可能为字符串, 过滤出对象\r\n            let children = (item.children || []).filter(o => typeof o == 'object');\r\n            //===============================================\r\n            stack.push(...children);\r\n        }\r\n        return r;\r\n    }\r\n    /**\r\n     * 通过组件编号获取组件的数据\r\n     * @param componentId 组件编号\r\n     */\r\n    findComponentData(componentId) {\r\n        let pageData = this.state.pageData;\r\n        if (!pageData)\r\n            throw errors_1.Errors.pageDataIsNull();\r\n        let componentDatas = PageDesigner.travelComponentData(pageData, (item) => item.id == componentId);\r\n        return componentDatas[0];\r\n    }\r\n    onKeyDown(e) {\r\n        const DELETE_KEY_CODE = 46;\r\n        if (e.keyCode == DELETE_KEY_CODE) {\r\n            if (this.selectedComponents.length == 0)\r\n                return;\r\n            this.removeComponents(this.selectedComponentIds);\r\n        }\r\n    }\r\n    /**\r\n     * 通过组件名称获取组件实例\r\n     * @param typeName 组件名称\r\n     */\r\n    findComponetsByTypeName(typeName) {\r\n        this.components[typeName];\r\n    }\r\n    render() {\r\n        return React.createElement(\"div\", { tabIndex: 0, ref: e => this._element = this._element || e, onKeyDown: e => this.onKeyDown(e), className: this.props.className, style: this.props.style },\r\n            React.createElement(exports.DesignerContext.Provider, { value: { designer: this } }, this.props.children));\r\n    }\r\n}\r\nexports.PageDesigner = PageDesigner;\r\n//# sourceMappingURL=page-designer.js.map","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.removeClassName = exports.appendClassName = exports.classNames = void 0;\r\nconst errors_1 = require(\"./errors\");\r\nexports.classNames = {\r\n    componentSelected: `component-selected`,\r\n    emptyTemplates: `empty-templates`,\r\n    loadingTemplates: `loading-templates`,\r\n    templateSelected: `template-selected`,\r\n    templateDialog: `template-dialog`,\r\n    emptyDocument: `empty-document`,\r\n    component: 'component',\r\n    componentWrapper: 'component-wrapper',\r\n    componentPanel: 'component-panel',\r\n    componentIcon: 'component-icon',\r\n    placeholder: 'placeholder',\r\n    editorPanel: 'editor-panel',\r\n    designer: 'designer',\r\n    moveDown: 'move-down',\r\n};\r\nlet templateDialog = {\r\n    nameHeight: 40,\r\n    fontSize: 22\r\n};\r\nlet element = document.createElement('style');\r\nelement.type = 'text/css';\r\nelement.setAttribute(\"data-name\", \"jueying\");\r\nelement.innerHTML = `\r\n            .${exports.classNames.componentSelected} {\r\n                border: solid 1px #337ab7!important;\r\n            }\r\n            .${exports.classNames.componentSelected} > :first-child {\r\n                border-color: blue;\r\n              }\r\n              .${exports.classNames.componentSelected} .resize_handle {\r\n                position: absolute;\r\n                height: 6px;\r\n                width: 6px;\r\n                border: 1px solid #89B;\r\n                background: #9AC;\r\n              }\r\n              .${exports.classNames.componentSelected} .move_handle {\r\n                height: 12px;\r\n                width: 12px;\r\n                top: 6px;\r\n                left: 8px;\r\n                border: solid 1px black;\r\n                position: relative;\r\n                margin-top: -12px;\r\n              }\r\n              .${exports.classNames.componentSelected} .NW,\r\n              .${exports.classNames.componentSelected} .NN,\r\n              .${exports.classNames.componentSelected} .NE {\r\n                top: -4px;\r\n              }\r\n              .${exports.classNames.componentSelected} .NE,\r\n              .${exports.classNames.componentSelected} .EE,\r\n              .${exports.classNames.componentSelected} .SE {\r\n                right: -4px;\r\n              }\r\n              .${exports.classNames.componentSelected} .SW,\r\n              .${exports.classNames.componentSelected}.SS,\r\n              .${exports.classNames.componentSelected} .SE {\r\n                bottom: -4px;\r\n              }\r\n              .${exports.classNames.componentSelected} .NW,\r\n              .${exports.classNames.componentSelected} .WW,\r\n              .${exports.classNames.componentSelected} .SW {\r\n                left: -4px;\r\n              }\r\n              .${exports.classNames.componentSelected} .SE,\r\n              .${exports.classNames.componentSelected} .NW {\r\n                cursor: nw-resize;\r\n              }\r\n              .${exports.classNames.componentSelected} .SW,\r\n              .${exports.classNames.componentSelected} .NE {\r\n                cursor: ne-resize;\r\n              }\r\n              .${exports.classNames.componentSelected} .NN,\r\n              .${exports.classNames.componentSelected} .SS {\r\n                cursor: n-resize;\r\n                left: 50%;\r\n                margin-left: -4px;\r\n              }\r\n              .${exports.classNames.componentSelected} .EE,\r\n              .${exports.classNames.componentSelected} .WW {\r\n                cursor: e-resize;\r\n                top: 50%;\r\n                margin-top: -4px;\r\n              }\r\n            .${exports.classNames.emptyTemplates} {\r\n                padding:50px 0;\r\n                text-align: center;\r\n            }\r\n            .${exports.classNames.loadingTemplates} {\r\n                padding:50px 0;\r\n                text-align: center;\r\n            }\r\n            .${exports.classNames.templateSelected} .page-view {\r\n                border: solid 1px #337ab7!important;\r\n            }\r\n            .${exports.classNames.templateDialog} .name {\r\n                margin-top: -${templateDialog.nameHeight}px;\r\n                height: ${templateDialog.nameHeight}px;\r\n                font-size: ${templateDialog.fontSize}px;\r\n                text-align: center;\r\n                padding-top: 6px;\r\n                background-color: black;\r\n                opacity: 0.5;\r\n            }\r\n            .${exports.classNames.templateDialog} .name span {\r\n                color: white;\r\n            }\r\n            .${exports.classNames.emptyDocument} {\r\n                text-align: center;\r\n                padding: 100px 0;\r\n            }\r\n            .${exports.classNames.component} > .NW,\r\n            .${exports.classNames.component} > .NN,\r\n            .${exports.classNames.component} > .NE,\r\n            .${exports.classNames.component} > .EE,\r\n            .${exports.classNames.component} > .SE,\r\n            .${exports.classNames.component} > .SW,\r\n            .${exports.classNames.component} > .SS,\r\n            .${exports.classNames.component} > .WW {\r\n                display: none;\r\n            }\r\n            .${exports.classNames.componentSelected}.component > .NW,\r\n            .${exports.classNames.componentSelected}.component > .NN,\r\n            .${exports.classNames.componentSelected}.component > .NE,\r\n            .${exports.classNames.componentSelected}.component > .EE,\r\n            .${exports.classNames.componentSelected}.component > .SE,\r\n            .${exports.classNames.componentSelected}.component > .SW,\r\n            .${exports.classNames.componentSelected}.component > .SS,\r\n            .${exports.classNames.componentSelected}.component > .WW {\r\n                display: block;\r\n            }\r\n            .${exports.classNames.placeholder} {\r\n                min-height: 40px;\r\n                width: 100%;\r\n            }\r\n            .${exports.classNames.placeholder}.active,\r\n            .${exports.classNames.componentWrapper}.active,\r\n            .${exports.classNames.componentWrapper}.${exports.classNames.componentSelected}.active {\r\n                border: 1px solid green;\r\n            }\r\n            .${exports.classNames.editorPanel} {\r\n                width: 300px;\r\n                background: white;\r\n                color: black;\r\n                margin: 0;\r\n                font-size: 14px;\r\n                z-index: 100;\r\n                overflow: auto;\r\n            }\r\n            .${exports.classNames.editorPanel} label {\r\n                width: 80px;\r\n                float: left;\r\n                padding: 4px;\r\n                text-overflow: ellipsis;\r\n                overflow: hidden;\r\n            }\r\n            .${exports.classNames.editorPanel} .control {\r\n                padding-left: 90px;\r\n            }\r\n            .${exports.classNames.editorPanel} .empty {\r\n                padding-top: 200px;\r\n                text-align: center;\r\n            }\r\n            .${exports.classNames.designer} .error,\r\n            .${exports.classNames.editorPanel} .error {\r\n                color: red;\r\n            }\r\n            .${exports.classNames.componentPanel} {\r\n                background: white;\r\n                color: black;\r\n                font-size: 14px;\r\n                z-index: 100;\r\n                list-style: none;\r\n                padding: 0;\r\n                text-align: center\r\n            }\r\n            .${exports.classNames.componentPanel} .panel-heading {\r\n                text-align: center;\r\n            }\r\n            .${exports.classNames.componentPanel} li {\r\n                text-align: center;\r\n                padding: 8px;\r\n            }\r\n            .${exports.classNames.componentWrapper}.${exports.classNames.moveDown} {\r\n         \r\n            }\r\n        `;\r\nif (document.head != null) {\r\n    document.head.appendChild(element);\r\n}\r\nfunction appendClassName(element, addonClassName) {\r\n    if (element == null)\r\n        throw errors_1.Errors.argumentNull('element');\r\n    if (!addonClassName)\r\n        throw errors_1.Errors.argumentNull('addonClassName');\r\n    let sourceClassName;\r\n    if (typeof element == 'string')\r\n        sourceClassName = element;\r\n    else\r\n        sourceClassName = element.className;\r\n    sourceClassName = sourceClassName || '';\r\n    console.assert(addonClassName != null);\r\n    if (sourceClassName.indexOf(addonClassName) >= 0)\r\n        return sourceClassName;\r\n    let className = `${sourceClassName} ${addonClassName}`;\r\n    if (typeof element != 'string')\r\n        element.className = className;\r\n    return className;\r\n}\r\nexports.appendClassName = appendClassName;\r\nfunction removeClassName(element, targetClassName) {\r\n    let sourceClassName;\r\n    if (typeof element == 'string')\r\n        sourceClassName = element;\r\n    else\r\n        sourceClassName = element.className || '';\r\n    if (sourceClassName.indexOf(targetClassName) < 0)\r\n        return sourceClassName;\r\n    sourceClassName = sourceClassName || '';\r\n    sourceClassName = sourceClassName.replace(new RegExp(targetClassName, 'g'), '');\r\n    sourceClassName = sourceClassName.trim();\r\n    if (typeof element != 'string')\r\n        element.className = sourceClassName;\r\n    return sourceClassName;\r\n}\r\nexports.removeClassName = removeClassName;\r\n//# sourceMappingURL=style.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ComponentDataHandler = exports.classNames = exports.TextInput = exports.PropEditor = exports.DesignerContext = exports.PageDesigner = exports.EditorPanel = exports.Component = exports.groupDisplayNames = void 0;\r\nvar common_1 = require(\"./common\");\r\nObject.defineProperty(exports, \"groupDisplayNames\", { enumerable: true, get: function () { return common_1.groupDisplayNames; } });\r\nvar component_1 = require(\"./component\");\r\nObject.defineProperty(exports, \"Component\", { enumerable: true, get: function () { return component_1.Component; } });\r\nvar editor_panel_1 = require(\"./editor-panel\");\r\nObject.defineProperty(exports, \"EditorPanel\", { enumerable: true, get: function () { return editor_panel_1.EditorPanel; } });\r\nvar page_designer_1 = require(\"./page-designer\");\r\nObject.defineProperty(exports, \"PageDesigner\", { enumerable: true, get: function () { return page_designer_1.PageDesigner; } });\r\nObject.defineProperty(exports, \"DesignerContext\", { enumerable: true, get: function () { return page_designer_1.DesignerContext; } });\r\nvar prop_editor_1 = require(\"./prop-editor\");\r\nObject.defineProperty(exports, \"PropEditor\", { enumerable: true, get: function () { return prop_editor_1.PropEditor; } });\r\nObject.defineProperty(exports, \"TextInput\", { enumerable: true, get: function () { return prop_editor_1.TextInput; } });\r\nvar style_1 = require(\"./style\");\r\nObject.defineProperty(exports, \"classNames\", { enumerable: true, get: function () { return style_1.classNames; } });\r\nvar component_data_handler_1 = require(\"./component-data-handler\");\r\nObject.defineProperty(exports, \"ComponentDataHandler\", { enumerable: true, get: function () { return component_data_handler_1.ComponentDataHandler; } });\r\n//# sourceMappingURL=index.js.map","module.exports = __WEBPACK_EXTERNAL_MODULE__9__;","module.exports = __WEBPACK_EXTERNAL_MODULE__10__;","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.EditorPanel = void 0;\r\nconst React = require(\"react\");\r\nconst property_editor_1 = require(\"./property-editor\");\r\nconst style_1 = require(\"./style\");\r\nclass EditorPanel extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { componentDatas: [] };\r\n    }\r\n    /** 对输入进行验证 */\r\n    validateInputs() {\r\n        return this.editor.validator.checkAsync();\r\n    }\r\n    render() {\r\n        let { empty } = this.props;\r\n        empty = empty || React.createElement(\"div\", { className: \"empty\" }, \"\\u6682\\u65E0\\u53EF\\u7528\\u7684\\u5C5E\\u6027\");\r\n        return React.createElement(\"div\", { className: `${style_1.classNames.editorPanel} ${this.props.className || \"\"}`, ref: (e) => this.element = e || this.element },\r\n            React.createElement(property_editor_1.PropertyEditor, { ref: e => this.editor = e || this.editor, empty: empty, customRender: this.props.customRender }));\r\n    }\r\n}\r\nexports.EditorPanel = EditorPanel;\r\n//# sourceMappingURL=editor-panel.js.map","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.TextInput = exports.PropEditor = void 0;\r\nconst React = require(\"react\");\r\nclass PropEditor extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n    }\r\n    static dropdown(items, valueType) {\r\n        return dropdown(items, valueType);\r\n    }\r\n    static textInput() {\r\n        return TextInput;\r\n    }\r\n}\r\nexports.PropEditor = PropEditor;\r\nclass TextInput extends PropEditor {\r\n    render() {\r\n        let { value } = this.props;\r\n        return React.createElement(\"input\", { className: 'form-control', value: value || '', onChange: e => {\r\n                // this.setState({ value: e.target.value })\r\n                this.props.updateComponentProp(e.target.value);\r\n            } });\r\n    }\r\n}\r\nexports.TextInput = TextInput;\r\nfunction dropdown(items, valueType) {\r\n    let itemsPromise;\r\n    let textValues = [];\r\n    if (valueType == null && Array.isArray(items)) {\r\n        valueType = items.length > 0 && typeof items[0] == \"number\" ? \"number\" : \"string\";\r\n        for (let i = 0; i < items.length; i++) {\r\n            textValues[i] = { text: items[i], value: items[i] };\r\n        }\r\n    }\r\n    else if (valueType == null) {\r\n        valueType = \"string\";\r\n        let propNames = Object.getOwnPropertyNames(items);\r\n        for (let i = 0; i < propNames.length; i++) {\r\n            textValues[i] = { text: items[propNames[i]], value: propNames[i] };\r\n        }\r\n    }\r\n    else if (Array.isArray(items)) {\r\n        textValues = items;\r\n    }\r\n    else {\r\n        itemsPromise = items;\r\n    }\r\n    class Dropdown extends PropEditor {\r\n        constructor(props) {\r\n            super(props);\r\n            this.state = {};\r\n        }\r\n        componentDidMount() {\r\n            return __awaiter(this, void 0, void 0, function* () {\r\n                if (itemsPromise) {\r\n                    let items = yield itemsPromise;\r\n                    this.setState({ items });\r\n                }\r\n            });\r\n        }\r\n        render() {\r\n            let { items } = this.state;\r\n            let { value } = this.props;\r\n            items = items || textValues;\r\n            return React.createElement(\"select\", { className: 'form-control', value: value == null ? \"\" : value, onChange: e => {\r\n                    let textValue = e.target.value;\r\n                    if (valueType == \"number\") {\r\n                        let integerRegex = /^\\d+$/;\r\n                        let floatRegex = /^[+-]?\\d+(\\.\\d+)?$/;\r\n                        if (integerRegex.test(textValue))\r\n                            value = parseInt(textValue);\r\n                        else if (floatRegex.test(textValue))\r\n                            value = parseFloat(textValue);\r\n                        else\r\n                            value = null;\r\n                    }\r\n                    else {\r\n                        value = textValue;\r\n                    }\r\n                    this.props.updateComponentProp(value);\r\n                } }, items.map(o => React.createElement(\"option\", { key: o.value, value: o.value }, o.text)));\r\n        }\r\n    }\r\n    return Dropdown;\r\n}\r\n//# sourceMappingURL=prop-editor.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ComponentDataHandler = void 0;\r\nconst errors_1 = require(\"./errors\");\r\nconst maishu_toolkit_1 = require(\"maishu-toolkit\");\r\nclass ComponentDataHandler {\r\n    constructor(componentData) {\r\n        this._components = {};\r\n        this.componentSelected = maishu_toolkit_1.Callback.create();\r\n        this.componentRemoved = maishu_toolkit_1.Callback.create();\r\n        this.componentAppend = maishu_toolkit_1.Callback.create();\r\n        this.componentUpdated = maishu_toolkit_1.Callback.create();\r\n        this.pageDataChanged = maishu_toolkit_1.Callback.create();\r\n        this._pageData = componentData;\r\n        this.initComponentData(this._pageData);\r\n    }\r\n    /** 对 pageData 字段补全 */\r\n    initComponentData(componentData) {\r\n        if (componentData == null) {\r\n            return;\r\n        }\r\n        componentData.children = componentData.children || [];\r\n        ComponentDataHandler.fillComponent(componentData);\r\n        ComponentDataHandler.setComponetRefProp(componentData, this._components);\r\n    }\r\n    /** 获取已选择了的组件 */\r\n    get selectedComponents() {\r\n        let arr = new Array();\r\n        let stack = new Array();\r\n        stack.push(this._pageData);\r\n        while (stack.length > 0) {\r\n            let item = stack.pop();\r\n            if (item.props != null && item.selected == true)\r\n                arr.push(item);\r\n            (item.children || []).forEach(child => {\r\n                if (typeof child == \"string\")\r\n                    return true;\r\n                stack.push(child);\r\n            });\r\n        }\r\n        return arr;\r\n    }\r\n    /** 获取已选择了的组件编号 */\r\n    get selectedComponentIds() {\r\n        return this.selectedComponents.map(o => o.id);\r\n    }\r\n    /**  */\r\n    get components() {\r\n        return this._components;\r\n    }\r\n    get pageData() {\r\n        return this._pageData;\r\n    }\r\n    set pageData(value) {\r\n        this._pageData = value;\r\n        this.initComponentData(value);\r\n        this.pageDataChanged.fire(value);\r\n    }\r\n    /**\r\n     * 移动控件到另外一个控件容器\r\n     * @param componentId 要移动的组件编号\r\n     * @param parentId 目标组件编号\r\n     * @param beforeChildId 组件的前一个子组件编号\r\n     */\r\n    moveComponent(componentId, parentId, childComponentIndex) {\r\n        let component = this.findComponentData(componentId);\r\n        if (component == null)\r\n            throw new Error(`Cannt find component by id ${componentId}`);\r\n        console.assert(component != null, `Cannt find component by id ${componentId}`);\r\n        let pageData = this.pageData;\r\n        console.assert(pageData.children != null);\r\n        let children = pageData.children; //translateComponentDataChildren(pageData.children);\r\n        this.removeComponentFrom(componentId, children);\r\n        this.appendComponent(parentId, component, childComponentIndex);\r\n    }\r\n    updateComponentProps(componentProps) {\r\n        let componentDatas = [];\r\n        for (let i = 0; i < componentProps.length; i++) {\r\n            let { componentId, propName, value } = componentProps[i];\r\n            let componentData = this.findComponentData(componentId);\r\n            if (componentData == null)\r\n                continue;\r\n            let navPropsNames = propName.split(\".\");\r\n            console.assert(componentData != null);\r\n            console.assert(navPropsNames != null, 'props is null');\r\n            componentData.props = componentData.props || {};\r\n            let obj = componentData.props;\r\n            for (let i = 0; i < navPropsNames.length - 1; i++) {\r\n                obj = obj[navPropsNames[i]] = obj[navPropsNames[i]] || {};\r\n            }\r\n            obj[navPropsNames[navPropsNames.length - 1]] = value;\r\n            componentDatas.push(componentData);\r\n        }\r\n        this.componentUpdated.fire(componentDatas);\r\n    }\r\n    findComponentData(componentId) {\r\n        let pageData = this._pageData;\r\n        if (!pageData)\r\n            throw errors_1.Errors.pageDataIsNull();\r\n        // let stack = new Array<ComponentData>();\r\n        // stack.push(pageData);\r\n        // while (stack.length > 0) {\r\n        //     let item = stack.pop();\r\n        //     if (item == null)\r\n        //         continue\r\n        //     if (item.props.id == componentId)\r\n        //         return item;\r\n        //     let children = (item.children || []).filter(o => typeof o == 'object') as ComponentData[]\r\n        //     stack.push(...children);\r\n        // }\r\n        let componentDatas = ComponentDataHandler.travelComponentData(pageData, (item) => item.id == componentId);\r\n        return componentDatas[0];\r\n    }\r\n    removeComponentFrom(controlId, collection) {\r\n        let controlIndex = null;\r\n        collection = collection || [];\r\n        for (let i = 0; i < collection.length; i++) {\r\n            let child = collection[i];\r\n            if (typeof child == \"string\")\r\n                continue;\r\n            if (controlId == child.id) {\r\n                controlIndex = i;\r\n                break;\r\n            }\r\n        }\r\n        if (controlIndex == null) {\r\n            for (let i = 0; i < collection.length; i++) {\r\n                let o = collection[i];\r\n                if (typeof o == \"string\")\r\n                    continue;\r\n                let children = o.children;\r\n                if (children && children.length > 0) {\r\n                    let isRemoved = this.removeComponentFrom(controlId, children);\r\n                    if (isRemoved) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        if (controlIndex == 0) {\r\n            collection.shift();\r\n        }\r\n        else if (controlIndex == collection.length - 1) {\r\n            collection.pop();\r\n        }\r\n        else {\r\n            collection.splice(controlIndex, 1);\r\n        }\r\n        return true;\r\n    }\r\n    static travelComponentData(pageData, filter) {\r\n        let stack = new Array();\r\n        stack.push(pageData);\r\n        let r = [];\r\n        // return new Promise((resolve, reject) => {\r\n        filter = filter || (() => true);\r\n        while (stack.length > 0) {\r\n            let item = stack.shift();\r\n            if (filter(item)) {\r\n                r.push(item);\r\n            }\r\n            //===============================================\r\n            // 子元素有可能为字符串, 过滤出对象\r\n            let children = (item.children || []).filter(o => typeof o == 'object');\r\n            //===============================================\r\n            stack.push(...children);\r\n        }\r\n        return r;\r\n    }\r\n    /**\r\n     * 添加控件\r\n     * @param parentId 父控件编号\r\n     * @param componentData 控件数据\r\n     * @param componentIndex 新添加组件在子组件中的次序\r\n     */\r\n    appendComponent(parentId, componentData, componentIndex) {\r\n        if (!parentId)\r\n            throw errors_1.Errors.argumentNull('parentId');\r\n        if (!componentData)\r\n            throw errors_1.Errors.argumentNull('childComponent');\r\n        this.initComponentData(componentData);\r\n        let parentControl = this.findComponentData(parentId);\r\n        if (parentControl == null)\r\n            throw new Error('Parent is not exists');\r\n        console.assert(parentControl != null);\r\n        parentControl.children = parentControl.children || [];\r\n        if (componentIndex != null) {\r\n            parentControl.children.splice(componentIndex, 0, componentData);\r\n        }\r\n        else {\r\n            parentControl.children.push(componentData);\r\n        }\r\n        this.selectComponents(componentData.id);\r\n        this.componentAppend.fire(this);\r\n    }\r\n    /**\r\n     * 对组件及其子控件进行命名\r\n     * @param component\r\n     */\r\n    static fillComponent(component) {\r\n        let namedComponents = {};\r\n        // let props: any = component.props = component.props || {};\r\n        //==================================================\r\n        // 兼容旧版本代码\r\n        // if (props.id) {\r\n        //     component.id = props.id;\r\n        //     delete props.id;\r\n        // }\r\n        // if (props.parentId) {\r\n        //     component.parentId = props.parentId;\r\n        //     delete component.parentId;\r\n        // }\r\n        // if (props.selected) {\r\n        //     component.selected = props.selected;\r\n        // }\r\n        // if (props.name) {\r\n        //     component.name = props.name;\r\n        //     delete props.name;\r\n        // }\r\n        // if (props.attr) {\r\n        //     component.attr = props.attr;\r\n        //     delete props.attr;\r\n        // }\r\n        //==================================================\r\n        if (!component[\"name\"]) {\r\n            let num = 0;\r\n            let name;\r\n            do {\r\n                num = num + 1;\r\n                name = `${component.type}${num}`;\r\n            } while (namedComponents[name]);\r\n            namedComponents[name] = component;\r\n            component[\"name\"] = name;\r\n        }\r\n        if (!component.id)\r\n            component.id = maishu_toolkit_1.guid();\r\n        component.children = component.children || [];\r\n        if (!component.children || component.children.length == 0) {\r\n            return;\r\n        }\r\n        component.children.forEach(child => {\r\n            if (typeof child == \"string\")\r\n                return true;\r\n            ComponentDataHandler.fillComponent(child);\r\n        });\r\n    }\r\n    static setComponetRefProp(pageData, components) {\r\n        //=========================================================\r\n        // 纪录当前 pageData 控件 ID\r\n        let componentIds = {};\r\n        //=========================================================\r\n        ComponentDataHandler.travelComponentData(pageData).forEach(item => {\r\n            let itemProps = item.props || {};\r\n            console.assert(item.props != null && item.id != null);\r\n            componentIds[item.type] = componentIds[item.type] || [];\r\n            componentIds[item.type].push(item.id);\r\n            let itemRef = itemProps.ref;\r\n            itemProps.ref = (e) => {\r\n                if (e != null) {\r\n                    components[item.type] = components[item.type] || [];\r\n                    components[item.type].push(e);\r\n                }\r\n                if (typeof itemRef == \"function\")\r\n                    itemRef(e);\r\n            };\r\n        });\r\n        //=========================================================\r\n        // 仅保留 componentIds 中的控件 \r\n        let names = Object.getOwnPropertyNames(components);\r\n        for (let i = 0; i < names.length; i++) {\r\n            let typename = names[i];\r\n            let ids = componentIds[typename] || [];\r\n            components[typename] = (components[typename] || []).filter(o => ids.indexOf(o[\"id\"] || o.props[\"id\"]) >= 0);\r\n        }\r\n        //=========================================================\r\n    }\r\n    /**\r\n     * 选择指定的控件\r\n     * @param control 指定的控件\r\n     */\r\n    selectComponent(componentId) {\r\n        return this.selectComponents(componentId);\r\n    }\r\n    /**\r\n     * 选择指定的控件，一个或多个\r\n     * @param control 指定的控件\r\n     */\r\n    selectComponents(componentIds) {\r\n        if (typeof componentIds == 'string')\r\n            componentIds = [componentIds];\r\n        var stack = [];\r\n        stack.push(this._pageData);\r\n        while (stack.length > 0) {\r\n            let item = stack.pop();\r\n            if (item == null || typeof item == \"string\")\r\n                continue;\r\n            let isSelectedControl = componentIds.indexOf(item.id) >= 0;\r\n            item.selected = isSelectedControl;\r\n            (item.children || []).forEach(child => {\r\n                if (typeof child == \"string\")\r\n                    return true;\r\n                stack.push(child);\r\n            });\r\n        }\r\n        this.componentSelected.fire(this.selectedComponentIds);\r\n    }\r\n    removeComponent(componentId) {\r\n        return this.removeComponents([componentId]);\r\n    }\r\n    /** 移除控件 */\r\n    removeComponents(componentIds) {\r\n        let pageData = this.pageData;\r\n        if (!pageData || !pageData.children || pageData.children.length == 0)\r\n            return;\r\n        let children = pageData.children;\r\n        componentIds.forEach(controlId => {\r\n            this.removeComponentFrom(controlId, children);\r\n        });\r\n        this.componentRemoved.fire(componentIds);\r\n    }\r\n}\r\nexports.ComponentDataHandler = ComponentDataHandler;\r\n//# sourceMappingURL=component-data-handler.js.map"],"sourceRoot":""}