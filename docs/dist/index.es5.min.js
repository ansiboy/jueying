/*!
 * 
 *  maishu-jueying v4.0.3
 *  
 *  Copyright (C) maishu All rights reserved.
 *  
 *  组件设计器 
 *   
 *  作者: 麦舒
 *  日期: 2018/5/30
 *  
 *  个人博客：   http://www.cnblogs.com/ansiboy/
 *  GITHUB:     https://github.com/ansiboy/jueying
 *  QQ 讨论组：  119038574 
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("maishu-jueying-core"),require("maishu-dilu")):"function"==typeof define&&define.amd?define(["react","maishu-jueying-core","maishu-dilu"],t):"object"==typeof exports?exports.jueying=t(require("react"),require("maishu-jueying-core"),require("maishu-dilu")):e.jueying=t(e.react,e["maishu-jueying-core"],e["maishu-dilu"])}(window,(function(e,t,n){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=15)}([function(t,n){t.exports=e},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.errors=void 0;var s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(s,e);var n,r,u,l=c(s);function s(){return o(this,s),l.apply(this,arguments)}return n=s,(r=[{key:"placeHolderIdNull",value:function(){return new Error("Place holder property id cannt be null or empty.")}},{key:"fileNotExists",value:function(e){return new Error("File '".concat(e,"' is not exists."))}},{key:"argumentNull",value:function(e){return new Error("Argument ".concat(e," is null or empty."))}},{key:"argumentRangeError",value:function(e){return new Error("Argument ".concat(e," range error."))}},{key:"pageDataIsNull",value:function(){return new Error("Page data is null.")}},{key:"toolbarRequiredKey",value:function(){return new Error("Toolbar has not a key prop.")}},{key:"loadPluginFail",value:function(e){return new Error("Load plugin '".concat(e,"' fail."))}},{key:"idRequired",value:function(){return new Error("Property id is required.")}},{key:"canntFindMasterPage",value:function(e){return new Error("Can not find master page for component container ".concat(e,"."))}},{key:"propCanntNull",value:function(e,t){var n="".concat(e," property ").concat(t," cannt be null or empty.");return new Error(n)}},{key:"argumentFieldCanntNull",value:function(e,t){var n="".concat(e," of argument ").concat(t," cannt be null or empty.");return new Error(n)}},{key:"designerContextArgumentNull",value:function(){var e=new Error("Designer cottext argument null.");return e.name=t.errors.designerContextArgumentNull.name,e}}])&&a(n.prototype,r),u&&a(n,u),Object.defineProperty(n,"prototype",{writable:!1}),s}(n(10).Errors);t.errors=new s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementFactoryName=t.isCustomComponent=t.groupDisplayNames=t.proptDisplayNames=t.constants=void 0;var r=n(4);t.constants={componentsDir:"components",connectorElementClassName:"component-container",componentTypeName:"data-component-name",componentData:"component-data",componentPosition:"component-position"},t.proptDisplayNames={},t.groupDisplayNames={},t.isCustomComponent=function(e){return e.type.toLocaleLowerCase()!=e.type&&!r.componentTypes[e.type]},t.elementFactoryName="h"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errors=void 0;const r=n(10),o=n(13);class a extends r.Errors{pathFieldRequired(e){return new Error(`Path field of '${e}' component config can not be null or empty.`)}canntFindModule(e,t){return new Error(`Can not find component '${e}' in the module, module path is: '${t}'.`)}componentTypeNotExists(e){return new Error(`Component '${e}' not exists.`)}argumentNull(e){return new Error(`Argument '${e}' can not be null or empty.`)}propsFileNull(e){let t=new Error(`Field '${e}' of props is null.`);return t.name="propsFileNull",t}nullPageDataParserArguments(){o.PageDataParser;let e=new Error("PageDataParser arguments is null. Is this component child of PageDataParser?");return e.name="nullPageDataParserArguments",e}}t.errors=new a},function(e,n){e.exports=t},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var o=n(9),a=n(4),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"getPropEditors",value:function(t){for(var n=t.type,r=[],o=this.componentPropEditors[n]||[],a=0;a<o.length;a++){var i=o[a].propName,c=e.componentPropEditorDisplay["".concat(n,".").concat(i)];null!=c&&0==c(t)||r.push(o[a])}return r}},{key:"getPropEditor",value:function(e,t){return this.getPropEditorByArray(e,t)}},{key:"getPropEditorByArray",value:function(e,t){return(this.componentPropEditors[e]||[]).filter((function(e){return e.propName==t}))[0]}},{key:"setPropEditor",value:function(t){var n=t.componentType,r=t.editorType,a=t.display,i=t.group,c=t.propName,u=t.displayName,l=t.defaultValue,s=t.validation;i=i||o.defaultGroupName,c=c||"",u=u||c;var p=c.split("."),f="string"==typeof n?n:n.prototype.typename||n.name;e.componentPropEditorDisplay["".concat(f,".").concat(c)]=a;for(var m=e.componentPropEditors[f]=e.componentPropEditors[f]||[],d=0;d<m.length;d++)if(m[d].propName==p.join("."))return void(m[d].editorType=r);m.push({propName:c,displayName:u,editorType:r,group:i,defaultValue:l,validation:s})}},{key:"register",value:function(e,t){return(0,a.registerComponent)(e,t)}}],(n=null)&&r(t.prototype,n),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.Component=i,i.Fragment="",i.componentPropEditors={},i.componentPropEditorDisplay={}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),c=new S(r||[]);return a(i,"_invoke",{value:C(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=p;var m={};function d(){}function y(){}function h(){}var v={};s(v,c,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(j([])));b&&b!==t&&n.call(b,c)&&(v=b);var w=h.prototype=d.prototype=Object.create(v);function P(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function N(e,t){var o;a(this,"_invoke",{value:function(a,i){function c(){return new t((function(o,c){!function o(a,i,c,u){var l=f(e[a],e,i);if("throw"!==l.type){var s=l.arg,p=s.value;return p&&"object"==r(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){o("next",e,c,u)}),(function(e){o("throw",e,c,u)})):t.resolve(p).then((function(e){s.value=e,c(s)}),(function(e){return o("throw",e,c,u)}))}u(l.arg)}(a,i,o,c)}))}return o=o?o.then(c,c):c()}})}function C(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return D()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=E(i,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function E(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var r=f(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function j(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:D}}function D(){return{value:void 0,done:!0}}return y.prototype=h,a(w,"constructor",{value:h,configurable:!0}),a(h,"constructor",{value:y,configurable:!0}),y.displayName=s(h,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},P(N.prototype),s(N.prototype,u,(function(){return this})),e.AsyncIterator=N,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new N(p(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},P(w),s(w,l,"Generator"),s(w,c,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:j(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),m}},e}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function i(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){i(a,r,o,c,u,"next",e)}function u(e){i(a,r,o,c,u,"throw",e)}c(void 0)}))}}function u(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.PageDesigner=t.DesignerContext=void 0;var h=n(0),v=n(4),g=n(1),b=n(16),w=n(17),P=n(12),N=n(5),C=n(18),E=n(2);t.DesignerContext=h.createContext(null);var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(O,e);var n,r,i,l,s,d,y=m(O);function O(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),(t=y.call(this,e))._prePageData=null,!e)throw g.errors.argumentNull("props");if(!e.componentsConfig)throw g.errors.argumentFieldCanntNull("componentsConfig","props");t.checkComponentsConfig(e.componentsConfig);var n=t.props.pageData,r={};return t.initPageData(n,r),t.state={pageData:n,componentTypes:r,componentEditors:{}},t}return n=O,r=[{key:"checkComponentsConfig",value:function(e){}},{key:"initPageData",value:function(e,t){if(null==e)throw g.errors.argumentNull("pageData");console.assert(null!=e.children,"PageData children is null."),new P.PageDataTravel(e).each((function(e){"string"!=typeof e&&(0,E.isCustomComponent)(e)&&!t[e.type]&&(t[e.type]=(0,w.createLoadingComponent)())}))}},{key:"initComponent",value:function(e,t){var n={};if(t.children.forEach((function(e){e.name&&(n[e.name]=e)})),!e.name){var r,o=0;do{o+=1,r="".concat(e.type).concat(o)}while(n[r]);n[r]=e,e.name=r}e.id||(e.id=(0,b.guid)())}},{key:"pageData",get:function(){return this.state.pageData}},{key:"componentTypes",get:function(){return this.state.componentTypes}},{key:"prePageData",get:function(){return this._prePageData},set:function(e){this._prePageData=e}},{key:"selectedComponentIds",get:function(){return this.selectedComponents.map((function(e){return e.id}))}},{key:"selectedComponents",get:function(){return this.pageData.children.filter((function(e){return((e.status||v.ComponentStatus.default)&v.ComponentStatus.selected)==v.ComponentStatus.selected}))}},{key:"element",get:function(){return this._element}},{key:"updateComponentProp",value:function(e,t,n){return this.updateComponentProps([{componentId:e,propName:t,value:n}])}},{key:"updateComponentProps",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=r.componentId,a=r.propName,i=r.value,c=this.findComponentData(o);if(null!=c){var u=a.split(".");console.assert(null!=c),console.assert(null!=u,"props is null"),c.props=c.props||{};for(var l=c.props,s=0;s<u.length-1;s++)l=l[u[s]]=l[u[s]]||{};l[u[u.length-1]]=i,t.push(c)}}this.setState({pageData:this.pageData})}},{key:"appendComponent",value:function(e,t){if(!e.parentId)throw new Error("ParentId field of component data is null.");if(!e)throw g.errors.argumentNull("childComponent");var n=this.pageData;this.initComponent(e,n),null==t?n.children.push(e):n.children.splice(t,0,e),this.selectComponents(e.id)}},{key:"selectComponent",value:function(e){this.selectComponents(e),this._element&&this._element.focus()}},{key:"selectComponents",value:function(e){"string"==typeof e&&(e=[e]),this.pageData.children.forEach((function(e){e.status=e.status||v.ComponentStatus.default,e.status=e.status&~v.ComponentStatus.selected})),this.pageData.children.filter((function(t){return e.indexOf(t.id)>=0})).forEach((function(e){e.status=e.status||v.ComponentStatus.default,e.status=e.status|v.ComponentStatus.selected})),this.setState({pageData:this.pageData})}},{key:"removeComponent",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.removeComponents(t)}},{key:"removeComponents",value:function(e){var t=this.pageData;if(t&&t.children&&0!=t.children.length){for(var n=0;n<e.length;n++)this.removeComponentFrom(e[n],t);this.setState({pageData:t})}}},{key:"moveComponent",value:function(e,t,n){var r=this.findComponentData(e);if(null==r)throw new Error("Cannt find component by id ".concat(e));console.assert(null!=r,"Cannt find component by id ".concat(e)),r.parentId=t;var o=this.pageData;console.assert(null!=o.children),this.removeComponentFrom(e,o),this.appendComponent(r,n)}},{key:"removeComponentFrom",value:function(e,t){var n=t.children.filter((function(t){return t.id==e}))[0];if(null==n)throw new Error("Component '".concat(e,"' is not exists."));for(var r=[n],o=[e],a=function(){var e=r.pop(),n=t.children.filter((function(t){return t.parentId==e.id}));n.length>0&&(r.push.apply(r,u(n)),o.push.apply(o,u(n.filter((function(e){return null==e.status||(e.status&v.ComponentStatus.asset)!=v.ComponentStatus.asset})).map((function(e){return e.id})))))};r.length>0;)a();t.children=t.children.filter((function(e){return o.indexOf(e.id)<0}))}},{key:"findComponentData",value:function(e){var t=this.state.pageData;if(!t)throw g.errors.pageDataIsNull();return t.children.filter((function(t){return t.id==e}))[0]}},{key:"loadEditorTypes",value:(d=c(o().mark((function e(t){var n,r,i,c,u,l,s,p,f,m,d,y;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],new P.PageDataTravel(t).each((function(e){"string"!=typeof e&&(0,E.isCustomComponent)(e)&&n.push(e.type)})),r=this.props.componentsConfig,i=n.map((function(e){return r[e]})).filter((function(e){return e})).map((function(e){return e.editor})),e.next=7,Promise.all(i);case 7:c=t.children.filter((function(e){return"string"!=typeof e})).map((function(e){return e})),u=this.state.componentEditors,l=a(c);try{for(l.s();!(s=l.n()).done;){p=s.value,u[p.type]=u[p.type]||{},f=N.Component.getPropEditors(p),m=a(f);try{for(m.s();!(d=m.n()).done;)y=d.value,u[p.type][y.propName]=y.editorType}catch(e){m.e(e)}finally{m.f()}}}catch(e){l.e(e)}finally{l.f()}this.setState({componentEditors:u});case 12:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"loadComponentTypes",value:function(e){var t=this,n={},r=this.props.componentsConfig,o=[];return new P.PageDataTravel(e).each((function(e){"string"==typeof e||o.indexOf(e.type)>=0||!(0,E.isCustomComponent)(e)||o.push(e.type)})),O.loadComponentTypes(o,r).then((function(e){Object.assign(n,e),t.setState({componentTypes:n})}))}},{key:"onKeyDown",value:function(e){if(46==e.keyCode){if(0==this.selectedComponents.length)return;this.removeComponents(this.selectedComponentIds)}}},{key:"onPageDataChanged",value:(s=c(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.loadComponentTypes(t),this.loadEditorTypes(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"render",value:function(){var e=this,n=this.state.pageData;return(0,C.deepEqual)(this.prePageData,n)||(this.prePageData=JSON.parse(JSON.stringify(n)),this.onPageDataChanged(n)),h.createElement("div",{tabIndex:0,ref:function(t){return e._element=e._element||t},onKeyDown:function(t){return e.onKeyDown(t)},className:this.props.className,style:this.props.style},h.createElement(t.DesignerContext.Provider,{value:{designer:this}},this.props.children))}}],i=[{key:"loadComponentTypes",value:(l=c(o().mark((function e(t,n){var r,a,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a={},i=function(e){var o=t[e];if(!o){var i="Component '".concat(o,"' has not a config.");return a[o]=(0,w.createInfoComponent)(i),"continue"}if(v.componentTypes[o])return r.push(Promise.resolve(v.componentTypes[o])),"continue";var c=new Promise((function(e,t){if(!n[o]){var r="Component '".concat(o,"' is not exists.");return a[o]=(0,w.createInfoComponent)(r),void e({})}if(!(n[o].type instanceof Promise)){var i="Component '".concat(o,"' type is invalid.");return a[o]=(0,w.createInfoComponent)(i),void e({})}n[o].type.then((function(t){if(t.default)a[o]=t.default;else{var n="Component '".concat(o,"' module has not export default member.");a[o]=(0,w.createInfoComponent)(n)}e({})})).catch((function(e){t(e)}))}));r.push(c)},c=0;case 4:if(!(c<t.length)){e.next=11;break}if("continue"!==i(c)){e.next=8;break}return e.abrupt("continue",8);case 8:c++,e.next=4;break;case 11:return e.next=13,Promise.all(r);case 13:return e.abrupt("return",a);case 14:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)})},{key:"getDerivedStateFromProps",value:function(e,t){return{pageData:e.pageData}}}],r&&p(n.prototype,r),i&&p(n,i),Object.defineProperty(n,"prototype",{writable:!1}),O}(h.Component);t.PageDesigner=O},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeClassName=t.appendClassName=t.classNames=void 0;var r=n(1);t.classNames={componentSelected:"component-selected",emptyTemplates:"empty-templates",loadingTemplates:"loading-templates",templateSelected:"template-selected",templateDialog:"template-dialog",emptyDocument:"empty-document",empty:"empty",selected:"selected",component:"component",componentWrapper:"component-wrapper",componentPanel:"component-panel",componentIcon:"component-icon",placeholder:"placeholder",editorPanel:"editor-panel",designer:"designer",moveDown:"move-down"};var o=40,a=22,i=document.createElement("style");i.type="text/css",i.setAttribute("data-name","jueying"),i.innerHTML="\n            .".concat(t.classNames.componentSelected," {\n                border: solid 1px #337ab7!important;\n            }\n            .").concat(t.classNames.componentSelected," > :first-child {\n                border-color: blue;\n              }\n              .").concat(t.classNames.componentSelected," .resize_handle {\n                position: absolute;\n                height: 6px;\n                width: 6px;\n                border: 1px solid #89B;\n                background: #9AC;\n              }\n              .").concat(t.classNames.componentSelected," .move_handle {\n                height: 12px;\n                width: 12px;\n                top: 6px;\n                left: 8px;\n                border: solid 1px black;\n                position: relative;\n                margin-top: -12px;\n              }\n              .").concat(t.classNames.componentSelected," .NW,\n              .").concat(t.classNames.componentSelected," .NN,\n              .").concat(t.classNames.componentSelected," .NE {\n                top: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .NE,\n              .").concat(t.classNames.componentSelected," .EE,\n              .").concat(t.classNames.componentSelected," .SE {\n                right: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .SW,\n              .").concat(t.classNames.componentSelected,".SS,\n              .").concat(t.classNames.componentSelected," .SE {\n                bottom: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .NW,\n              .").concat(t.classNames.componentSelected," .WW,\n              .").concat(t.classNames.componentSelected," .SW {\n                left: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .SE,\n              .").concat(t.classNames.componentSelected," .NW {\n                cursor: nw-resize;\n              }\n              .").concat(t.classNames.componentSelected," .SW,\n              .").concat(t.classNames.componentSelected," .NE {\n                cursor: ne-resize;\n              }\n              .").concat(t.classNames.componentSelected," .NN,\n              .").concat(t.classNames.componentSelected," .SS {\n                cursor: n-resize;\n                left: 50%;\n                margin-left: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .EE,\n              .").concat(t.classNames.componentSelected," .WW {\n                cursor: e-resize;\n                top: 50%;\n                margin-top: -4px;\n              }\n            .").concat(t.classNames.emptyTemplates," {\n                padding:50px 0;\n                text-align: center;\n            }\n            .").concat(t.classNames.loadingTemplates," {\n                padding:50px 0;\n                text-align: center;\n            }\n            .").concat(t.classNames.templateSelected," .page-view {\n                border: solid 1px #337ab7!important;\n            }\n            .").concat(t.classNames.templateDialog," .name {\n                margin-top: -").concat(o,"px;\n                height: ").concat(o,"px;\n                font-size: ").concat(a,"px;\n                text-align: center;\n                padding-top: 6px;\n                background-color: black;\n                opacity: 0.5;\n            }\n            .").concat(t.classNames.templateDialog," .name span {\n                color: white;\n            }\n            .").concat(t.classNames.emptyDocument," {\n                text-align: center;\n                padding: 100px 0;\n            }\n            .").concat(t.classNames.component," > .NW,\n            .").concat(t.classNames.component," > .NN,\n            .").concat(t.classNames.component," > .NE,\n            .").concat(t.classNames.component," > .EE,\n            .").concat(t.classNames.component," > .SE,\n            .").concat(t.classNames.component," > .SW,\n            .").concat(t.classNames.component," > .SS,\n            .").concat(t.classNames.component," > .WW {\n                display: none;\n            }\n            .").concat(t.classNames.componentSelected,".component > .NW,\n            .").concat(t.classNames.componentSelected,".component > .NN,\n            .").concat(t.classNames.componentSelected,".component > .NE,\n            .").concat(t.classNames.componentSelected,".component > .EE,\n            .").concat(t.classNames.componentSelected,".component > .SE,\n            .").concat(t.classNames.componentSelected,".component > .SW,\n            .").concat(t.classNames.componentSelected,".component > .SS,\n            .").concat(t.classNames.componentSelected,".component > .WW {\n                display: block;\n            }\n            .").concat(t.classNames.placeholder," {\n                min-height: 40px;\n                width: 100%;\n            }\n            .").concat(t.classNames.placeholder,".active,\n            .").concat(t.classNames.componentWrapper,".active,\n            .").concat(t.classNames.componentWrapper,".").concat(t.classNames.componentSelected,".active {\n                border: 1px solid green;\n            }\n            .").concat(t.classNames.editorPanel," {\n                width: 300px;\n                background: white;\n                color: black;\n                margin: 0;\n                font-size: 14px;\n                z-index: 100;\n                overflow: auto;\n            }\n            .").concat(t.classNames.editorPanel," label {\n                width: 80px;\n                float: left;\n                padding: 4px;\n                text-overflow: ellipsis;\n                overflow: hidden;\n            }\n            .").concat(t.classNames.editorPanel," .control {\n                padding-left: 90px;\n            }\n            .").concat(t.classNames.editorPanel," .empty {\n                padding-top: 200px;\n                text-align: center;\n            }\n            .").concat(t.classNames.designer," .error,\n            .").concat(t.classNames.editorPanel," .error {\n                color: red;\n            }\n            .").concat(t.classNames.componentPanel," {\n                background: white;\n                color: black;\n                font-size: 14px;\n                z-index: 100;\n                list-style: none;\n                padding: 0;\n                text-align: center\n            }\n            .").concat(t.classNames.componentPanel," .panel-heading {\n                text-align: center;\n            }\n            .").concat(t.classNames.componentPanel," li {\n                text-align: center;\n                padding: 8px;\n            }\n            .").concat(t.classNames.componentWrapper,".").concat(t.classNames.moveDown," {\n         \n            }\n        "),null!=document.head&&document.head.appendChild(i),t.appendClassName=function(e,t){if(null==e)throw r.errors.argumentNull("element");if(!t)throw r.errors.argumentNull("addonClassName");var n;if(n=(n="string"==typeof e?e:e.className)||"",console.assert(null!=t),n.indexOf(t)>=0)return n;var o="".concat(n," ").concat(t);return"string"!=typeof e&&(e.className=o),o},t.removeClassName=function(e,t){var n;return(n="string"==typeof e?e:e.className||"").indexOf(t)<0||(n=(n=(n=n||"").replace(new RegExp(t,"g"),"")).trim(),"string"!=typeof e&&(e.className=n)),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseComponentData=void 0;const r=n(3),o=n(23);t.parseComponentData=function e(t,n,a){if(!t)throw r.errors.argumentNull("componentData");if(!n)throw r.errors.argumentNull("componentTypes");if(!t.type)throw r.errors.argumentFieldNull("type","componentData");let i=t.type.toLowerCase()==t.type?t.type:n[t.type]||o.componentTypes[t.type];if(null==i)throw r.errors.componentTypeNotExists(t.type);let c=[],u=t.children||[];u.length>0&&(c=u.map(t=>"string"==typeof t?t:e(t,n,a)));let l=Object.assign({},t.props);return l.key=l.key||t.id,l.id=t.id,a(i,l,c)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return(o=d()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&p(o,n.prototype),o}).apply(null,arguments)}function a(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=d();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorBoundary=t.PropertyEditor=t.defaultGroupName=void 0;var h=n(0),v=n(5),g=n(1),b=n(6),w=n(2),P=n(19);t.defaultGroupName="";var N=function(e){s(r,e);var n=f(r);function r(e){var t;return c(this,r),(t=n.call(this,e)).state={},t}return l(r,[{key:"getEditors",value:function(e){var t=this;if(null==e)return[];for(var n=[],r=e.selectedComponents,i=function(e){var t=r[e],o=v.Component.getPropEditors(t);if(0==e)n=o||[];else{var a=[];n.forEach((function(e){o.forEach((function(t){var n=e.propName,r=t.propName;e.editorType==t.editorType&&n==r&&a.push(e)}))})),n=a}},c=0;c<r.length;c++)i(c);for(var u={},l=0;l<r.length;l++){var s=r[l],p=Object.assign({},s.props);if(delete p.children,0==l)u=p;else{var f={};for(var m in u)u[m]==p[m]&&(f[m]=p[m]);u=f}}for(var d=[],y=function(i){var c=n[i],l=c.propName,s=c.editorType,p=t.propValue(l,u);null==p&&(p=c.defaultValue);var f={value:p,editComponents:r,updateComponentProp:function(i){var u=r.map((function(e){return{componentId:e.id,propName:c.propName,value:i}}));null==t._validator&&(t._validateFields=n.filter((function(e){return null!=e.validation})).map((function(e){return Object.assign(e.validation,{name:e.propName,rules:[]})})),t._validator=o(P.FormValidator,[t.element].concat(a(t._validateFields)))),t._validateFields.filter((function(e){return e.name==c.propName})).length>0&&t._validator.checkElement(c.propName),e.updateComponentProps(u)}},m=h.createElement(s,f);d.push({prop:c.propName,displayName:c.displayName,editor:m,group:c.group})},g=0;g<n.length;g++)y(g);return d}},{key:"propValue",value:function(e,t){if(!e)throw g.errors.argumentNull("propName");if(!t)throw g.errors.argumentNull("props");for(var n=e.split("."),r=t,o=0;o<n.length;o++)if(null==(r=r[n[o]]))return null;return r}},{key:"render",value:function(){var e=this;return h.createElement(b.DesignerContext.Consumer,null,(function(n){if(!n)throw g.errors.designerContextArgumentNull();var r=n.designer,o=e.getEditors(r);if(0==o.length){var a=e.props.empty;return h.createElement("div",{className:"text-center"},a)}if(e.props.customRender){var i=o.map((function(e){return Object.assign({displayName:e.displayName},e)})),c=e.props.customRender(r.selectedComponents,i);if(null!=c)return h.createElement("div",{ref:function(t){return e._element=t||e._element}},c)}for(var u=[],l=function(e){var n=o[e].group||t.defaultGroupName,r=u.filter((function(e){return e.group==n}))[0];null==r&&(r={group:o[e].group,editors:[]},u.push(r)),r.editors.push({prop:o[e].prop,displayName:o[e].displayName,editor:o[e].editor})},s=0;s<o.length;s++)l(s);return u.map((function(t){return h.createElement("div",{key:t.group,className:"panel panel-default",ref:function(t){return e._element=t||e._element}},t.group?h.createElement("div",{className:"panel-heading"},w.groupDisplayNames[t.group]||t.group):null,h.createElement("div",{className:"panel-body"},t.editors.map((function(e,t){return h.createElement("div",{key:e.prop,className:"form-group clearfix"},h.createElement("label",null,e.displayName),h.createElement("div",{className:"control"},h.createElement(C,null,e.editor)))}))))}))}))}},{key:"element",get:function(){return this._element}},{key:"validator",get:function(){return this._validator}}]),r}(h.Component);t.PropertyEditor=N,N.contextType=b.DesignerContext;var C=function(e){s(n,e);var t=f(n);function n(e){var r;return c(this,n),(r=t.call(this,e)).state={},r}return l(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e})}},{key:"render",value:function(){var e=(this.state||{}).error;return e?h.createElement("div",{className:"error"},h.createElement("div",null,e.message),h.createElement("div",null,e.stack)):this.props.children}}]),n}(h.Component);t.ErrorBoundary=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errors=t.Errors=void 0;class r{argumentNull(e){let t=new Error(`Argument ${e} cannt be null or emtpy.`);return t.name="argumentNull",t}routeDataFieldNull(e){let t=new Error(`The ${e} field of route data cannt be null.`);return t.name="routeDataFieldNull",t}argumentFieldNull(e,t){let n=new Error(`The ${e} field of ${t} cannt be null.`);return n.name="argumentFieldNull",n}argumentTypeIncorrect(e,t){let n=new Error(`Argument ${e} type error, expected type is ${t}.`);return n.name="argumentTypeIncorrect",n}pathStartsHttp(e){let t=new Error(`Path ${e} start with http or https.`);return t.name="pathStartsHttp",t}}t.Errors=r,t.errors=new r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.strings=void 0,t.strings={emptyCompoenntPanel:"暂无可用组件",emptyDiagram:"请拖放组件到此处",componentLoading:"组件正在加载中..."}},function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.PageDataTravel=void 0;var i=n(1),c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pageData=t}var t,n,o;return t=e,o=[{key:"findComponent",value:function(t,n){if(!t)throw i.errors.argumentNull("pageData");if(!n)throw i.errors.argumentNull("componentId");var r;return new e(t).each((function(e){"string"==typeof e||r||n==e.id&&(r=e)})),r}}],(n=[{key:"each",value:function(e){for(var t=r(this.pageData.children||[]),n=t.pop();null!=n;){if(e(n),"string"!=typeof n){var o=n.children||[];t.push.apply(t,r(o))}n=t.pop()}}}])&&a(t.prototype,n),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.PageDataTravel=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageDataParser=t.PageDataParserContext=void 0;const r=n(3),o=n(0),a=n(8);t.PageDataParserContext=o.createContext(null);class i extends o.Component{constructor(e){if(super(e),!e)throw r.errors.argumentNull("props");if(!e.pageData)throw r.errors.argumentFieldNull("pageData","props");if(!e.elementFactory)throw r.errors.argumentFieldNull("elementFactory","props");this.state={pageData:e.pageData,componentTypes:e.componentTypes}}static getDerivedStateFromProps(e,t){return{pageData:e.pageData,componentTypes:e.componentTypes}}render(){let{pageData:e}=this.state,{elementFactory:n,componentTypes:r}=this.props,i=e.children.filter(e=>!e.parentId).map(e=>(0,a.parseComponentData)(e,r,n));return o.createElement(t.PageDataParserContext.Provider,{value:{pageData:e,elementFactory:n,componentTypes:r}},i)}}t.PageDataParser=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DesignComponentContext=void 0;var r=n(0);t.DesignComponentContext=r.createContext(null)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentDiagram=t.classNames=t.DesignerContext=t.PageDesigner=t.EditorPanel=t.Component=t.groupDisplayNames=void 0;var r=n(2);Object.defineProperty(t,"groupDisplayNames",{enumerable:!0,get:function(){return r.groupDisplayNames}});var o=n(5);Object.defineProperty(t,"Component",{enumerable:!0,get:function(){return o.Component}});var a=n(20);Object.defineProperty(t,"EditorPanel",{enumerable:!0,get:function(){return a.EditorPanel}});var i=n(6);Object.defineProperty(t,"PageDesigner",{enumerable:!0,get:function(){return i.PageDesigner}}),Object.defineProperty(t,"DesignerContext",{enumerable:!0,get:function(){return i.DesignerContext}});var c=n(7);Object.defineProperty(t,"classNames",{enumerable:!0,get:function(){return c.classNames}});var u=n(21);Object.defineProperty(t,"ComponentDiagram",{enumerable:!0,get:function(){return u.ComponentDiagram}}),n(25)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.guid=void 0,t.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.createLoadingComponent=t.createInfoComponent=void 0;var f=n(0),m=n(11);t.createInfoComponent=function(e){return function(t){c(r,t);var n=l(r);function r(){return o(this,r),n.apply(this,arguments)}return i(r,[{key:"render",value:function(){return f.createElement("div",{className:"text-center",style:{paddingTop:20,paddingBottom:20}},e)}}]),r}(f.Component)},t.createLoadingComponent=function(){return function(e){c(n,e);var t=l(n);function n(){return o(this,n),t.apply(this,arguments)}return i(n,[{key:"render",value:function(){return f.createElement("div",{key:this.props.id,style:{padding:"50px 0 50px 0",textAlign:"center"}},m.strings.componentLoading)}}]),n}(f.Component)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.deepEqual=void 0,t.deepEqual=function e(t,n){if(t===n)return!0;if("object"==r(t)&&null!=t&&"object"==r(n)&&null!=n){if(Object.keys(t).length!=Object.keys(n).length)return!1;for(var o in t){if(!n.hasOwnProperty(o))return!1;if(!e(t[o],n[o]))return!1}return!0}return!1}},function(e,t){e.exports=n},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.EditorPanel=void 0;var l=n(0),s=n(9),p=n(7),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(u,e);var t,n,r,c=i(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e)).state={componentDatas:[]},t}return t=u,(n=[{key:"validateInputs",value:function(){return this.editor.validator.checkAsync()}},{key:"render",value:function(){var e=this,t=this.props.empty;return t=t||l.createElement("div",{className:"empty"},"暂无可用的属性"),l.createElement("div",{className:"".concat(p.classNames.editorPanel," ").concat(this.props.className||""),ref:function(t){return e.element=t||e.element}},l.createElement(s.PropertyEditor,{ref:function(t){return e.editor=t||e.editor},empty:t,customRender:this.props.customRender}))}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(l.Component);t.EditorPanel=f},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentDiagram=void 0;var l=n(1),s=n(22),p=n(8),f=n(0),m=n(6),d=n(11),y=n(7),h=n(12),v=n(14),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(u,e);var t,n,r,c=i(u);function u(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),t=c.call(this,e),!e)throw l.errors.argumentNull("props");return t.state={},t}return t=u,r=[{key:"createComponent",value:function(e,t,n){var r=t;if(!r.id)throw l.errors.argumentFieldNull("id","props");return f.createElement(m.DesignerContext.Consumer,null,(function(o){if(!o)throw l.errors.designerContextArgumentNull();var a=h.PageDataTravel.findComponent(o.designer.pageData,r.id);if(!a)throw new Error("Can not find component data by '".concat(r.id,"' in the page data."));var i=o.designer.props.componentsConfig[a.type];if(!i)return f.createElement(e,t,n);var c={componentData:a,componentConfig:i};return f.createElement(v.DesignComponentContext.Provider,{value:c},f.createElement(e,t,n))}))}}],(n=[{key:"selectComponent",value:function(e,t){t?e.selectComponent(t):e.selectComponent([])}},{key:"render",value:function(){var e=this;return f.createElement("ul",null,f.createElement(m.DesignerContext.Consumer,null,(function(t){if(!t)throw l.errors.designerContextArgumentNull();var n=t.designer.pageData.children||[];if(0==n.length)return f.createElement("li",null,d.strings.emptyCompoenntPanel);var r=t.designer.componentTypes;return f.createElement(f.Fragment,null,n.map((function(n){var o=((n.status||s.ComponentStatus.default)&s.ComponentStatus.selected)==s.ComponentStatus.selected;return f.createElement("li",{key:n.id,className:o?y.classNames.selected:"",onClick:function(r){r.preventDefault(),r.stopPropagation(),e.selectComponent(t.designer,n.id)}},(0,p.parseComponentData)(n,r,u.createComponent))})))})))}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(f.Component);t.ComponentDiagram=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentStatus=void 0,function(e){e[e.default=0]="default",e[e.selected=1]="selected",e[e.disabled=2]="disabled",e[e.asset=4]="asset"}(t.ComponentStatus||(t.ComponentStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerComponent=t.componentTypes=void 0;const r=n(24),o=n(3);t.componentTypes={},t.registerComponent=function(e,n){if(null==n&&"function"==typeof e&&(e=(n=e).name,n.componentName=e),!e)throw o.errors.argumentNull("componentName");if(!n)throw o.errors.argumentNull("componentType");t.componentTypes[e]=n},t.componentTypes[r.ComponentPlaceHolder.typeName]=r.ComponentPlaceHolder},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentPlaceHolder=void 0;const r=n(0),o=n(13),a=n(3),i=n(8);class c extends r.Component{constructor(e){super(e)}render(){return r.createElement(o.PageDataParserContext.Consumer,null,e=>{if(!e)throw a.errors.nullPageDataParserArguments();return e.pageData.children.filter(e=>e.parentId&&e.parentId==this.props.id).map(t=>(0,i.parseComponentData)(t,e.componentTypes,e.elementFactory))})}}t.ComponentPlaceHolder=c,c.typeName="PlaceHolder"},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(14),a=n(27),i=n(2),c=function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),c=2;c<n;c++)i[c-2]=arguments[c];var u={};return t&&(u={key:t.id||t.key}),r.createElement(o.DesignComponentContext.Consumer,u,(function(n){return null!=n?((("number"==typeof n.componentConfig.design?n.componentConfig.design:a.DesignBehavior.default)&a.DesignBehavior.disableClick)==a.DesignBehavior.disableClick&&delete t.onClick,r.createElement.apply(r,[e,t].concat(i))):r.createElement.apply(r,[e,t].concat(i))}))};"undefined"==typeof window?e[i.elementFactoryName]=c:window[i.elementFactoryName]=c}).call(this,n(26))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DesignBehavior=void 0,function(e){e[e.default=1]="default",e[e.disableClick=1]="disableClick"}(t.DesignBehavior||(t.DesignBehavior={}))}])}));
//# sourceMappingURL=index.es5.min.js.map