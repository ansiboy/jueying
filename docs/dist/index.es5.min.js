/*!
 * 
 *  maishu-jueying v3.1.17
 *  
 *  Copyright (C) maishu All rights reserved.
 *  
 *  组件设计器 
 *   
 *  作者: 麦舒
 *  日期: 2018/5/30
 *  
 *  个人博客：   http://www.cnblogs.com/ansiboy/
 *  GITHUB:     https://github.com/ansiboy/jueying
 *  QQ 讨论组：  119038574 
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):"object"==typeof exports?exports.jueying=t(require("react")):e.jueying=t(e.react)}(window,(function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=16)}([function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerComponent=t.componentTypes=void 0;const r=n(10);t.componentTypes={},t.registerComponent=function(e,n){if(null==n&&"function"==typeof e&&(e=(n=e).name,n.componentName=e),!e)throw r.errors.argumentNull("componentName");if(!n)throw r.errors.argumentNull("componentType");t.componentTypes[e]=n}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Errors=void 0;var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"placeHolderIdNull",value:function(){return new Error("Place holder property id cannt be null or empty.")}},{key:"fileNotExists",value:function(e){return new Error("File '".concat(e,"' is not exists."))}},{key:"argumentNull",value:function(e){return new Error("Argument ".concat(e," is null or empty."))}},{key:"argumentRangeError",value:function(e){return new Error("Argument ".concat(e," range error."))}},{key:"pageDataIsNull",value:function(){return new Error("Page data is null.")}},{key:"toolbarRequiredKey",value:function(){return new Error("Toolbar has not a key prop.")}},{key:"loadPluginFail",value:function(e){return new Error("Load plugin '".concat(e,"' fail."))}},{key:"idRequired",value:function(){return new Error("Property id is required.")}},{key:"canntFindMasterPage",value:function(e){return new Error("Can not find master page for component container ".concat(e,"."))}},{key:"propCanntNull",value:function(e,t){var n="".concat(e," property ").concat(t," cannt be null or empty.");return new Error(n)}},{key:"argumentFieldCanntNull",value:function(e,t){var n="".concat(e," of argument ").concat(t," cannt be null or empty.");return new Error(n)}}],(n=null)&&r(t.prototype,n),o&&r(t,o),e}();t.Errors=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentContainer=void 0;const r=n(0),o=n(5),a=n(4);class i extends r.Component{renderChild(e){return r.createElement(r.Fragment,{key:e.id},a.parseComponentData(e))}render(){return r.createElement(o.PageContext.Consumer,null,e=>{var t;let n=(null===(t=e.pageData)||void 0===t?void 0:t.children.filter(e=>e.parentId==this.props.id))||[];return r.createElement("div",{className:this.props.className,style:this.props.style},n.map(e=>this.renderChild(e)))})}}t.ComponentContainer=i,i.contextType=o.PageContext},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseComponentData=void 0;const r=n(0),o=n(1),a=n(10);t.parseComponentData=function e(t){let n=o.componentTypes[t.type];if(null==n)throw a.errors.componentTypeNotExists(t.type);let i=[];return null!=t.children&&(i=t.children.map(t=>"string"==typeof t?t:e(t))),r.createElement(n,t.props,...i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageBody=t.PageFooter=t.PageHeader=t.PageContext=t.Page=void 0;var r=n(11);Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return r.Page}}),Object.defineProperty(t,"PageContext",{enumerable:!0,get:function(){return r.PageContext}});var o=n(12);Object.defineProperty(t,"PageHeader",{enumerable:!0,get:function(){return o.PageHeader}});var a=n(13);Object.defineProperty(t,"PageFooter",{enumerable:!0,get:function(){return a.PageFooter}});var i=n(20);Object.defineProperty(t,"PageBody",{enumerable:!0,get:function(){return i.PageBody}})},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Callback=t.guid=t.groupDisplayNames=t.proptDisplayNames=t.constants=void 0,t.constants={componentsDir:"components",connectorElementClassName:"component-container",componentTypeName:"data-component-name",componentData:"component-data",componentPosition:"component-position"},t.proptDisplayNames={},t.groupDisplayNames={},t.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.funcs=new Array}var t,n,o;return t=e,o=[{key:"create",value:function(){return new e}}],(n=[{key:"add",value:function(e){this.funcs.push(e)}},{key:"remove",value:function(e){this.funcs=this.funcs.filter((function(t){return t!=e}))}},{key:"fire",value:function(e){this.funcs.forEach((function(t){return t(e)}))}}])&&r(t.prototype,n),o&&r(t,o),e}();t.Callback=o},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var o=n(8),a=n(18),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"getPropEditors",value:function(t){for(var n=t.type,r=[],o=this.componentPropEditors[n]||[],a=0;a<o.length;a++){var i=o[a].propName,l=e.componentPropEditorDisplay["".concat(n,".").concat(i)];null!=l&&0==l(t)||r.push(o[a])}return r}},{key:"getPropEditor",value:function(e,t){return this.getPropEditorByArray(e,t)}},{key:"getPropEditorByArray",value:function(e,t){return(this.componentPropEditors[e]||[]).filter((function(e){return e.propName==t}))[0]}},{key:"setPropEditor",value:function(t){var n=t.componentType,r=t.editorType,a=t.display,i=t.group,l=t.propName,s=t.displayName,c=t.defaultValue,u=t.validation;i=i||o.defaultGroupName,l=l||"",s=s||l;var p=l.split("."),f="string"==typeof n?n:n.prototype.typename||n.name;e.componentPropEditorDisplay["".concat(f,".").concat(l)]=a;for(var m=e.componentPropEditors[f]=e.componentPropEditors[f]||[],d=0;d<m.length;d++)if(m[d].propName==p.join("."))return void(m[d].editorType=r);m.push({propName:l,displayName:s,editorType:r,group:i,defaultValue:c,validation:u})}},{key:"register",value:function(e,t){return a.registerComponent(e,t)}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();t.Component=i,i.Fragment="",i.componentPropEditors={},i.componentPropEditorDisplay={}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function a(e,t,n){return(a=o()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&m(o,n.prototype),o}).apply(null,arguments)}function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorBoundary=t.PropertyEditor=t.defaultGroupName=void 0;var d=n(0),h=n(7),y=n(2),g=n(9),v=n(6),b=n(17);t.defaultGroupName="";var N=function(e){function n(e){var t;return l(this,n),(t=u(this,p(n).call(this,e))).state={},t}return f(n,e),c(n,[{key:"getEditors",value:function(e){var t=this;if(null==e)return[];for(var n=[],r=e.selectedComponents,o=function(e){var t=r[e],o=h.Component.getPropEditors(t);if(0==e)n=o||[];else{var a=[];n.forEach((function(e){o.forEach((function(t){var n=e.propName,r=t.propName;e.editorType==t.editorType&&n==r&&a.push(e)}))})),n=a}},l=0;l<r.length;l++)o(l);var s={};for(l=0;l<r.length;l++){var c=r[l],u=Object.assign({},c.props);if(delete u.children,0==l)s=u;else{var p={};for(var f in s)s[f]==u[f]&&(p[f]=u[f]);s=p}}for(var m=[],y=function(o){var l=n[o],c=l.propName,u=l.editorType,p=t.propValue(c,s);null==p&&(p=l.defaultValue);var f={value:p,editComponents:r,updateComponentProp:function(o){var s=r.map((function(e){return{componentId:e.id,propName:l.propName,value:o}}));null==t._validator&&(t._validateFields=n.filter((function(e){return null!=e.validation})).map((function(e){return Object.assign(e.validation,{name:e.propName})})),t._validator=a(b.FormValidator,[t.element].concat(i(t._validateFields)))),t._validateFields.filter((function(e){return e.name==l.propName})).length>0&&t._validator.checkElement(l.propName),e.updateComponentProps(s)}},h=d.createElement(u,f);m.push({prop:l.propName,displayName:l.displayName,editor:h,group:l.group})},g=0;g<n.length;g++)y(g);return m}},{key:"propValue",value:function(e,t){if(!e)throw y.Errors.argumentNull("propName");if(!t)throw y.Errors.argumentNull("props");for(var n=e.split("."),r=t,o=0;o<n.length;o++)if(null==(r=r[n[o]]))return null;return r}},{key:"render",value:function(){var e=this;return d.createElement(g.DesignerContext.Consumer,null,(function(n){var r=n.designer;if(null==r)return null;var o=e.getEditors(r);if(0==o.length){var a=e.props.empty;return d.createElement("div",{className:"text-center"},a)}if(e.props.customRender){var i=o.map((function(e){return Object.assign({displayName:e.displayName},e)})),l=e.props.customRender(r.selectedComponents,i);if(null!=l)return d.createElement("div",{ref:function(t){return e._element=t||e._element}},l)}for(var s=[],c=function(e){var n=o[e].group||t.defaultGroupName,r=s.filter((function(e){return e.group==n}))[0];null==r&&(r={group:o[e].group,editors:[]},s.push(r)),r.editors.push({prop:o[e].prop,displayName:o[e].displayName,editor:o[e].editor})},u=0;u<o.length;u++)c(u);return s.map((function(t){return d.createElement("div",{key:t.group,className:"panel panel-default",ref:function(t){return e._element=t||e._element}},t.group?d.createElement("div",{className:"panel-heading"},v.groupDisplayNames[t.group]||t.group):null,d.createElement("div",{className:"panel-body"},t.editors.map((function(e,t){return d.createElement("div",{key:e.prop,className:"form-group clearfix"},d.createElement("label",null,e.displayName),d.createElement("div",{className:"control"},d.createElement(E,null,e.editor)))}))))}))}))}},{key:"element",get:function(){return this._element}},{key:"validator",get:function(){return this._validator}}]),n}(d.Component);t.PropertyEditor=N,N.contextType=g.DesignerContext;var E=function(e){function t(e){var n;return l(this,t),(n=u(this,p(t).call(this,e))).state={},n}return f(t,e),c(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e})}},{key:"render",value:function(){var e=(this.state||{}).error;return e?d.createElement("div",{className:"error"},d.createElement("div",null,e.message),d.createElement("div",null,e.stack)):this.props.children}}]),t}(d.Component);t.ErrorBoundary=E},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PageDesigner=t.DesignerContext=void 0;var c=n(0),u=n(2),p=n(15);t.DesignerContext=c.createContext({designer:null});var f=function(e){function n(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=i(this,l(n).call(this,e))).components={};var r=t.props.pageData;return t.initPageData(r),t.state={pageData:r},t}var f,m,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,e),f=n,d=[{key:"travelComponentData",value:function(e,t){var n=new Array;n.push(e);var a=[];for(t=t||function(){return!0};n.length>0;){var i=n.shift();t(i)&&a.push(i);var l=(i.children||[]).filter((function(e){return"object"==r(e)}));n.push.apply(n,o(l))}return a}}],(m=[{key:"setComponetRefProp",value:function(e){var t=this,r={};n.travelComponentData(e).forEach((function(e){console.assert(null!=e.props&&null!=e.id),r[e.type]=r[e.type]||[],r[e.type].push(e.id);var n=e.props.ref;e.props.ref=function(r){null!=r&&(t.components[e.type]=t.components[e.type]||{},t.components[e.type][e.id]=r),"function"==typeof n&&n(r)}}))}},{key:"initPageData",value:function(e){null!=e&&(e.children=e.children||[],this.fillComponent(e),this.setComponetRefProp(e))}},{key:"fillComponent",value:function(e){var t=this,n={};if(!e.name){var r,o=0;do{o+=1,r="".concat(e.type).concat(o)}while(n[r]);n[r]=e,e.name=r}e.id||(e.id=p.guid()),e.children=e.children||[],e.children&&0!=e.children.length&&e.children.forEach((function(e){if("string"==typeof e)return!0;t.fillComponent(e)}))}},{key:"allComponents",value:function(){var e=this,t=[],n=function(n){var r=Object.getOwnPropertyNames(e.components[n]);t.push.apply(t,o(r.map((function(t){return e.components[n][t]}))))};for(var r in this.components)n(r);return t}},{key:"updateComponentProp",value:function(e,t,n){return this.updateComponentProps([{componentId:e,propName:t,value:n}])}},{key:"updateComponentProps",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=r.componentId,a=r.propName,i=r.value,l=this.findComponentData(o);if(null!=l){var s=a.split(".");console.assert(null!=l),console.assert(null!=s,"props is null"),l.props=l.props||{};for(var c=l.props,u=0;u<s.length-1;u++)c=c[s[u]]=c[s[u]]||{};c[s[s.length-1]]=i,t.push(l)}}this.setState({pageData:this.pageData})}},{key:"appendComponent",value:function(e,t,n){if(!e)throw u.Errors.argumentNull("parentId");if(!t)throw u.Errors.argumentNull("childComponent");this.initPageData(t);var r=this.findComponentData(e);if(null==r)throw new Error("Parent is not exists");console.assert(null!=r),r.children=r.children||[],null!=n?r.children.splice(n,0,t):r.children.push(t),this.selectComponents(t.id)}},{key:"selectComponent",value:function(e){this.selectComponents(e),this._element&&this._element.focus()}},{key:"selectComponents",value:function(e){"string"==typeof e&&(e=[e]);var t=this.selectedComponentIds;if(!this.isSame(e,t)){var n=[];for(n.push(this.pageData);n.length>0;){var r=n.pop(),o=e.indexOf(r.id)>=0;r.selected=o,(r.children||[]).forEach((function(e){if("string"==typeof e)return!0;n.push(e)}))}this.setState({pageData:this.pageData})}}},{key:"isSame",value:function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(t.indexOf(e[n])<0)return!1;return!0}},{key:"removeComponent",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.removeComponents(t)}},{key:"removeComponents",value:function(e){var t=this,n=this.pageData;if(n&&n.children&&0!=n.children.length){var r=n.children;e.forEach((function(e){t.removeComponentFrom(e,r)})),this.setState({pageData:n})}}},{key:"moveComponent",value:function(e,t,n){var r=this.findComponentData(e);if(null==r)throw new Error("Cannt find component by id ".concat(e));console.assert(null!=r,"Cannt find component by id ".concat(e));var o=this.pageData;console.assert(null!=o.children);var a=o.children;this.removeComponentFrom(e,a),this.appendComponent(t,r,n)}},{key:"removeComponentFrom",value:function(e,t){var n=this,r=null;t=t||[];for(var o=0;o<t.length;o++){var a=t[o];if("string"!=typeof a&&e==a.id){r=o;break}}if(null==r){for(var i=function(r){var o=t[r];if("string"==typeof o)return"continue";var a=o.children||[];a.forEach((function(t){return"string"==typeof t||!!n.removeComponentFrom(e,a)||void 0}))},l=0;l<t.length;l++)i(l);return!1}return 0==r?t.shift():r==t.length-1?t.pop():t.splice(r,1),!0}},{key:"findComponentData",value:function(e){var t=this.state.pageData;if(!t)throw u.Errors.pageDataIsNull();return n.travelComponentData(t,(function(t){return t.id==e}))[0]}},{key:"onKeyDown",value:function(e){if(46==e.keyCode){if(0==this.selectedComponents.length)return;this.removeComponents(this.selectedComponentIds)}}},{key:"findComponetsByTypeName",value:function(e){this.components[e]}},{key:"render",value:function(){var e=this;return c.createElement("div",{tabIndex:0,ref:function(t){return e._element=e._element||t},onKeyDown:function(t){return e.onKeyDown(t)},className:this.props.className,style:this.props.style},c.createElement(t.DesignerContext.Provider,{value:{designer:this}},this.props.children))}},{key:"pageData",get:function(){return this.state.pageData}},{key:"selectedComponentIds",get:function(){return this.selectedComponents.map((function(e){return e.id}))}},{key:"selectedComponents",get:function(){var e=new Array,t=new Array;for(t.push(this.pageData);t.length>0;){var n=t.pop();null!=n.props&&1==n.selected&&e.push(n),(n.children||[]).forEach((function(e){if("string"==typeof e)return!0;t.push(e)}))}return e}},{key:"element",get:function(){return this._element}}])&&a(f.prototype,m),d&&a(f,d),n}(c.Component);t.PageDesigner=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errors=void 0,t.errors={pathFieldRequired:e=>new Error(`Path field of '${e}' component config can not be null or empty.`),canntFindModule:(e,t)=>new Error(`Can not find component '${e}' in the module, module path is: '${t}'.`),componentTypeNotExists:e=>new Error(`Component '${e}' not exists.`),argumentNull:e=>new Error(`Argument '${e}' can not be null or empty.`)}},function(e,t,n){"use strict";var r,o=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Page=t.PageContext=void 0;const a=n(0),i=n(1),l=n(4),s=n(19);t.PageContext=a.createContext({});class c extends a.Component{constructor(e){super(e),this.childComponentCreated=new s.Callback,r.set(this,{})}get components(){return o(this,r)}render(){let e=this.props.pageData;e.children.forEach(e=>{e.props.ref=t=>{null!=t&&(null==o(this,r)[e.id]&&this.childComponentCreated.fire({component:t,id:e.id}),o(this,r)[e.id]=t||o(this,r)[e.id])}});let n=e.children.filter(t=>t.parentId==e.id).map(e=>a.createElement(a.Fragment,{key:e.id},l.parseComponentData(e)));return a.createElement("div",{className:`${c.className}`,style:{}},a.createElement(t.PageContext.Provider,{value:{page:this,pageData:e}},n))}}t.Page=c,r=new WeakMap,c.typeName="article",c.className="page-view",i.registerComponent("PageView",c),i.registerComponent(c.typeName,c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageHeader=void 0;const r=n(0),o=n(3),a=n(1);class i extends r.Component{render(){let e=this.props.style||{};return Object.assign({},e,{height:this.props.height,display:this.props.visible?"":"none"}),r.createElement(o.ComponentContainer,{id:this.props.id,className:i.className,style:e})}}t.PageHeader=i,i.typeName="header",i.className="header",i.id="page-header",i.defaultProps={height:50,visible:!0,id:i.id},a.registerComponent(i.typeName,i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageFooter=void 0;const r=n(0),o=n(3),a=n(1);class i extends r.Component{render(){let e=this.props.style||{};return Object.assign({},e,{height:this.props.height,display:this.props.visible?"":"none"}),r.createElement(o.ComponentContainer,{id:this.props.id,className:i.className,style:e})}}t.PageFooter=i,i.typeName="footer",i.className="footer",i.id="page-footer",i.defaultProps={id:i.id,height:50,visible:!0},a.registerComponent(i.typeName,i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeClassName=t.appendClassName=t.classNames=void 0;var r=n(2);t.classNames={componentSelected:"component-selected",emptyTemplates:"empty-templates",loadingTemplates:"loading-templates",templateSelected:"template-selected",templateDialog:"template-dialog",emptyDocument:"empty-document",component:"component",componentWrapper:"component-wrapper",componentPanel:"component-panel",componentIcon:"component-icon",placeholder:"placeholder",editorPanel:"editor-panel",designer:"designer",moveDown:"move-down"};var o=40,a=22,i=document.createElement("style");i.type="text/css",i.setAttribute("data-name","jueying"),i.innerHTML="\n            .".concat(t.classNames.componentSelected," {\n                border: solid 1px #337ab7!important;\n            }\n            .").concat(t.classNames.componentSelected," > :first-child {\n                border-color: blue;\n              }\n              .").concat(t.classNames.componentSelected," .resize_handle {\n                position: absolute;\n                height: 6px;\n                width: 6px;\n                border: 1px solid #89B;\n                background: #9AC;\n              }\n              .").concat(t.classNames.componentSelected," .move_handle {\n                height: 12px;\n                width: 12px;\n                top: 6px;\n                left: 8px;\n                border: solid 1px black;\n                position: relative;\n                margin-top: -12px;\n              }\n              .").concat(t.classNames.componentSelected," .NW,\n              .").concat(t.classNames.componentSelected," .NN,\n              .").concat(t.classNames.componentSelected," .NE {\n                top: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .NE,\n              .").concat(t.classNames.componentSelected," .EE,\n              .").concat(t.classNames.componentSelected," .SE {\n                right: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .SW,\n              .").concat(t.classNames.componentSelected,".SS,\n              .").concat(t.classNames.componentSelected," .SE {\n                bottom: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .NW,\n              .").concat(t.classNames.componentSelected," .WW,\n              .").concat(t.classNames.componentSelected," .SW {\n                left: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .SE,\n              .").concat(t.classNames.componentSelected," .NW {\n                cursor: nw-resize;\n              }\n              .").concat(t.classNames.componentSelected," .SW,\n              .").concat(t.classNames.componentSelected," .NE {\n                cursor: ne-resize;\n              }\n              .").concat(t.classNames.componentSelected," .NN,\n              .").concat(t.classNames.componentSelected," .SS {\n                cursor: n-resize;\n                left: 50%;\n                margin-left: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .EE,\n              .").concat(t.classNames.componentSelected," .WW {\n                cursor: e-resize;\n                top: 50%;\n                margin-top: -4px;\n              }\n            .").concat(t.classNames.emptyTemplates," {\n                padding:50px 0;\n                text-align: center;\n            }\n            .").concat(t.classNames.loadingTemplates," {\n                padding:50px 0;\n                text-align: center;\n            }\n            .").concat(t.classNames.templateSelected," .page-view {\n                border: solid 1px #337ab7!important;\n            }\n            .").concat(t.classNames.templateDialog," .name {\n                margin-top: -").concat(o,"px;\n                height: ").concat(o,"px;\n                font-size: ").concat(a,"px;\n                text-align: center;\n                padding-top: 6px;\n                background-color: black;\n                opacity: 0.5;\n            }\n            .").concat(t.classNames.templateDialog," .name span {\n                color: white;\n            }\n            .").concat(t.classNames.emptyDocument," {\n                text-align: center;\n                padding: 100px 0;\n            }\n            .").concat(t.classNames.component," > .NW,\n            .").concat(t.classNames.component," > .NN,\n            .").concat(t.classNames.component," > .NE,\n            .").concat(t.classNames.component," > .EE,\n            .").concat(t.classNames.component," > .SE,\n            .").concat(t.classNames.component," > .SW,\n            .").concat(t.classNames.component," > .SS,\n            .").concat(t.classNames.component," > .WW {\n                display: none;\n            }\n            .").concat(t.classNames.componentSelected,".component > .NW,\n            .").concat(t.classNames.componentSelected,".component > .NN,\n            .").concat(t.classNames.componentSelected,".component > .NE,\n            .").concat(t.classNames.componentSelected,".component > .EE,\n            .").concat(t.classNames.componentSelected,".component > .SE,\n            .").concat(t.classNames.componentSelected,".component > .SW,\n            .").concat(t.classNames.componentSelected,".component > .SS,\n            .").concat(t.classNames.componentSelected,".component > .WW {\n                display: block;\n            }\n            .").concat(t.classNames.placeholder," {\n                min-height: 40px;\n                width: 100%;\n            }\n            .").concat(t.classNames.placeholder,".active,\n            .").concat(t.classNames.componentWrapper,".active,\n            .").concat(t.classNames.componentWrapper,".").concat(t.classNames.componentSelected,".active {\n                border: 1px solid green;\n            }\n            .").concat(t.classNames.editorPanel," {\n                width: 300px;\n                background: white;\n                color: black;\n                margin: 0;\n                font-size: 14px;\n                z-index: 100;\n                overflow: auto;\n            }\n            .").concat(t.classNames.editorPanel," label {\n                width: 80px;\n                float: left;\n                padding: 4px;\n                text-overflow: ellipsis;\n                overflow: hidden;\n            }\n            .").concat(t.classNames.editorPanel," .control {\n                padding-left: 90px;\n            }\n            .").concat(t.classNames.editorPanel," .empty {\n                padding-top: 200px;\n                text-align: center;\n            }\n            .").concat(t.classNames.designer," .error,\n            .").concat(t.classNames.editorPanel," .error {\n                color: red;\n            }\n            .").concat(t.classNames.componentPanel," {\n                background: white;\n                color: black;\n                font-size: 14px;\n                z-index: 100;\n                list-style: none;\n                padding: 0;\n                text-align: center\n            }\n            .").concat(t.classNames.componentPanel," .panel-heading {\n                text-align: center;\n            }\n            .").concat(t.classNames.componentPanel," li {\n                text-align: center;\n                padding: 8px;\n            }\n            .").concat(t.classNames.componentWrapper,".").concat(t.classNames.moveDown," {\n         \n            }\n        "),null!=document.head&&document.head.appendChild(i),t.appendClassName=function(e,t){if(null==e)throw r.Errors.argumentNull("element");if(!t)throw r.Errors.argumentNull("addonClassName");var n;if(n=(n="string"==typeof e?e:e.className)||"",console.assert(null!=t),n.indexOf(t)>=0)return n;var o="".concat(n," ").concat(t);return"string"!=typeof e&&(e.className=o),o},t.removeClassName=function(e,t){var n;return(n="string"==typeof e?e:e.className||"").indexOf(t)<0?n:(n=(n=(n=n||"").replace(new RegExp(t,"g"),"")).trim(),"string"!=typeof e&&(e.className=n),n)}},function(e,t,n){"use strict";function r(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function o(...e){if(0==(e=e||[]).length)return"";if(1==e.length)return e[0];let t=e.join("");return t=t.replace(/\/+/g,"/"),t}n.r(t);class a{argumentNull(e){let t=new Error(`Argument ${e} cannt be null or emtpy.`);return t.name="argumentNull",t}routeDataFieldNull(e){let t=new Error(`The ${e} field of route data cannt be null.`);return t.name="routeDataFieldNull",t}argumentFieldNull(e,t){let n=new Error(`The ${e} field of ${t} cannt be null.`);return n.name="argumentFieldNull",n}argumentTypeIncorrect(e,t){let n=new Error(`Argument ${e} type error, expected type is ${t}.`);return n.name="argumentTypeIncorrect",n}queryResultTypeError(){return new Error("Type of the query result is expected as Array or DataSourceSelectResult.")}}let i=new a;class l{constructor(){this.funcs=new Array}add(e){this.funcs.push(e)}remove(e){this.funcs=this.funcs.filter(t=>t!=e)}fire(e){this.funcs.forEach(t=>t(e))}static create(){return new l}}let s=Object.assign(i,{dataSourceCanntInsert:()=>new Error("DataSource can not insert."),dataSourceCanntDelete:()=>new Error("DataSource can not delete."),dataSourceCanntUpdate:()=>new Error("DataSource can not update."),primaryKeyNull:e=>new Error(`Primary key named '${e}' value is null.`)});class c{constructor(e){this.inserting=new l,this.inserted=new l,this.deleting=new l,this.deleted=new l,this.updating=new l,this.updated=new l,this.selecting=new l,this.selected=new l,this.error=new l,this.args=e,this.primaryKeys=e.primaryKeys||[]}get canDelete(){return null!=this.args.delete&&this.primaryKeys.length>0}get canInsert(){return null!=this.args.insert&&this.primaryKeys.length>0}get canUpdate(){return null!=this.args.update&&this.primaryKeys.length>0}executeInsert(e,t){return this.args.insert(e,t)}executeDelete(e,t){return this.args.delete(e,t)}executeUpdate(e,t){return this.args.update(e,t)}executeSelect(e){return e=e||{},this.args.select(e)}insert(e,t,n){if(!this.canInsert)throw s.dataSourceCanntInsert();if(!e)throw s.argumentNull("item");return"number"==typeof t&&(n=t,t=null),this.inserting.fire({sender:this,dataItem:e,index:n}),this.executeInsert(e,t).then(t=>(Object.assign(e,t),this.inserted.fire({sender:this,dataItem:e,index:n}),t)).catch(e=>{throw this.processError(e,"insert"),e})}delete(e,t){if(!this.canDelete)throw s.dataSourceCanntDelete();if(!e)throw s.argumentNull("item");return this.checkPrimaryKeys(e),this.deleting.fire({sender:this,dataItem:e}),this.executeDelete(e,t).then(t=>(this.deleted.fire({sender:this,dataItem:e}),t)).catch(e=>{throw this.processError(e,"delete"),e})}update(e,t){if(!this.canUpdate)throw s.dataSourceCanntUpdate();if(!e)throw s.argumentNull("item");return this.checkPrimaryKeys(e),this.updating.fire({sender:this,dataItem:e}),this.executeUpdate(e,t).then(t=>(Object.assign(e,t),this.updated.fire({sender:this,dataItem:e}),t)).catch(e=>{throw this.processError(e,"update"),e})}isSameItem(e,t){if(null==e)throw s.argumentNull("theItem");if(null==t)throw s.argumentNull("otherItem");if(0==this.primaryKeys.length)return e==t;this.checkPrimaryKeys(e),this.checkPrimaryKeys(t);for(let n of this.primaryKeys)if(e[n]!=t[n])return!1;return!0}checkPrimaryKeys(e){for(let t in e)if(null==e[t]&&this.primaryKeys.indexOf(t)>=0)throw s.primaryKeyNull(t)}select(e){return e=e||{},this.selecting.fire({sender:this,selectArguments:e}),this.executeSelect(e).then(e=>{let t,n;if(Array.isArray(e))t=e,n=e.length;else{if(void 0===e.dataItems||void 0===e.totalRowCount)throw s.queryResultTypeError();t=e.dataItems,n=e.totalRowCount}return this.selected.fire({sender:this,selectResult:{totalRowCount:n,dataItems:t}}),{totalRowCount:n,dataItems:t}}).catch(e=>{throw this.processError(e,"select"),e})}processError(e,t){if(e.method=t,this.error.fire({sender:this,error:e}),!e.handled)throw e}}class u{constructor(){this.startRowIndex=0,this.maximumRows=2147483647}}function p(e){let t=e.indexOf("?");return t<0?{}:function(e){let t,n=/\+/g,r=/([^&=]+)=?([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},a={};for(;t=r.exec(e);)a[o(t[1])]=o(t[2]);return a}(e.substr(t+1))}n.d(t,"guid",(function(){return r})),n.d(t,"pathContact",(function(){return o})),n.d(t,"Errors",(function(){return a})),n.d(t,"errors",(function(){return i})),n.d(t,"Callback",(function(){return l})),n.d(t,"DataSource",(function(){return c})),n.d(t,"DataSourceSelectArguments",(function(){return u})),n.d(t,"parseUrl",(function(){return p}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentDataHandler=t.classNames=t.TextInput=t.PropEditor=t.DesignerContext=t.PageDesigner=t.EditorPanel=t.Component=t.groupDisplayNames=void 0;var r=n(6);Object.defineProperty(t,"groupDisplayNames",{enumerable:!0,get:function(){return r.groupDisplayNames}});var o=n(7);Object.defineProperty(t,"Component",{enumerable:!0,get:function(){return o.Component}});var a=n(22);Object.defineProperty(t,"EditorPanel",{enumerable:!0,get:function(){return a.EditorPanel}});var i=n(9);Object.defineProperty(t,"PageDesigner",{enumerable:!0,get:function(){return i.PageDesigner}}),Object.defineProperty(t,"DesignerContext",{enumerable:!0,get:function(){return i.DesignerContext}});var l=n(23);Object.defineProperty(t,"PropEditor",{enumerable:!0,get:function(){return l.PropEditor}}),Object.defineProperty(t,"TextInput",{enumerable:!0,get:function(){return l.TextInput}});var s=n(14);Object.defineProperty(t,"classNames",{enumerable:!0,get:function(){return s.classNames}});var c=n(24);Object.defineProperty(t,"ComponentDataHandler",{enumerable:!0,get:function(){return c.ComponentDataHandler}})},function(e,t,n){
/*!
 * 
 *  maishu-dilu v1.7.1
 *  https://github.com/ansiboy/dilu
 *  
 *  Copyright (c) 2016-2018, shu mai <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */
var r;window,r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./out/index.js")}({"./out/errors.js":
/*!***********************!*\
  !*** ./out/errors.js ***!
  \***********************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errors={argumentNull:e=>new Error(`Parameter ${e} can not be null or empty.`),elementValidateRuleNotSet(e){let t=`元素'${e.name}'没有设置验证规则`;return new Error(t)},fieldElementCanntNull:e=>new Error(null!=e?`The element value in the field cannt be null, field index is ${e}.`:"The element in the field is null"),elementNotExists:e=>new Error(`Element ${e} is not exits in the form.`),fieldResultExpectBooleanType:e=>new Error(`Result of ${e} field is expected boolean.`)}},"./out/formValidator.js":
/*!******************************!*\
  !*** ./out/formValidator.js ***!
  \******************************/
/*! no static exports found */function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function l(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(/*! ./errors */"./out/errors.js");class a{constructor(e,...t){if(this.validateOnChanged=!0,!e)throw o.errors.argumentNull("form");this.fields=t||[],this.form=e,this.elementEvents={}}appendField(e){this.fields.push(e)}clearErrors(){this.fields.map(e=>e.errorElement).filter(e=>null!=e).forEach(e=>e.style.display="none")}clearElementError(e){if(!e)throw o.errors.argumentNull("name");let t=this.fields.filter(t=>t.name==e);for(let e of t)this.fieldErrorElement(e).style.display="none"}setElementError(e,t){if(!e)throw o.errors.argumentNull("name");if(!t)throw o.errors.argumentNull("error");let n=this.fields.filter(t=>t.name==e);for(let e of n){let n=this.fieldErrorElement(e);n.style.removeProperty("display"),n.innerHTML=t}}fieldElement(e){let t=e.name,n=this.form.querySelectorAll(`[name='${t}']`)[0];if(null==n)throw o.errors.elementNotExists(t);return n}fieldErrorElement(e){if(!e.errorElement){let t=this.form.getElementsByClassName(`${a.errorClassName} ${e.name}`)[0];if(!t){let n=this.fieldElement(e);t=document.createElement("span"),t.className=a.errorClassName,t.style.display="none",n.nextSibling?n.parentElement.insertBefore(t,n.nextSibling):n.parentElement.appendChild(t)}e.errorElement=t}return e.errorElement}check(){let e=new Array;for(let t=0;t<this.fields.length;t++){let n=this.fields[t],r=this.fieldElement(n);if(n.condition&&0==n.condition(r))continue;let o=this.checkField(n);e.push(o)}return 0==e.filter(e=>0==e).length}checkAsync(){return r(this,void 0,void 0,(function*(){let e=new Array;for(let t=0;t<this.fields.length;t++){let n=this.fields[t],r=this.fieldElement(n);if(n.condition&&0==n.condition(r))continue;let o=this.checkFieldAsync(n);e.push(o)}return 0==(yield Promise.all(e)).filter(e=>0==e).length}))}bindElementEvent(e,t){if(this.elementEvents[e.name])return;let n=this.fieldElement(e),r=(()=>{let n=!1;return()=>{n||(n=!0,t?this.checkFieldAsync(e).then(()=>n=!1).catch(()=>n=!1):(this.checkField(e),n=!1))}})();if(this.validateOnChanged){n.addEventListener("change",r);let e=n.type||"text";if("text"==e||"password"==e)n.addEventListener("keyup",r);else if("radio"==e){let e=n.name,t=this.form.querySelectorAll(`[name='${e}']`);for(let e=0;e<t.length;e++)t[e]!=n&&t[e].addEventListener("change",r)}}this.elementEvents[e.name]=!0}checkField(e){this.bindElementEvent(e,!1);let t=this.fieldElement(e),n=e.depends||[];for(let e=0;e<n.length;e++){let r=n[e](t);if("object"==typeof r)throw new Error("Please use checkAsync method.");if(!r)return!1}for(let t=0;t<e.rules.length;t++){let n=e.rules[t],r=this.fieldElement(e);if(null==r)throw o.errors.fieldElementCanntNull();let a=this.elementValue(r),i=n.validate(a);if("object"==typeof i)throw new Error("Please use checkAsync method.");if(this.showElement(!i,e,n,r),!i)return!1}return!0}checkFieldAsync(e){return r(this,void 0,void 0,(function*(){this.bindElementEvent(e,!0);let t=this.fieldElement(e),n=e.depends||[];for(let e=0;e<n.length;e++){let r=n[e](t);if("boolean"==typeof r&&(r=Promise.resolve(r)),!(yield r))return!1}for(let t=0;t<e.rules.length;t++){let n=e.rules[t],r=this.fieldElement(e);if(null==r)throw o.errors.fieldElementCanntNull();let a=this.elementValue(r),i=n.validate(a);"boolean"==typeof i&&(i=Promise.resolve(i));let l=yield i;if(this.showElement(!l,e,n,r),!l)return!1}return!0}))}showElement(e,t,n,r){let o=this.fieldErrorElement(t);if(console.assert(null!=o,"errorElement cannt be null."),null!=n.error){o=t.errorElement;let e=this.elementName(r),a="string"==typeof n.error?n.error:n.error()||"";o.innerHTML=a.replace("%s",e)}e?o.style.removeProperty("display"):o.style.display="none"}checkElementAsync(e){let t=this.fields.filter(t=>t.name==e)[0];if(!t)throw o.errors.elementNotExists(e);return this.checkFieldAsync(t)}checkElement(e){let t=this.fields.filter(t=>t.name==e)[0];if(!t)throw o.errors.elementNotExists(e);return this.checkField(t)}elementValue(e){if("TEXTAREA"==e.tagName)return e.value;let t=e;if("radio"==t.type){let e=this.form.querySelectorAll(`[name='${t.name}']`);for(let t=0;t<e.length;t++)if(e[t].checked)return e[t].value;return""}return e.value}elementName(e){return e.tagName,e.name}}t.FormValidator=a,a.errorClassName="validationMessage"},"./out/index.js":
/*!**********************!*\
  !*** ./out/index.js ***!
  \**********************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(/*! ./formValidator */"./out/formValidator.js");t.FormValidator=r.FormValidator;var o=n(/*! ./rules */"./out/rules.js");t.rules=o.rules},"./out/rules.js":
/*!**********************!*\
  !*** ./out/rules.js ***!
  \**********************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/^[0-9]+$/,o=/^\-?[0-9]*\.?[0-9]+$/,a=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,i=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,l=/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,s=/^1[34578]\d{9}$/,c=/\d{4}-\d{1,2}-\d{1,2}/;let u="%s不能为空",p="%s与%s不匹配",f="%s和%s必须相同",m="%s至少包含%s个字符",d="The %s field must contain a number greater than %s.",h="The %s field must contain a number less than %s.",y="请数入数字",g="The %s field must contain a valid IP.",v="The %s field must contain a valid URL.",b="请输入正确的手机号码",N="请输入正确制";function E(e,t){return{validate:e,error:t}}function P(e){return"function"==typeof e?e():e}function C(e,t){let n;return n="number"==typeof t?o.test(e)?parseFloat(e):null:"string"==typeof t?e:function(e){if(!e.match("today")&&!e.match(c))return null;var t,n=new Date;return e.match("today")||(t=e.split("-"),n.setFullYear(t[0]),n.setMonth(t[1]-1),n.setDate(t[2])),n}(e),n<t?"lessThan":n>t?"greaterThan":"equal"}t.rules={required:e=>E(e=>""!=e,e||u),matches:(e,t)=>E(t=>t==e.value,t||u),email:e=>E(e=>a.test(e),e||u),minLength:(e,t)=>E(t=>(t||"").length>=P(e),t||m),maxLength:(e,t)=>E(t=>(t||"").length<=P(e),t||p),greaterThan:(e,t)=>E(t=>"greaterThan"==C(t,P(e)),t||d),lessThan:(e,t)=>E(t=>"lessThan"==C(t,P(e)),t||h),equal:(e,t)=>E(t=>"equal"==C(t,P(e)),t||f),ip:e=>E(e=>i.test(e),e||g),url:e=>E(e=>l.test(e),e||v),mobile:e=>E(e=>s.test(e),e||b),numeric:e=>E(e=>r.test(e),e||y),custom:(e,t)=>E(e,t||N)}}})},e.exports=r()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentContainer=t.PageBody=t.PageFooter=t.PageHeader=t.Page=t.componentTypes=t.registerComponent=t.parseComponentData=void 0;var r=n(4);Object.defineProperty(t,"parseComponentData",{enumerable:!0,get:function(){return r.parseComponentData}});var o=n(1);Object.defineProperty(t,"registerComponent",{enumerable:!0,get:function(){return o.registerComponent}}),Object.defineProperty(t,"componentTypes",{enumerable:!0,get:function(){return o.componentTypes}});var a=n(5);Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return a.Page}}),Object.defineProperty(t,"PageHeader",{enumerable:!0,get:function(){return a.PageHeader}}),Object.defineProperty(t,"PageFooter",{enumerable:!0,get:function(){return a.PageFooter}}),Object.defineProperty(t,"PageBody",{enumerable:!0,get:function(){return a.PageBody}});var i=n(3);Object.defineProperty(t,"ComponentContainer",{enumerable:!0,get:function(){return i.ComponentContainer}}),n(21)},function(e,t,n){"use strict";n.r(t),n.d(t,"Callback",(function(){return r}));class r{constructor(){this.funcs=new Array}add(e){this.funcs.push(e)}remove(e){this.funcs=this.funcs.filter(t=>t!=e)}fire(e){this.funcs.forEach(t=>t(e))}static create(){return new r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageBody=void 0;const r=n(0),o=n(3),a=n(11),i=n(12),l=n(13),s=n(1);class c extends r.Component{render(){return r.createElement(a.PageContext.Consumer,null,e=>{let t={marginTop:0};if(null!=e.pageData){let n=e.pageData.children.filter(e=>e.type==i.PageHeader.typeName)[0],r=e.pageData.children.filter(e=>e.type==l.PageFooter.typeName)[0];if(null!=n&&n.props.visible){let e=n.props;t.marginTop=e.height,t.height=`calc(100% - ${e.height}px)`}if(null!=r&&r.props.visible){let e=r.props;t.marginBottom=e.height,t.height=`calc(100% - ${t.marginTop+e.height}px)`}}return t.display=this.props.visible?"":"none",r.createElement(o.ComponentContainer,Object.assign({className:c.className},this.props,{style:t}))})}}t.PageBody=c,c.typeName="section",c.className="body",c.id="page-body",c.defaultProps={id:c.id,visible:!0},c.contextType=a.PageContext,s.registerComponent(c.typeName,c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFixed=t.isVisible=void 0;const r=n(5);if(!document.getElementById("maishu-jueying-core-style")&&null!=document.head){let e=document.createElement("style");e.type="text/css",e.id="maishu-jueying-core-style",document.head.appendChild(e),e.innerHTML=`\n    .${r.Page.className} {\n        width   : 100%;\n        height  : 100%;\n        position: absolute;\n    }\n    \n    .${r.Page.className} .${r.PageBody.className} {\n        overflow-y: auto;\n        overflow-x: hidden;\n        height  : 100%;\n    }\n    \n    .${r.Page.className} .${r.PageBody.className}::-webkit-scrollbar-track-piece {\n        background-color: #fff;\n    }\n    \n    .${r.Page.className} .${r.PageBody.className}::-webkit-scrollbar {\n        width: 4px;\n    }\n    \n    .${r.Page.className} .${r.PageBody.className}::-webkit-scrollbar-thumb {\n        background: #999;\n    }\n    \n    .${r.Page.className} .${r.PageHeader.className} {\n        position: absolute;\n        top     : 0px;\n        width   : 100%;\n    }\n    \n    .${r.Page.className} .${r.PageFooter.className} {\n        position: absolute;\n        bottom  : 0px;\n        width   : 100%;\n        margin  : 0;\n    }\n    `}t.isVisible=function(e){return!e.display||"none"!=e.display},t.isFixed=function(e){return"fixed"==e.position||"absolute"==e.position}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EditorPanel=void 0;var s=n(0),c=n(8),u=n(14),p=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=a(this,i(t).call(this,e))).state={componentDatas:[]},n}var n,r,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,e),n=t,(r=[{key:"validateInputs",value:function(){return this.editor.validator.checkAsync()}},{key:"render",value:function(){var e=this,t=this.props.empty;return t=t||s.createElement("div",{className:"empty"},"暂无可用的属性"),s.createElement("div",{className:"".concat(u.classNames.editorPanel," ").concat(this.props.className||""),ref:function(t){return e.element=t||e.element}},s.createElement(c.PropertyEditor,{ref:function(t){return e.editor=t||e.editor},empty:t,customRender:this.props.customRender}))}}])&&o(n.prototype,r),p&&o(n,p),t}(s.Component);t.EditorPanel=p},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function l(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TextInput=t.PropEditor=void 0;var f=n(0),m=function(e){function t(e){return o(this,t),l(this,s(t).call(this,e))}return c(t,e),i(t,null,[{key:"dropdown",value:function(e,t){return h(e,t)}},{key:"textInput",value:function(){return d}}]),t}(f.Component);t.PropEditor=m;var d=function(e){function t(){return o(this,t),l(this,s(t).apply(this,arguments))}return c(t,e),i(t,[{key:"render",value:function(){var e=this,t=this.props.value;return f.createElement("input",{className:"form-control",value:t||"",onChange:function(t){e.props.updateComponentProp(t.target.value)}})}}]),t}(m);function h(e,t){var n,r=[];if(null==t&&Array.isArray(e)){t=e.length>0&&"number"==typeof e[0]?"number":"string";for(var a=0;a<e.length;a++)r[a]={text:e[a],value:e[a]}}else if(null==t){t="string";for(var u=Object.getOwnPropertyNames(e),d=0;d<u.length;d++)r[d]={text:e[u[d]],value:u[d]}}else Array.isArray(e)?r=e:n=e;return function(e){function a(e){var t;return o(this,a),(t=l(this,s(a).call(this,e))).state={},t}return c(a,e),i(a,[{key:"componentDidMount",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,n;case 3:t=e.sent,this.setState({items:t});case 5:case"end":return e.stop()}}),e,this)})))}},{key:"render",value:function(){var e=this,n=this.state.items,o=this.props.value;return n=n||r,f.createElement("select",{className:"form-control",value:null==o?"":o,onChange:function(n){var r=n.target.value;if("number"==t){o=/^\d+$/.test(r)?parseInt(r):/^[+-]?\d+(\.\d+)?$/.test(r)?parseFloat(r):null}else o=r;e.props.updateComponentProp(o)}},n.map((function(e){return f.createElement("option",{key:e.value,value:e.value},e.text)})))}}]),a}(m)}t.TextInput=d},function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentDataHandler=void 0;var i=n(2),l=n(15),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._components={},this.componentSelected=l.Callback.create(),this.componentRemoved=l.Callback.create(),this.componentAppend=l.Callback.create(),this.componentUpdated=l.Callback.create(),this.pageDataChanged=l.Callback.create(),this._pageData=t,this.initComponentData(this._pageData)}var t,n,s;return t=e,s=[{key:"travelComponentData",value:function(e,t){var n=new Array;n.push(e);var a=[];for(t=t||function(){return!0};n.length>0;){var i=n.shift();t(i)&&a.push(i);var l=(i.children||[]).filter((function(e){return"object"==o(e)}));n.push.apply(n,r(l))}return a}},{key:"fillComponent",value:function(t){var n={};if(!t.name){var r,o=0;do{o+=1,r="".concat(t.type).concat(o)}while(n[r]);n[r]=t,t.name=r}t.id||(t.id=l.guid()),t.children=t.children||[],t.children&&0!=t.children.length&&t.children.forEach((function(t){if("string"==typeof t)return!0;e.fillComponent(t)}))}},{key:"setComponetRefProp",value:function(t,n){var r={};e.travelComponentData(t).forEach((function(e){var t=e.props||{};console.assert(null!=e.props&&null!=e.id),r[e.type]=r[e.type]||[],r[e.type].push(e.id);var o=t.ref;t.ref=function(t){null!=t&&(n[e.type]=n[e.type]||[],n[e.type].push(t)),"function"==typeof o&&o(t)}}));for(var o=Object.getOwnPropertyNames(n),a=function(e){var t=o[e],a=r[t]||[];n[t]=(n[t]||[]).filter((function(e){return a.indexOf(e.id||e.props.id)>=0}))},i=0;i<o.length;i++)a(i)}}],(n=[{key:"initComponentData",value:function(t){null!=t&&(t.children=t.children||[],e.fillComponent(t),e.setComponetRefProp(t,this._components))}},{key:"moveComponent",value:function(e,t,n){var r=this.findComponentData(e);if(null==r)throw new Error("Cannt find component by id ".concat(e));console.assert(null!=r,"Cannt find component by id ".concat(e));var o=this.pageData;console.assert(null!=o.children);var a=o.children;this.removeComponentFrom(e,a),this.appendComponent(t,r,n)}},{key:"updateComponentProps",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=r.componentId,a=r.propName,i=r.value,l=this.findComponentData(o);if(null!=l){var s=a.split(".");console.assert(null!=l),console.assert(null!=s,"props is null"),l.props=l.props||{};for(var c=l.props,u=0;u<s.length-1;u++)c=c[s[u]]=c[s[u]]||{};c[s[s.length-1]]=i,t.push(l)}}this.componentUpdated.fire(t)}},{key:"findComponentData",value:function(t){var n=this._pageData;if(!n)throw i.Errors.pageDataIsNull();return e.travelComponentData(n,(function(e){return e.id==t}))[0]}},{key:"removeComponentFrom",value:function(e,t){var n=null;t=t||[];for(var r=0;r<t.length;r++){var o=t[r];if("string"!=typeof o&&e==o.id){n=r;break}}if(null==n){for(var a=0;a<t.length;a++){var i=t[a];if("string"!=typeof i){var l=i.children;if(l&&l.length>0&&this.removeComponentFrom(e,l))return!0}}return!1}return 0==n?t.shift():n==t.length-1?t.pop():t.splice(n,1),!0}},{key:"appendComponent",value:function(e,t,n){if(!e)throw i.Errors.argumentNull("parentId");if(!t)throw i.Errors.argumentNull("childComponent");this.initComponentData(t);var r=this.findComponentData(e);if(null==r)throw new Error("Parent is not exists");console.assert(null!=r),r.children=r.children||[],null!=n?r.children.splice(n,0,t):r.children.push(t),this.selectComponents(t.id),this.componentAppend.fire(this)}},{key:"selectComponent",value:function(e){return this.selectComponents(e)}},{key:"selectComponents",value:function(e){"string"==typeof e&&(e=[e]);var t=[];for(t.push(this._pageData);t.length>0;){var n=t.pop();if(null!=n&&"string"!=typeof n){var r=e.indexOf(n.id)>=0;n.selected=r,(n.children||[]).forEach((function(e){if("string"==typeof e)return!0;t.push(e)}))}}this.componentSelected.fire(this.selectedComponentIds)}},{key:"removeComponent",value:function(e){return this.removeComponents([e])}},{key:"removeComponents",value:function(e){var t=this,n=this.pageData;if(n&&n.children&&0!=n.children.length){var r=n.children;e.forEach((function(e){t.removeComponentFrom(e,r)})),this.componentRemoved.fire(e)}}},{key:"selectedComponents",get:function(){var e=new Array,t=new Array;for(t.push(this._pageData);t.length>0;){var n=t.pop();null!=n.props&&1==n.selected&&e.push(n),(n.children||[]).forEach((function(e){if("string"==typeof e)return!0;t.push(e)}))}return e}},{key:"selectedComponentIds",get:function(){return this.selectedComponents.map((function(e){return e.id}))}},{key:"components",get:function(){return this._components}},{key:"pageData",get:function(){return this._pageData},set:function(e){this._pageData=e,this.initComponentData(e),this.pageDataChanged.fire(e)}}])&&a(t.prototype,n),s&&a(t,s),e}();t.ComponentDataHandler=s}])}));
//# sourceMappingURL=index.es5.min.js.map