/*!
 * 
 *  maishu-jueying v3.1.20
 *  
 *  Copyright (C) maishu All rights reserved.
 *  
 *  组件设计器 
 *   
 *  作者: 麦舒
 *  日期: 2018/5/30
 *  
 *  个人博客：   http://www.cnblogs.com/ansiboy/
 *  GITHUB:     https://github.com/ansiboy/jueying
 *  QQ 讨论组：  119038574 
 * 
 */
!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("react"),require("maishu-toolkit"),require("maishu-dilu"),require("maishu-jueying-core")):"function"==typeof define&&define.amd?define(["react","maishu-toolkit","maishu-dilu","maishu-jueying-core"],n):"object"==typeof exports?exports.jueying=n(require("react"),require("maishu-toolkit"),require("maishu-dilu"),require("maishu-jueying-core")):e.jueying=n(e.react,e["maishu-toolkit"],e["maishu-dilu"],e["maishu-jueying-core"])}(window,(function(e,n,t,o){return function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=8)}([function(n,t){n.exports=e},function(e,n,t){"use strict";function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Errors=void 0;var r=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,t,r;return n=e,r=[{key:"placeHolderIdNull",value:function(){return new Error("Place holder property id cannt be null or empty.")}},{key:"fileNotExists",value:function(e){return new Error("File '".concat(e,"' is not exists."))}},{key:"argumentNull",value:function(e){return new Error("Argument ".concat(e," is null or empty."))}},{key:"argumentRangeError",value:function(e){return new Error("Argument ".concat(e," range error."))}},{key:"pageDataIsNull",value:function(){return new Error("Page data is null.")}},{key:"toolbarRequiredKey",value:function(){return new Error("Toolbar has not a key prop.")}},{key:"loadPluginFail",value:function(e){return new Error("Load plugin '".concat(e,"' fail."))}},{key:"idRequired",value:function(){return new Error("Property id is required.")}},{key:"canntFindMasterPage",value:function(e){return new Error("Can not find master page for component container ".concat(e,"."))}},{key:"propCanntNull",value:function(e,n){var t="".concat(e," property ").concat(n," cannt be null or empty.");return new Error(t)}},{key:"argumentFieldCanntNull",value:function(e,n){var t="".concat(e," of argument ").concat(n," cannt be null or empty.");return new Error(t)}}],(t=null)&&o(n.prototype,t),r&&o(n,r),e}();n.Errors=r},function(e,n,t){"use strict";function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Callback=n.guid=n.groupDisplayNames=n.proptDisplayNames=n.constants=void 0,n.constants={componentsDir:"components",connectorElementClassName:"component-container",componentTypeName:"data-component-name",componentData:"component-data",componentPosition:"component-position"},n.proptDisplayNames={},n.groupDisplayNames={},n.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};var r=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.funcs=new Array}var n,t,r;return n=e,r=[{key:"create",value:function(){return new e}}],(t=[{key:"add",value:function(e){this.funcs.push(e)}},{key:"remove",value:function(e){this.funcs=this.funcs.filter((function(n){return n!=e}))}},{key:"fire",value:function(e){this.funcs.forEach((function(n){return n(e)}))}}])&&o(n.prototype,t),r&&o(n,r),e}();n.Callback=r},function(e,n,t){"use strict";function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Component=void 0;var r=t(4),a=t(10),i=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,t,i;return n=e,i=[{key:"getPropEditors",value:function(n){for(var t=n.type,o=[],r=this.componentPropEditors[t]||[],a=0;a<r.length;a++){var i=r[a].propName,c=e.componentPropEditorDisplay["".concat(t,".").concat(i)];null!=c&&0==c(n)||o.push(r[a])}return o}},{key:"getPropEditor",value:function(e,n){return this.getPropEditorByArray(e,n)}},{key:"getPropEditorByArray",value:function(e,n){return(this.componentPropEditors[e]||[]).filter((function(e){return e.propName==n}))[0]}},{key:"setPropEditor",value:function(n){var t=n.componentType,o=n.editorType,a=n.display,i=n.group,c=n.propName,l=n.displayName,u=n.defaultValue,s=n.validation;i=i||r.defaultGroupName,c=c||"",l=l||c;var p=c.split("."),f="string"==typeof t?t:t.prototype.typename||t.name;e.componentPropEditorDisplay["".concat(f,".").concat(c)]=a;for(var m=e.componentPropEditors[f]=e.componentPropEditors[f]||[],d=0;d<m.length;d++)if(m[d].propName==p.join("."))return void(m[d].editorType=o);m.push({propName:c,displayName:l,editorType:o,group:i,defaultValue:u,validation:s})}},{key:"register",value:function(e,n){return a.registerComponent(e,n)}}],(t=null)&&o(n.prototype,t),i&&o(n,i),e}();n.Component=i,i.Fragment="",i.componentPropEditors={},i.componentPropEditorDisplay={}},function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function a(e,n,t){return(a=r()?Reflect.construct:function(e,n,t){var o=[null];o.push.apply(o,n);var r=new(Function.bind.apply(e,o));return t&&m(r,t.prototype),r}).apply(null,arguments)}function i(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function l(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,n,t){return n&&l(e.prototype,n),t&&l(e,t),e}function s(e,n){return!n||"object"!==o(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&m(e,n)}function m(e,n){return(m=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorBoundary=n.PropertyEditor=n.defaultGroupName=void 0;var d=t(0),y=t(3),h=t(1),v=t(5),g=t(2),b=t(9);n.defaultGroupName="";var N=function(e){function t(e){var n;return c(this,t),(n=s(this,p(t).call(this,e))).state={},n}return f(t,e),u(t,[{key:"getEditors",value:function(e){var n=this;if(null==e)return[];for(var t=[],o=e.selectedComponents,r=function(e){var n=o[e],r=y.Component.getPropEditors(n);if(0==e)t=r||[];else{var a=[];t.forEach((function(e){r.forEach((function(n){var t=e.propName,o=n.propName;e.editorType==n.editorType&&t==o&&a.push(e)}))})),t=a}},c=0;c<o.length;c++)r(c);var l={};for(c=0;c<o.length;c++){var u=o[c],s=Object.assign({},u.props);if(delete s.children,0==c)l=s;else{var p={};for(var f in l)l[f]==s[f]&&(p[f]=s[f]);l=p}}for(var m=[],h=function(r){var c=t[r],u=c.propName,s=c.editorType,p=n.propValue(u,l);null==p&&(p=c.defaultValue);var f={value:p,editComponents:o,updateComponentProp:function(r){var l=o.map((function(e){return{componentId:e.id,propName:c.propName,value:r}}));null==n._validator&&(n._validateFields=t.filter((function(e){return null!=e.validation})).map((function(e){return Object.assign(e.validation,{name:e.propName})})),n._validator=a(b.FormValidator,[n.element].concat(i(n._validateFields)))),n._validateFields.filter((function(e){return e.name==c.propName})).length>0&&n._validator.checkElement(c.propName),e.updateComponentProps(l)}},y=d.createElement(s,f);m.push({prop:c.propName,displayName:c.displayName,editor:y,group:c.group})},v=0;v<t.length;v++)h(v);return m}},{key:"propValue",value:function(e,n){if(!e)throw h.Errors.argumentNull("propName");if(!n)throw h.Errors.argumentNull("props");for(var t=e.split("."),o=n,r=0;r<t.length;r++)if(null==(o=o[t[r]]))return null;return o}},{key:"render",value:function(){var e=this;return d.createElement(v.DesignerContext.Consumer,null,(function(t){var o=t.designer;if(null==o)return null;var r=e.getEditors(o);if(0==r.length){var a=e.props.empty;return d.createElement("div",{className:"text-center"},a)}if(e.props.customRender){var i=r.map((function(e){return Object.assign({displayName:e.displayName},e)})),c=e.props.customRender(o.selectedComponents,i);if(null!=c)return d.createElement("div",{ref:function(n){return e._element=n||e._element}},c)}for(var l=[],u=function(e){var t=r[e].group||n.defaultGroupName,o=l.filter((function(e){return e.group==t}))[0];null==o&&(o={group:r[e].group,editors:[]},l.push(o)),o.editors.push({prop:r[e].prop,displayName:r[e].displayName,editor:r[e].editor})},s=0;s<r.length;s++)u(s);return l.map((function(n){return d.createElement("div",{key:n.group,className:"panel panel-default",ref:function(n){return e._element=n||e._element}},n.group?d.createElement("div",{className:"panel-heading"},g.groupDisplayNames[n.group]||n.group):null,d.createElement("div",{className:"panel-body"},n.editors.map((function(e,n){return d.createElement("div",{key:e.prop,className:"form-group clearfix"},d.createElement("label",null,e.displayName),d.createElement("div",{className:"control"},d.createElement(C,null,e.editor)))}))))}))}))}},{key:"element",get:function(){return this._element}},{key:"validator",get:function(){return this._validator}}]),t}(d.Component);n.PropertyEditor=N,N.contextType=v.DesignerContext;var C=function(e){function n(e){var t;return c(this,n),(t=s(this,p(n).call(this,e))).state={},t}return f(n,e),u(n,[{key:"componentDidCatch",value:function(e,n){this.setState({error:e})}},{key:"render",value:function(){var e=(this.state||{}).error;return e?d.createElement("div",{className:"error"},d.createElement("div",null,e.message),d.createElement("div",null,e.stack)):this.props.children}}]),n}(d.Component);n.ErrorBoundary=C},function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,n){return!n||"object"!==o(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,n){return(l=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.PageDesigner=n.DesignerContext=void 0;var u=t(0),s=t(1),p=t(6);n.DesignerContext=u.createContext({designer:null});var f=function(e){function t(e){var n;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),(n=i(this,c(t).call(this,e))).components={};var o=n.props.pageData;return n.initPageData(o),n.state={pageData:o},n}var f,m,d;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&l(e,n)}(t,e),f=t,d=[{key:"travelComponentData",value:function(e,n){var t=new Array;t.push(e);var a=[];for(n=n||function(){return!0};t.length>0;){var i=t.shift();n(i)&&a.push(i);var c=(i.children||[]).filter((function(e){return"object"==o(e)}));t.push.apply(t,r(c))}return a}}],(m=[{key:"setComponetRefProp",value:function(e){var n=this,o={};t.travelComponentData(e).forEach((function(e){console.assert(null!=e.props&&null!=e.id),o[e.type]=o[e.type]||[],o[e.type].push(e.id);var t=e.props.ref;e.props.ref=function(o){null!=o&&(n.components[e.type]=n.components[e.type]||{},n.components[e.type][e.id]=o),"function"==typeof t&&t(o)}}))}},{key:"initPageData",value:function(e){null!=e&&(e.children=e.children||[],this.fillComponent(e),this.setComponetRefProp(e))}},{key:"fillComponent",value:function(e){var n=this,t={};if(!e.name){var o,r=0;do{r+=1,o="".concat(e.type).concat(r)}while(t[o]);t[o]=e,e.name=o}e.id||(e.id=p.guid()),e.children=e.children||[],e.children&&0!=e.children.length&&e.children.forEach((function(e){if("string"==typeof e)return!0;n.fillComponent(e)}))}},{key:"allComponents",value:function(){var e=this,n=[],t=function(t){var o=Object.getOwnPropertyNames(e.components[t]);n.push.apply(n,r(o.map((function(n){return e.components[t][n]}))))};for(var o in this.components)t(o);return n}},{key:"updateComponentProp",value:function(e,n,t){return this.updateComponentProps([{componentId:e,propName:n,value:t}])}},{key:"updateComponentProps",value:function(e){for(var n=[],t=0;t<e.length;t++){var o=e[t],r=o.componentId,a=o.propName,i=o.value,c=this.findComponentData(r);if(null!=c){var l=a.split(".");console.assert(null!=c),console.assert(null!=l,"props is null"),c.props=c.props||{};for(var u=c.props,s=0;s<l.length-1;s++)u=u[l[s]]=u[l[s]]||{};u[l[l.length-1]]=i,n.push(c)}}this.setState({pageData:this.pageData})}},{key:"appendComponent",value:function(e,n,t){if(!e)throw s.Errors.argumentNull("parentId");if(!n)throw s.Errors.argumentNull("childComponent");this.initPageData(n);var o=this.findComponentData(e);if(null==o)throw new Error("Parent is not exists");console.assert(null!=o),o.children=o.children||[],null!=t?o.children.splice(t,0,n):o.children.push(n),this.selectComponents(n.id)}},{key:"selectComponent",value:function(e){this.selectComponents(e),this._element&&this._element.focus()}},{key:"selectComponents",value:function(e){"string"==typeof e&&(e=[e]);var n=this.selectedComponentIds;if(!this.isSame(e,n)){var t=[];for(t.push(this.pageData);t.length>0;){var o=t.pop(),r=e.indexOf(o.id)>=0;o.selected=r,(o.children||[]).forEach((function(e){if("string"==typeof e)return!0;t.push(e)}))}this.setState({pageData:this.pageData})}}},{key:"isSame",value:function(e,n){if(e.length!=n.length)return!1;for(var t=0;t<e.length;t++)if(n.indexOf(e[t])<0)return!1;return!0}},{key:"removeComponent",value:function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];this.removeComponents(n)}},{key:"removeComponents",value:function(e){var n=this,t=this.pageData;if(t&&t.children&&0!=t.children.length){var o=t.children;e.forEach((function(e){n.removeComponentFrom(e,o)})),this.setState({pageData:t})}}},{key:"moveComponent",value:function(e,n,t){var o=this.findComponentData(e);if(null==o)throw new Error("Cannt find component by id ".concat(e));console.assert(null!=o,"Cannt find component by id ".concat(e));var r=this.pageData;console.assert(null!=r.children);var a=r.children;this.removeComponentFrom(e,a),this.appendComponent(n,o,t)}},{key:"removeComponentFrom",value:function(e,n){var t=this,o=null;n=n||[];for(var r=0;r<n.length;r++){var a=n[r];if("string"!=typeof a&&e==a.id){o=r;break}}if(null==o){for(var i=function(o){var r=n[o];if("string"==typeof r)return"continue";var a=r.children||[];a.forEach((function(n){return"string"==typeof n||!!t.removeComponentFrom(e,a)||void 0}))},c=0;c<n.length;c++)i(c);return!1}return 0==o?n.shift():o==n.length-1?n.pop():n.splice(o,1),!0}},{key:"findComponentData",value:function(e){var n=this.state.pageData;if(!n)throw s.Errors.pageDataIsNull();return t.travelComponentData(n,(function(n){return n.id==e}))[0]}},{key:"onKeyDown",value:function(e){if(46==e.keyCode){if(0==this.selectedComponents.length)return;this.removeComponents(this.selectedComponentIds)}}},{key:"findComponetsByTypeName",value:function(e){this.components[e]}},{key:"render",value:function(){var e=this;return u.createElement("div",{tabIndex:0,ref:function(n){return e._element=e._element||n},onKeyDown:function(n){return e.onKeyDown(n)},className:this.props.className,style:this.props.style},u.createElement(n.DesignerContext.Provider,{value:{designer:this}},this.props.children))}},{key:"pageData",get:function(){return this.state.pageData}},{key:"selectedComponentIds",get:function(){return this.selectedComponents.map((function(e){return e.id}))}},{key:"selectedComponents",get:function(){var e=new Array,n=new Array;for(n.push(this.pageData);n.length>0;){var t=n.pop();null!=t.props&&1==t.selected&&e.push(t),(t.children||[]).forEach((function(e){if("string"==typeof e)return!0;n.push(e)}))}return e}},{key:"element",get:function(){return this._element}}])&&a(f.prototype,m),d&&a(f,d),t}(u.Component);n.PageDesigner=f},function(e,t){e.exports=n},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.removeClassName=n.appendClassName=n.classNames=void 0;var o=t(1);n.classNames={componentSelected:"component-selected",emptyTemplates:"empty-templates",loadingTemplates:"loading-templates",templateSelected:"template-selected",templateDialog:"template-dialog",emptyDocument:"empty-document",component:"component",componentWrapper:"component-wrapper",componentPanel:"component-panel",componentIcon:"component-icon",placeholder:"placeholder",editorPanel:"editor-panel",designer:"designer",moveDown:"move-down"};var r=40,a=22,i=document.createElement("style");i.type="text/css",i.setAttribute("data-name","jueying"),i.innerHTML="\n            .".concat(n.classNames.componentSelected," {\n                border: solid 1px #337ab7!important;\n            }\n            .").concat(n.classNames.componentSelected," > :first-child {\n                border-color: blue;\n              }\n              .").concat(n.classNames.componentSelected," .resize_handle {\n                position: absolute;\n                height: 6px;\n                width: 6px;\n                border: 1px solid #89B;\n                background: #9AC;\n              }\n              .").concat(n.classNames.componentSelected," .move_handle {\n                height: 12px;\n                width: 12px;\n                top: 6px;\n                left: 8px;\n                border: solid 1px black;\n                position: relative;\n                margin-top: -12px;\n              }\n              .").concat(n.classNames.componentSelected," .NW,\n              .").concat(n.classNames.componentSelected," .NN,\n              .").concat(n.classNames.componentSelected," .NE {\n                top: -4px;\n              }\n              .").concat(n.classNames.componentSelected," .NE,\n              .").concat(n.classNames.componentSelected," .EE,\n              .").concat(n.classNames.componentSelected," .SE {\n                right: -4px;\n              }\n              .").concat(n.classNames.componentSelected," .SW,\n              .").concat(n.classNames.componentSelected,".SS,\n              .").concat(n.classNames.componentSelected," .SE {\n                bottom: -4px;\n              }\n              .").concat(n.classNames.componentSelected," .NW,\n              .").concat(n.classNames.componentSelected," .WW,\n              .").concat(n.classNames.componentSelected," .SW {\n                left: -4px;\n              }\n              .").concat(n.classNames.componentSelected," .SE,\n              .").concat(n.classNames.componentSelected," .NW {\n                cursor: nw-resize;\n              }\n              .").concat(n.classNames.componentSelected," .SW,\n              .").concat(n.classNames.componentSelected," .NE {\n                cursor: ne-resize;\n              }\n              .").concat(n.classNames.componentSelected," .NN,\n              .").concat(n.classNames.componentSelected," .SS {\n                cursor: n-resize;\n                left: 50%;\n                margin-left: -4px;\n              }\n              .").concat(n.classNames.componentSelected," .EE,\n              .").concat(n.classNames.componentSelected," .WW {\n                cursor: e-resize;\n                top: 50%;\n                margin-top: -4px;\n              }\n            .").concat(n.classNames.emptyTemplates," {\n                padding:50px 0;\n                text-align: center;\n            }\n            .").concat(n.classNames.loadingTemplates," {\n                padding:50px 0;\n                text-align: center;\n            }\n            .").concat(n.classNames.templateSelected," .page-view {\n                border: solid 1px #337ab7!important;\n            }\n            .").concat(n.classNames.templateDialog," .name {\n                margin-top: -").concat(r,"px;\n                height: ").concat(r,"px;\n                font-size: ").concat(a,"px;\n                text-align: center;\n                padding-top: 6px;\n                background-color: black;\n                opacity: 0.5;\n            }\n            .").concat(n.classNames.templateDialog," .name span {\n                color: white;\n            }\n            .").concat(n.classNames.emptyDocument," {\n                text-align: center;\n                padding: 100px 0;\n            }\n            .").concat(n.classNames.component," > .NW,\n            .").concat(n.classNames.component," > .NN,\n            .").concat(n.classNames.component," > .NE,\n            .").concat(n.classNames.component," > .EE,\n            .").concat(n.classNames.component," > .SE,\n            .").concat(n.classNames.component," > .SW,\n            .").concat(n.classNames.component," > .SS,\n            .").concat(n.classNames.component," > .WW {\n                display: none;\n            }\n            .").concat(n.classNames.componentSelected,".component > .NW,\n            .").concat(n.classNames.componentSelected,".component > .NN,\n            .").concat(n.classNames.componentSelected,".component > .NE,\n            .").concat(n.classNames.componentSelected,".component > .EE,\n            .").concat(n.classNames.componentSelected,".component > .SE,\n            .").concat(n.classNames.componentSelected,".component > .SW,\n            .").concat(n.classNames.componentSelected,".component > .SS,\n            .").concat(n.classNames.componentSelected,".component > .WW {\n                display: block;\n            }\n            .").concat(n.classNames.placeholder," {\n                min-height: 40px;\n                width: 100%;\n            }\n            .").concat(n.classNames.placeholder,".active,\n            .").concat(n.classNames.componentWrapper,".active,\n            .").concat(n.classNames.componentWrapper,".").concat(n.classNames.componentSelected,".active {\n                border: 1px solid green;\n            }\n            .").concat(n.classNames.editorPanel," {\n                width: 300px;\n                background: white;\n                color: black;\n                margin: 0;\n                font-size: 14px;\n                z-index: 100;\n                overflow: auto;\n            }\n            .").concat(n.classNames.editorPanel," label {\n                width: 80px;\n                float: left;\n                padding: 4px;\n                text-overflow: ellipsis;\n                overflow: hidden;\n            }\n            .").concat(n.classNames.editorPanel," .control {\n                padding-left: 90px;\n            }\n            .").concat(n.classNames.editorPanel," .empty {\n                padding-top: 200px;\n                text-align: center;\n            }\n            .").concat(n.classNames.designer," .error,\n            .").concat(n.classNames.editorPanel," .error {\n                color: red;\n            }\n            .").concat(n.classNames.componentPanel," {\n                background: white;\n                color: black;\n                font-size: 14px;\n                z-index: 100;\n                list-style: none;\n                padding: 0;\n                text-align: center\n            }\n            .").concat(n.classNames.componentPanel," .panel-heading {\n                text-align: center;\n            }\n            .").concat(n.classNames.componentPanel," li {\n                text-align: center;\n                padding: 8px;\n            }\n            .").concat(n.classNames.componentWrapper,".").concat(n.classNames.moveDown," {\n         \n            }\n        "),null!=document.head&&document.head.appendChild(i),n.appendClassName=function(e,n){if(null==e)throw o.Errors.argumentNull("element");if(!n)throw o.Errors.argumentNull("addonClassName");var t;if(t=(t="string"==typeof e?e:e.className)||"",console.assert(null!=n),t.indexOf(n)>=0)return t;var r="".concat(t," ").concat(n);return"string"!=typeof e&&(e.className=r),r},n.removeClassName=function(e,n){var t;return(t="string"==typeof e?e:e.className||"").indexOf(n)<0?t:(t=(t=(t=t||"").replace(new RegExp(n,"g"),"")).trim(),"string"!=typeof e&&(e.className=t),t)}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ComponentDataHandler=n.classNames=n.TextInput=n.PropEditor=n.DesignerContext=n.PageDesigner=n.EditorPanel=n.Component=n.groupDisplayNames=void 0;var o=t(2);Object.defineProperty(n,"groupDisplayNames",{enumerable:!0,get:function(){return o.groupDisplayNames}});var r=t(3);Object.defineProperty(n,"Component",{enumerable:!0,get:function(){return r.Component}});var a=t(11);Object.defineProperty(n,"EditorPanel",{enumerable:!0,get:function(){return a.EditorPanel}});var i=t(5);Object.defineProperty(n,"PageDesigner",{enumerable:!0,get:function(){return i.PageDesigner}}),Object.defineProperty(n,"DesignerContext",{enumerable:!0,get:function(){return i.DesignerContext}});var c=t(12);Object.defineProperty(n,"PropEditor",{enumerable:!0,get:function(){return c.PropEditor}}),Object.defineProperty(n,"TextInput",{enumerable:!0,get:function(){return c.TextInput}});var l=t(7);Object.defineProperty(n,"classNames",{enumerable:!0,get:function(){return l.classNames}});var u=t(13);Object.defineProperty(n,"ComponentDataHandler",{enumerable:!0,get:function(){return u.ComponentDataHandler}})},function(e,n){e.exports=t},function(e,n){e.exports=o},function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,n){return!n||"object"!==o(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,n){return(c=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.EditorPanel=void 0;var l=t(0),u=t(4),s=t(7),p=function(e){function n(e){var t;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(t=a(this,i(n).call(this,e))).state={componentDatas:[]},t}var t,o,p;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&c(e,n)}(n,e),t=n,(o=[{key:"validateInputs",value:function(){return this.editor.validator.checkAsync()}},{key:"render",value:function(){var e=this,n=this.props.empty;return n=n||l.createElement("div",{className:"empty"},"暂无可用的属性"),l.createElement("div",{className:"".concat(s.classNames.editorPanel," ").concat(this.props.className||""),ref:function(n){return e.element=n||e.element}},l.createElement(u.PropertyEditor,{ref:function(n){return e.editor=n||e.editor},empty:n,customRender:this.props.customRender}))}}])&&r(t.prototype,o),p&&r(t,p),n}(l.Component);n.EditorPanel=p},function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function a(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,n,t){return n&&a(e.prototype,n),t&&a(e,t),e}function c(e,n){return!n||"object"!==o(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&s(e,n)}function s(e,n){return(s=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var p=function(e,n,t,o){return new(t||(t=Promise))((function(r,a){function i(e){try{l(o.next(e))}catch(e){a(e)}}function c(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,c)}l((o=o.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.TextInput=n.PropEditor=void 0;var f=t(0),m=function(e){function n(e){return r(this,n),c(this,l(n).call(this,e))}return u(n,e),i(n,null,[{key:"dropdown",value:function(e,n){return y(e,n)}},{key:"textInput",value:function(){return d}}]),n}(f.Component);n.PropEditor=m;var d=function(e){function n(){return r(this,n),c(this,l(n).apply(this,arguments))}return u(n,e),i(n,[{key:"render",value:function(){var e=this,n=this.props.value;return f.createElement("input",{className:"form-control",value:n||"",onChange:function(n){e.props.updateComponentProp(n.target.value)}})}}]),n}(m);function y(e,n){var t,o=[];if(null==n&&Array.isArray(e)){n=e.length>0&&"number"==typeof e[0]?"number":"string";for(var a=0;a<e.length;a++)o[a]={text:e[a],value:e[a]}}else if(null==n){n="string";for(var s=Object.getOwnPropertyNames(e),d=0;d<s.length;d++)o[d]={text:e[s[d]],value:s[d]}}else Array.isArray(e)?o=e:t=e;return function(e){function a(e){var n;return r(this,a),(n=c(this,l(a).call(this,e))).state={},n}return u(a,e),i(a,[{key:"componentDidMount",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,t;case 3:n=e.sent,this.setState({items:n});case 5:case"end":return e.stop()}}),e,this)})))}},{key:"render",value:function(){var e=this,t=this.state.items,r=this.props.value;return t=t||o,f.createElement("select",{className:"form-control",value:null==r?"":r,onChange:function(t){var o=t.target.value;if("number"==n){r=/^\d+$/.test(o)?parseInt(o):/^[+-]?\d+(\.\d+)?$/.test(o)?parseFloat(o):null}else r=o;e.props.updateComponentProp(r)}},t.map((function(e){return f.createElement("option",{key:e.value,value:e.value},e.text)})))}}]),a}(m)}n.TextInput=d},function(e,n,t){"use strict";function o(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(n,"__esModule",{value:!0}),n.ComponentDataHandler=void 0;var i=t(1),c=t(6),l=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._components={},this.componentSelected=c.Callback.create(),this.componentRemoved=c.Callback.create(),this.componentAppend=c.Callback.create(),this.componentUpdated=c.Callback.create(),this.pageDataChanged=c.Callback.create(),this._pageData=n,this.initComponentData(this._pageData)}var n,t,l;return n=e,l=[{key:"travelComponentData",value:function(e,n){var t=new Array;t.push(e);var a=[];for(n=n||function(){return!0};t.length>0;){var i=t.shift();n(i)&&a.push(i);var c=(i.children||[]).filter((function(e){return"object"==r(e)}));t.push.apply(t,o(c))}return a}},{key:"fillComponent",value:function(n){var t={};if(!n.name){var o,r=0;do{r+=1,o="".concat(n.type).concat(r)}while(t[o]);t[o]=n,n.name=o}n.id||(n.id=c.guid()),n.children=n.children||[],n.children&&0!=n.children.length&&n.children.forEach((function(n){if("string"==typeof n)return!0;e.fillComponent(n)}))}},{key:"setComponetRefProp",value:function(n,t){var o={};e.travelComponentData(n).forEach((function(e){var n=e.props||{};console.assert(null!=e.props&&null!=e.id),o[e.type]=o[e.type]||[],o[e.type].push(e.id);var r=n.ref;n.ref=function(n){null!=n&&(t[e.type]=t[e.type]||[],t[e.type].push(n)),"function"==typeof r&&r(n)}}));for(var r=Object.getOwnPropertyNames(t),a=function(e){var n=r[e],a=o[n]||[];t[n]=(t[n]||[]).filter((function(e){return a.indexOf(e.id||e.props.id)>=0}))},i=0;i<r.length;i++)a(i)}}],(t=[{key:"initComponentData",value:function(n){null!=n&&(n.children=n.children||[],e.fillComponent(n),e.setComponetRefProp(n,this._components))}},{key:"moveComponent",value:function(e,n,t){var o=this.findComponentData(e);if(null==o)throw new Error("Cannt find component by id ".concat(e));console.assert(null!=o,"Cannt find component by id ".concat(e));var r=this.pageData;console.assert(null!=r.children);var a=r.children;this.removeComponentFrom(e,a),this.appendComponent(n,o,t)}},{key:"updateComponentProps",value:function(e){for(var n=[],t=0;t<e.length;t++){var o=e[t],r=o.componentId,a=o.propName,i=o.value,c=this.findComponentData(r);if(null!=c){var l=a.split(".");console.assert(null!=c),console.assert(null!=l,"props is null"),c.props=c.props||{};for(var u=c.props,s=0;s<l.length-1;s++)u=u[l[s]]=u[l[s]]||{};u[l[l.length-1]]=i,n.push(c)}}this.componentUpdated.fire(n)}},{key:"findComponentData",value:function(n){var t=this._pageData;if(!t)throw i.Errors.pageDataIsNull();return e.travelComponentData(t,(function(e){return e.id==n}))[0]}},{key:"removeComponentFrom",value:function(e,n){var t=null;n=n||[];for(var o=0;o<n.length;o++){var r=n[o];if("string"!=typeof r&&e==r.id){t=o;break}}if(null==t){for(var a=0;a<n.length;a++){var i=n[a];if("string"!=typeof i){var c=i.children;if(c&&c.length>0&&this.removeComponentFrom(e,c))return!0}}return!1}return 0==t?n.shift():t==n.length-1?n.pop():n.splice(t,1),!0}},{key:"appendComponent",value:function(e,n,t){if(!e)throw i.Errors.argumentNull("parentId");if(!n)throw i.Errors.argumentNull("childComponent");this.initComponentData(n);var o=this.findComponentData(e);if(null==o)throw new Error("Parent is not exists");console.assert(null!=o),o.children=o.children||[],null!=t?o.children.splice(t,0,n):o.children.push(n),this.selectComponents(n.id),this.componentAppend.fire(this)}},{key:"selectComponent",value:function(e){return this.selectComponents(e)}},{key:"selectComponents",value:function(e){"string"==typeof e&&(e=[e]);var n=[];for(n.push(this._pageData);n.length>0;){var t=n.pop();if(null!=t&&"string"!=typeof t){var o=e.indexOf(t.id)>=0;t.selected=o,(t.children||[]).forEach((function(e){if("string"==typeof e)return!0;n.push(e)}))}}this.componentSelected.fire(this.selectedComponentIds)}},{key:"removeComponent",value:function(e){return this.removeComponents([e])}},{key:"removeComponents",value:function(e){var n=this,t=this.pageData;if(t&&t.children&&0!=t.children.length){var o=t.children;e.forEach((function(e){n.removeComponentFrom(e,o)})),this.componentRemoved.fire(e)}}},{key:"selectedComponents",get:function(){var e=new Array,n=new Array;for(n.push(this._pageData);n.length>0;){var t=n.pop();null!=t.props&&1==t.selected&&e.push(t),(t.children||[]).forEach((function(e){if("string"==typeof e)return!0;n.push(e)}))}return e}},{key:"selectedComponentIds",get:function(){return this.selectedComponents.map((function(e){return e.id}))}},{key:"components",get:function(){return this._components}},{key:"pageData",get:function(){return this._pageData},set:function(e){this._pageData=e,this.initComponentData(e),this.pageDataChanged.fire(e)}}])&&a(n.prototype,t),l&&a(n,l),e}();n.ComponentDataHandler=l}])}));
//# sourceMappingURL=index.es5.min.js.map