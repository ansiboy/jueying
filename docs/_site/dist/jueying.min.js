"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(factory){if("function"==typeof require&&"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof(module))){var target=module.exports||exports,result=factory(require);Object.assign(target,result)}else"function"==typeof define&&define.amd?define(factory):factory()}(function(){var $,$event,drag,origadd,origteardown;return function($){$.fn.drag=function(str,arg,opts){var type="string"==typeof str?str:"",fn=$.isFunction(str)?str:$.isFunction(arg)?arg:null;return 0!==type.indexOf("drag")&&(type="drag"+type),opts=(str==fn?arg:opts)||{},fn?this.bind(type,opts,fn):this.trigger(type)};var $event=$.event,$special=$event.special,drag=$special.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(obj){var data=$.data(this,drag.datakey),opts=obj.data||{};data.related+=1,$.each(drag.defaults,function(key,def){void 0!==opts[key]&&(data[key]=opts[key])})},remove:function(){$.data(this,drag.datakey).related-=1},setup:function(){if(!$.data(this,drag.datakey)){var data=$.extend({related:0},drag.defaults);$.data(this,drag.datakey,data),$event.add(this,"touchstart mousedown",drag.init,data),this.attachEvent&&this.attachEvent("ondragstart",drag.dontstart)}},teardown:function(){($.data(this,drag.datakey)||{}).related||($.removeData(this,drag.datakey),$event.remove(this,"touchstart mousedown",drag.init),drag.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",drag.dontstart))},init:function(event){if(!drag.touched){var results,dd=event.data;if(!(0!=event.which&&0<dd.which&&event.which!=dd.which)&&!$(event.target).is(dd.not)&&(!dd.handle||$(event.target).closest(dd.handle,event.currentTarget).length)&&(drag.touched="touchstart"==event.type?this:null,dd.propagates=1,dd.mousedown=this,dd.interactions=[drag.interaction(this,dd)],dd.target=event.target,dd.pageX=event.pageX,dd.pageY=event.pageY,dd.dragging=null,results=drag.hijack(event,"draginit",dd),dd.propagates))return(results=drag.flatten(results))&&results.length&&(dd.interactions=[],$.each(results,function(){dd.interactions.push(drag.interaction(this,dd))})),dd.propagates=dd.interactions.length,!1!==dd.drop&&$special.drop&&$special.drop.handler(event,dd),drag.textselect(!1),drag.touched?$event.add(drag.touched,"touchmove touchend",drag.handler,dd):$event.add(document,"mousemove mouseup",drag.handler,dd),!(!drag.touched||dd.live)&&void 0}},interaction:function(elem,dd){var offset=$(elem)[dd.relative?"position":"offset"]()||{top:0,left:0};return{drag:elem,callback:new drag.callback,droppable:[],offset:offset}},handler:function(event){var dd=event.data;switch(event.type){case!dd.dragging&&"touchmove":event.preventDefault();case!dd.dragging&&"mousemove":if(Math.pow(event.pageX-dd.pageX,2)+Math.pow(event.pageY-dd.pageY,2)<Math.pow(dd.distance,2))break;event.target=dd.target,drag.hijack(event,"dragstart",dd),dd.propagates&&(dd.dragging=!0);case"touchmove":event.preventDefault();case"mousemove":if(dd.dragging){if(drag.hijack(event,"drag",dd),dd.propagates){!1!==dd.drop&&$special.drop&&$special.drop.handler(event,dd);break}event.type="mouseup"}case"touchend":case"mouseup":default:drag.touched?$event.remove(drag.touched,"touchmove touchend",drag.handler):$event.remove(document,"mousemove mouseup",drag.handler),dd.dragging&&(!1!==dd.drop&&$special.drop&&$special.drop.handler(event,dd),drag.hijack(event,"dragend",dd)),drag.textselect(!0),!1===dd.click&&dd.dragging&&$.data(dd.mousedown,"suppress.click",(new Date).getTime()+5),dd.dragging=drag.touched=!1}},hijack:function(event,type,dd,x,elem){if(dd){var result,ia,callback,orig={event:event.originalEvent,type:event.type},mode=type.indexOf("drop")?"drag":"drop",i=x||0,len=isNaN(x)?dd.interactions.length:x;event.type=type,event.originalEvent=null,dd.results=[];do{if(ia=dd.interactions[i]){if("dragend"!==type&&ia.cancelled)continue;callback=drag.properties(event,dd,ia),ia.results=[],$(elem||ia[mode]||dd.droppable).each(function(p,subject){if(callback.target=subject,!(event.isPropagationStopped=function(){return!1})===(result=subject?$event.dispatch.call(subject,event,callback):null)?("drag"==mode&&(ia.cancelled=!0,dd.propagates-=1),"drop"==type&&(ia[mode][p]=null)):"dropinit"==type&&ia.droppable.push(drag.element(result)||subject),"dragstart"==type&&(ia.proxy=$(drag.element(result)||ia.drag)[0]),ia.results.push(result),delete event.result,"dropinit"!==type)return result}),dd.results[i]=drag.flatten(ia.results),"dropinit"==type&&(ia.droppable=drag.flatten(ia.droppable)),"dragstart"!=type||ia.cancelled||callback.update()}}while(++i<len);return event.type=orig.type,event.originalEvent=orig.event,drag.flatten(dd.results)}},properties:function(event,dd,ia){var obj=ia.callback;return obj.drag=ia.drag,obj.proxy=ia.proxy||ia.drag,obj.startX=dd.pageX,obj.startY=dd.pageY,obj.deltaX=event.pageX-dd.pageX,obj.deltaY=event.pageY-dd.pageY,obj.originalX=ia.offset.left,obj.originalY=ia.offset.top,obj.offsetX=obj.originalX+obj.deltaX,obj.offsetY=obj.originalY+obj.deltaY,obj.drop=drag.flatten((ia.drop||[]).slice()),obj.available=drag.flatten((ia.droppable||[]).slice()),obj},element:function(arg){if(arg&&(arg.jquery||1==arg.nodeType))return arg},flatten:function(arr){return $.map(arr,function(member){return member&&member.jquery?$.makeArray(member):member&&member.length?drag.flatten(member):member})},textselect:function(bool){$(document)[bool?"unbind":"bind"]("selectstart",drag.dontstart).css("MozUserSelect",bool?"":"none"),document.unselectable=bool?"off":"on"},dontstart:function(){return!1},callback:function(){}};drag.callback.prototype={update:function(){$special.drop&&this.available.length&&$.each(this.available,function(i){$special.drop.locate(this,i)})}};var $dispatch=$event.dispatch;$event.dispatch=function(event){if(!(0<$.data(this,"suppress."+event.type)-(new Date).getTime()))return $dispatch.apply(this,arguments);$.removeData(this,"suppress."+event.type)};var touchHooks=$event.fixHooks.touchstart=$event.fixHooks.touchmove=$event.fixHooks.touchend=$event.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(event,orig){if(orig){var touched=orig.touches&&orig.touches[0]||orig.changedTouches&&orig.changedTouches[0]||null;touched&&$.each(touchHooks.props,function(i,prop){event[prop]=touched[prop]})}return event}};$special.draginit=$special.dragstart=$special.dragend=drag}(jQuery),$=jQuery,$event=$.event,drag=$event.special.drag,origadd=drag.add,origteardown=drag.teardown,drag.noBubble=!1,drag.livekey="livedrag",drag.add=function(obj){origadd.apply(this,arguments);var data=$.data(this,drag.datakey);!data.live&&obj.selector&&(data.live=!0,$event.add(this,"draginit."+drag.livekey,drag.delegate))},drag.teardown=function(){origteardown.apply(this,arguments);var data=$.data(this,drag.datakey)||{};data.live&&($event.remove(this,"draginit."+drag.livekey,drag.delegate),data.live=!1)},drag.delegate=function(event){var target,elems=[],events=$.data(this,"events")||{};return $.each(events||[],function(key,arr){0===key.indexOf("drag")&&$.each(arr||[],function(i,obj){(target=$(event.target).closest(obj.selector,event.currentTarget)[0])&&($event.add(target,obj.origType+"."+drag.livekey,obj.origHandler||obj.handler,obj.data),$.inArray(target,elems)<0&&elems.push(target))})}),!!elems.length&&$(elems).bind("dragend."+drag.livekey,function(){$event.remove(this,"."+drag.livekey)})},function($){$.fn.drop=function(str,arg,opts){var type="string"==typeof str?str:"",fn=$.isFunction(str)?str:$.isFunction(arg)?arg:null;return 0!==type.indexOf("drop")&&(type="drop"+type),opts=(str==fn?arg:opts)||{},fn?this.bind(type,opts,fn):this.trigger(type)},$.drop=function(opts){opts=opts||{},drop.multi=!0===opts.multi?1/0:!1===opts.multi?1:isNaN(opts.multi)?drop.multi:opts.multi,drop.delay=opts.delay||drop.delay,drop.tolerance=$.isFunction(opts.tolerance)?opts.tolerance:null===opts.tolerance?null:drop.tolerance,drop.mode=opts.mode||drop.mode||"intersect"};var $special=$.event.special,drop=$.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(obj){$.data(this,drop.datakey).related+=1},remove:function(){$.data(this,drop.datakey).related-=1},setup:function(){if(!$.data(this,drop.datakey)){$.data(this,drop.datakey,{related:0,active:[],anyactive:0,winner:0,location:{}}),drop.targets.push(this)}},teardown:function(){if(!($.data(this,drop.datakey)||{}).related){$.removeData(this,drop.datakey);var element=this;drop.targets=$.grep(drop.targets,function(target){return target!==element})}},handler:function(event,dd){var $targets;if(dd)switch(event.type){case"mousedown":case"touchstart":$targets=$(drop.targets),"string"==typeof dd.drop&&($targets=$targets.filter(dd.drop)),$targets.each(function(){var data=$.data(this,drop.datakey);data.active=[],data.anyactive=0,data.winner=0}),dd.droppable=$targets,$special.drag.hijack(event,"dropinit",dd);break;case"mousemove":case"touchmove":drop.event=event,drop.timer||drop.tolerate(dd);break;case"mouseup":case"touchend":drop.timer=clearTimeout(drop.timer),dd.propagates&&($special.drag.hijack(event,"drop",dd),$special.drag.hijack(event,"dropend",dd))}},locate:function(elem,index){var data=$.data(elem,drop.datakey),$elem=$(elem),posi=$elem.offset()||{},height=$elem.outerHeight(),width=$elem.outerWidth(),location={elem:elem,width:width,height:height,top:posi.top,left:posi.left,right:posi.left+width,bottom:posi.top+height};return data&&(data.location=location,data.index=index,data.elem=elem),location},contains:function(target,test){return(test[0]||test.left)>=target.left&&(test[0]||test.right)<=target.right&&(test[1]||test.top)>=target.top&&(test[1]||test.bottom)<=target.bottom},modes:{intersect:function(event,proxy,target){return this.contains(target,[event.pageX,event.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(event,proxy,target){return Math.max(0,Math.min(target.bottom,proxy.bottom)-Math.max(target.top,proxy.top))*Math.max(0,Math.min(target.right,proxy.right)-Math.max(target.left,proxy.left))},fit:function(event,proxy,target){return this.contains(target,proxy)?1:0},middle:function(event,proxy,target){return this.contains(target,[proxy.left+.5*proxy.width,proxy.top+.5*proxy.height])?1:0}},sort:function(a,b){return b.winner-a.winner||a.index-b.index},tolerate:function(dd){var i,drp,drg,data,arr,len,elem,ia,x=0,end=dd.interactions.length,xy=[drop.event.pageX,drop.event.pageY],tolerance=drop.tolerance||drop.modes[drop.mode];do{if(ia=dd.interactions[x]){if(!ia)return;ia.drop=[],arr=[],len=ia.droppable.length,tolerance&&(drg=drop.locate(ia.proxy)),i=0;do{if(elem=ia.droppable[i]){if(!(drp=(data=$.data(elem,drop.datakey)).location))continue;data.winner=tolerance?tolerance.call(drop,drop.event,drg,drp):drop.contains(drp,xy)?1:0,arr.push(data)}}while(++i<len);for(arr.sort(drop.sort),i=0;(data=arr[i])&&(data.winner&&ia.drop.length<drop.multi?(data.active[x]||data.anyactive||(!1!==$special.drag.hijack(drop.event,"dropstart",dd,x,data.elem)[0]?(data.active[x]=1,data.anyactive+=1):data.winner=0),data.winner&&ia.drop.push(data.elem)):data.active[x]&&1==data.anyactive&&($special.drag.hijack(drop.event,"dropend",dd,x,data.elem),data.active[x]=0,data.anyactive-=1)),++i<len;);}}while(++x<end);drop.last&&xy[0]==drop.last.pageX&&xy[1]==drop.last.pageY?delete drop.timer:drop.timer=setTimeout(function(){drop.tolerate(dd)},drop.delay),drop.last=drop.event}};$special.dropinit=$special.dropstart=$special.dropend=drop}(jQuery),function($){var $event=$.event,drop=$event.special.drop,origadd=drop.add,origteardown=drop.teardown;drop.noBubble=!1,drop.livekey="livedrop",drop.add=function(obj){origadd.apply(this,arguments);var data=$.data(this,drop.datakey);!data.live&&obj.selector&&(data.live=!0,$event.add(this,"dropinit."+drop.livekey,drop.delegate))},drop.teardown=function(){origteardown.apply(this,arguments);var data=$.data(this,drop.datakey)||{};data.live&&($event.remove(this,"dropinit",drop.delegate),data.live=!1)},drop.delegate=function(event,dd){var $targets,elems=[],events=$.data(this,"events")||{};return $.each(events||[],function(key,arr){0===key.indexOf("drop")&&$.each(arr,function(i,obj){($targets=$(event.currentTarget).find(obj.selector)).length&&$targets.each(function(){$event.add(this,obj.origType+"."+drop.livekey,obj.origHandler||obj.handler,obj.data),$.inArray(this,elems)<0&&elems.push(this)})})}),dd&&$event.add(dd.drag,"dragend."+drop.livekey,function(){$.each(elems.concat(this),function(){$event.remove(this,"."+drop.livekey)})}),!!elems.length&&$(elems)}}(jQuery),window.jueying=window.jueying||jueying,jueying});