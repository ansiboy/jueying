{"version":3,"sources":["webpack://jueying/webpack/universalModuleDefinition","webpack://jueying/webpack/bootstrap","webpack://jueying/external \"react\"","webpack://jueying/./out/common.js","webpack://jueying/./out/style.js","webpack://jueying/./out/component.js","webpack://jueying/./out/errors.js","webpack://jueying/./out/component-panel.js","webpack://jueying/./out/page-designer.js","webpack://jueying/./out/index.js","webpack://jueying/./out/component-wrapper.js","webpack://jueying/./out/editor-panel.js","webpack://jueying/./out/property-editor.js","webpack://jueying/./out/prop-editor.js","webpack://jueying/./out/component-factory.js","webpack://jueying/./out/jquery.js","webpack://jueying/external \"jquery\"","webpack://jueying/./lib/jquery.event.drag-2.2.js","webpack://jueying/./lib/jquery.event.drag.live-2.2.js","webpack://jueying/./lib/jquery.event.drop-2.2.js","webpack://jueying/./lib/jquery.event.drop.live-2.2.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__14__","enumerable","get","getter","value","key","bind","Object","prototype","hasOwnProperty","call","object","property","defineProperty","constants","componentsDir","connectorElementClassName","componentTypeName","componentData","componentPosition","proptDisplayNames","guid","s4","Math","floor","random","toString","substring","Callback","this","funcs","Array","func","push","filter","o","args","forEach","errors_1","classNames","componentSelected","emptyTemplates","loadingTemplates","templateSelected","templateDialog","emptyDocument","component","componentWrapper","componentPanel","componentIcon","placeholder","editorPanel","designer","moveDown","element","document","createElement","type","setAttribute","innerHTML","head","appendChild","appendClassName","addonClassName","Errors","argumentNull","sourceClassName","className","console","assert","indexOf","removeClassName","targetClassName","replace","RegExp","trim","React","page_designer_1","style_1","common_1","component_panel_1","DesignerContext","createContext","ComponentWrapperContext","constructor","PageDesigner","Component","name","register","typename","attr","componentAttributes","assign","defaultComponentAttribute","componentType","result","propEditorInfo","componentPropEditors","i","length","propName","display","componentPropEditorDisplay","controlClassName","getPropEditorByArray","propNames","componentTypeOrOptions","editorType","group","editorDisplay","options","displayName","split","classProps","join","h","_createElement","components","componentTypes","context","componentName","controlType","masterPage","children","map","props","text","Fragment","ref","e","MasterPage","typeName","childComponents","error","container","movable","showHandler","resize","MasterPageName","MasterPageContext","master","super","state","arr","isArray","isValidElement","style","minHeight","parentId","Provider","PlaceHolder","id","placeHolderIdNull","getAttribute","addEventListener","event","preventDefault","stopPropagation","dataTransfer","getData","dropEffect","log","layerX","ondrop","ctrl","ComponentPanel","getComponentData","appendComponent","host","$","drop","dd","sourceElement","wraper","source","findComponentData","moveComponent","updateComponentProps","componentId","empty","Consumer","canntFindMasterPage","enableAppendDroppable","enableMoveDroppable","PageView","pageData","propCanntNull","ErrorBoundary","info","setState","message","stack","Error","fileName","argumentName","pluginId","fieldName","component_1","componets","toolbarElement","toolItemElement","draggable","ev","setData","JSON","stringify","x","offsetX","y","offsetY","str","parse","c","componentIndexName","icon","fontSize","color","componentDraggable","component_wrapper_1","create","componentRemoved","componentAppend","componentUpdated","designtimeComponentDidMount","initPageData","add","componentIds","travelComponentData","item","itemRef","names","getOwnPropertyNames","ids","nameComponent","setComponetRefProp","r","selectedComponents","pop","selected","_element","componentProps","componentDatas","navPropsNames","obj","fire","childIds","parentControl","p","child","a","namedComponents","num","componentIndex","splice","selectComponent","position","setComponentsPosition","size","height","width","positions","left","top","isSelectedControl","selectedComponentIds","focus","controlId","removeComponentFrom","childComponentIndex","collection","controlIndex","shift","pageDataIsNull","keyCode","removeComponent","argumentFieldCanntNull","attr1","attr2","wrapperProps","ComponentWrapper","elementTag","tabIndex","componentFactory","renderDesignTimeComponent","onKeyDown","t","defaultProps","editor_panel_1","prop_editor_1","component_factory_1","strings","EditorPanel","PropEditor","TextInput","ComponentFactory","handler","onclick","invokeOnClick","arguments","pos","mouseInnerPosition","startPos","rect","dragStart","drag","is","target","prop","Date","now","max","deltaX","deltaY","setLeft","setTop","setPosition","isResizeHandleClassName","css","click","interval","isDrag","transform","setComponentPosition","setComponentSize","elementID","ctrlKey","selectedControlIds","designtimeBehavior","renderWidthoutWrapper","visibility","move_handle","showResizeHandle","createRawElement","tagName","emtpy","designTimeEmptyElement","designTimeText","property_editor_1","designerComponentChanged","_designer","remove","PropertyEditor","editor","customRender","commonFlatProps","commonPropEditorInfos","propEditorInfos","getPropEditors","items","propInfo1","propInfo2","propName1","propName2","control","controlProps","editors","editorProps","propValue","editComponents","updateComponentProp","getEditors","groupEditorsArray","groupEditors","g","P","Promise","resolve","reject","fulfilled","step","generator","next","rejected","done","then","apply","thisArg","_arguments","valueType","itemsPromise","textValues","__awaiter","onChange","textValue","floatRegex","test","parseInt","parseFloat","dropdown","compentData","renderComponent","j","fn","arg","opts","isFunction","trigger","$event","$special","special","defaults","which","distance","not","handle","relative","datakey","noBubble","data","related","each","def","undefined","setup","extend","init","attachEvent","dontstart","teardown","removeData","textselect","detachEvent","touched","results","closest","currentTarget","propagates","mousedown","interactions","interaction","pageX","pageY","dragging","hijack","flatten","live","elem","offset","callback","droppable","pow","getTime","ia","orig","originalEvent","mode","len","isNaN","cancelled","properties","subject","isPropagationStopped","dispatch","proxy","update","startX","startY","originalX","originalY","slice","available","jquery","nodeType","member","makeArray","bool","unselectable","locate","$dispatch","touchHooks","fixHooks","touchstart","touchmove","touchend","touchcancel","touches","changedTouches","draginit","dragstart","dragend","jQuery","origadd","origteardown","livekey","selector","delegate","elems","events","origType","origHandler","inArray","multi","Infinity","delay","tolerance","targets","active","anyactive","winner","location","grep","$targets","timer","tolerate","clearTimeout","index","$elem","posi","outerHeight","outerWidth","right","bottom","contains","modes","overlap","min","sort","b","drp","drg","end","xy","last","setTimeout","dropinit","dropstart","dropend","find","concat"],"mappings":"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","file":"index.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"), require(\"jquery\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\", \"jquery\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"jueying\"] = factory(require(\"react\"), require(\"jquery\"));\n\telse\n\t\troot[\"jueying\"] = factory(root[\"react\"], root[\"jquery\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__14__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","define([\"require\", \"exports\"], function (require, exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.constants = {\n        componentsDir: 'components',\n        connectorElementClassName: 'component-container',\n        componentTypeName: 'data-component-name',\n        componentData: 'component-data',\n        componentPosition: \"component-position\"\n    };\n    exports.proptDisplayNames = {};\n    function guid() {\n        function s4() {\n            return Math.floor((1 + Math.random()) * 0x10000)\n                .toString(16)\n                .substring(1);\n        }\n        return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n            s4() + '-' + s4() + s4() + s4();\n    }\n    exports.guid = guid;\n    class Callback {\n        constructor() {\n            this.funcs = new Array();\n        }\n        add(func) {\n            this.funcs.push(func);\n        }\n        remove(func) {\n            this.funcs = this.funcs.filter(o => o != func);\n        }\n        fire(args) {\n            this.funcs.forEach(o => o(args));\n        }\n        static create() {\n            return new Callback();\n        }\n    }\n    exports.Callback = Callback;\n});\n//# sourceMappingURL=common.js.map","define([\"require\", \"exports\", \"./errors\"], function (require, exports, errors_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.classNames = {\n        componentSelected: `component-selected`,\n        emptyTemplates: `empty-templates`,\n        loadingTemplates: `loading-templates`,\n        templateSelected: `template-selected`,\n        templateDialog: `template-dialog`,\n        emptyDocument: `empty-document`,\n        component: 'component',\n        componentWrapper: 'component-wrapper',\n        componentPanel: 'component-panel',\n        componentIcon: 'component-icon',\n        placeholder: 'placeholder',\n        editorPanel: 'editor-panel',\n        designer: 'designer',\n        moveDown: 'move-down',\n    };\n    let templateDialog = {\n        nameHeight: 40,\n        fontSize: 22\n    };\n    let element = document.createElement('style');\n    element.type = 'text/css';\n    element.setAttribute(\"data-name\", \"jueying\");\n    element.innerHTML = `\r\n            .${exports.classNames.componentSelected} {\r\n                border: solid 1px #337ab7!important;\r\n            }\r\n            .${exports.classNames.componentSelected} > :first-child {\r\n                border-color: blue;\r\n              }\r\n              .${exports.classNames.componentSelected} .resize_handle {\r\n                position: absolute;\r\n                height: 6px;\r\n                width: 6px;\r\n                border: 1px solid #89B;\r\n                background: #9AC;\r\n              }\r\n              .${exports.classNames.componentSelected} .move_handle {\r\n                height: 12px;\r\n                width: 12px;\r\n                top: 6px;\r\n                left: 8px;\r\n                border: solid 1px black;\r\n                position: relative;\r\n                margin-top: -12px;\r\n              }\r\n              .${exports.classNames.componentSelected} .NW,\r\n              .${exports.classNames.componentSelected} .NN,\r\n              .${exports.classNames.componentSelected} .NE {\r\n                top: -4px;\r\n              }\r\n              .${exports.classNames.componentSelected} .NE,\r\n              .${exports.classNames.componentSelected} .EE,\r\n              .${exports.classNames.componentSelected} .SE {\r\n                right: -4px;\r\n              }\r\n              .${exports.classNames.componentSelected} .SW,\r\n              .${exports.classNames.componentSelected}.SS,\r\n              .${exports.classNames.componentSelected} .SE {\r\n                bottom: -4px;\r\n              }\r\n              .${exports.classNames.componentSelected} .NW,\r\n              .${exports.classNames.componentSelected} .WW,\r\n              .${exports.classNames.componentSelected} .SW {\r\n                left: -4px;\r\n              }\r\n              .${exports.classNames.componentSelected} .SE,\r\n              .${exports.classNames.componentSelected} .NW {\r\n                cursor: nw-resize;\r\n              }\r\n              .${exports.classNames.componentSelected} .SW,\r\n              .${exports.classNames.componentSelected} .NE {\r\n                cursor: ne-resize;\r\n              }\r\n              .${exports.classNames.componentSelected} .NN,\r\n              .${exports.classNames.componentSelected} .SS {\r\n                cursor: n-resize;\r\n                left: 50%;\r\n                margin-left: -4px;\r\n              }\r\n              .${exports.classNames.componentSelected} .EE,\r\n              .${exports.classNames.componentSelected} .WW {\r\n                cursor: e-resize;\r\n                top: 50%;\r\n                margin-top: -4px;\r\n              }\r\n            .${exports.classNames.emptyTemplates} {\r\n                padding:50px 0;\r\n                text-align: center;\r\n            }\r\n            .${exports.classNames.loadingTemplates} {\r\n                padding:50px 0;\r\n                text-align: center;\r\n            }\r\n            .${exports.classNames.templateSelected} .page-view {\r\n                border: solid 1px #337ab7!important;\r\n            }\r\n            .${exports.classNames.templateDialog} .name {\r\n                margin-top: -${templateDialog.nameHeight}px;\r\n                height: ${templateDialog.nameHeight}px;\r\n                font-size: ${templateDialog.fontSize}px;\r\n                text-align: center;\r\n                padding-top: 6px;\r\n                background-color: black;\r\n                opacity: 0.5;\r\n            }\r\n            .${exports.classNames.templateDialog} .name span {\r\n                color: white;\r\n            }\r\n            .${exports.classNames.emptyDocument} {\r\n                text-align: center;\r\n                padding: 100px 0;\r\n            }\r\n            .${exports.classNames.component} > .NW,\r\n            .${exports.classNames.component} > .NN,\r\n            .${exports.classNames.component} > .NE,\r\n            .${exports.classNames.component} > .EE,\r\n            .${exports.classNames.component} > .SE,\r\n            .${exports.classNames.component} > .SW,\r\n            .${exports.classNames.component} > .SS,\r\n            .${exports.classNames.component} > .WW {\r\n                display: none;\r\n            }\r\n            .${exports.classNames.componentSelected}.component > .NW,\r\n            .${exports.classNames.componentSelected}.component > .NN,\r\n            .${exports.classNames.componentSelected}.component > .NE,\r\n            .${exports.classNames.componentSelected}.component > .EE,\r\n            .${exports.classNames.componentSelected}.component > .SE,\r\n            .${exports.classNames.componentSelected}.component > .SW,\r\n            .${exports.classNames.componentSelected}.component > .SS,\r\n            .${exports.classNames.componentSelected}.component > .WW {\r\n                display: block;\r\n            }\r\n            .${exports.classNames.placeholder} {\r\n                min-height: 40px;\r\n                width: 100%;\r\n            }\r\n            .${exports.classNames.placeholder}.active,\r\n            .${exports.classNames.componentWrapper}.active,\r\n            .${exports.classNames.componentWrapper}.${exports.classNames.componentSelected}.active {\r\n                border: 1px solid green;\r\n            }\r\n            .${exports.classNames.editorPanel} {\r\n                width: 300px;\r\n                background: white;\r\n                color: black;\r\n                margin: 0;\r\n                font-size: 14px;\r\n                z-index: 100;\r\n                overflow: auto;\r\n            }\r\n            .${exports.classNames.editorPanel} label {\r\n                width: 80px;\r\n                float: left;\r\n                padding: 4px;\r\n                text-overflow: ellipsis;\r\n                overflow: hidden;\r\n            }\r\n            .${exports.classNames.editorPanel} .control {\r\n                padding-left: 90px;\r\n            }\r\n            .${exports.classNames.editorPanel} .empty {\r\n                padding-top: 200px;\r\n                text-align: center;\r\n            }\r\n            .${exports.classNames.designer} .error,\r\n            .${exports.classNames.editorPanel} .error {\r\n                color: red;\r\n            }\r\n            .${exports.classNames.componentPanel} {\r\n                background: white;\r\n                color: black;\r\n                font-size: 14px;\r\n                z-index: 100;\r\n                list-style: none;\r\n                padding: 0;\r\n                text-align: center\r\n            }\r\n            .${exports.classNames.componentPanel} .panel-heading {\r\n                text-align: center;\r\n            }\r\n            .${exports.classNames.componentPanel} li {\r\n                text-align: center;\r\n                padding: 8px;\r\n            }\r\n            .${exports.classNames.componentWrapper}.${exports.classNames.moveDown} {\r\n         \r\n            }\r\n        `;\n    document.head.appendChild(element);\n    function appendClassName(element, addonClassName) {\n        if (element == null)\n            throw errors_1.Errors.argumentNull('element');\n        if (!addonClassName)\n            throw errors_1.Errors.argumentNull('addonClassName');\n        let sourceClassName;\n        if (typeof element == 'string')\n            sourceClassName = element;\n        else\n            sourceClassName = element.className;\n        sourceClassName = sourceClassName || '';\n        console.assert(addonClassName);\n        if (sourceClassName.indexOf(addonClassName) >= 0)\n            return sourceClassName;\n        let className = `${sourceClassName} ${addonClassName}`;\n        if (typeof element != 'string')\n            element.className = className;\n        return className;\n    }\n    exports.appendClassName = appendClassName;\n    function removeClassName(element, targetClassName) {\n        let sourceClassName;\n        if (typeof element == 'string')\n            sourceClassName = element;\n        else\n            sourceClassName = element.className || '';\n        if (sourceClassName.indexOf(targetClassName) < 0)\n            return sourceClassName;\n        sourceClassName = sourceClassName || '';\n        sourceClassName = sourceClassName.replace(new RegExp(targetClassName, 'g'), '');\n        sourceClassName = sourceClassName.trim();\n        if (typeof element != 'string')\n            element.className = sourceClassName;\n        return sourceClassName;\n    }\n    exports.removeClassName = removeClassName;\n});\n//# sourceMappingURL=style.js.map","define([\"require\", \"exports\", \"react\", \"./page-designer\", \"./errors\", \"./style\", \"./common\", \"./component-panel\"], function (require, exports, React, page_designer_1, errors_1, style_1, common_1, component_panel_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.DesignerContext = React.createContext({ designer: null });\n    exports.ComponentWrapperContext = React.createContext(null);\n    function component(args) {\n        return function (constructor) {\n            if (page_designer_1.PageDesigner) {\n                Component.setAttribute(constructor.name, args);\n            }\n            Component.register(constructor.name, constructor);\n            return constructor;\n        };\n    }\n    exports.component = component;\n    class Component {\n        /**\n         * 设置组件特性\n         * @param typename 组件类型名称\n         * @param attr 组件特性\n         */\n        static setAttribute(typename, attr) {\n            Component.componentAttributes[typename] = attr;\n        }\n        /**\n         * 获取组件特性\n         * @param typename 组件类型名称\n         */\n        static getAttribute(type) {\n            let typename = typeof type == 'string' ? type : type.name;\n            let attr = Component.componentAttributes[typename];\n            return Object.assign({ type }, Component.defaultComponentAttribute, attr || {});\n        }\n        static getPropEditors(componentData) {\n            let componentType = componentData.type;\n            let result = [];\n            let propEditorInfo = this.componentPropEditors[componentType] || [];\n            for (let i = 0; i < propEditorInfo.length; i++) {\n                let propName = propEditorInfo[i].propName;\n                let display = Component.componentPropEditorDisplay[`${componentType}.${propName}`];\n                if (display != null && display(componentData) == false)\n                    continue;\n                result.push(propEditorInfo[i]);\n            }\n            return result;\n            // let classEditors = this.componentPropEditors[componentType] || []\n            // Component.componentPropEditorDisplay[`${className}.${propName}`] = editorDisplay;\n            // return classEditors\n        }\n        static getPropEditor(controlClassName, propName) {\n            return this.getPropEditorByArray(controlClassName, propName);\n        }\n        /** 通过属性数组获取属性的编辑器 */\n        static getPropEditorByArray(controlClassName, propNames) {\n            let classEditors = this.componentPropEditors[controlClassName] || [];\n            let editor = classEditors.filter(o => o.propName == propNames)[0];\n            return editor;\n        }\n        static setPropEditor(componentTypeOrOptions, propName, editorType, group) {\n            let componentType;\n            let editorDisplay;\n            if (typeof componentTypeOrOptions == \"object\") {\n                let options = componentTypeOrOptions;\n                componentType = options.componentType;\n                propName = options.propName;\n                editorType = options.editorType;\n                group = options.group;\n                editorDisplay = options.display;\n                if (options.displayName != null) {\n                    common_1.proptDisplayNames[propName] = options.displayName;\n                }\n            }\n            else {\n                componentType = componentTypeOrOptions;\n            }\n            group = group || '';\n            // 属性可能为导航属性,例如 style.width\n            let propNames = propName.split('.');\n            let className = typeof componentType == 'string' ? componentType : componentType.prototype.typename || componentType.name;\n            Component.componentPropEditorDisplay[`${className}.${propName}`] = editorDisplay;\n            let classProps = Component.componentPropEditors[className] = Component.componentPropEditors[className] || [];\n            for (let i = 0; i < classProps.length; i++) {\n                let propName1 = classProps[i].propName; //classProps[i].propNames.join('.')\n                let propName2 = propNames.join('.');\n                if (propName1 == propName2) {\n                    classProps[i].editorType = editorType;\n                    return;\n                }\n            }\n            classProps.push({ propName, editorType, group });\n        }\n        static createElement(componentData, h) {\n            return Component._createElement(componentData, { components: [], componentTypes: [] }, h);\n        }\n        /**\n         * 将持久化的元素数据转换为 ReactElement\n         * @param componentData 元素数据\n         */\n        static _createElement(componentData, context, h) {\n            if (!componentData)\n                throw errors_1.Errors.argumentNull('componentData');\n            h = h || React.createElement;\n            try {\n                let type = componentData.type;\n                let componentName = componentData.type;\n                let controlType = Component.componentTypes[componentName];\n                if (controlType) {\n                    type = controlType;\n                }\n                let children = componentData.children ? componentData.children.map(o => Component._createElement(o, context, h)) : [];\n                let props = componentData.props == null ? {} : Object.assign({}, componentData.props); //JSON.parse(JSON.stringify(componentData.props));\n                if (controlType != null && controlType[\"defaultProps\"]) {\n                    props = Object.assign({}, controlType[\"defaultProps\"], props);\n                }\n                let result;\n                if (typeof type == 'string') {\n                    if (props.text) {\n                        children.push(props.text);\n                    }\n                    //=========================================\n                    // props.text 非 DOM 的 prop，并且已经使用完\n                    delete props.text;\n                    if (h == React.createElement) {\n                        delete props.attr;\n                    }\n                    //=========================================\n                }\n                let masterPage;\n                type = type == Component.Fragment ? React.Fragment : type;\n                let ref = props.ref;\n                props.ref = function (e) {\n                    if (typeof ref == \"function\")\n                        ref(e);\n                    if (e instanceof MasterPage) {\n                        masterPage = e;\n                        for (let i = 0; i < context.componentTypes.length; i++) {\n                            let typeName = context.componentTypes[i];\n                            let childComponents = masterPage.childComponents[typeName] = masterPage.childComponents[typeName] || [];\n                            childComponents.push(context.components[i]);\n                        }\n                    }\n                    else if (e != null) {\n                        context.components.push(e);\n                        context.componentTypes.push(typeof type == \"string\" ? type : type.name);\n                        // masterPage.componentCreated.fire({ component: e, type: typeof type == \"string\" ? type : type.name });\n                    }\n                };\n                result = h(type, props, ...children);\n                return result;\n            }\n            catch (e) {\n                console.error(e);\n                return null;\n            }\n        }\n        static register(componentName, componentType, attr) {\n            if (componentType == null && typeof componentName == 'function') {\n                componentType = componentName;\n                componentName = componentType.name;\n                componentType['componentName'] = componentName;\n            }\n            if (!componentName)\n                throw errors_1.Errors.argumentNull('componentName');\n            if (!componentType)\n                throw errors_1.Errors.argumentNull('componentType');\n            Component.componentTypes[componentName] = componentType;\n            if (attr)\n                Component.setAttribute(componentName, attr);\n        }\n    }\n    //==========================================\n    // 用于创建 React 的 React.Fragment \n    Component.Fragment = \"\";\n    //==========================================\n    Component.defaultComponentAttribute = {\n        container: false, movable: false, showHandler: false, resize: false\n    };\n    Component.componentAttributes = {\n        'div': { container: true, movable: true, showHandler: true, resize: true },\n        'img': { container: false, movable: true, resize: true },\n        'label': { movable: true },\n        'ul': { container: false, movable: true, showHandler: true, resize: false },\n        'li': { container: true, movable: false, },\n        'table': { container: false, movable: true, showHandler: true, resize: true },\n        'thead': { container: false, movable: false },\n        'tbody': { container: false, movable: false },\n        'tfoot': { container: false, movable: false },\n        'tr': { container: false, movable: false },\n        'td': { container: true, movable: false },\n    };\n    Component.componentPropEditors = {};\n    Component.componentPropEditorDisplay = {};\n    Component.componentTypes = {};\n    exports.Component = Component;\n    exports.MasterPageName = 'MasterPage';\n    exports.MasterPageContext = React.createContext({ master: null });\n    class MasterPage extends React.Component {\n        constructor(props) {\n            super(props);\n            this.childComponents = {};\n            let children = MasterPage.children(props);\n            this.state = { children };\n        }\n        static children(props) {\n            let arr = props.children == null ? [] :\n                Array.isArray(props.children) ? props.children : [props.children];\n            let children = [];\n            arr.forEach(o => {\n                if (!React.isValidElement(o))\n                    return;\n                children.push(o);\n            });\n            return children;\n        }\n        static getDerivedStateFromProps(props) {\n            let children = MasterPage.children(props);\n            return { children };\n        }\n        render() {\n            let props = {};\n            for (let key in this.props) {\n                if (key == 'ref' || key == 'id')\n                    continue;\n                props[key] = this.props[key];\n            }\n            props.style = Object.assign({ minHeight: 40 }, props.style);\n            let children = this.state.children.filter(o => o.props.parentId == null);\n            let master = this;\n            console.assert(master != null);\n            return React.createElement(exports.MasterPageContext.Provider, { value: { master } }, children);\n        }\n    }\n    exports.MasterPage = MasterPage;\n    Component.register(exports.MasterPageName, MasterPage, { container: false });\n    /**\n     * 占位符，用于放置控件\n     */\n    class PlaceHolder extends React.Component {\n        constructor(props) {\n            super(props);\n            if (!this.props.id) {\n                throw errors_1.Errors.placeHolderIdNull();\n            }\n        }\n        /**\n         * 启用拖放操作，以便通过拖放图标添加控件\n         */\n        enableAppendDroppable(element, master) {\n            if (element.getAttribute('enable-append-droppable'))\n                return;\n            element.setAttribute('enable-append-droppable', 'true');\n            console.assert(element != null);\n            element.addEventListener('dragover', function (event) {\n                event.preventDefault();\n                event.stopPropagation();\n                element.className = style_1.appendClassName(element.className || '', 'active');\n                let componentName = event.dataTransfer.getData(common_1.constants.componentData);\n                if (componentName)\n                    event.dataTransfer.dropEffect = \"copy\";\n                else\n                    event.dataTransfer.dropEffect = \"move\";\n                console.log(`dragover: left:${event.layerX} top:${event.layerX}`);\n            });\n            let func = function (event) {\n                event.preventDefault();\n                event.stopPropagation();\n                element.className = style_1.removeClassName(element.className, 'active');\n            };\n            element.addEventListener('dragleave', func);\n            element.addEventListener('dragend', func);\n            element.addEventListener('dragexit', func);\n            element.ondrop = (event) => {\n                event.preventDefault();\n                event.stopPropagation();\n                element.className = style_1.removeClassName(element.className, 'active');\n                let ctrl;\n                if (event.dataTransfer)\n                    ctrl = component_panel_1.ComponentPanel.getComponentData(event.dataTransfer);\n                if (!ctrl)\n                    return;\n                console.assert(this.props.id != null);\n                console.assert(this.designer != null);\n                ctrl.props.parentId = this.props.id;\n                console.assert(master != null, 'host is null');\n                this.designer.appendComponent(master.props.id, ctrl);\n            };\n        }\n        enableMoveDroppable(element, host) {\n            if (element.getAttribute('enable-move-droppable'))\n                return;\n            element.setAttribute('enable-move-droppable', 'true');\n            $(element)\n                .drop('start', (event, dd) => {\n                if (dd.sourceElement.id == this.wraper.props.source.props.id)\n                    return;\n                style_1.appendClassName(element, 'active');\n            })\n                .drop('drop', (event, dd) => {\n                if (dd.sourceElement.id == this.wraper.props.source.props.id)\n                    return;\n                let componentData = this.designer.findComponentData(dd.sourceElement.id);\n                console.assert(componentData != null);\n                let propName = 'parentId';\n                this.designer.moveComponent(dd.sourceElement.id, host.props.id);\n                this.designer.updateComponentProps({\n                    componentId: \"string\", propName: \"string\", value: \"any\"\n                }); //dd.sourceElement.id, propName, this.props.id\n            })\n                .drop('end', (event, dd) => {\n                if (dd.sourceElement.id == this.wraper.props.source.props.id)\n                    return;\n                style_1.removeClassName(element, 'active');\n            });\n        }\n        render() {\n            let empty = this.props.empty || React.createElement(\"div\", { key: common_1.guid(), className: \"empty\" }, \"\\u53EF\\u4EE5\\u62D6\\u62C9\\u63A7\\u4EF6\\u5230\\u8FD9\\u91CC\");\n            return React.createElement(exports.MasterPageContext.Consumer, null, (args) => {\n                let master = args.master;\n                if (master == null)\n                    throw errors_1.Errors.canntFindMasterPage(this.props.id);\n                let children = [];\n                if (master.props && master.props.children) {\n                    let arr;\n                    if (Array.isArray(master.props.children)) {\n                        arr = master.props.children;\n                    }\n                    else {\n                        arr = [master.props.children];\n                    }\n                    children = arr.filter((o) => o.props.parentId != null && o.props.parentId == this.props.id);\n                }\n                return React.createElement(exports.DesignerContext.Consumer, null, args => React.createElement(exports.ComponentWrapperContext.Consumer, null, wraper => {\n                    this.wraper = wraper;\n                    console.assert(this.wraper != null);\n                    if (args.designer != null && children.length == 0) {\n                        children = [empty];\n                    }\n                    let element = React.createElement(React.Fragment, null,\n                        this.props.children,\n                        children);\n                    if (args.designer) {\n                        this.designer = args.designer;\n                        element = React.createElement(\"div\", { key: common_1.guid(), className: style_1.classNames.placeholder, ref: e => {\n                                if (!e)\n                                    return;\n                                this.element = e;\n                                this.enableAppendDroppable(e, master);\n                                this.enableMoveDroppable(e, master);\n                            } }, element);\n                    }\n                    return element;\n                }));\n            });\n        }\n    }\n    exports.PlaceHolder = PlaceHolder;\n    Component.register('PlaceHolder', PlaceHolder);\n    class PageView extends React.Component {\n        constructor(props) {\n            super(props);\n            if (!this.props.pageData)\n                throw errors_1.Errors.propCanntNull(PageView.name, 'pageData');\n        }\n        render() {\n            let element = Component.createElement(this.props.pageData);\n            return element;\n        }\n    }\n    exports.PageView = PageView;\n    class ErrorBoundary extends React.Component {\n        constructor(props) {\n            super(props);\n            this.state = {};\n        }\n        componentDidCatch(error, info) {\n            // Display fallback UI\n            this.setState({ error });\n            // You can also log the error to an error reporting service\n            //   logErrorToMyService(error, info);\n            debugger;\n        }\n        render() {\n            let { error } = this.state || {};\n            if (error) {\n                // You can render any custom fallback UI\n                return React.createElement(\"div\", { className: \"error\" },\n                    React.createElement(\"div\", null, error.message),\n                    React.createElement(\"div\", null, error.stack));\n            }\n            return this.props.children;\n        }\n    }\n    exports.ErrorBoundary = ErrorBoundary;\n});\n//# sourceMappingURL=component.js.map","define([\"require\", \"exports\"], function (require, exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    class Errors {\n        static placeHolderIdNull() {\n            let msg = `Place holder property id cannt be null or empty.`;\n            return new Error(msg);\n        }\n        static fileNotExists(fileName) {\n            return new Error(`File '${fileName}' is not exists.`);\n        }\n        static argumentNull(argumentName) {\n            return new Error(`Argument ${argumentName} is null or empty.`);\n        }\n        static argumentRangeError(argumentName) {\n            return new Error(`Argument ${argumentName} range error.`);\n        }\n        static pageDataIsNull() {\n            return new Error(`Page data is null.`);\n        }\n        static toolbarRequiredKey() {\n            return new Error(`Toolbar has not a key prop.`);\n        }\n        static loadPluginFail(pluginId) {\n            return new Error(`Load plugin '${pluginId}' fail.`);\n        }\n        static idRequired() {\n            return new Error(`Property id is required.`);\n        }\n        static canntFindMasterPage(componentId) {\n            return new Error(`Can not find master page for component container ${componentId}.`);\n        }\n        static propCanntNull(componentName, property) {\n            let msg = `${componentName} property ${property} cannt be null or empty.`;\n            return new Error(msg);\n        }\n        static argumentFieldCanntNull(fieldName, argumentName) {\n            let msg = `${fieldName} of argument ${argumentName} cannt be null or empty.`;\n            return new Error(msg);\n        }\n    }\n    exports.Errors = Errors;\n});\n//# sourceMappingURL=errors.js.map","define([\"require\", \"exports\", \"react\", \"./common\", \"./component\", \"./style\"], function (require, exports, React, common_1, component_1, style_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    class ComponentPanel extends React.Component {\n        constructor(props) {\n            super(props);\n            this.state = { componets: [] };\n        }\n        get element() {\n            return this.toolbarElement;\n        }\n        componentDraggable(toolItemElement, componentData) {\n            console.assert(toolItemElement != null);\n            toolItemElement.draggable = true;\n            toolItemElement.addEventListener('dragstart', function (ev) {\n                componentData.props = componentData.props || {};\n                ev.dataTransfer.setData(common_1.constants.componentData, JSON.stringify(componentData));\n                ev.dataTransfer.setData('mousePosition', JSON.stringify({ x: ev.offsetX, y: ev.offsetY }));\n            });\n        }\n        setComponets(componets) {\n            this.setState({ componets });\n        }\n        static getComponentData(dataTransfer) {\n            var str = dataTransfer.getData(common_1.constants.componentData);\n            if (!str)\n                return;\n            return JSON.parse(str);\n        }\n        /** 获取光标在图标内的位置 */\n        static mouseInnerPosition(dataTransfer) {\n            let str = dataTransfer.getData('mousePosition');\n            if (!str)\n                return;\n            return JSON.parse(str);\n        }\n        render() {\n            let empty = this.props.empty || React.createElement(\"div\", { className: \"empty\" }, \"\\u6682\\u65E0\\u53EF\\u7528\\u7EC4\\u4EF6\");\n            let props = Object.assign({}, this.props);\n            let componets = this.state.componets || [];\n            return React.createElement(component_1.DesignerContext.Consumer, null, context => {\n                this.designer = context.designer;\n                return React.createElement(\"ul\", Object.assign({}, props, { className: `${style_1.classNames.componentPanel} ${this.props.className || \"\"}`, ref: (e) => this.toolbarElement = this.toolbarElement || e }), componets.length == 0 ? empty : componets.map((c, i) => {\n                    let props = { key: i };\n                    props[ComponentPanel.componentIndexName] = `${i}`;\n                    return React.createElement(\"li\", Object.assign({}, props, { className: style_1.classNames.componentIcon }),\n                        React.createElement(\"div\", { className: \"btn-link\" },\n                            React.createElement(\"i\", { className: c.icon, style: { fontSize: 44, color: 'black' }, ref: e => {\n                                    if (!e)\n                                        return;\n                                    let ctrl = c.componentData;\n                                    this.componentDraggable(e, ctrl);\n                                } })),\n                        React.createElement(\"div\", null, c.displayName));\n                }));\n                // return <div {...props as any} className={`${classNames.componentPanel} panel panel-primary`}>\n                //     <div className=\"panel-heading\">工具栏</div>\n                //     <div className=\"panel-body\">\n                //     </div>\n                // </div>\n            });\n        }\n    }\n    ComponentPanel.componentIndexName = \"data-component-index\";\n    exports.ComponentPanel = ComponentPanel;\n});\n//# sourceMappingURL=component-panel.js.map","/*******************************************************************************\n * Copyright (C) maishu All rights reserved.\n *\n * HTML 页面设计器\n *\n * 作者: 麦舒\n * 日期: 2018/5/30\n *\n * 个人博客：   http://www.cnblogs.com/ansiboy/\n * GITHUB:     http://github.com/ansiboy\n * QQ 讨论组：  119038574\n *\n ********************************************************************************/\ndefine([\"require\", \"exports\", \"react\", \"./common\", \"./errors\", \"./component\", \"./style\", \"./component-wrapper\"], function (require, exports, React, common_1, errors_1, component_1, style_1, component_wrapper_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    class PageDesigner extends React.Component {\n        // private components: { [typeName: string]: React.Component[] } = {};\n        constructor(props) {\n            super(props);\n            this.componentSelected = common_1.Callback.create();\n            this.componentRemoved = common_1.Callback.create();\n            this.componentAppend = common_1.Callback.create();\n            this.componentUpdated = common_1.Callback.create();\n            this.designtimeComponentDidMount = common_1.Callback.create();\n            let components = {};\n            PageDesigner.initPageData(props.pageData, components);\n            this.state = { pageData: props.pageData, components };\n            this.designtimeComponentDidMount.add((args) => {\n                console.log(`this:designer event:controlComponentDidMount`);\n            });\n        }\n        static setComponetRefProp(pageData, components) {\n            //=========================================================\n            // 纪录当前 pageData 控件 ID\n            let componentIds = {};\n            //=========================================================\n            PageDesigner.travelComponentData(pageData).forEach(item => {\n                console.assert(item.props != null && item.props.id != null);\n                componentIds[item.type] = componentIds[item.type] || [];\n                componentIds[item.type].push(item.props[\"id\"]);\n                let itemRef = item.props.ref;\n                item.props.ref = (e) => {\n                    if (e != null) {\n                        components[item.type] = components[item.type] || [];\n                        components[item.type].push(e);\n                    }\n                    if (typeof itemRef == \"function\")\n                        itemRef(e);\n                };\n            });\n            //=========================================================\n            // 仅保留 componentIds 中的控件 \n            let names = Object.getOwnPropertyNames(components);\n            for (let i = 0; i < names.length; i++) {\n                let typename = names[i];\n                let ids = componentIds[typename] || [];\n                components[typename] = (components[typename] || []).filter(o => ids.indexOf(o[\"id\"] || o.props[\"id\"]) >= 0);\n            }\n            //=========================================================\n        }\n        static initPageData(pageData, components) {\n            if (pageData == null) {\n                return;\n            }\n            pageData.children = pageData.children || [];\n            PageDesigner.nameComponent(pageData);\n            PageDesigner.setComponetRefProp(pageData, components);\n        }\n        allComponents() {\n            let r = [];\n            for (let key in this.state.components) {\n                r.push(...this.state.components[key]);\n            }\n            return r;\n        }\n        /** 页面数据 */\n        get pageData() {\n            return this.state.pageData;\n        }\n        /** 获取已选择了的组件编号 */\n        get selectedComponentIds() {\n            return this.selectedComponents.map(o => o.props.id);\n        }\n        /** 获取已选择了的组件 */\n        get selectedComponents() {\n            let arr = new Array();\n            let stack = new Array();\n            stack.push(this.pageData);\n            while (stack.length > 0) {\n                let item = stack.pop();\n                if (item.props != null && item.props.selected == true)\n                    arr.push(item);\n                let children = item.children || [];\n                for (let i = 0; i < children.length; i++)\n                    stack.push(children[i]);\n            }\n            return arr;\n        }\n        get element() {\n            return this._element;\n        }\n        updateComponentProp(componentId, propName, value) {\n            return this.updateComponentProps({ componentId, propName, value });\n        }\n        updateComponentProps(...componentProps) {\n            let componentDatas = [];\n            for (let i = 0; i < componentProps.length; i++) {\n                let { componentId, propName, value } = componentProps[i];\n                let componentData = this.findComponentData(componentId);\n                if (componentData == null)\n                    continue;\n                let navPropsNames = propName.split(\".\");\n                console.assert(componentData != null);\n                console.assert(navPropsNames != null, 'props is null');\n                componentData.props = componentData.props || {};\n                let obj = componentData.props;\n                for (let i = 0; i < navPropsNames.length - 1; i++) {\n                    obj = obj[navPropsNames[i]] = obj[navPropsNames[i]] || {};\n                }\n                obj[navPropsNames[navPropsNames.length - 1]] = value;\n                componentDatas.push(componentData);\n            }\n            this.setState(this.state);\n            this.componentUpdated.fire(componentDatas);\n        }\n        sortChildren(parentId, childIds) {\n            if (!parentId)\n                throw errors_1.Errors.argumentNull('parentId');\n            if (!childIds)\n                throw errors_1.Errors.argumentNull('childIds');\n            let pageData = this.state.pageData;\n            let parentControl = this.findComponentData(parentId);\n            if (parentControl == null)\n                throw new Error('Parent is not exists');\n            console.assert(parentControl != null);\n            console.assert(parentControl.children != null);\n            console.assert((parentControl.children || []).length == childIds.length);\n            let p = parentControl;\n            parentControl.children = childIds.map(o => {\n                let child = p.children.filter(a => a.props.id == o)[0];\n                console.assert(child != null, `child ${o} is null`);\n                return child;\n            });\n            this.setState({ pageData });\n        }\n        /**\n         * 对组件及其子控件进行命名\n         * @param component\n         */\n        static nameComponent(component) {\n            let namedComponents = {};\n            let props = component.props = component.props || {};\n            if (!props.name) {\n                let num = 0;\n                let name;\n                do {\n                    num = num + 1;\n                    name = `${component.type}${num}`;\n                } while (namedComponents[name]);\n                namedComponents[name] = component;\n                props.name = name;\n            }\n            if (!props.id)\n                props.id = common_1.guid();\n            if (!component.children || component.children.length == 0) {\n                return;\n            }\n            for (let i = 0; i < component.children.length; i++) {\n                PageDesigner.nameComponent(component.children[i]);\n            }\n        }\n        /**\n         * 添加控件\n         * @param parentId 父控件编号\n         * @param componentData 控件数据\n         * @param componentIndex 新添加组件在子组件中的次序\n         */\n        appendComponent(parentId, componentData, componentIndex) {\n            if (!parentId)\n                throw errors_1.Errors.argumentNull('parentId');\n            if (!componentData)\n                throw errors_1.Errors.argumentNull('childComponent');\n            PageDesigner.nameComponent(componentData);\n            let parentControl = this.findComponentData(parentId);\n            if (parentControl == null)\n                throw new Error('Parent is not exists');\n            console.assert(parentControl != null);\n            parentControl.children = parentControl.children || [];\n            if (componentIndex != null) {\n                parentControl.children.splice(componentIndex, 0, componentData);\n            }\n            else {\n                parentControl.children.push(componentData);\n            }\n            let { pageData } = this.state;\n            this.setState({ pageData });\n            this.selectComponent(componentData.props.id);\n            this.componentAppend.fire(this);\n        }\n        /**\n         * 设置控件位置\n         * @param componentId 组件编号\n         * @param position 组件位置\n         */\n        setComponentPosition(componentId, position) {\n            return this.setComponentsPosition([{ componentId, position }]);\n        }\n        /**\n         * 设置控件大小\n         * @param componentId 组件编号\n         * @param size 组件大小\n         */\n        setComponentSize(componentId, size) {\n            console.assert(componentId != null);\n            console.assert(size != null);\n            let componentData = this.findComponentData(componentId);\n            if (!componentData)\n                throw new Error(`Control ${componentId} is not exits.`);\n            let style = componentData.props.style = (componentData.props.style || {});\n            if (size.height)\n                style.height = size.height;\n            if (size.width)\n                style.width = size.width;\n            let { pageData } = this.state;\n            this.setState({ pageData });\n            this.componentUpdated.fire([componentData]);\n        }\n        setComponentsPosition(positions) {\n            let componentDatas = new Array();\n            positions.forEach(o => {\n                let { componentId } = o;\n                let { left, top } = o.position;\n                let componentData = this.findComponentData(componentId);\n                if (!componentData)\n                    throw new Error(`Control ${componentId} is not exits.`);\n                let style = componentData.props.style = (componentData.props.style || {});\n                if (left)\n                    style.left = left;\n                if (top)\n                    style.top = top;\n                let { pageData } = this.state;\n                this.setState({ pageData });\n                componentDatas.push(componentData);\n            });\n            this.componentUpdated.fire(componentDatas);\n        }\n        /**\n         * 选择指定的控件\n         * @param control 指定的控件\n         */\n        selectComponent(componentIds) {\n            if (typeof componentIds == 'string')\n                componentIds = [componentIds];\n            var stack = [];\n            stack.push(this.pageData);\n            while (stack.length > 0) {\n                let item = stack.pop();\n                let isSelectedControl = componentIds.indexOf(item.props.id) >= 0;\n                item.props.selected = isSelectedControl;\n                let children = item.children || [];\n                for (let i = 0; i < children.length; i++) {\n                    stack.push(children[i]);\n                }\n            }\n            this.setState({ pageData: this.pageData });\n            this.componentSelected.fire(this.selectedComponentIds);\n            //====================================================\n            // 设置焦点，以便获取键盘事件\n            if (this._element)\n                this._element.focus();\n            //====================================================\n        }\n        /** 移除控件 */\n        removeComponent(...componentIds) {\n            let pageData = this.state.pageData;\n            if (!pageData || !pageData.children || pageData.children.length == 0)\n                return;\n            componentIds.forEach(controlId => {\n                this.removeComponentFrom(controlId, pageData.children);\n            });\n            this.setState({ pageData });\n            this.componentRemoved.fire(componentIds);\n        }\n        /**\n         * 移动控件到另外一个控件容器\n         * @param componentId 要移动的组件编号\n         * @param parentId 目标组件编号\n         * @param beforeChildId 组件的前一个子组件编号\n         */\n        moveComponent(componentId, parentId, childComponentIndex) {\n            let component = this.findComponentData(componentId);\n            if (component == null)\n                throw new Error(`Cannt find component by id ${componentId}`);\n            console.assert(component != null, `Cannt find component by id ${componentId}`);\n            let pageData = this.state.pageData;\n            console.assert(pageData.children != null);\n            this.removeComponentFrom(componentId, pageData.children);\n            this.appendComponent(parentId, component, childComponentIndex);\n        }\n        removeComponentFrom(controlId, collection) {\n            let controlIndex = null;\n            for (let i = 0; i < collection.length; i++) {\n                if (controlId == collection[i].props.id) {\n                    controlIndex = i;\n                    break;\n                }\n            }\n            if (controlIndex == null) {\n                for (let i = 0; i < collection.length; i++) {\n                    let o = collection[i];\n                    if (o.children && o.children.length > 0) {\n                        let isRemoved = this.removeComponentFrom(controlId, o.children);\n                        if (isRemoved) {\n                            return true;\n                        }\n                    }\n                }\n                return false;\n            }\n            if (controlIndex == 0) {\n                collection.shift();\n            }\n            else if (controlIndex == collection.length - 1) {\n                collection.pop();\n            }\n            else {\n                collection.splice(controlIndex, 1);\n            }\n            return true;\n        }\n        static travelComponentData(pageData, filter) {\n            let stack = new Array();\n            stack.push(pageData);\n            let r = [];\n            // return new Promise((resolve, reject) => {\n            filter = filter || (() => true);\n            while (stack.length > 0) {\n                let item = stack.shift();\n                if (filter(item)) {\n                    r.push(item);\n                }\n                //===============================================\n                // 子元素有可能为字符串, 过滤出对象\n                let children = (item.children || []).filter(o => typeof o == 'object');\n                //===============================================\n                stack.push(...children);\n            }\n            return r;\n        }\n        findComponetsByTypeName(componentTypeName) {\n            let components = this.state.components[componentTypeName];\n            return components;\n        }\n        findComponentData(componentId) {\n            let pageData = this.state.pageData;\n            if (!pageData)\n                throw errors_1.Errors.pageDataIsNull();\n            // let stack = new Array<ComponentData>();\n            // stack.push(pageData);\n            // while (stack.length > 0) {\n            //     let item = stack.pop();\n            //     if (item == null)\n            //         continue\n            //     if (item.props.id == componentId)\n            //         return item;\n            //     let children = (item.children || []).filter(o => typeof o == 'object') as ComponentData[]\n            //     stack.push(...children);\n            // }\n            let componentDatas = PageDesigner.travelComponentData(pageData, (item) => item.props.id == componentId);\n            return componentDatas[0];\n        }\n        onKeyDown(e) {\n            const DELETE_KEY_CODE = 46;\n            if (e.keyCode == DELETE_KEY_CODE) {\n                if (this.selectedComponents.length == 0)\n                    return;\n                this.removeComponent(...this.selectedComponentIds);\n            }\n        }\n        createDesignTimeElement(type, props, ...children) {\n            if (type == null)\n                throw errors_1.Errors.argumentNull('type');\n            if (props == null)\n                throw errors_1.Errors.argumentNull('props');\n            if (props.id == null)\n                throw errors_1.Errors.argumentFieldCanntNull('id', 'props');\n            console.assert(props.id != null);\n            if (props.id != null)\n                props.key = props.id;\n            //===================================================\n            // 获取对象的 ComponentAttribute ，以从对象 props 中获取的为准\n            let attr1 = component_1.Component.getAttribute(type);\n            console.assert(attr1 != null);\n            let attr2 = props.attr || {};\n            let attr = Object.assign({}, attr1, attr2);\n            delete props.attr;\n            //===================================================\n            let className = props.selected ? style_1.appendClassName(props.className || '', style_1.classNames.componentSelected) : props.className;\n            let wrapperProps = Object.assign({}, props);\n            delete wrapperProps.ref;\n            wrapperProps.className = className;\n            return React.createElement(component_wrapper_1.ComponentWrapper, Object.assign({}, wrapperProps, { designer: this, source: { type, attr, props, children } }));\n        }\n        static getDerivedStateFromProps(props, state) {\n            PageDesigner.initPageData(props.pageData, state.components);\n            return { pageData: props.pageData };\n        }\n        render() {\n            let designer = this;\n            let { pageData } = this.state;\n            let style = this.props.style;\n            let elementTag = this.props.elementTag || \"div\";\n            let result = React.createElement(elementTag, {\n                className: style_1.classNames.designer, tabIndex: 1, style,\n                ref: (e) => {\n                    if (!e)\n                        return;\n                    this._element = e || this._element;\n                    this.props.componentFactory.renderDesignTimeComponent(pageData, e, { designer: this });\n                },\n                onKeyDown: (t) => this.onKeyDown(t)\n            });\n            return result;\n        }\n    }\n    PageDesigner.defaultProps = { pageData: null, };\n    exports.PageDesigner = PageDesigner;\n});\n//# sourceMappingURL=page-designer.js.map","define([\"require\", \"exports\", \"./common\", \"./component\", \"./component-panel\", \"./editor-panel\", \"./page-designer\", \"./prop-editor\", \"./style\", \"./component-factory\", \"./jquery\", \"../lib/jquery.event.drag-2.2\", \"../lib/jquery.event.drag.live-2.2\", \"../lib/jquery.event.drop-2.2\", \"../lib/jquery.event.drop.live-2.2\"], function (require, exports, common_1, component_1, component_panel_1, editor_panel_1, page_designer_1, prop_editor_1, style_1, component_factory_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.strings = common_1.proptDisplayNames;\n    exports.proptDisplayNames = common_1.proptDisplayNames;\n    exports.Component = component_1.Component;\n    exports.DesignerContext = component_1.DesignerContext;\n    exports.MasterPage = component_1.MasterPage;\n    exports.MasterPageContext = component_1.MasterPageContext;\n    exports.ComponentPanel = component_panel_1.ComponentPanel;\n    exports.EditorPanel = editor_panel_1.EditorPanel;\n    exports.PageDesigner = page_designer_1.PageDesigner;\n    exports.PropEditor = prop_editor_1.PropEditor;\n    exports.TextInput = prop_editor_1.TextInput;\n    exports.classNames = style_1.classNames;\n    exports.ComponentFactory = component_factory_1.ComponentFactory;\n});\n//# sourceMappingURL=index.js.map","define([\"require\", \"exports\", \"react\", \"./errors\", \"./common\", \"./component-panel\", \"./style\", \"./component\"], function (require, exports, React, errors_1, common_1, component_panel_1, style_1, component_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    /**\n     * 组件包装器，对组件进行包装，实现组件设计时的行为。\n     * 1. 组件的移动\n     * 2. 组件的拖放\n     */\n    class ComponentWrapper extends React.Component {\n        constructor(props) {\n            super(props);\n        }\n        componentDidCatch(error, info) {\n            // Display fallback UI\n            this.setState({ error });\n            // You can also log the error to an error reporting service\n            //   logErrorToMyService(error, info);\n            debugger;\n        }\n        designtimeBehavior(element, attr) {\n            if (!element)\n                throw errors_1.Errors.argumentNull('element');\n            if (!attr)\n                throw errors_1.Errors.argumentNull('args');\n            if (element.getAttribute('data-behavior')) {\n                return;\n            }\n            element.setAttribute('data-behavior', 'behavior');\n            let designer = this.props.designer;\n            console.assert(attr.container != null);\n            console.assert(attr.movable != null);\n            if (attr.container) {\n                ComponentWrapper.enableAppendDroppable(element, designer);\n            }\n            if (attr.movable) {\n                console.assert(element != null);\n                ComponentWrapper.draggable(designer, element);\n                if (this.handler != null)\n                    ComponentWrapper.draggable(designer, element, this.handler);\n            }\n            else {\n                element.onclick = (ev) => ComponentWrapper.invokeOnClick(ev, designer, element);\n            }\n        }\n        /**\n         * 启用拖放操作，以便通过拖放图标添加控件\n         */\n        static enableAppendDroppable(element, designer) {\n            console.assert(element != null);\n            element.addEventListener('dragover', function (event) {\n                event.preventDefault();\n                event.stopPropagation();\n                let componentName = event.dataTransfer.getData(common_1.constants.componentData);\n                if (componentName)\n                    event.dataTransfer.dropEffect = \"copy\";\n                else\n                    event.dataTransfer.dropEffect = \"move\";\n                console.log(`dragover: left:${event['layerX']} top:${event['layerX']}`);\n            });\n            element.addEventListener(\"drop\", function (event) {\n                event.preventDefault();\n                event.stopPropagation();\n                let args1 = arguments[1];\n                if (!event.dataTransfer)\n                    return;\n                let ctrl = component_panel_1.ComponentPanel.getComponentData(event.dataTransfer);\n                if (!ctrl)\n                    return;\n                ctrl.props.style = ctrl.props.style || {};\n                designer.pageData.props.style = designer.pageData.props.style || {};\n                if (!ctrl.props.style.position) {\n                    ctrl.props.style.position = designer.pageData.props.style.position;\n                }\n                let pos = component_panel_1.ComponentPanel.mouseInnerPosition(event.dataTransfer);\n                console.assert(pos != null);\n                if (ctrl.props.style.position == 'absolute') {\n                    ctrl.props.style.left = event['layerX'] - pos.x;\n                    ctrl.props.style.top = event['layerY'] - pos.y;\n                }\n                designer.appendComponent(element.id, ctrl);\n            });\n        }\n        static isResizeHandleClassName(className) {\n            let classNames = [\n                'resize_handle NE', 'resize_handle NN', 'resize_handle NW',\n                'resize_handle WW', 'resize_handle EE', 'resize_handle SW',\n                'resize_handle SS', 'resize_handle SE',\n            ];\n            return classNames.indexOf(className) >= 0;\n        }\n        static draggable(designer, element, handler) {\n            if (!designer)\n                throw errors_1.Errors.argumentNull('designer');\n            if (!element)\n                throw errors_1.Errors.argumentNull('element');\n            console.assert(element.id != \"\");\n            handler = handler || element;\n            let componentId = element.id;\n            console.assert(componentId != \"\");\n            let startPos;\n            let rect;\n            let dragStart;\n            $(handler)\n                .drag(\"init\", function (ev) {\n                startPos = $(element).position();\n                if ($(this).is(`.${style_1.classNames.componentSelected}`))\n                    return $(`.${style_1.classNames.componentSelected}`);\n            })\n                .drag('start', function (ev, dd) {\n                dd.attr = $(ev.target).prop(\"className\");\n                dd.width = $(this).width();\n                dd.height = $(this).height();\n                dd.sourceElement = element;\n                dragStart = Date.now();\n            })\n                .drag(function (ev, dd) {\n                ev.preventDefault();\n                ev.stopPropagation();\n                console.log(`drop:`);\n                console.log(dd.drop);\n                rect = {};\n                if (dd.attr.indexOf(\"E\") > -1) {\n                    rect.width = Math.max(32, dd.width + dd.deltaX);\n                }\n                if (dd.attr.indexOf(\"S\") > -1) {\n                    rect.height = Math.max(32, dd.height + dd.deltaY);\n                }\n                if (dd.attr.indexOf(\"W\") > -1) {\n                    rect.width = Math.max(32, dd.width - dd.deltaX);\n                    setLeft(dd);\n                }\n                if (dd.attr.indexOf(\"N\") > -1) {\n                    rect.height = Math.max(32, dd.height - dd.deltaY);\n                    setTop(dd);\n                }\n                if (dd.attr.indexOf(\"WW\") >= 0)\n                    setLeft(dd);\n                if (dd.attr.indexOf(\"NE\") >= 0 || dd.attr.indexOf(\"NW\") >= 0 || dd.attr.indexOf(\"SW\") >= 0)\n                    setPosition(dd);\n                if (dd.attr.indexOf(\"NN\") >= 0)\n                    setTop(dd);\n                if (dd.attr.indexOf(\"drag\") > -1) {\n                    rect.top = dd.offsetY;\n                    rect.left = dd.offsetX;\n                }\n                if (!ComponentWrapper.isResizeHandleClassName(dd.attr)) {\n                    setPosition(dd);\n                }\n                if (dd.attr)\n                    $(this).css(rect);\n            }, { click: true })\n                .drag('end', function (ev, dd) {\n                let interval = Date.now() - dragStart;\n                ComponentWrapper.isDrag = interval >= 300;\n                if (!ComponentWrapper.isResizeHandleClassName(dd.attr)) {\n                    let left = startPos.left + dd.deltaX;\n                    let top = startPos.top + dd.deltaY;\n                    designer.setComponentPosition(element.id, { left, top });\n                    element.style.transform = '';\n                }\n                else {\n                    let left, top;\n                    if (dd.attr.indexOf(\"W\") > -1)\n                        left = startPos.left + dd.deltaX;\n                    if (dd.attr.indexOf(\"N\") > -1)\n                        top = startPos.top + dd.deltaY;\n                    element.style.transform = '';\n                    designer.setComponentPosition(element.id, { left, top });\n                    designer.setComponentSize(componentId, rect);\n                }\n            })\n                .click((ev) => {\n                ComponentWrapper.invokeOnClick(ev, designer, element);\n            });\n            let setPosition = (dd) => {\n                console.log(['dd.offsetX, dd.offsetY', dd.offsetX, dd.offsetY]);\n                console.log(dd);\n                element.style.transform = `translate(${dd.deltaX}px,${dd.deltaY}px)`;\n            };\n            let setTop = (dd) => {\n                element.style.transform = `translateY(${dd.deltaY}px)`;\n            };\n            let setLeft = (dd) => {\n                element.style.transform = `translateX(${dd.deltaX}px)`;\n            };\n        }\n        static invokeOnClick(ev, designer, element) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            if (ComponentWrapper.isDrag) {\n                ComponentWrapper.isDrag = false;\n                return;\n            }\n            let elementID = element.id;\n            if (!ev.ctrlKey) {\n                designer.selectComponent(element.id);\n                return;\n            }\n            let selectedControlIds = designer.selectedComponentIds;\n            console.assert(elementID != \"\");\n            if (selectedControlIds.indexOf(elementID) >= 0) {\n                selectedControlIds = selectedControlIds.filter(o => o != elementID);\n            }\n            else {\n                selectedControlIds.push(elementID);\n            }\n            designer.selectComponent(selectedControlIds);\n        }\n        componentDidMount() {\n            if (!this.element) {\n                return;\n            }\n            let attr = this.props.source.attr;\n            this.designtimeBehavior(this.element, attr);\n        }\n        render() {\n            let { error } = this.state || {};\n            if (error) {\n                return React.createElement(\"div\", { className: \"error\" },\n                    React.createElement(\"div\", null, error.message),\n                    React.createElement(\"div\", null, error.stack));\n            }\n            let attr = this.props.source.attr;\n            let shouldWrapper = attr.resize || (typeof this.props.source.type != 'string' && this.props.source.type != component_1.MasterPage);\n            if (!shouldWrapper) {\n                return this.renderWidthoutWrapper();\n            }\n            let props = this.props.source.props;\n            let style = props.style = JSON.parse(JSON.stringify(props.style || {})); // 深复制 style\n            let { top, left, position, width, height, display, visibility } = style;\n            let className = style_1.appendClassName(props.className || '', style_1.classNames.componentWrapper);\n            className = props.selected ? style_1.appendClassName(className, style_1.classNames.componentSelected) : className;\n            let wrapperProps = {\n                id: props.id,\n                className,\n                style: { top, left, position, width, height, display, visibility },\n                ref: (e) => this.element = e || this.element\n            };\n            let move_handle = props.selected && attr.showHandler ? React.createElement(\"div\", { className: \"move_handle\", style: {}, ref: e => this.handler = e || this.handler }) : null;\n            let showResizeHandle = attr.resize && props.style.position == 'absolute' && props.selected;\n            let source = this.props.source;\n            if (props.style) {\n                delete props.style.left;\n                delete props.style.top;\n                delete props.style.position;\n                if (wrapperProps.style.width && wrapperProps.style.width != 'unset')\n                    props.style.width = '100%';\n                if (wrapperProps.style.height && wrapperProps.style.height != 'unset')\n                    props.style.height = '100%';\n            }\n            // source.props.ref = function (e) {\n            // };\n            return React.createElement(component_1.ComponentWrapperContext.Provider, { value: this },\n                React.createElement(\"div\", Object.assign({}, wrapperProps),\n                    move_handle,\n                    showResizeHandle ?\n                        React.createElement(React.Fragment, null,\n                            React.createElement(\"div\", { className: \"resize_handle NE\" }),\n                            React.createElement(\"div\", { className: \"resize_handle NN\" }),\n                            React.createElement(\"div\", { className: \"resize_handle NW\" }),\n                            React.createElement(\"div\", { className: \"resize_handle WW\" }),\n                            React.createElement(\"div\", { className: \"resize_handle EE\" }),\n                            React.createElement(\"div\", { className: \"resize_handle SW\" }),\n                            React.createElement(\"div\", { className: \"resize_handle SS\" }),\n                            React.createElement(\"div\", { className: \"resize_handle SE\" })) : null,\n                    this.createRawElement(source.type, source.props, source.children)));\n        }\n        renderWidthoutWrapper() {\n            let { type, props, children } = this.props.source;\n            let ref = props.ref;\n            props.ref = (e) => {\n                if (typeof ref == \"function\")\n                    ref(e);\n                if (!e)\n                    return;\n                if (e.tagName) {\n                    let attr = this.props.source.attr;\n                    this.designtimeBehavior(e, attr);\n                    return;\n                }\n            };\n            if (props.selected) {\n                props.className = style_1.appendClassName(props.className || '', style_1.classNames.componentSelected);\n            }\n            let element = this.createRawElement(type, props, children);\n            return React.createElement(component_1.ComponentWrapperContext.Provider, { value: this }, element);\n        }\n        createRawElement(type, props, children) {\n            let isEmptyElement = (children || []).length == 0;\n            if (isEmptyElement) {\n                let emtpy = this.designTimeEmptyElement(type, props);\n                if (emtpy != null)\n                    children = [emtpy];\n            }\n            return React.createElement(type, props, ...children);\n        }\n        designTimeEmptyElement(type, props) {\n            if (type == 'input' || type == 'img' || type == 'meta' || type == 'link')\n                return null;\n            let typename = typeof type == 'string' ? type : type.name;\n            let text = this.designTimeText(typename, props);\n            return text;\n        }\n        designTimeText(type, props) {\n            let text = props.text;\n            if (text) {\n                return text;\n            }\n            text = text || props.name || type;\n            return text;\n        }\n    }\n    ComponentWrapper.isDrag = false;\n    exports.ComponentWrapper = ComponentWrapper;\n});\n//# sourceMappingURL=component-wrapper.js.map","define([\"require\", \"exports\", \"react\", \"./property-editor\", \"./style\"], function (require, exports, React, property_editor_1, style_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    class EditorPanel extends React.Component {\n        constructor(props) {\n            super(props);\n            this.state = { componentDatas: [], designer: null };\n            this.designerComponentChanged = () => {\n                console.assert(this.designer != null);\n                this.setState({ designer: this.designer });\n            };\n        }\n        get designer() {\n            return this._designer;\n        }\n        set designer(value) {\n            if (this._designer) {\n                this._designer.componentRemoved.remove(this.designerComponentChanged);\n                this._designer.componentAppend.remove(this.designerComponentChanged);\n                this._designer.componentUpdated.remove(this.designerComponentChanged);\n                this._designer.componentSelected.remove(this.designerComponentChanged);\n            }\n            if (value) {\n                value.componentRemoved.add(this.designerComponentChanged);\n                value.componentAppend.add(this.designerComponentChanged);\n                value.componentUpdated.add(this.designerComponentChanged);\n                value.componentSelected.add(this.designerComponentChanged);\n            }\n            this._designer = value;\n            this.setState({ designer: value });\n        }\n        render() {\n            let { empty } = this.props;\n            empty = empty || React.createElement(\"div\", { className: \"empty\" }, \"\\u6682\\u65E0\\u53EF\\u7528\\u7684\\u5C5E\\u6027\");\n            let { designer } = this.state;\n            return React.createElement(\"div\", { className: `${style_1.classNames.editorPanel} ${this.props.className || \"\"}`, ref: (e) => this.element = e || this.element },\n                React.createElement(property_editor_1.PropertyEditor, { designer: designer, ref: e => this.editor = e || this.editor, empty: empty, customRender: this.props.customRender }));\n        }\n    }\n    exports.EditorPanel = EditorPanel;\n});\n//# sourceMappingURL=editor-panel.js.map","/*******************************************************************************\n * Copyright (C) maishu All rights reserved.\n *\n * HTML 页面设计器\n *\n * 作者: 寒烟\n * 日期: 2018/5/30\n *\n * 个人博客：   http://www.cnblogs.com/ansiboy/\n * GITHUB:     http://github.com/ansiboy\n * QQ 讨论组：  119038574\n *\n ********************************************************************************/\ndefine([\"require\", \"exports\", \"react\", \"./component\", \"./common\", \"./errors\"], function (require, exports, React, component_1, common_1, errors_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    class PropertyEditor extends React.Component {\n        constructor(props) {\n            super(props);\n            this._element = null;\n            this.state = { designer: this.props.designer };\n        }\n        static getDerivedStateFromProps(props, state) {\n            return { designer: props.designer };\n        }\n        getEditors(designer) {\n            if (designer == null) {\n                return [];\n            }\n            // 各个控件相同的编辑器\n            let commonPropEditorInfos = [];\n            let selectedComponents = designer.selectedComponents;\n            for (let i = 0; i < selectedComponents.length; i++) {\n                let componentData = selectedComponents[i];\n                let propEditorInfos = component_1.Component.getPropEditors(componentData);\n                if (i == 0) {\n                    commonPropEditorInfos = propEditorInfos || [];\n                }\n                else {\n                    let items = [];\n                    commonPropEditorInfos.forEach(propInfo1 => {\n                        propEditorInfos.forEach(propInfo2 => {\n                            let propName1 = propInfo1.propName; //propInfo1.propNames.join('.')\n                            let propName2 = propInfo2.propName; //propInfo2.propNames.join('.')\n                            if (propInfo1.editorType == propInfo2.editorType && propName1 == propName2) {\n                                items.push(propInfo1);\n                            }\n                        });\n                    });\n                    commonPropEditorInfos = items;\n                }\n            }\n            // 各个控件相同的属性值\n            let commonFlatProps;\n            for (let i = 0; i < selectedComponents.length; i++) {\n                let control = selectedComponents[i];\n                let controlProps = Object.assign({}, control.props);\n                delete controlProps.children;\n                // controlProps = this.flatProps(controlProps)\n                if (i == 0) {\n                    commonFlatProps = controlProps;\n                }\n                else {\n                    let obj = {};\n                    for (let key in commonFlatProps) {\n                        if (commonFlatProps[key] == controlProps[key])\n                            obj[key] = controlProps[key];\n                    }\n                    commonFlatProps = obj;\n                }\n            }\n            let editors = [];\n            for (let i = 0; i < commonPropEditorInfos.length; i++) {\n                let propEditorInfo = commonPropEditorInfos[i];\n                let propName = propEditorInfo.propName;\n                ;\n                let editorType = propEditorInfo.editorType;\n                let value = this.propValue(propName, commonFlatProps);\n                let editorProps = {\n                    value: value,\n                    editComponents: selectedComponents,\n                    updateComponentProp: (value) => {\n                        let componentProps = selectedComponents.map(o => ({\n                            componentId: o.props.id, propName: propEditorInfo.propName, value\n                        }));\n                        designer.updateComponentProps(...componentProps);\n                    }\n                };\n                let editor = React.createElement(editorType, editorProps);\n                editors.push({ prop: propEditorInfo.propName, editor, group: propEditorInfo.group });\n            }\n            return editors;\n        }\n        propValue(propName, props) {\n            if (!propName)\n                throw errors_1.Errors.argumentNull(\"propName\");\n            if (!props)\n                throw errors_1.Errors.argumentNull(\"props\");\n            let navPropsNames = propName.split(\".\");\n            let obj = props;\n            for (let i = 0; i < navPropsNames.length; i++) {\n                obj = obj[navPropsNames[i]];\n                if (obj == null)\n                    return null;\n            }\n            return obj;\n        }\n        render() {\n            let { designer } = this.state;\n            let editors = this.getEditors(designer);\n            if (editors.length == 0) {\n                let empty = this.props.empty;\n                return React.createElement(\"div\", { className: \"text-center\" }, empty);\n            }\n            if (this.props.customRender) {\n                let items = editors.map(o => Object.assign({ displayName: common_1.proptDisplayNames[o.prop] || o.prop }, o));\n                let r = this.props.customRender(designer.selectedComponents, items);\n                if (r != null) {\n                    return r;\n                }\n            }\n            let groupEditorsArray = [];\n            for (let i = 0; i < editors.length; i++) {\n                let group = editors[i].group || '';\n                let groupEditors = groupEditorsArray.filter(o => o.group == group)[0];\n                if (groupEditors == null) {\n                    groupEditors = { group: editors[i].group, editors: [] };\n                    groupEditorsArray.push(groupEditors);\n                }\n                groupEditors.editors.push({ prop: editors[i].prop, editor: editors[i].editor });\n            }\n            return React.createElement(React.Fragment, null, groupEditorsArray.map((g) => React.createElement(\"div\", { key: g.group, className: \"panel panel-default\" },\n                g.group ? React.createElement(\"div\", { className: \"panel-heading\" }, common_1.proptDisplayNames[g.group] || g.group) : null,\n                React.createElement(\"div\", { className: \"panel-body\" }, g.editors.map((o, i) => React.createElement(\"div\", { key: o.prop, className: \"form-group clearfix\" },\n                    React.createElement(\"label\", null, common_1.proptDisplayNames[o.prop] || o.prop),\n                    React.createElement(\"div\", { className: \"control\" },\n                        React.createElement(component_1.ErrorBoundary, null, o.editor))))))));\n        }\n        get element() {\n            return this._element;\n        }\n    }\n    exports.PropertyEditor = PropertyEditor;\n});\n//# sourceMappingURL=property-editor.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\ndefine([\"require\", \"exports\", \"react\"], function (require, exports, React) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    class PropEditor extends React.Component {\n        constructor(props) {\n            super(props);\n        }\n        static dropdown(items, valueType) {\n            return dropdown(items, valueType);\n        }\n        static textInput() {\n            return TextInput;\n        }\n    }\n    exports.PropEditor = PropEditor;\n    class TextInput extends PropEditor {\n        render() {\n            let { value } = this.props;\n            return React.createElement(\"input\", { className: 'form-control', value: value || '', onChange: e => {\n                    // this.setState({ value: e.target.value })\n                    this.props.updateComponentProp(e.target.value);\n                } });\n        }\n    }\n    exports.TextInput = TextInput;\n    function dropdown(items, valueType) {\n        let itemsPromise;\n        let textValues = [];\n        if (valueType == null && Array.isArray(items)) {\n            valueType = items.length > 0 && typeof items[0] == \"number\" ? \"number\" : \"string\";\n            for (let i = 0; i < items.length; i++) {\n                textValues[i] = { text: items[i], value: items[i] };\n            }\n        }\n        else if (valueType == null) {\n            valueType = \"string\";\n            let propNames = Object.getOwnPropertyNames(items);\n            for (let i = 0; i < propNames.length; i++) {\n                textValues[i] = { text: items[propNames[i]], value: propNames[i] };\n            }\n        }\n        else if (Array.isArray(items)) {\n            textValues = items;\n        }\n        else {\n            itemsPromise = items;\n        }\n        class Dropdown extends PropEditor {\n            constructor(props) {\n                super(props);\n                this.state = {};\n            }\n            componentDidMount() {\n                return __awaiter(this, void 0, void 0, function* () {\n                    if (itemsPromise) {\n                        let items = yield itemsPromise;\n                        this.setState({ items });\n                    }\n                });\n            }\n            render() {\n                let { items } = this.state;\n                let { value } = this.props;\n                items = items || textValues;\n                return React.createElement(\"select\", { className: 'form-control', value: value == null ? \"\" : value, onChange: e => {\n                        let textValue = e.target.value;\n                        if (valueType == \"number\") {\n                            let integerRegex = /^\\d+$/;\n                            let floatRegex = /^[+-]?\\d+(\\.\\d+)?$/;\n                            if (integerRegex.test(textValue))\n                                value = parseInt(textValue);\n                            else if (floatRegex.test(textValue))\n                                value = parseFloat(textValue);\n                            else\n                                value = null;\n                        }\n                        else {\n                            value = textValue;\n                        }\n                        this.props.updateComponentProp(value);\n                    } }, items.map(o => React.createElement(\"option\", { key: o.value, value: o.value }, o.text)));\n            }\n        }\n        return Dropdown;\n    }\n});\n//# sourceMappingURL=prop-editor.js.map","define([\"require\", \"exports\"], function (require, exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    class ComponentFactory {\n        renderDesignTimeComponent(compentData, element, context) {\n            this.renderComponent(compentData, element, context);\n        }\n    }\n    exports.ComponentFactory = ComponentFactory;\n});\n//# sourceMappingURL=component-factory.js.map","define([\"require\", \"exports\", \"jquery\"], function (require, exports, j) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    let jquery = window['$'] || window['jQuery'];\n    if (jquery == null) {\n        window['$'] = window['jQuery'] = j;\n    }\n});\n//# sourceMappingURL=jquery.js.map","module.exports = __WEBPACK_EXTERNAL_MODULE__14__;","/*! \r\n * jquery.event.drag - v 2.2\r\n * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com\r\n * Open Source MIT License - http://threedubmedia.com/code/license\r\n */\r\n// Created: 2008-06-04 \r\n// Updated: 2012-05-21\r\n// REQUIRES: jquery 1.7.x\r\n\r\n;(function( $ ){\r\n\r\n// add the jquery instance method\r\n$.fn.drag = function( str, arg, opts ){\r\n\t// figure out the event type\r\n\tvar type = typeof str == \"string\" ? str : \"\",\r\n\t// figure out the event handler...\r\n\tfn = $.isFunction( str ) ? str : $.isFunction( arg ) ? arg : null;\r\n\t// fix the event type\r\n\tif ( type.indexOf(\"drag\") !== 0 ) \r\n\t\ttype = \"drag\"+ type;\r\n\t// were options passed\r\n\topts = ( str == fn ? arg : opts ) || {};\r\n\t// trigger or bind event handler\r\n\treturn fn ? this.bind( type, opts, fn ) : this.trigger( type );\r\n};\r\n\r\n// local refs (increase compression)\r\nvar $event = $.event, \r\n$special = $event.special,\r\n// configure the drag special event \r\ndrag = $special.drag = {\r\n\t\r\n\t// these are the default settings\r\n\tdefaults: {\r\n\t\twhich: 1, // mouse button pressed to start drag sequence\r\n\t\tdistance: 0, // distance dragged before dragstart\r\n\t\tnot: ':input', // selector to suppress dragging on target elements\r\n\t\thandle: null, // selector to match handle target elements\r\n\t\trelative: false, // true to use \"position\", false to use \"offset\"\r\n\t\tdrop: true, // false to suppress drop events, true or selector to allow\r\n\t\tclick: false // false to suppress click events after dragend (no proxy)\r\n\t},\r\n\t\r\n\t// the key name for stored drag data\r\n\tdatakey: \"dragdata\",\r\n\t\r\n\t// prevent bubbling for better performance\r\n\tnoBubble: true,\r\n\t\r\n\t// count bound related events\r\n\tadd: function( obj ){ \r\n\t\t// read the interaction data\r\n\t\tvar data = $.data( this, drag.datakey ),\r\n\t\t// read any passed options \r\n\t\topts = obj.data || {};\r\n\t\t// count another realted event\r\n\t\tdata.related += 1;\r\n\t\t// extend data options bound with this event\r\n\t\t// don't iterate \"opts\" in case it is a node \r\n\t\t$.each( drag.defaults, function( key, def ){\r\n\t\t\tif ( opts[ key ] !== undefined )\r\n\t\t\t\tdata[ key ] = opts[ key ];\r\n\t\t});\r\n\t},\r\n\t\r\n\t// forget unbound related events\r\n\tremove: function(){\r\n\t\t$.data( this, drag.datakey ).related -= 1;\r\n\t},\r\n\t\r\n\t// configure interaction, capture settings\r\n\tsetup: function(){\r\n\t\t// check for related events\r\n\t\tif ( $.data( this, drag.datakey ) ) \r\n\t\t\treturn;\r\n\t\t// initialize the drag data with copied defaults\r\n\t\tvar data = $.extend({ related:0 }, drag.defaults );\r\n\t\t// store the interaction data\r\n\t\t$.data( this, drag.datakey, data );\r\n\t\t// bind the mousedown event, which starts drag interactions\r\n\t\t$event.add( this, \"touchstart mousedown\", drag.init, data );\r\n\t\t// prevent image dragging in IE...\r\n\t\tif ( this.attachEvent ) \r\n\t\t\tthis.attachEvent(\"ondragstart\", drag.dontstart ); \r\n\t},\r\n\t\r\n\t// destroy configured interaction\r\n\tteardown: function(){\r\n\t\tvar data = $.data( this, drag.datakey ) || {};\r\n\t\t// check for related events\r\n\t\tif ( data.related ) \r\n\t\t\treturn;\r\n\t\t// remove the stored data\r\n\t\t$.removeData( this, drag.datakey );\r\n\t\t// remove the mousedown event\r\n\t\t$event.remove( this, \"touchstart mousedown\", drag.init );\r\n\t\t// enable text selection\r\n\t\tdrag.textselect( true ); \r\n\t\t// un-prevent image dragging in IE...\r\n\t\tif ( this.detachEvent ) \r\n\t\t\tthis.detachEvent(\"ondragstart\", drag.dontstart ); \r\n\t},\r\n\t\t\r\n\t// initialize the interaction\r\n\tinit: function( event ){ \r\n\t\t// sorry, only one touch at a time\r\n\t\tif ( drag.touched ) \r\n\t\t\treturn;\r\n\t\t// the drag/drop interaction data\r\n\t\tvar dd = event.data, results;\r\n\t\t// check the which directive\r\n\t\tif ( event.which != 0 && dd.which > 0 && event.which != dd.which ) \r\n\t\t\treturn; \r\n\t\t// check for suppressed selector\r\n\t\tif ( $( event.target ).is( dd.not ) ) \r\n\t\t\treturn;\r\n\t\t// check for handle selector\r\n\t\tif ( dd.handle && !$( event.target ).closest( dd.handle, event.currentTarget ).length ) \r\n\t\t\treturn;\r\n\r\n\t\tdrag.touched = event.type == 'touchstart' ? this : null;\r\n\t\tdd.propagates = 1;\r\n\t\tdd.mousedown = this;\r\n\t\tdd.interactions = [ drag.interaction( this, dd ) ];\r\n\t\tdd.target = event.target;\r\n\t\tdd.pageX = event.pageX;\r\n\t\tdd.pageY = event.pageY;\r\n\t\tdd.dragging = null;\r\n\t\t// handle draginit event... \r\n\t\tresults = drag.hijack( event, \"draginit\", dd );\r\n\t\t// early cancel\r\n\t\tif ( !dd.propagates )\r\n\t\t\treturn;\r\n\t\t// flatten the result set\r\n\t\tresults = drag.flatten( results );\r\n\t\t// insert new interaction elements\r\n\t\tif ( results && results.length ){\r\n\t\t\tdd.interactions = [];\r\n\t\t\t$.each( results, function(){\r\n\t\t\t\tdd.interactions.push( drag.interaction( this, dd ) );\r\n\t\t\t});\r\n\t\t}\r\n\t\t// remember how many interactions are propagating\r\n\t\tdd.propagates = dd.interactions.length;\r\n\t\t// locate and init the drop targets\r\n\t\tif ( dd.drop !== false && $special.drop ) \r\n\t\t\t$special.drop.handler( event, dd );\r\n\t\t// disable text selection\r\n\t\tdrag.textselect( false ); \r\n\t\t// bind additional events...\r\n\t\tif ( drag.touched )\r\n\t\t\t$event.add( drag.touched, \"touchmove touchend\", drag.handler, dd );\r\n\t\telse \r\n\t\t\t$event.add( document, \"mousemove mouseup\", drag.handler, dd );\r\n\t\t// helps prevent text selection or scrolling\r\n\t\tif ( !drag.touched || dd.live )\r\n\t\t\treturn false;\r\n\t},\t\r\n\t\r\n\t// returns an interaction object\r\n\tinteraction: function( elem, dd ){\r\n\t\tvar offset = $( elem )[ dd.relative ? \"position\" : \"offset\" ]() || { top:0, left:0 };\r\n\t\treturn {\r\n\t\t\tdrag: elem, \r\n\t\t\tcallback: new drag.callback(), \r\n\t\t\tdroppable: [],\r\n\t\t\toffset: offset\r\n\t\t};\r\n\t},\r\n\t\r\n\t// handle drag-releatd DOM events\r\n\thandler: function( event ){ \r\n\t\t// read the data before hijacking anything\r\n\t\tvar dd = event.data;\t\r\n\t\t// handle various events\r\n\t\tswitch ( event.type ){\r\n\t\t\t// mousemove, check distance, start dragging\r\n\t\t\tcase !dd.dragging && 'touchmove': \r\n\t\t\t\tevent.preventDefault();\r\n\t\t\tcase !dd.dragging && 'mousemove':\r\n\t\t\t\t//  drag tolerance, x� + y� = distance�\r\n\t\t\t\tif ( Math.pow(  event.pageX-dd.pageX, 2 ) + Math.pow(  event.pageY-dd.pageY, 2 ) < Math.pow( dd.distance, 2 ) ) \r\n\t\t\t\t\tbreak; // distance tolerance not reached\r\n\t\t\t\tevent.target = dd.target; // force target from \"mousedown\" event (fix distance issue)\r\n\t\t\t\tdrag.hijack( event, \"dragstart\", dd ); // trigger \"dragstart\"\r\n\t\t\t\tif ( dd.propagates ) // \"dragstart\" not rejected\r\n\t\t\t\t\tdd.dragging = true; // activate interaction\r\n\t\t\t// mousemove, dragging\r\n\t\t\tcase 'touchmove':\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\tcase 'mousemove':\r\n\t\t\t\tif ( dd.dragging ){\r\n\t\t\t\t\t// trigger \"drag\"\t\t\r\n\t\t\t\t\tdrag.hijack( event, \"drag\", dd );\r\n\t\t\t\t\tif ( dd.propagates ){\r\n\t\t\t\t\t\t// manage drop events\r\n\t\t\t\t\t\tif ( dd.drop !== false && $special.drop )\r\n\t\t\t\t\t\t\t$special.drop.handler( event, dd ); // \"dropstart\", \"dropend\"\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tbreak; // \"drag\" not rejected, stop\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.type = \"mouseup\"; // helps \"drop\" handler behave\r\n\t\t\t\t}\r\n\t\t\t// mouseup, stop dragging\r\n\t\t\tcase 'touchend': \r\n\t\t\tcase 'mouseup': \r\n\t\t\tdefault:\r\n\t\t\t\tif ( drag.touched )\r\n\t\t\t\t\t$event.remove( drag.touched, \"touchmove touchend\", drag.handler ); // remove touch events\r\n\t\t\t\telse \r\n\t\t\t\t\t$event.remove( document, \"mousemove mouseup\", drag.handler ); // remove page events\t\r\n\t\t\t\tif ( dd.dragging ){\r\n\t\t\t\t\tif ( dd.drop !== false && $special.drop )\r\n\t\t\t\t\t\t$special.drop.handler( event, dd ); // \"drop\"\r\n\t\t\t\t\tdrag.hijack( event, \"dragend\", dd ); // trigger \"dragend\"\t\r\n\t\t\t\t}\r\n\t\t\t\tdrag.textselect( true ); // enable text selection\r\n\t\t\t\t// if suppressing click events...\r\n\t\t\t\tif ( dd.click === false && dd.dragging )\r\n\t\t\t\t\t$.data( dd.mousedown, \"suppress.click\", new Date().getTime() + 5 );\r\n\t\t\t\tdd.dragging = drag.touched = false; // deactivate element\t\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t},\r\n\t\t\r\n\t// re-use event object for custom events\r\n\thijack: function( event, type, dd, x, elem ){\r\n\t\t// not configured\r\n\t\tif ( !dd ) \r\n\t\t\treturn;\r\n\t\t// remember the original event and type\r\n\t\tvar orig = { event:event.originalEvent, type:event.type },\r\n\t\t// is the event drag related or drog related?\r\n\t\tmode = type.indexOf(\"drop\") ? \"drag\" : \"drop\",\r\n\t\t// iteration vars\r\n\t\tresult, i = x || 0, ia, $elems, callback,\r\n\t\tlen = !isNaN( x ) ? x : dd.interactions.length;\r\n\t\t// modify the event type\r\n\t\tevent.type = type;\r\n\t\t// remove the original event\r\n\t\tevent.originalEvent = null;\r\n\t\t// initialize the results\r\n\t\tdd.results = [];\r\n\t\t// handle each interacted element\r\n\t\tdo if ( ia = dd.interactions[ i ] ){\r\n\t\t\t// validate the interaction\r\n\t\t\tif ( type !== \"dragend\" && ia.cancelled )\r\n\t\t\t\tcontinue;\r\n\t\t\t// set the dragdrop properties on the event object\r\n\t\t\tcallback = drag.properties( event, dd, ia );\r\n\t\t\t// prepare for more results\r\n\t\t\tia.results = [];\r\n\t\t\t// handle each element\r\n\t\t\t$( elem || ia[ mode ] || dd.droppable ).each(function( p, subject ){\r\n\t\t\t\t// identify drag or drop targets individually\r\n\t\t\t\tcallback.target = subject;\r\n\t\t\t\t// force propagtion of the custom event\r\n\t\t\t\tevent.isPropagationStopped = function(){ return false; };\r\n\t\t\t\t// handle the event\t\r\n\t\t\t\tresult = subject ? $event.dispatch.call( subject, event, callback ) : null;\r\n\t\t\t\t// stop the drag interaction for this element\r\n\t\t\t\tif ( result === false ){\r\n\t\t\t\t\tif ( mode == \"drag\" ){\r\n\t\t\t\t\t\tia.cancelled = true;\r\n\t\t\t\t\t\tdd.propagates -= 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( type == \"drop\" ){\r\n\t\t\t\t\t\tia[ mode ][p] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// assign any dropinit elements\r\n\t\t\t\telse if ( type == \"dropinit\" )\r\n\t\t\t\t\tia.droppable.push( drag.element( result ) || subject );\r\n\t\t\t\t// accept a returned proxy element \r\n\t\t\t\tif ( type == \"dragstart\" )\r\n\t\t\t\t\tia.proxy = $( drag.element( result ) || ia.drag )[0];\r\n\t\t\t\t// remember this result\t\r\n\t\t\t\tia.results.push( result );\r\n\t\t\t\t// forget the event result, for recycling\r\n\t\t\t\tdelete event.result;\r\n\t\t\t\t// break on cancelled handler\r\n\t\t\t\tif ( type !== \"dropinit\" )\r\n\t\t\t\t\treturn result;\r\n\t\t\t});\t\r\n\t\t\t// flatten the results\t\r\n\t\t\tdd.results[ i ] = drag.flatten( ia.results );\t\r\n\t\t\t// accept a set of valid drop targets\r\n\t\t\tif ( type == \"dropinit\" )\r\n\t\t\t\tia.droppable = drag.flatten( ia.droppable );\r\n\t\t\t// locate drop targets\r\n\t\t\tif ( type == \"dragstart\" && !ia.cancelled )\r\n\t\t\t\tcallback.update(); \r\n\t\t}\r\n\t\twhile ( ++i < len )\r\n\t\t// restore the original event & type\r\n\t\tevent.type = orig.type;\r\n\t\tevent.originalEvent = orig.event;\r\n\t\t// return all handler results\r\n\t\treturn drag.flatten( dd.results );\r\n\t},\r\n\t\t\r\n\t// extend the callback object with drag/drop properties...\r\n\tproperties: function( event, dd, ia ){\t\t\r\n\t\tvar obj = ia.callback;\r\n\t\t// elements\r\n\t\tobj.drag = ia.drag;\r\n\t\tobj.proxy = ia.proxy || ia.drag;\r\n\t\t// starting mouse position\r\n\t\tobj.startX = dd.pageX;\r\n\t\tobj.startY = dd.pageY;\r\n\t\t// current distance dragged\r\n\t\tobj.deltaX = event.pageX - dd.pageX;\r\n\t\tobj.deltaY = event.pageY - dd.pageY;\r\n\t\t// original element position\r\n\t\tobj.originalX = ia.offset.left;\r\n\t\tobj.originalY = ia.offset.top;\r\n\t\t// adjusted element position\r\n\t\tobj.offsetX = obj.originalX + obj.deltaX; \r\n\t\tobj.offsetY = obj.originalY + obj.deltaY;\r\n\t\t// assign the drop targets information\r\n\t\tobj.drop = drag.flatten( ( ia.drop || [] ).slice() );\r\n\t\tobj.available = drag.flatten( ( ia.droppable || [] ).slice() );\r\n\t\treturn obj;\t\r\n\t},\r\n\t\r\n\t// determine is the argument is an element or jquery instance\r\n\telement: function( arg ){\r\n\t\tif ( arg && ( arg.jquery || arg.nodeType == 1 ) )\r\n\t\t\treturn arg;\r\n\t},\r\n\t\r\n\t// flatten nested jquery objects and arrays into a single dimension array\r\n\tflatten: function( arr ){\r\n\t\treturn $.map( arr, function( member ){\r\n\t\t\treturn member && member.jquery ? $.makeArray( member ) : \r\n\t\t\t\tmember && member.length ? drag.flatten( member ) : member;\r\n\t\t});\r\n\t},\r\n\t\r\n\t// toggles text selection attributes ON (true) or OFF (false)\r\n\ttextselect: function( bool ){ \r\n\t\t$( document )[ bool ? \"unbind\" : \"bind\" ](\"selectstart\", drag.dontstart )\r\n\t\t\t.css(\"MozUserSelect\", bool ? \"\" : \"none\" );\r\n\t\t// .attr(\"unselectable\", bool ? \"off\" : \"on\" )\r\n\t\tdocument.unselectable = bool ? \"off\" : \"on\"; \r\n\t},\r\n\t\r\n\t// suppress \"selectstart\" and \"ondragstart\" events\r\n\tdontstart: function(){ \r\n\t\treturn false; \r\n\t},\r\n\t\r\n\t// a callback instance contructor\r\n\tcallback: function(){}\r\n\t\r\n};\r\n\r\n// callback methods\r\ndrag.callback.prototype = {\r\n\tupdate: function(){\r\n\t\tif ( $special.drop && this.available.length )\r\n\t\t\t$.each( this.available, function( i ){\r\n\t\t\t\t$special.drop.locate( this, i );\r\n\t\t\t});\r\n\t}\r\n};\r\n\r\n// patch $.event.$dispatch to allow suppressing clicks\r\nvar $dispatch = $event.dispatch;\r\n$event.dispatch = function( event ){\r\n\tif ( $.data( this, \"suppress.\"+ event.type ) - new Date().getTime() > 0 ){\r\n\t\t$.removeData( this, \"suppress.\"+ event.type );\r\n\t\treturn;\r\n\t}\r\n\treturn $dispatch.apply( this, arguments );\r\n};\r\n\r\n// event fix hooks for touch events...\r\nvar touchHooks = \r\n$event.fixHooks.touchstart = \r\n$event.fixHooks.touchmove = \r\n$event.fixHooks.touchend =\r\n$event.fixHooks.touchcancel = {\r\n\tprops: \"clientX clientY pageX pageY screenX screenY\".split( \" \" ),\r\n\tfilter: function( event, orig ) {\r\n\t\tif ( orig ){\r\n\t\t\tvar touched = ( orig.touches && orig.touches[0] )\r\n\t\t\t\t|| ( orig.changedTouches && orig.changedTouches[0] )\r\n\t\t\t\t|| null; \r\n\t\t\t// iOS webkit: touchstart, touchmove, touchend\r\n\t\t\tif ( touched ) \r\n\t\t\t\t$.each( touchHooks.props, function( i, prop ){\r\n\t\t\t\t\tevent[ prop ] = touched[ prop ];\r\n\t\t\t\t});\r\n\t\t}\r\n\t\treturn event;\r\n\t}\r\n};\r\n\r\n// share the same special event configuration with related events...\r\n$special.draginit = $special.dragstart = $special.dragend = drag;\r\n\r\n})( jQuery );","/*! \r\n * jquery.event.drag.live - v 2.2\r\n * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com\r\n * Open Source MIT License - http://threedubmedia.com/code/license\r\n */\r\n// Created: 2010-06-07\r\n// Updated: 2012-05-21\r\n// REQUIRES: jquery 1.7.x, event.drag 2.2\r\n\r\n;(function( $ ){\r\n\t\r\n// local refs (increase compression)\r\nvar $event = $.event,\r\n// ref the special event config\r\ndrag = $event.special.drag,\r\n// old drag event add method\r\norigadd = drag.add,\r\n// old drag event teradown method\r\norigteardown = drag.teardown;\r\n\r\n// allow events to bubble for delegation\r\ndrag.noBubble = false;\r\n\r\n// the namespace for internal live events\r\ndrag.livekey = \"livedrag\";\r\n\r\n// new drop event add method\r\ndrag.add = function( obj ){ \r\n\t// call the old method\r\n\torigadd.apply( this, arguments );\r\n\t// read the data\r\n\tvar data = $.data( this, drag.datakey );\r\n\t// bind the live \"draginit\" delegator\r\n\tif ( !data.live && obj.selector ){\r\n\t\tdata.live = true;\r\n\t\t$event.add( this, \"draginit.\"+ drag.livekey, drag.delegate );\r\n\t}\r\n};\r\n\r\n// new drop event teardown method\r\ndrag.teardown = function(){ \r\n\t// call the old method\r\n\torigteardown.apply( this, arguments );\r\n\t// read the data\r\n\tvar data = $.data( this, drag.datakey ) || {};\r\n\t// bind the live \"draginit\" delegator\r\n\tif ( data.live ){\r\n\t\t// remove the \"live\" delegation\r\n\t\t$event.remove( this, \"draginit.\"+ drag.livekey, drag.delegate );\r\n\t\tdata.live = false;\r\n\t}\r\n};\r\n\r\n// identify potential delegate elements\r\ndrag.delegate = function( event ){\r\n\t// local refs\r\n\tvar elems = [], target, \r\n\t// element event structure\r\n\tevents = $.data( this, \"events\" ) || {};\r\n\t// query live events\r\n\t$.each( events || [], function( key, arr ){\r\n\t\t// no event type matches\r\n\t\tif ( key.indexOf(\"drag\") !== 0 )\r\n\t\t\treturn;\r\n\t\t$.each( arr || [], function( i, obj ){\r\n\t\t\t// locate the element to delegate\r\n\t\t\ttarget = $( event.target ).closest( obj.selector, event.currentTarget )[0];\r\n\t\t\t// no element found\r\n\t\t\tif ( !target ) \r\n\t\t\t\treturn;\r\n\t\t\t// add an event handler\r\n\t\t\t$event.add( target, obj.origType+'.'+drag.livekey, obj.origHandler || obj.handler, obj.data );\r\n\t\t\t// remember new elements\r\n\t\t\tif ( $.inArray( target, elems ) < 0 )\r\n\t\t\t\telems.push( target );\t\t\r\n\t\t});\r\n\t});\r\n\t// if there are no elements, break\r\n\tif ( !elems.length ) \r\n\t\treturn false;\r\n\t// return the matched results, and clenup when complete\t\t\r\n\treturn $( elems ).bind(\"dragend.\"+ drag.livekey, function(){\r\n\t\t$event.remove( this, \".\"+ drag.livekey ); // cleanup delegation\r\n\t});\r\n};\r\n\t\r\n})( jQuery );","/*! \n * jquery.event.drop - v 2.2\n * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com\n * Open Source MIT License - http://threedubmedia.com/code/license\n */\n// Created: 2008-06-04 \n// Updated: 2012-05-21\n// REQUIRES: jquery 1.7.x, event.drag 2.2\n\n;(function($){ // secure $ jQuery alias\n\n// Events: drop, dropstart, dropend\n\n// add the jquery instance method\n$.fn.drop = function( str, arg, opts ){\n\t// figure out the event type\n\tvar type = typeof str == \"string\" ? str : \"\",\n\t// figure out the event handler...\n\tfn = $.isFunction( str ) ? str : $.isFunction( arg ) ? arg : null;\n\t// fix the event type\n\tif ( type.indexOf(\"drop\") !== 0 ) \n\t\ttype = \"drop\"+ type;\n\t// were options passed\n\topts = ( str == fn ? arg : opts ) || {};\n\t// trigger or bind event handler\n\treturn fn ? this.bind( type, opts, fn ) : this.trigger( type );\n};\n\n// DROP MANAGEMENT UTILITY\n// returns filtered drop target elements, caches their positions\n$.drop = function( opts ){ \n\topts = opts || {};\n\t// safely set new options...\n\tdrop.multi = opts.multi === true ? Infinity : \n\t\topts.multi === false ? 1 : !isNaN( opts.multi ) ? opts.multi : drop.multi;\n\tdrop.delay = opts.delay || drop.delay;\n\tdrop.tolerance = $.isFunction( opts.tolerance ) ? opts.tolerance : \n\t\topts.tolerance === null ? null : drop.tolerance;\n\tdrop.mode = opts.mode || drop.mode || 'intersect';\n};\n\n// local refs (increase compression)\nvar $event = $.event, \n$special = $event.special,\n// configure the drop special event\ndrop = $.event.special.drop = {\n\n\t// these are the default settings\n\tmulti: 1, // allow multiple drop winners per dragged element\n\tdelay: 20, // async timeout delay\n\tmode: 'overlap', // drop tolerance mode\n\t\t\n\t// internal cache\n\ttargets: [], \n\t\n\t// the key name for stored drop data\n\tdatakey: \"dropdata\",\n\t\t\n\t// prevent bubbling for better performance\n\tnoBubble: true,\n\t\n\t// count bound related events\n\tadd: function( obj ){ \n\t\t// read the interaction data\n\t\tvar data = $.data( this, drop.datakey );\n\t\t// count another realted event\n\t\tdata.related += 1;\n\t},\n\t\n\t// forget unbound related events\n\tremove: function(){\n\t\t$.data( this, drop.datakey ).related -= 1;\n\t},\n\t\n\t// configure the interactions\n\tsetup: function(){\n\t\t// check for related events\n\t\tif ( $.data( this, drop.datakey ) ) \n\t\t\treturn;\n\t\t// initialize the drop element data\n\t\tvar data = { \n\t\t\trelated: 0,\n\t\t\tactive: [],\n\t\t\tanyactive: 0,\n\t\t\twinner: 0,\n\t\t\tlocation: {}\n\t\t};\n\t\t// store the drop data on the element\n\t\t$.data( this, drop.datakey, data );\n\t\t// store the drop target in internal cache\n\t\tdrop.targets.push( this );\n\t},\n\t\n\t// destroy the configure interaction\t\n\tteardown: function(){ \n\t\tvar data = $.data( this, drop.datakey ) || {};\n\t\t// check for related events\n\t\tif ( data.related ) \n\t\t\treturn;\n\t\t// remove the stored data\n\t\t$.removeData( this, drop.datakey );\n\t\t// reference the targeted element\n\t\tvar element = this;\n\t\t// remove from the internal cache\n\t\tdrop.targets = $.grep( drop.targets, function( target ){ \n\t\t\treturn ( target !== element ); \n\t\t});\n\t},\n\t\n\t// shared event handler\n\thandler: function( event, dd ){ \n\t\t// local vars\n\t\tvar results, $targets;\n\t\t// make sure the right data is available\n\t\tif ( !dd ) \n\t\t\treturn;\n\t\t// handle various events\n\t\tswitch ( event.type ){\n\t\t\t// draginit, from $.event.special.drag\n\t\t\tcase 'mousedown': // DROPINIT >>\n\t\t\tcase 'touchstart': // DROPINIT >>\n\t\t\t\t// collect and assign the drop targets\n\t\t\t\t$targets =  $( drop.targets );\n\t\t\t\tif ( typeof dd.drop == \"string\" )\n\t\t\t\t\t$targets = $targets.filter( dd.drop );\n\t\t\t\t// reset drop data winner properties\n\t\t\t\t$targets.each(function(){\n\t\t\t\t\tvar data = $.data( this, drop.datakey );\n\t\t\t\t\tdata.active = [];\n\t\t\t\t\tdata.anyactive = 0;\n\t\t\t\t\tdata.winner = 0;\n\t\t\t\t});\n\t\t\t\t// set available target elements\n\t\t\t\tdd.droppable = $targets;\n\t\t\t\t// activate drop targets for the initial element being dragged\n\t\t\t\t$special.drag.hijack( event, \"dropinit\", dd ); \n\t\t\t\tbreak;\n\t\t\t// drag, from $.event.special.drag\n\t\t\tcase 'mousemove': // TOLERATE >>\n\t\t\tcase 'touchmove': // TOLERATE >>\n\t\t\t\tdrop.event = event; // store the mousemove event\n\t\t\t\tif ( !drop.timer )\n\t\t\t\t\t// monitor drop targets\n\t\t\t\t\tdrop.tolerate( dd ); \n\t\t\t\tbreak;\n\t\t\t// dragend, from $.event.special.drag\n\t\t\tcase 'mouseup': // DROP >> DROPEND >>\n\t\t\tcase 'touchend': // DROP >> DROPEND >>\n\t\t\t\tdrop.timer = clearTimeout( drop.timer ); // delete timer\t\n\t\t\t\tif ( dd.propagates ){\n\t\t\t\t\t$special.drag.hijack( event, \"drop\", dd ); \n\t\t\t\t\t$special.drag.hijack( event, \"dropend\", dd ); \n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t}\n\t},\n\t\t\n\t// returns the location positions of an element\n\tlocate: function( elem, index ){ \n\t\tvar data = $.data( elem, drop.datakey ),\n\t\t$elem = $( elem ), \n\t\tposi = $elem.offset() || {}, \n\t\theight = $elem.outerHeight(), \n\t\twidth = $elem.outerWidth(),\n\t\tlocation = { \n\t\t\telem: elem, \n\t\t\twidth: width, \n\t\t\theight: height,\n\t\t\ttop: posi.top, \n\t\t\tleft: posi.left, \n\t\t\tright: posi.left + width, \n\t\t\tbottom: posi.top + height\n\t\t};\n\t\t// drag elements might not have dropdata\n\t\tif ( data ){\n\t\t\tdata.location = location;\n\t\t\tdata.index = index;\n\t\t\tdata.elem = elem;\n\t\t}\n\t\treturn location;\n\t},\n\t\n\t// test the location positions of an element against another OR an X,Y coord\n\tcontains: function( target, test ){ // target { location } contains test [x,y] or { location }\n\t\treturn ( ( test[0] || test.left ) >= target.left && ( test[0] || test.right ) <= target.right\n\t\t\t&& ( test[1] || test.top ) >= target.top && ( test[1] || test.bottom ) <= target.bottom ); \n\t},\n\t\n\t// stored tolerance modes\n\tmodes: { // fn scope: \"$.event.special.drop\" object \n\t\t// target with mouse wins, else target with most overlap wins\n\t\t'intersect': function( event, proxy, target ){\n\t\t\treturn this.contains( target, [ event.pageX, event.pageY ] ) ? // check cursor\n\t\t\t\t1e9 : this.modes.overlap.apply( this, arguments ); // check overlap\n\t\t},\n\t\t// target with most overlap wins\t\n\t\t'overlap': function( event, proxy, target ){\n\t\t\t// calculate the area of overlap...\n\t\t\treturn Math.max( 0, Math.min( target.bottom, proxy.bottom ) - Math.max( target.top, proxy.top ) )\n\t\t\t\t* Math.max( 0, Math.min( target.right, proxy.right ) - Math.max( target.left, proxy.left ) );\n\t\t},\n\t\t// proxy is completely contained within target bounds\t\n\t\t'fit': function( event, proxy, target ){\n\t\t\treturn this.contains( target, proxy ) ? 1 : 0;\n\t\t},\n\t\t// center of the proxy is contained within target bounds\t\n\t\t'middle': function( event, proxy, target ){\n\t\t\treturn this.contains( target, [ proxy.left + proxy.width * .5, proxy.top + proxy.height * .5 ] ) ? 1 : 0;\n\t\t}\n\t},\t\n\t\n\t// sort drop target cache by by winner (dsc), then index (asc)\n\tsort: function( a, b ){\n\t\treturn ( b.winner - a.winner ) || ( a.index - b.index );\n\t},\n\t\t\n\t// async, recursive tolerance execution\n\ttolerate: function( dd ){\t\t\n\t\t// declare local refs\n\t\tvar i, drp, drg, data, arr, len, elem,\n\t\t// interaction iteration variables\n\t\tx = 0, ia, end = dd.interactions.length,\n\t\t// determine the mouse coords\n\t\txy = [ drop.event.pageX, drop.event.pageY ],\n\t\t// custom or stored tolerance fn\n\t\ttolerance = drop.tolerance || drop.modes[ drop.mode ];\n\t\t// go through each passed interaction...\n\t\tdo if ( ia = dd.interactions[x] ){\n\t\t\t// check valid interaction\n\t\t\tif ( !ia )\n\t\t\t\treturn; \n\t\t\t// initialize or clear the drop data\n\t\t\tia.drop = [];\n\t\t\t// holds the drop elements\n\t\t\tarr = []; \n\t\t\tlen = ia.droppable.length;\n\t\t\t// determine the proxy location, if needed\n\t\t\tif ( tolerance )\n\t\t\t\tdrg = drop.locate( ia.proxy ); \n\t\t\t// reset the loop\n\t\t\ti = 0;\n\t\t\t// loop each stored drop target\n\t\t\tdo if ( elem = ia.droppable[i] ){ \n\t\t\t\tdata = $.data( elem, drop.datakey );\n\t\t\t\tdrp = data.location;\n\t\t\t\tif ( !drp ) continue;\n\t\t\t\t// find a winner: tolerance function is defined, call it\n\t\t\t\tdata.winner = tolerance ? tolerance.call( drop, drop.event, drg, drp ) \n\t\t\t\t\t// mouse position is always the fallback\n\t\t\t\t\t: drop.contains( drp, xy ) ? 1 : 0; \n\t\t\t\tarr.push( data );\t\n\t\t\t} while ( ++i < len ); // loop \n\t\t\t// sort the drop targets\n\t\t\tarr.sort( drop.sort );\t\t\t\n\t\t\t// reset the loop\n\t\t\ti = 0;\n\t\t\t// loop through all of the targets again\n\t\t\tdo if ( data = arr[ i ] ){\n\t\t\t\t// winners...\n\t\t\t\tif ( data.winner && ia.drop.length < drop.multi ){\n\t\t\t\t\t// new winner... dropstart\n\t\t\t\t\tif ( !data.active[x] && !data.anyactive ){\n\t\t\t\t\t\t// check to make sure that this is not prevented\n\t\t\t\t\t\tif ( $special.drag.hijack( drop.event, \"dropstart\", dd, x, data.elem )[0] !== false ){ \t\n\t\t\t\t\t\t\tdata.active[x] = 1;\n\t\t\t\t\t\t\tdata.anyactive += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// if false, it is not a winner\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tdata.winner = 0;\n\t\t\t\t\t}\n\t\t\t\t\t// if it is still a winner\n\t\t\t\t\tif ( data.winner )\n\t\t\t\t\t\tia.drop.push( data.elem );\n\t\t\t\t}\n\t\t\t\t// losers... \n\t\t\t\telse if ( data.active[x] && data.anyactive == 1 ){\n\t\t\t\t\t// former winner... dropend\n\t\t\t\t\t$special.drag.hijack( drop.event, \"dropend\", dd, x, data.elem ); \n\t\t\t\t\tdata.active[x] = 0;\n\t\t\t\t\tdata.anyactive -= 1;\n\t\t\t\t}\n\t\t\t} while ( ++i < len ); // loop \t\t\n\t\t} while ( ++x < end ) // loop\n\t\t// check if the mouse is still moving or is idle\n\t\tif ( drop.last && xy[0] == drop.last.pageX && xy[1] == drop.last.pageY ) \n\t\t\tdelete drop.timer; // idle, don't recurse\n\t\telse  // recurse\n\t\t\tdrop.timer = setTimeout(function(){ \n\t\t\t\tdrop.tolerate( dd ); \n\t\t\t}, drop.delay );\n\t\t// remember event, to compare idleness\n\t\tdrop.last = drop.event; \n\t}\n\t\n};\n\n// share the same special event configuration with related events...\n$special.dropinit = $special.dropstart = $special.dropend = drop;\n\n})(jQuery); // confine scope\t","/*! \n * jquery.event.drop.live - v 2.2\n * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com\n * Open Source MIT License - http://threedubmedia.com/code/license\n */\n// Created: 2010-06-07\n// Updated: 2012-05-21\n// REQUIRES: jquery 1.7.x, event.drag 2.2, event.drop 2.2\n\n;(function($){ // secure $ jQuery alias\n\n// local refs (increase compression)\nvar $event = $.event,\n// ref the drop special event config\ndrop = $event.special.drop,\n// old drop event add method\norigadd = drop.add,\n// old drop event teradown method\norigteardown = drop.teardown;\n\n// allow events to bubble for delegation\ndrop.noBubble = false;\n\n// the namespace for internal live events\ndrop.livekey = \"livedrop\";\n\n// new drop event add method\ndrop.add = function( obj ){ \n\t// call the old method\n\torigadd.apply( this, arguments );\n\t// read the data\n\tvar data = $.data( this, drop.datakey );\n\t// bind the live \"dropinit\" delegator\n\tif ( !data.live && obj.selector ){\n\t\tdata.live = true;\n\t\t$event.add( this, \"dropinit.\"+ drop.livekey, drop.delegate );\n\t}\n};\n\n// new drop event teardown method\ndrop.teardown = function(){ \n\t// call the old method\n\torigteardown.apply( this, arguments );\n\t// read the data\n\tvar data = $.data( this, drop.datakey ) || {};\n\t// remove the live \"dropinit\" delegator\n\tif ( data.live ){\n\t\t// remove the \"live\" delegation\n\t\t$event.remove( this, \"dropinit\", drop.delegate );\n\t\tdata.live = false;\n\t}\n};\n\n// identify potential delegate elements\ndrop.delegate = function( event, dd ){\n\t// local refs\n\tvar elems = [], $targets, \n\t// element event structure\n\tevents = $.data( this, \"events\" ) || {};\n\t// query live events\n\t$.each( events || [], function( key, arr ){\n\t\t// no event type matches\n\t\tif ( key.indexOf(\"drop\") !== 0 )\n\t\t\treturn;\n\t\t$.each( arr, function( i, obj ){\n\t\t\t// locate the elements to delegate\n\t\t\t$targets = $( event.currentTarget ).find( obj.selector );\n\t\t\t// no element found\n\t\t\tif ( !$targets.length ) \n\t\t\t\treturn;\n\t\t\t// take each target...\n\t\t\t$targets.each(function(){\n\t\t\t\t// add an event handler\n\t\t\t\t$event.add( this, obj.origType +'.'+ drop.livekey, obj.origHandler || obj.handler, obj.data );\n\t\t\t\t// remember new elements\n\t\t\t\tif ( $.inArray( this, elems ) < 0 )\n\t\t\t\t\telems.push( this );\t\n\t\t\t});\t\n\t\t});\n\t});\n\t// may not exist when artifically triggering dropinit event\n\tif ( dd )\n\t\t// clean-up after the interaction ends\n\t\t$event.add( dd.drag, \"dragend.\"+drop.livekey, function(){\n\t\t\t$.each( elems.concat( this ), function(){\n\t\t\t\t$event.remove( this, '.'+ drop.livekey );\t\t\t\t\t\t\t\n\t\t\t});\n\t\t});\n\t//drop.delegates.push( elems );\n\treturn elems.length ? $( elems ) : false;\n};\n\n})( jQuery ); // confine scope\t"],"sourceRoot":""}