/*!
 * 
 *  maishu-jueying v1.7.8
 *  
 *  Copyright (C) maishu All rights reserved.
 *  
 *  组件设计器 
 *   
 *  作者: 麦舒
 *  日期: 2018/5/30
 *  
 *  个人博客：   http://www.cnblogs.com/ansiboy/
 *  GITHUB:     https://github.com/ansiboy/jueying
 *  QQ 讨论组：  119038574 
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("jquery")):"function"==typeof define&&define.amd?define(["react","jquery"],t):"object"==typeof exports?exports.jueying=t(require("react"),require("jquery")):e.jueying=t(e.react,e.jquery)}(window,(function(e,t){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=12)}([function(t,n){t.exports=e},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(10),c=n(2),s=n(4),l=n(5);t.DesignerContext=a.createContext({designer:null}),t.ComponentWrapperContext=a.createContext(null),t.component=function(e){return function(t){return i.PageDesigner&&p.setAttribute(t.name,e),p.register(t.name,t),t}};var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"setAttribute",value:function(t,n){e.componentAttributes[t]=n}},{key:"getAttribute",value:function(t){var n="string"==typeof t?t:t.name,o=e.componentAttributes[n];return Object.assign({type:t},e.defaultComponentAttribute,o||{})}},{key:"getPropEditors",value:function(t){for(var n=t.type,o=[],r=this.componentPropEditors[n]||[],a=0;a<r.length;a++){var i=r[a].propName,c=e.componentPropEditorDisplay["".concat(n,".").concat(i)];null!=c&&0==c(t)||o.push(r[a])}return o}},{key:"getPropEditor",value:function(e,t){return this.getPropEditorByArray(e,t)}},{key:"getPropEditorByArray",value:function(e,t){return(this.componentPropEditors[e]||[]).filter((function(e){return e.propName==t}))[0]}},{key:"setPropEditor",value:function(t,n,r,a){var i,c;if("object"==o(t)){var l=t;i=l.componentType,n=l.propName,r=l.editorType,a=l.group,c=l.display,null!=l.displayName&&(s.proptDisplayNames[n]=l.displayName)}else i=t;a=a||"";var p=n.split("."),u="string"==typeof i?i:i.prototype.typename||i.name;e.componentPropEditorDisplay["".concat(u,".").concat(n)]=c;for(var f=e.componentPropEditors[u]=e.componentPropEditors[u]||[],d=0;d<f.length;d++)if(f[d].propName==p.join("."))return void(f[d].editorType=r);f.push({propName:n,editorType:r,group:a})}},{key:"createElement",value:function(t,n){return e._createElement(t,{components:[],componentTypes:[]},n)}},{key:"_createElement",value:function(t,n,o){if(!t)throw c.Errors.argumentNull("componentData");o=o||a.createElement;try{var r=t.type,i=t.type,s=e.componentTypes[i];s&&(r=s);for(var p=[],u=0;u<t.children.length;u++){var f=t.children[u];"string"==typeof f?p.push(f):p.push(e._createElement(f,n,o))}var d,m=null==t.props?{}:Object.assign({},t.props);null!=s&&s.defaultProps&&(m=Object.assign({},s.defaultProps,m)),"string"==typeof r&&(m.text&&p.push(m.text),delete m.text,o==a.createElement&&delete m.attr),r=r==e.Fragment?a.Fragment:r;var y=m.ref;return m.ref=function(e){if("function"==typeof y&&y(e),e instanceof l.MasterPage){d=e;for(var t=0;t<n.componentTypes.length;t++){var o=n.componentTypes[t];(d.childComponents[o]=d.childComponents[o]||[]).push(n.components[t])}}else null!=e&&(n.components.push(e),n.componentTypes.push("string"==typeof r?r:r.name))},o.apply(void 0,[r,m].concat(p))}catch(e){return console.error(e),null}}},{key:"register",value:function(t,n,o){if(null==n&&"function"==typeof t&&(t=(n=t).name,n.componentName=t),!t)throw c.Errors.argumentNull("componentName");if(!n)throw c.Errors.argumentNull("componentType");e.componentTypes[t]=n,o&&e.setAttribute(t,o)}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();p.Fragment="",p.defaultComponentAttribute={container:!1,movable:!1,showHandler:!1,resize:!1},p.componentAttributes={div:{container:!0,movable:!0,showHandler:!0,resize:!0},img:{container:!1,movable:!0,resize:!0},label:{movable:!0},ul:{container:!1,movable:!0,showHandler:!0,resize:!1},li:{container:!0,movable:!1},table:{container:!1,movable:!0,showHandler:!0,resize:!0},thead:{container:!1,movable:!1},tbody:{container:!1,movable:!1},tfoot:{container:!1,movable:!1},tr:{container:!1,movable:!1},td:{container:!0,movable:!1}},p.componentPropEditors={},p.componentPropEditorDisplay={},p.componentTypes={},t.Component=p},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"placeHolderIdNull",value:function(){return new Error("Place holder property id cannt be null or empty.")}},{key:"fileNotExists",value:function(e){return new Error("File '".concat(e,"' is not exists."))}},{key:"argumentNull",value:function(e){return new Error("Argument ".concat(e," is null or empty."))}},{key:"argumentRangeError",value:function(e){return new Error("Argument ".concat(e," range error."))}},{key:"pageDataIsNull",value:function(){return new Error("Page data is null.")}},{key:"toolbarRequiredKey",value:function(){return new Error("Toolbar has not a key prop.")}},{key:"loadPluginFail",value:function(e){return new Error("Load plugin '".concat(e,"' fail."))}},{key:"idRequired",value:function(){return new Error("Property id is required.")}},{key:"canntFindMasterPage",value:function(e){return new Error("Can not find master page for component container ".concat(e,"."))}},{key:"propCanntNull",value:function(e,t){var n="".concat(e," property ").concat(t," cannt be null or empty.");return new Error(n)}},{key:"argumentFieldCanntNull",value:function(e,t){var n="".concat(e," of argument ").concat(t," cannt be null or empty.");return new Error(n)}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();t.Errors=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2);t.classNames={componentSelected:"component-selected",emptyTemplates:"empty-templates",loadingTemplates:"loading-templates",templateSelected:"template-selected",templateDialog:"template-dialog",emptyDocument:"empty-document",component:"component",componentWrapper:"component-wrapper",componentPanel:"component-panel",componentIcon:"component-icon",placeholder:"placeholder",editorPanel:"editor-panel",designer:"designer",moveDown:"move-down"};var r=40,a=22,i=document.createElement("style");i.type="text/css",i.setAttribute("data-name","jueying"),i.innerHTML="\n            .".concat(t.classNames.componentSelected," {\n                border: solid 1px #337ab7!important;\n            }\n            .").concat(t.classNames.componentSelected," > :first-child {\n                border-color: blue;\n              }\n              .").concat(t.classNames.componentSelected," .resize_handle {\n                position: absolute;\n                height: 6px;\n                width: 6px;\n                border: 1px solid #89B;\n                background: #9AC;\n              }\n              .").concat(t.classNames.componentSelected," .move_handle {\n                height: 12px;\n                width: 12px;\n                top: 6px;\n                left: 8px;\n                border: solid 1px black;\n                position: relative;\n                margin-top: -12px;\n              }\n              .").concat(t.classNames.componentSelected," .NW,\n              .").concat(t.classNames.componentSelected," .NN,\n              .").concat(t.classNames.componentSelected," .NE {\n                top: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .NE,\n              .").concat(t.classNames.componentSelected," .EE,\n              .").concat(t.classNames.componentSelected," .SE {\n                right: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .SW,\n              .").concat(t.classNames.componentSelected,".SS,\n              .").concat(t.classNames.componentSelected," .SE {\n                bottom: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .NW,\n              .").concat(t.classNames.componentSelected," .WW,\n              .").concat(t.classNames.componentSelected," .SW {\n                left: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .SE,\n              .").concat(t.classNames.componentSelected," .NW {\n                cursor: nw-resize;\n              }\n              .").concat(t.classNames.componentSelected," .SW,\n              .").concat(t.classNames.componentSelected," .NE {\n                cursor: ne-resize;\n              }\n              .").concat(t.classNames.componentSelected," .NN,\n              .").concat(t.classNames.componentSelected," .SS {\n                cursor: n-resize;\n                left: 50%;\n                margin-left: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .EE,\n              .").concat(t.classNames.componentSelected," .WW {\n                cursor: e-resize;\n                top: 50%;\n                margin-top: -4px;\n              }\n            .").concat(t.classNames.emptyTemplates," {\n                padding:50px 0;\n                text-align: center;\n            }\n            .").concat(t.classNames.loadingTemplates," {\n                padding:50px 0;\n                text-align: center;\n            }\n            .").concat(t.classNames.templateSelected," .page-view {\n                border: solid 1px #337ab7!important;\n            }\n            .").concat(t.classNames.templateDialog," .name {\n                margin-top: -").concat(r,"px;\n                height: ").concat(r,"px;\n                font-size: ").concat(a,"px;\n                text-align: center;\n                padding-top: 6px;\n                background-color: black;\n                opacity: 0.5;\n            }\n            .").concat(t.classNames.templateDialog," .name span {\n                color: white;\n            }\n            .").concat(t.classNames.emptyDocument," {\n                text-align: center;\n                padding: 100px 0;\n            }\n            .").concat(t.classNames.component," > .NW,\n            .").concat(t.classNames.component," > .NN,\n            .").concat(t.classNames.component," > .NE,\n            .").concat(t.classNames.component," > .EE,\n            .").concat(t.classNames.component," > .SE,\n            .").concat(t.classNames.component," > .SW,\n            .").concat(t.classNames.component," > .SS,\n            .").concat(t.classNames.component," > .WW {\n                display: none;\n            }\n            .").concat(t.classNames.componentSelected,".component > .NW,\n            .").concat(t.classNames.componentSelected,".component > .NN,\n            .").concat(t.classNames.componentSelected,".component > .NE,\n            .").concat(t.classNames.componentSelected,".component > .EE,\n            .").concat(t.classNames.componentSelected,".component > .SE,\n            .").concat(t.classNames.componentSelected,".component > .SW,\n            .").concat(t.classNames.componentSelected,".component > .SS,\n            .").concat(t.classNames.componentSelected,".component > .WW {\n                display: block;\n            }\n            .").concat(t.classNames.placeholder," {\n                min-height: 40px;\n                width: 100%;\n            }\n            .").concat(t.classNames.placeholder,".active,\n            .").concat(t.classNames.componentWrapper,".active,\n            .").concat(t.classNames.componentWrapper,".").concat(t.classNames.componentSelected,".active {\n                border: 1px solid green;\n            }\n            .").concat(t.classNames.editorPanel," {\n                width: 300px;\n                background: white;\n                color: black;\n                margin: 0;\n                font-size: 14px;\n                z-index: 100;\n                overflow: auto;\n            }\n            .").concat(t.classNames.editorPanel," label {\n                width: 80px;\n                float: left;\n                padding: 4px;\n                text-overflow: ellipsis;\n                overflow: hidden;\n            }\n            .").concat(t.classNames.editorPanel," .control {\n                padding-left: 90px;\n            }\n            .").concat(t.classNames.editorPanel," .empty {\n                padding-top: 200px;\n                text-align: center;\n            }\n            .").concat(t.classNames.designer," .error,\n            .").concat(t.classNames.editorPanel," .error {\n                color: red;\n            }\n            .").concat(t.classNames.componentPanel," {\n                background: white;\n                color: black;\n                font-size: 14px;\n                z-index: 100;\n                list-style: none;\n                padding: 0;\n                text-align: center\n            }\n            .").concat(t.classNames.componentPanel," .panel-heading {\n                text-align: center;\n            }\n            .").concat(t.classNames.componentPanel," li {\n                text-align: center;\n                padding: 8px;\n            }\n            .").concat(t.classNames.componentWrapper,".").concat(t.classNames.moveDown," {\n         \n            }\n        "),document.head.appendChild(i),t.appendClassName=function(e,t){if(null==e)throw o.Errors.argumentNull("element");if(!t)throw o.Errors.argumentNull("addonClassName");var n;if(n=(n="string"==typeof e?e:e.className)||"",console.assert(t),n.indexOf(t)>=0)return n;var r="".concat(n," ").concat(t);return"string"!=typeof e&&(e.className=r),r},t.removeClassName=function(e,t){var n;return(n="string"==typeof e?e:e.className||"").indexOf(t)<0?n:(n=(n=(n=n||"").replace(new RegExp(t,"g"),"")).trim(),"string"!=typeof e&&(e.className=n),n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5);t.proptDisplayNames={};var r=n(8);t.guid=r.guid,t.Callback=r.Callback,t.translateComponentDataChildren=function(e){if(null==e||0==e.length)return[];for(var t=[],n=0;n<e.length;n++){var r=e[n];"string"==typeof r?(r={type:o.ComponentTypes.Text,props:{text:r}},t.push(r)):t.push(e[n])}return t}},function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n(9)),o(n(20)),o(n(22));var r=n(7);t.ComponentTypes=r.ComponentTypes,t.constants=r.constants},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),l=n(5),p=n(3),u=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=a(this,i(t).call(this,e))).state={componets:[]},n.designer=n.props.designer,n}var n,o,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),n=t,u=[{key:"getComponentData",value:function(e){var t=e.getData(l.constants.componentData);if(t)return JSON.parse(t)}},{key:"mouseInnerPosition",value:function(e){var t=e.getData("mousePosition");if(t)return JSON.parse(t)}}],(o=[{key:"componentDraggable",value:function(e,t){console.assert(null!=e),e.draggable=!0,e.addEventListener("dragstart",(function(e){t.props=t.props||{},e.dataTransfer.setData(l.constants.componentData,JSON.stringify(t)),e.dataTransfer.setData("mousePosition",JSON.stringify({x:e.offsetX,y:e.offsetY}))}))}},{key:"setComponets",value:function(e){this.setState({componets:e})}},{key:"render",value:function(){var e=this,n=this.props.empty||s.createElement("div",{className:"empty"},"暂无可用组件"),o=Object.assign({},this.props),r=this.state.componets||[];return s.createElement("ul",Object.assign({},o,{className:"".concat(p.classNames.componentPanel," ").concat(this.props.className||""),ref:function(t){return e.toolbarElement=e.toolbarElement||t}}),0==r.length?n:r.map((function(n,o){var r={key:o};return r[t.componentIndexName]="".concat(o),s.createElement("li",Object.assign({},r,{className:p.classNames.componentIcon}),s.createElement("div",{className:"btn-link"},s.createElement("i",{className:n.icon,style:{fontSize:44,color:"black"},ref:function(t){if(t){var o=n.componentData;e.componentDraggable(t,o)}}})),s.createElement("div",null,n.displayName))})))}},{key:"element",get:function(){return this.toolbarElement}}])&&r(n.prototype,o),u&&r(n,u),t}(s.Component);u.componentIndexName="data-component-index",t.ComponentPanel=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentTypes={Text:"Text",PageView:"PageView",PlaceHolder:"PlaceHolder"},t.constants={componentsDir:"components",connectorElementClassName:"component-container",componentTypeName:"data-component-name",componentData:"component-data",componentPosition:"component-position"};var o=n(8);t.guid=o.guid},function(e,t,n){(function(t){
/*!
 * ~
 *  maishu-toolkit v1.1.1
 *  https://github.com/ansiboy/toolkit
 *  
 *  Copyright (c) 2016-2018, shu mai <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */
var n;"undefined"==typeof window||window,n=function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./out/index.js")}({"./out/callback.js":
/*!*************************!*\
  !*** ./out/callback.js ***!
  \*************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class o{constructor(){this.funcs=new Array}add(e){this.funcs.push(e)}remove(e){this.funcs=this.funcs.filter(t=>t!=e)}fire(e){this.funcs.forEach(t=>t(e))}static create(){return new o}}t.Callback=o},"./out/errors.js":
/*!***********************!*\
  !*** ./out/errors.js ***!
  \***********************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class o{argumentNull(e){let t=new Error(`Argument ${e} cannt be null or emtpy.`);return t.name="argumentNull",t}routeDataFieldNull(e){let t=new Error(`The ${e} field of route data cannt be null.`);return t.name="routeDataFieldNull",t}argumentFieldNull(e,t){let n=new Error(`The ${e} field of ${t} cannt be null.`);return n.name="argumentFieldNull",n}argumentTypeIncorrect(e,t){let n=new Error(`Argument ${e} type error, expected type is ${t}.`);return n.name="argumentTypeIncorrect",n}}t.Errors=o,t.errors=new o},"./out/guid.js":
/*!*********************!*\
  !*** ./out/guid.js ***!
  \*********************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},"./out/index.js":
/*!**********************!*\
  !*** ./out/index.js ***!
  \**********************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(/*! ./guid */"./out/guid.js");t.guid=o.guid;var r=n(/*! ./path */"./out/path.js");t.pathContact=r.pathContact;var a=n(/*! ./errors */"./out/errors.js");t.Errors=a.Errors;var i=n(/*! ./callback */"./out/callback.js");t.Callback=i.Callback},"./out/path.js":
/*!*********************!*\
  !*** ./out/path.js ***!
  \*********************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pathContact=function(...e){if(0==(e=e||[]).length)return"";if(1==e.length)return e[0];let t=e.join("");return t=t.replace(/\/+/g,"/"),t}}})},e.exports=n()}).call(this,n(11))},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),l=n(1);t.MasterPageName="MasterPage",t.MasterPageContext=s.createContext({master:null});var p=function(e){function n(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=a(this,i(n).call(this,e))).childComponents={};var o=n.children(e);return t.state={children:o},t}var o,l,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,e),o=n,p=[{key:"children",value:function(e){var t=null==e.children?[]:Array.isArray(e.children)?e.children:[e.children],n=[];return t.forEach((function(e){s.isValidElement(e)&&n.push(e)})),n}},{key:"getDerivedStateFromProps",value:function(e){return{children:n.children(e)}}}],(l=[{key:"render",value:function(){var e={};for(var n in this.props)"ref"!=n&&"id"!=n&&(e[n]=this.props[n]);e.style=Object.assign({minHeight:40},e.style);var o=this.state.children.filter((function(e){return null==e.props.parentId}));return console.assert(null!=this),s.createElement(t.MasterPageContext.Provider,{value:{master:this}},o)}}])&&r(o.prototype,l),p&&r(o,p),n}(s.Component);t.MasterPage=p,l.Component.register(t.MasterPageName,p,{container:!1})},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),p=n(4),u=n(2),f=n(1),d=n(3),m=n(19),y=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=i(this,c(t).call(this,e))).components={};var o=n.props.componentDataHandler.pageData;return n.initPageData(o),n.state={pageData:o},n.props.componentDataHandler.componentSelected.add((function(e){n.setState({pageData:n.props.componentDataHandler.pageData})})),n.props.componentDataHandler.componentRemoved.add((function(e){n.setState({pageData:n.props.componentDataHandler.pageData})})),n.props.componentDataHandler.componentUpdated.add((function(e){n.setState({pageData:n.props.componentDataHandler.pageData})})),n.props.componentDataHandler.pageDataChanged.add((function(e){n.setState({pageData:e})})),n}var n,y,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,e),n=t,h=[{key:"nameComponent",value:function(e){var n={},o=e.props=e.props||{};if(!o.name){var r,a=0;do{a+=1,r="".concat(e.type).concat(a)}while(n[r]);n[r]=e,o.name=r}if(o.id||(o.id=p.guid()),e.children&&0!=e.children.length)for(var i=p.translateComponentDataChildren(e.children),c=0;c<i.length;c++)t.nameComponent(i[c])}},{key:"travelComponentData",value:function(e,t){var n=new Array;n.push(e);var a=[];for(t=t||function(){return!0};n.length>0;){var i=n.shift();t(i)&&a.push(i);var c=(i.children||[]).filter((function(e){return"object"==o(e)}));n.push.apply(n,r(c))}return a}},{key:"getDerivedStateFromProps",value:function(e,t){return{pageData:e.componentDataHandler.pageData}}}],(y=[{key:"setComponetRefProp",value:function(e){var n=this,o={};t.travelComponentData(e).forEach((function(e){console.assert(null!=e.props&&null!=e.props.id),o[e.type]=o[e.type]||[],o[e.type].push(e.props.id);var t=e.props.ref;e.props.ref=function(o){null!=o&&(n.components[e.type]=n.components[e.type]||[],n.components[e.type].push(o)),"function"==typeof t&&t(o)}}));for(var r=Object.getOwnPropertyNames(this.components),a=function(e){var t=r[e],a=o[t]||[];n.components[t]=(n.components[t]||[]).filter((function(e){return a.indexOf(e.id||e.props.id)>=0}))},i=0;i<r.length;i++)a(i)}},{key:"initPageData",value:function(e){null!=e&&(e.children=e.children||[],this.setComponetRefProp(e))}},{key:"allComponents",value:function(){var e=[];for(var t in this.components)e.push.apply(e,r(this.components[t]));return e}},{key:"updateComponentProp",value:function(e,t,n){return this.updateComponentProps({componentId:e,propName:t,value:n})}},{key:"updateComponentProps",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.props.componentDataHandler.updateComponentProps(t)}},{key:"appendComponent",value:function(e,t,n){this.props.componentDataHandler.appendComponent(e,t,n)}},{key:"setComponentPosition",value:function(e,t){return this.setComponentsPosition([{componentId:e,position:t}])}},{key:"setComponentSize",value:function(e,t){console.assert(null!=e),console.assert(null!=t);var n=this.findComponentData(e);if(!n)throw new Error("Control ".concat(e," is not exits."));var o=n.props.style=n.props.style||{};t.height&&(o.height=t.height),t.width&&(o.width=t.width);var r=this.state.pageData;this.setState({pageData:r})}},{key:"setComponentsPosition",value:function(e){var t=this,n=[];e.forEach((function(e){var o=e.componentId,r=e.position,a=r.left,i=r.top,c=t.props.componentDataHandler.findComponentData(o);if(!c)throw new Error("Control ".concat(o," is not exits."));var s=c.props.style=c.props.style||{};a&&(s.left=a),i&&(s.top=i),n.push({componentId:o,propName:"style",value:s})})),this.props.componentDataHandler.updateComponentProps(n)}},{key:"selectComponent",value:function(e){this.props.componentDataHandler.selectComponents(e),this._element&&this._element.focus()}},{key:"removeComponent",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.props.componentDataHandler.removeComponents(t)}},{key:"moveComponent",value:function(e,t,n){return this.props.componentDataHandler.moveComponent(e,t,n)}},{key:"removeComponentFrom",value:function(e,t){for(var n=null,o=0;o<t.length;o++)if(e==t[o].props.id){n=o;break}if(null==n){for(var r=0;r<t.length;r++){var a=t[r],i=p.translateComponentDataChildren(a.children);if(i&&i.length>0&&this.removeComponentFrom(e,i))return!0}return!1}return 0==n?t.shift():n==t.length-1?t.pop():t.splice(n,1),!0}},{key:"findComponentData",value:function(e){return this.props.componentDataHandler.findComponentData(e)}},{key:"onKeyDown",value:function(e){if(46==e.keyCode){if(0==this.selectedComponents.length)return;this.props.componentDataHandler.removeComponents(this.selectedComponentIds)}}},{key:"createDesignTimeElement",value:function(e,t){if(null==e)throw u.Errors.argumentNull("type");if(null==t)throw u.Errors.argumentNull("props");if(null==t.id)throw u.Errors.argumentFieldCanntNull("id","props");console.assert(null!=t.id),null!=t.id&&(t.key=t.id);var n=f.Component.getAttribute(e);console.assert(null!=n);var o=t.attr||{},r=Object.assign({},n,o);delete t.attr;var a=t.selected?d.appendClassName(t.className||"",d.classNames.componentSelected):t.className,i=Object.assign({},t);delete i.ref,i.className=a;for(var c=arguments.length,s=new Array(c>2?c-2:0),p=2;p<c;p++)s[p-2]=arguments[p];return l.createElement(m.ComponentWrapper,Object.assign({},i,{designer:this,source:{type:e,attr:r,props:t,children:s}}))}},{key:"render",value:function(){var e=this,t=this.state.pageData,n=this.props.style,o=this.props.elementTag||"div";return l.createElement(o,{className:d.classNames.designer,tabIndex:1,style:n,ref:function(n){n&&(e._element=n||e._element,e.props.componentFactory.renderDesignTimeComponent(t,n,{handler:e.props.componentDataHandler}))},onKeyDown:function(t){return e.onKeyDown(t)}})}},{key:"pageData",get:function(){return this.state.pageData}},{key:"selectedComponentIds",get:function(){return this.selectedComponents.map((function(e){return e.props.id}))}},{key:"selectedComponents",get:function(){return this.props.componentDataHandler.selectedComponents}},{key:"element",get:function(){return this._element}}])&&a(n.prototype,y),h&&a(n,h),t}(l.Component);y.defaultProps={componentDataHandler:null},t.PageDesigner=y},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(13),n(15),n(16),n(17),n(18);var r=n(4);t.strings=r.proptDisplayNames,t.proptDisplayNames=r.proptDisplayNames;var a=n(1);t.Component=a.Component,t.DesignerContext=a.DesignerContext;var i=n(6);t.ComponentPanel=i.ComponentPanel;var c=n(23);t.EditorPanel=c.EditorPanel;var s=n(10);t.PageDesigner=s.PageDesigner;var l=n(25);t.PropEditor=l.PropEditor,t.TextInput=l.TextInput;var p=n(3);t.classNames=p.classNames;var u=n(26);t.ComponentFactory=u.ComponentFactory;var f=n(27);t.ComponentDataHandler=f.ComponentDataHandler,o(n(5)),o(n(28));var d=n(29);t.component=d.component},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(14);null==(window.$||window.jQuery)&&(window.$=window.jQuery=o)},function(e,n){e.exports=t},function(e,t){!function(e){e.fn.drag=function(t,n,o){var r="string"==typeof t?t:"",a=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==r.indexOf("drag")&&(r="drag"+r),o=(t==a?n:o)||{},a?this.bind(r,o,a):this.trigger(r)};var t=e.event,n=t.special,o=n.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var n=e.data(this,o.datakey),r=t.data||{};n.related+=1,e.each(o.defaults,(function(e,t){void 0!==r[e]&&(n[e]=r[e])}))},remove:function(){e.data(this,o.datakey).related-=1},setup:function(){if(!e.data(this,o.datakey)){var n=e.extend({related:0},o.defaults);e.data(this,o.datakey,n),t.add(this,"touchstart mousedown",o.init,n),this.attachEvent&&this.attachEvent("ondragstart",o.dontstart)}},teardown:function(){(e.data(this,o.datakey)||{}).related||(e.removeData(this,o.datakey),t.remove(this,"touchstart mousedown",o.init),o.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",o.dontstart))},init:function(r){if(!o.touched){var a,i=r.data;if(!(0!=r.which&&i.which>0&&r.which!=i.which)&&!e(r.target).is(i.not)&&(!i.handle||e(r.target).closest(i.handle,r.currentTarget).length)&&(o.touched="touchstart"==r.type?this:null,i.propagates=1,i.mousedown=this,i.interactions=[o.interaction(this,i)],i.target=r.target,i.pageX=r.pageX,i.pageY=r.pageY,i.dragging=null,a=o.hijack(r,"draginit",i),i.propagates))return(a=o.flatten(a))&&a.length&&(i.interactions=[],e.each(a,(function(){i.interactions.push(o.interaction(this,i))}))),i.propagates=i.interactions.length,!1!==i.drop&&n.drop&&n.drop.handler(r,i),o.textselect(!1),o.touched?t.add(o.touched,"touchmove touchend",o.handler,i):t.add(document,"mousemove mouseup",o.handler,i),!(!o.touched||i.live)&&void 0}},interaction:function(t,n){var r=e(t)[n.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new o.callback,droppable:[],offset:r}},handler:function(r){var a=r.data;switch(r.type){case!a.dragging&&"touchmove":r.preventDefault();case!a.dragging&&"mousemove":if(Math.pow(r.pageX-a.pageX,2)+Math.pow(r.pageY-a.pageY,2)<Math.pow(a.distance,2))break;r.target=a.target,o.hijack(r,"dragstart",a),a.propagates&&(a.dragging=!0);case"touchmove":r.preventDefault();case"mousemove":if(a.dragging){if(o.hijack(r,"drag",a),a.propagates){!1!==a.drop&&n.drop&&n.drop.handler(r,a);break}r.type="mouseup"}case"touchend":case"mouseup":default:o.touched?t.remove(o.touched,"touchmove touchend",o.handler):t.remove(document,"mousemove mouseup",o.handler),a.dragging&&(!1!==a.drop&&n.drop&&n.drop.handler(r,a),o.hijack(r,"dragend",a)),o.textselect(!0),!1===a.click&&a.dragging&&e.data(a.mousedown,"suppress.click",(new Date).getTime()+5),a.dragging=o.touched=!1}},hijack:function(n,r,a,i,c){if(a){var s,l,p,u={event:n.originalEvent,type:n.type},f=r.indexOf("drop")?"drag":"drop",d=i||0,m=isNaN(i)?a.interactions.length:i;n.type=r,n.originalEvent=null,a.results=[];do{if(l=a.interactions[d]){if("dragend"!==r&&l.cancelled)continue;p=o.properties(n,a,l),l.results=[],e(c||l[f]||a.droppable).each((function(i,c){if(p.target=c,n.isPropagationStopped=function(){return!1},!1===(s=c?t.dispatch.call(c,n,p):null)?("drag"==f&&(l.cancelled=!0,a.propagates-=1),"drop"==r&&(l[f][i]=null)):"dropinit"==r&&l.droppable.push(o.element(s)||c),"dragstart"==r&&(l.proxy=e(o.element(s)||l.drag)[0]),l.results.push(s),delete n.result,"dropinit"!==r)return s})),a.results[d]=o.flatten(l.results),"dropinit"==r&&(l.droppable=o.flatten(l.droppable)),"dragstart"!=r||l.cancelled||p.update()}}while(++d<m);return n.type=u.type,n.originalEvent=u.event,o.flatten(a.results)}},properties:function(e,t,n){var r=n.callback;return r.drag=n.drag,r.proxy=n.proxy||n.drag,r.startX=t.pageX,r.startY=t.pageY,r.deltaX=e.pageX-t.pageX,r.deltaY=e.pageY-t.pageY,r.originalX=n.offset.left,r.originalY=n.offset.top,r.offsetX=r.originalX+r.deltaX,r.offsetY=r.originalY+r.deltaY,r.drop=o.flatten((n.drop||[]).slice()),r.available=o.flatten((n.droppable||[]).slice()),r},element:function(e){if(e&&(e.jquery||1==e.nodeType))return e},flatten:function(t){return e.map(t,(function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?o.flatten(t):t}))},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",o.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};o.callback.prototype={update:function(){n.drop&&this.available.length&&e.each(this.available,(function(e){n.drop.locate(this,e)}))}};var r=t.dispatch;t.dispatch=function(t){if(!(e.data(this,"suppress."+t.type)-(new Date).getTime()>0))return r.apply(this,arguments);e.removeData(this,"suppress."+t.type)};var a=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,n){if(n){var o=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0]||null;o&&e.each(a.props,(function(e,n){t[n]=o[n]}))}return t}};n.draginit=n.dragstart=n.dragend=o}(jQuery)},function(e,t){!function(e){var t=e.event,n=t.special.drag,o=n.add,r=n.teardown;n.noBubble=!1,n.livekey="livedrag",n.add=function(r){o.apply(this,arguments);var a=e.data(this,n.datakey);!a.live&&r.selector&&(a.live=!0,t.add(this,"draginit."+n.livekey,n.delegate))},n.teardown=function(){r.apply(this,arguments);var o=e.data(this,n.datakey)||{};o.live&&(t.remove(this,"draginit."+n.livekey,n.delegate),o.live=!1)},n.delegate=function(o){var r,a=[],i=e.data(this,"events")||{};return e.each(i||[],(function(i,c){0===i.indexOf("drag")&&e.each(c||[],(function(i,c){(r=e(o.target).closest(c.selector,o.currentTarget)[0])&&(t.add(r,c.origType+"."+n.livekey,c.origHandler||c.handler,c.data),e.inArray(r,a)<0&&a.push(r))}))})),!!a.length&&e(a).bind("dragend."+n.livekey,(function(){t.remove(this,"."+n.livekey)}))}}(jQuery)},function(e,t){!function(e){e.fn.drop=function(t,n,o){var r="string"==typeof t?t:"",a=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==r.indexOf("drop")&&(r="drop"+r),o=(t==a?n:o)||{},a?this.bind(r,o,a):this.trigger(r)},e.drop=function(t){t=t||{},n.multi=!0===t.multi?1/0:!1===t.multi?1:isNaN(t.multi)?n.multi:t.multi,n.delay=t.delay||n.delay,n.tolerance=e.isFunction(t.tolerance)?t.tolerance:null===t.tolerance?null:n.tolerance,n.mode=t.mode||n.mode||"intersect"};var t=e.event.special,n=e.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(t){e.data(this,n.datakey).related+=1},remove:function(){e.data(this,n.datakey).related-=1},setup:function(){if(!e.data(this,n.datakey)){e.data(this,n.datakey,{related:0,active:[],anyactive:0,winner:0,location:{}}),n.targets.push(this)}},teardown:function(){if(!(e.data(this,n.datakey)||{}).related){e.removeData(this,n.datakey);var t=this;n.targets=e.grep(n.targets,(function(e){return e!==t}))}},handler:function(o,r){var a;if(r)switch(o.type){case"mousedown":case"touchstart":a=e(n.targets),"string"==typeof r.drop&&(a=a.filter(r.drop)),a.each((function(){var t=e.data(this,n.datakey);t.active=[],t.anyactive=0,t.winner=0})),r.droppable=a,t.drag.hijack(o,"dropinit",r);break;case"mousemove":case"touchmove":n.event=o,n.timer||n.tolerate(r);break;case"mouseup":case"touchend":n.timer=clearTimeout(n.timer),r.propagates&&(t.drag.hijack(o,"drop",r),t.drag.hijack(o,"dropend",r))}},locate:function(t,o){var r=e.data(t,n.datakey),a=e(t),i=a.offset()||{},c=a.outerHeight(),s=a.outerWidth(),l={elem:t,width:s,height:c,top:i.top,left:i.left,right:i.left+s,bottom:i.top+c};return r&&(r.location=l,r.index=o,r.elem=t),l},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,n){return this.contains(n,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,n){return Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top))*Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left))},fit:function(e,t,n){return this.contains(n,t)?1:0},middle:function(e,t,n){return this.contains(n,[t.left+.5*t.width,t.top+.5*t.height])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(o){var r,a,i,c,s,l,p,u,f=0,d=o.interactions.length,m=[n.event.pageX,n.event.pageY],y=n.tolerance||n.modes[n.mode];do{if(u=o.interactions[f]){if(!u)return;u.drop=[],s=[],l=u.droppable.length,y&&(i=n.locate(u.proxy)),r=0;do{if(p=u.droppable[r]){if(!(a=(c=e.data(p,n.datakey)).location))continue;c.winner=y?y.call(n,n.event,i,a):n.contains(a,m)?1:0,s.push(c)}}while(++r<l);s.sort(n.sort),r=0;do{(c=s[r])&&(c.winner&&u.drop.length<n.multi?(c.active[f]||c.anyactive||(!1!==t.drag.hijack(n.event,"dropstart",o,f,c.elem)[0]?(c.active[f]=1,c.anyactive+=1):c.winner=0),c.winner&&u.drop.push(c.elem)):c.active[f]&&1==c.anyactive&&(t.drag.hijack(n.event,"dropend",o,f,c.elem),c.active[f]=0,c.anyactive-=1))}while(++r<l)}}while(++f<d);n.last&&m[0]==n.last.pageX&&m[1]==n.last.pageY?delete n.timer:n.timer=setTimeout((function(){n.tolerate(o)}),n.delay),n.last=n.event}};t.dropinit=t.dropstart=t.dropend=n}(jQuery)},function(e,t){!function(e){var t=e.event,n=t.special.drop,o=n.add,r=n.teardown;n.noBubble=!1,n.livekey="livedrop",n.add=function(r){o.apply(this,arguments);var a=e.data(this,n.datakey);!a.live&&r.selector&&(a.live=!0,t.add(this,"dropinit."+n.livekey,n.delegate))},n.teardown=function(){r.apply(this,arguments);var o=e.data(this,n.datakey)||{};o.live&&(t.remove(this,"dropinit",n.delegate),o.live=!1)},n.delegate=function(o,r){var a,i=[],c=e.data(this,"events")||{};return e.each(c||[],(function(r,c){0===r.indexOf("drop")&&e.each(c,(function(r,c){(a=e(o.currentTarget).find(c.selector)).length&&a.each((function(){t.add(this,c.origType+"."+n.livekey,c.origHandler||c.handler,c.data),e.inArray(this,i)<0&&i.push(this)}))}))})),r&&t.add(r.drag,"dragend."+n.livekey,(function(){e.each(i.concat(this),(function(){t.remove(this,"."+n.livekey)}))})),!!i.length&&e(i)}}(jQuery)},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),p=n(2),u=n(6),f=n(3),d=n(1),m=n(5),y=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,c(t).call(this,e))}var n,o,y;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,e),n=t,y=[{key:"enableAppendDroppable",value:function(e,t){console.assert(null!=e),e.addEventListener("dragover",(function(e){e.preventDefault(),e.stopPropagation();var t=e.dataTransfer.getData(m.constants.componentData);e.dataTransfer.dropEffect=t?"copy":"move",console.log("dragover: left:".concat(e.layerX," top:").concat(e.layerX))})),e.addEventListener("drop",(function(n){if(n.preventDefault(),n.stopPropagation(),arguments[1],n.dataTransfer){var o=u.ComponentPanel.getComponentData(n.dataTransfer);if(o){o.props.style=o.props.style||{},t.pageData.props.style=t.pageData.props.style||{},o.props.style.position||(o.props.style.position=t.pageData.props.style.position);var r=u.ComponentPanel.mouseInnerPosition(n.dataTransfer);console.assert(null!=r),"absolute"==o.props.style.position&&(o.props.style.left=n.layerX-r.x,o.props.style.top=n.layerY-r.y),t.appendComponent(e.id,o)}}}))}},{key:"isResizeHandleClassName",value:function(e){return["resize_handle NE","resize_handle NN","resize_handle NW","resize_handle WW","resize_handle EE","resize_handle SW","resize_handle SS","resize_handle SE"].indexOf(e)>=0}},{key:"draggable",value:function(e,n,o){if(!e)throw p.Errors.argumentNull("designer");if(!n)throw p.Errors.argumentNull("element");console.assert(""!=n.id),o=o||n;var r,a,i,c=n.id;console.assert(""!=c),$(o).drag("init",(function(e){if(r=$(n).position(),$(this).is(".".concat(f.classNames.componentSelected)))return $(".".concat(f.classNames.componentSelected))})).drag("start",(function(e,t){t.attr=$(e.target).prop("className"),t.width=$(this).width(),t.height=$(this).height(),t.sourceElement=n,i=Date.now()})).drag((function(e,n){e.preventDefault(),e.stopPropagation(),console.log("drop:"),console.log(n.drop),a={},n.attr.indexOf("E")>-1&&(a.width=Math.max(32,n.width+n.deltaX)),n.attr.indexOf("S")>-1&&(a.height=Math.max(32,n.height+n.deltaY)),n.attr.indexOf("W")>-1&&(a.width=Math.max(32,n.width-n.deltaX),u(n)),n.attr.indexOf("N")>-1&&(a.height=Math.max(32,n.height-n.deltaY),l(n)),n.attr.indexOf("WW")>=0&&u(n),(n.attr.indexOf("NE")>=0||n.attr.indexOf("NW")>=0||n.attr.indexOf("SW")>=0)&&s(n),n.attr.indexOf("NN")>=0&&l(n),n.attr.indexOf("drag")>-1&&(a.top=n.offsetY,a.left=n.offsetX),t.isResizeHandleClassName(n.attr)||s(n),n.attr&&$(this).css(a)}),{click:!0}).drag("end",(function(o,s){var l=Date.now()-i;if(t.isDrag=l>=300,t.isResizeHandleClassName(s.attr)){var p,u;s.attr.indexOf("W")>-1&&(p=r.left+s.deltaX),s.attr.indexOf("N")>-1&&(u=r.top+s.deltaY),n.style.transform="",e.setComponentPosition(n.id,{left:p,top:u}),e.setComponentSize(c,a)}else{var f=r.left+s.deltaX,d=r.top+s.deltaY;e.setComponentPosition(n.id,{left:f,top:d}),n.style.transform=""}})).click((function(o){t.invokeOnClick(o,e,n)}));var s=function(e){console.log(["dd.offsetX, dd.offsetY",e.offsetX,e.offsetY]),console.log(e),n.style.transform="translate(".concat(e.deltaX,"px,").concat(e.deltaY,"px)")},l=function(e){n.style.transform="translateY(".concat(e.deltaY,"px)")},u=function(e){n.style.transform="translateX(".concat(e.deltaX,"px)")}}},{key:"invokeOnClick",value:function(e,n,o){if(e.preventDefault(),e.stopPropagation(),t.isDrag)t.isDrag=!1;else{var r=o.id;if(e.ctrlKey){var a=n.selectedComponentIds;console.assert(""!=r),a.indexOf(r)>=0?a=a.filter((function(e){return e!=r})):a.push(r),n.selectComponent(a)}else n.selectComponent(o.id)}}}],(o=[{key:"componentDidCatch",value:function(e,t){this.setState({error:e})}},{key:"designtimeBehavior",value:function(e,n){if(!e)throw p.Errors.argumentNull("element");if(!n)throw p.Errors.argumentNull("args");if(!e.getAttribute("data-behavior")){e.setAttribute("data-behavior","behavior");var o=this.props.designer;console.assert(null!=n.container),console.assert(null!=n.movable),n.container&&t.enableAppendDroppable(e,o),n.movable?(console.assert(null!=e),t.draggable(o,e),null!=this.handler&&t.draggable(o,e,this.handler)):e.onclick=function(n){return t.invokeOnClick(n,o,e)}}}},{key:"componentDidMount",value:function(){if(this.element){var e=this.props.source.attr;this.designtimeBehavior(this.element,e)}}},{key:"render",value:function(){var e=this,t=(this.state||{}).error;if(t)return l.createElement("div",{className:"error"},l.createElement("div",null,t.message),l.createElement("div",null,t.stack));var n=this.props.source.attr;if(!(n.resize||"string"!=typeof this.props.source.type&&this.props.source.type!=m.MasterPage))return this.renderWidthoutWrapper();var o=this.props.source.props,r=o.style=JSON.parse(JSON.stringify(o.style||{})),a=r.top,i=r.left,c=r.position,s=r.width,p=r.height,u=r.display,y=r.visibility,h=f.appendClassName(o.className||"",f.classNames.componentWrapper);h=o.selected?f.appendClassName(h,f.classNames.componentSelected):h;var v={id:o.id,className:h,style:{top:a,left:i,position:c,width:s,height:p,display:u,visibility:y},ref:function(t){return e.element=t||e.element}},g=o.selected&&n.showHandler?l.createElement("div",{className:"move_handle",style:{},ref:function(t){return e.handler=t||e.handler}}):null,b=n.resize&&"absolute"==o.style.position&&o.selected,w=this.props.source;return o.style&&(delete o.style.left,delete o.style.top,delete o.style.position,v.style.width&&"unset"!=v.style.width&&(o.style.width="100%"),v.style.height&&"unset"!=v.style.height&&(o.style.height="100%")),l.createElement(d.ComponentWrapperContext.Provider,{value:this},l.createElement("div",Object.assign({},v),g,b?l.createElement(l.Fragment,null,l.createElement("div",{className:"resize_handle NE"}),l.createElement("div",{className:"resize_handle NN"}),l.createElement("div",{className:"resize_handle NW"}),l.createElement("div",{className:"resize_handle WW"}),l.createElement("div",{className:"resize_handle EE"}),l.createElement("div",{className:"resize_handle SW"}),l.createElement("div",{className:"resize_handle SS"}),l.createElement("div",{className:"resize_handle SE"})):null,this.createRawElement(w.type,w.props,w.children)))}},{key:"renderWidthoutWrapper",value:function(){var e=this,t=this.props.source,n=t.type,o=t.props,r=t.children,a=o.ref;o.ref=function(t){if("function"==typeof a&&a(t),t&&t.tagName){var n=e.props.source.attr;e.designtimeBehavior(t,n)}},o.selected&&(o.className=f.appendClassName(o.className||"",f.classNames.componentSelected));var i=this.createRawElement(n,o,r);return l.createElement(d.ComponentWrapperContext.Provider,{value:this},i)}},{key:"createRawElement",value:function(e,t,n){if(0==(n||[]).length){var o=this.designTimeEmptyElement(e,t);null!=o&&(n=[o])}return l.createElement.apply(l,[e,t].concat(r(n)))}},{key:"designTimeEmptyElement",value:function(e,t){if("input"==e||"img"==e||"meta"==e||"link"==e)return null;var n="string"==typeof e?e:e.name;return this.designTimeText(n,t)}},{key:"designTimeText",value:function(e,t){var n=t.text;return n||(n=n||t.name||e)}}])&&a(n.prototype,o),y&&a(n,y),t}(l.Component);y.isDrag=!1,t.ComponentWrapper=y},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),l=n(21),p=n(3),u=n(6),f=n(9),d=n(1),m=n(7),y=function(e){function t(e){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!(n=a(this,i(t).call(this,e))).props.id)throw l.Errors.placeHolderIdNull();return n}var n,o,y;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),n=t,(o=[{key:"enableAppendDroppable",value:function(e,t){var n=this;if(!e.getAttribute("enable-append-droppable")){e.setAttribute("enable-append-droppable","true"),console.assert(null!=e),e.addEventListener("dragover",(function(t){t.preventDefault(),t.stopPropagation(),e.className=p.appendClassName(e.className||"","active");var n=t.dataTransfer.getData(m.constants.componentData);t.dataTransfer.dropEffect=n?"copy":"move",console.log("dragover: left:".concat(t.layerX," top:").concat(t.layerX))}));var o=function(t){t.preventDefault(),t.stopPropagation(),e.className=p.removeClassName(e.className,"active")};e.addEventListener("dragleave",o),e.addEventListener("dragend",o),e.addEventListener("dragexit",o),e.ondrop=function(o){var r;o.preventDefault(),o.stopPropagation(),e.className=p.removeClassName(e.className,"active"),o.dataTransfer&&(r=u.ComponentPanel.getComponentData(o.dataTransfer)),r&&(console.assert(null!=n.props.id),console.assert(null!=n.designer),r.props.parentId=n.props.id,console.assert(null!=t,"host is null"),n.designer.appendComponent(t.props.id,r))}}}},{key:"enableMoveDroppable",value:function(e,t){var n=this;e.getAttribute("enable-move-droppable")||(e.setAttribute("enable-move-droppable","true"),$(e).drop("start",(function(t,o){o.sourceElement.id!=n.wraper.props.source.props.id&&p.appendClassName(e,"active")})).drop("drop",(function(e,o){if(o.sourceElement.id!=n.wraper.props.source.props.id){var r=n.designer.findComponentData(o.sourceElement.id);console.assert(null!=r),n.designer.moveComponent(o.sourceElement.id,t.props.id),n.designer.updateComponentProps({componentId:"string",propName:"string",value:"any"})}})).drop("end",(function(t,o){o.sourceElement.id!=n.wraper.props.source.props.id&&p.removeClassName(e,"active")})))}},{key:"render",value:function(){var e=this,t=this.props.empty||s.createElement("div",{key:m.guid(),className:"empty"},"可以拖拉控件到这里");return s.createElement(f.MasterPageContext.Consumer,null,(function(n){var o=n.master;if(null==o)throw l.Errors.canntFindMasterPage(e.props.id);var r,a=[];return o.props&&o.props.children&&(r=Array.isArray(o.props.children)?o.props.children:[o.props.children],a=r.filter((function(t){return null!=t.props.parentId&&t.props.parentId==e.props.id}))),s.createElement(d.DesignerContext.Consumer,null,(function(n){return s.createElement(d.ComponentWrapperContext.Consumer,null,(function(r){e.wraper=r,console.assert(null!=e.wraper),null!=n.designer&&0==a.length&&(a=[t]);var i=s.createElement(s.Fragment,null,e.props.children,a);return n.designer&&(e.designer=n.designer,i=s.createElement("div",{key:m.guid(),className:p.classNames.placeholder,ref:function(t){t&&(e.element=t,e.enableAppendDroppable(t,o),e.enableMoveDroppable(t,o))}},i)),i}))}))}))}}])&&r(n.prototype,o),y&&r(n,y),t}(s.Component);t.PlaceHolder=y,d.Component.register(m.ComponentTypes.PlaceHolder,y)},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"propCanntNull",value:function(e,t){var n="".concat(e," property ").concat(t," cannt be null or empty.");return new Error(n)}},{key:"placeHolderIdNull",value:function(){return new Error("Place holder property id cannt be null or empty.")}},{key:"canntFindMasterPage",value:function(e){return new Error("Can not find master page for component container ".concat(e,"."))}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();t.Errors=r},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),p=n(1),u=n(7),f=function(e){function t(){return r(this,t),i(this,c(t).apply(this,arguments))}var n,o,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){return l.createElement("span",null,this.props.text)}}])&&a(n.prototype,o),p&&a(n,p),t}(l.Component);t.Text=f,p.Component.register(u.ComponentTypes.Text,f)},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),l=n(24),p=n(3),u=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=a(this,i(t).call(this,e))).state={componentDatas:[]},n}var n,o,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){var e=this,t=this.props.empty;t=t||s.createElement("div",{className:"empty"},"暂无可用的属性");var n=this.props.designer;return s.createElement("div",{className:"".concat(p.classNames.editorPanel," ").concat(this.props.className||""),ref:function(t){return e.element=t||e.element}},s.createElement(l.PropertyEditor,{designer:n,ref:function(t){return e.editor=t||e.editor},empty:t,customRender:this.props.customRender}))}},{key:"designer",get:function(){return this._designer}}])&&r(n.prototype,o),u&&r(n,u),t}(s.Component);t.EditorPanel=u},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),f=n(1),d=n(4),m=n(2),y=function(e){function t(e){var n;return r(this,t),(n=c(this,s(t).call(this,e)))._element=null,n.state={groupedEditors:[]},n.props.designer.componentSelected.add((function(){var e=n.getEditors(n.props.designer);n.setState({groupedEditors:e})})),n}return l(t,e),i(t,[{key:"getEditors",value:function(e){var t=this;if(null==e)return[];for(var n,o=[],r=e.selectedComponents,a=function(e){var t=r[e],n=f.Component.getPropEditors(t);if(0==e)o=n||[];else{var a=[];o.forEach((function(e){n.forEach((function(t){var n=e.propName,o=t.propName;e.editorType==t.editorType&&n==o&&a.push(e)}))})),o=a}},i=0;i<r.length;i++)a(i);for(i=0;i<r.length;i++){var c=r[i],s=Object.assign({},c.props);if(delete s.children,0==i)n=s;else{var l={};for(var p in n)n[p]==s[p]&&(l[p]=s[p]);n=l}}for(var d=[],m=function(a){var i=o[a],c=i.propName,s=i.editorType,l={value:t.propValue(c,n),editComponents:r,updateComponentProp:function(t){var n=r.map((function(e){return{componentId:e.props.id,propName:i.propName,value:t}}));e.updateComponentProps(n)}},p=u.createElement(s,l);d.push({prop:i.propName,editor:p,group:i.group})},y=0;y<o.length;y++)m(y);return d}},{key:"propValue",value:function(e,t){if(!e)throw m.Errors.argumentNull("propName");if(!t)throw m.Errors.argumentNull("props");for(var n=e.split("."),o=t,r=0;r<n.length;r++)if(null==(o=o[n[r]]))return null;return o}},{key:"render",value:function(){var e=this.props.designer,t=this.state.groupedEditors;if(0==t.length){var n=this.props.empty;return u.createElement("div",{className:"text-center"},n)}if(this.props.customRender){var o=t.map((function(e){return Object.assign({displayName:d.proptDisplayNames[e.prop]||e.prop},e)})),r=this.props.customRender(e.selectedComponents,o);if(null!=r)return r}for(var a=[],i=function(e){var n=t[e].group||"",o=a.filter((function(e){return e.group==n}))[0];null==o&&(o={group:t[e].group,editors:[]},a.push(o)),o.editors.push({prop:t[e].prop,editor:t[e].editor})},c=0;c<t.length;c++)i(c);return u.createElement(u.Fragment,null,a.map((function(e){return u.createElement("div",{key:e.group,className:"panel panel-default"},e.group?u.createElement("div",{className:"panel-heading"},d.proptDisplayNames[e.group]||e.group):null,u.createElement("div",{className:"panel-body"},e.editors.map((function(e,t){return u.createElement("div",{key:e.prop,className:"form-group clearfix"},u.createElement("label",null,d.proptDisplayNames[e.prop]||e.prop),u.createElement("div",{className:"control"},u.createElement(h,null,e.editor)))}))))})))}},{key:"element",get:function(){return this._element}}]),t}(u.Component);t.PropertyEditor=y;var h=function(e){function t(e){var n;return r(this,t),(n=c(this,s(t).call(this,e))).state={},n}return l(t,e),i(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e})}},{key:"render",value:function(){var e=(this.state||{}).error;return e?u.createElement("div",{className:"error"},u.createElement("div",null,e.message),u.createElement("div",null,e.stack)):this.props.children}}]),t}(u.Component);t.ErrorBoundary=h},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(i,c)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var f=n(0),d=function(e){function t(e){return r(this,t),c(this,s(t).call(this,e))}return l(t,e),i(t,null,[{key:"dropdown",value:function(e,t){return y(e,t)}},{key:"textInput",value:function(){return m}}]),t}(f.Component);t.PropEditor=d;var m=function(e){function t(){return r(this,t),c(this,s(t).apply(this,arguments))}return l(t,e),i(t,[{key:"render",value:function(){var e=this,t=this.props.value;return f.createElement("input",{className:"form-control",value:t||"",onChange:function(t){e.props.updateComponentProp(t.target.value)}})}}]),t}(d);function y(e,t){var n,o=[];if(null==t&&Array.isArray(e)){t=e.length>0&&"number"==typeof e[0]?"number":"string";for(var a=0;a<e.length;a++)o[a]={text:e[a],value:e[a]}}else if(null==t){t="string";for(var p=Object.getOwnPropertyNames(e),m=0;m<p.length;m++)o[m]={text:e[p[m]],value:p[m]}}else Array.isArray(e)?o=e:n=e;return function(e){function a(e){var t;return r(this,a),(t=c(this,s(a).call(this,e))).state={},t}return l(a,e),i(a,[{key:"componentDidMount",value:function(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,n;case 3:t=e.sent,this.setState({items:t});case 5:case"end":return e.stop()}}),e,this)})))}},{key:"render",value:function(){var e=this,n=this.state.items,r=this.props.value;return n=n||o,f.createElement("select",{className:"form-control",value:null==r?"":r,onChange:function(n){var o=n.target.value;if("number"==t){r=/^\d+$/.test(o)?parseInt(o):/^[+-]?\d+(\.\d+)?$/.test(o)?parseFloat(o):null}else r=o;e.props.updateComponentProp(r)}},n.map((function(e){return f.createElement("option",{key:e.value,value:e.value},e.text)})))}}]),a}(d)}t.TextInput=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ComponentFactory=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}},function(e,t,n){"use strict";function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),c=n(8),s=n(4),l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._components={},this.componentSelected=c.Callback.create(),this.componentRemoved=c.Callback.create(),this.componentAppend=c.Callback.create(),this.componentUpdated=c.Callback.create(),this.pageDataChanged=c.Callback.create(),this._pageData=t,e.initPageData(this._pageData,this._components)}var t,n,l;return t=e,l=[{key:"initPageData",value:function(t,n){null!=t&&(t.children=t.children||[],e.nameComponent(t),e.setComponetRefProp(t,n))}},{key:"travelComponentData",value:function(e,t){var n=new Array;n.push(e);var a=[];for(t=t||function(){return!0};n.length>0;){var i=n.shift();t(i)&&a.push(i);var c=(i.children||[]).filter((function(e){return"object"==r(e)}));n.push.apply(n,o(c))}return a}},{key:"nameComponent",value:function(t){var n={},o=t.props=t.props||{};if(!o.name){var r,a=0;do{a+=1,r="".concat(t.type).concat(a)}while(n[r]);n[r]=t,o.name=r}if(o.id||(o.id=c.guid()),t.children&&0!=t.children.length)for(var i=s.translateComponentDataChildren(t.children),l=0;l<i.length;l++)e.nameComponent(i[l])}},{key:"setComponetRefProp",value:function(t,n){var o={};e.travelComponentData(t).forEach((function(e){console.assert(null!=e.props&&null!=e.props.id),o[e.type]=o[e.type]||[],o[e.type].push(e.props.id);var t=e.props.ref;e.props.ref=function(o){null!=o&&(n[e.type]=n[e.type]||[],n[e.type].push(o)),"function"==typeof t&&t(o)}}));for(var r=Object.getOwnPropertyNames(n),a=function(e){var t=r[e],a=o[t]||[];n[t]=(n[t]||[]).filter((function(e){return a.indexOf(e.id||e.props.id)>=0}))},i=0;i<r.length;i++)a(i)}}],(n=[{key:"moveComponent",value:function(e,t,n){var o=this.findComponentData(e);if(null==o)throw new Error("Cannt find component by id ".concat(e));console.assert(null!=o,"Cannt find component by id ".concat(e));var r=this.pageData;console.assert(null!=r.children);var a=s.translateComponentDataChildren(r.children);this.removeComponentFrom(e,a),this.appendComponent(t,o,n)}},{key:"updateComponentProps",value:function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n],r=o.componentId,a=o.propName,i=o.value,c=this.findComponentData(r);if(null!=c){var s=a.split(".");console.assert(null!=c),console.assert(null!=s,"props is null"),c.props=c.props||{};for(var l=c.props,p=0;p<s.length-1;p++)l=l[s[p]]=l[s[p]]||{};l[s[s.length-1]]=i,t.push(c)}}this.componentUpdated.fire(t)}},{key:"findComponentData",value:function(t){var n=this._pageData;if(!n)throw i.Errors.pageDataIsNull();return e.travelComponentData(n,(function(e){return e.props.id==t}))[0]}},{key:"removeComponentFrom",value:function(e,t){for(var n=null,o=0;o<t.length;o++)if(e==t[o].props.id){n=o;break}if(null==n){for(var r=0;r<t.length;r++){var a=t[r],i=s.translateComponentDataChildren(a.children);if(i&&i.length>0&&this.removeComponentFrom(e,i))return!0}return!1}return 0==n?t.shift():n==t.length-1?t.pop():t.splice(n,1),!0}},{key:"appendComponent",value:function(t,n,o){if(!t)throw i.Errors.argumentNull("parentId");if(!n)throw i.Errors.argumentNull("childComponent");e.nameComponent(n);var r=this.findComponentData(t);if(null==r)throw new Error("Parent is not exists");console.assert(null!=r),r.children=r.children||[],null!=o?r.children.splice(o,0,n):r.children.push(n),this.selectComponents(n.props.id),this.componentAppend.fire(this)}},{key:"selectComponents",value:function(e){"string"==typeof e&&(e=[e]);var t=[];for(t.push(this._pageData);t.length>0;){var n=t.pop(),o=e.indexOf(n.props.id)>=0;n.props.selected=o;for(var r=s.translateComponentDataChildren(n.children||[]),a=0;a<r.length;a++)t.push(r[a])}this.componentSelected.fire(this.selectedComponentIds)}},{key:"removeComponents",value:function(e){var t=this,n=this.pageData;if(n&&n.children&&0!=n.children.length){var o=s.translateComponentDataChildren(n.children);e.forEach((function(e){t.removeComponentFrom(e,o)})),this.componentRemoved.fire(e)}}},{key:"selectedComponents",get:function(){var e=new Array,t=new Array;for(t.push(this._pageData);t.length>0;){var n=t.pop();null!=n.props&&1==n.props.selected&&e.push(n);for(var o=s.translateComponentDataChildren(n.children||[]),r=0;r<o.length;r++)t.push(o[r])}return e}},{key:"selectedComponentIds",get:function(){return this.selectedComponents.map((function(e){return e.props.id}))}},{key:"components",get:function(){return this._components}},{key:"pageData",get:function(){return this._pageData},set:function(e){this._pageData=e,this.pageDataChanged.fire(e)}}])&&a(t.prototype,n),l&&a(t,l),e}();t.ComponentDataHandler=l},function(e,t,n){(function(t){
/*!
 * ~
 *  jueying-core v1.0.2
 * 
 *  Copyright (c) 2016-2018, mais.shu <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */
var o;"undefined"==typeof window||window,o=function(e){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./out/index.js")}({"./out/component-factory.js":
/*!**********************************!*\
  !*** ./out/component-factory.js ***!
  \**********************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(/*! react */"react"),r=n(/*! ./errors */"./out/errors.js");t.CompoenntFactory=class{constructor(e){this.compoenntTypes=e}createComponent(e,t){try{return this._createComponent(e,t)}catch(e){return this.createErrorElement(e)}}createViewComponent(e,...t){return o.createElement("div",e,...t)}createErrorElement(e){return this.createViewComponent(this.createViewComponent("Error:"),this.createViewComponent(e.message))}_createComponent(e,t){if("string"==typeof e)return e;let n=(e.children||[]).map(e=>this._createComponent(e)),a=e.props||{},i=e.typeName,c=this.compoenntTypes[i];if(null==c)throw r.errors.componentNotExists(i);return o.createElement(c,a,n)}}},"./out/errors.js":
/*!***********************!*\
  !*** ./out/errors.js ***!
  \***********************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errors={pathFieldRequired:e=>new Error(`Path field of '${e}' component config can not be null or empty.`),canntFindModule:(e,t)=>new Error(`Can not find component '${e}' in the module, module path is: '${t}'.`),componentNotExists:e=>new Error(`Component '${e}' not exists.`)}},"./out/index.js":
/*!**********************!*\
  !*** ./out/index.js ***!
  \**********************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(/*! ./component-factory */"./out/component-factory.js");t.CompoenntFactory=o.CompoenntFactory},react:
/*!************************!*\
  !*** external "react" ***!
  \************************/
/*! no static exports found */function(t,n){t.exports=e}})},e.exports=o(n(0))}).call(this,n(11))},function(e,t,n){
/*!
 * ~
 *  jueying-core v1.0.2
 * 
 *  Copyright (c) 2016-2018, mais.shu <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */
var o;window,o=function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./out/decorators.js")}({"./out/decorators.js":
/*!***************************!*\
  !*** ./out/decorators.js ***!
  \***************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.component=function(e){return function(e){}}}})},e.exports=o()}])}));
//# sourceMappingURL=index.es5.min.js.map