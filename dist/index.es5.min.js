/*!
 * 
 *  maishu-jueying v1.7.4
 *  https://github.com/ansiboy/jueying
 *  
 *  Copyright (c) 2016-2018, shu mai <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */
define(["react","jquery"],function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(t,n){t.exports=e},function(e,t,n){"use strict";var r;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.constants={componentsDir:"components",connectorElementClassName:"component-container",componentTypeName:"data-component-name",componentData:"component-data",componentPosition:"component-position"},t.proptDisplayNames={},t.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.funcs=new Array}var t,n,r;return t=e,r=[{key:"create",value:function(){return new e}}],(n=[{key:"add",value:function(e){this.funcs.push(e)}},{key:"remove",value:function(e){this.funcs=this.funcs.filter(function(t){return t!=e})}},{key:"fire",value:function(e){this.funcs.forEach(function(t){return t(e)})}}])&&o(t.prototype,n),r&&o(t,r),e}();t.Callback=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){"use strict";var r,o;r=[n,t,n(4)],void 0===(o=function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.classNames={componentSelected:"component-selected",emptyTemplates:"empty-templates",loadingTemplates:"loading-templates",templateSelected:"template-selected",templateDialog:"template-dialog",emptyDocument:"empty-document",component:"component",componentWrapper:"component-wrapper",componentPanel:"component-panel",componentIcon:"component-icon",placeholder:"placeholder",editorPanel:"editor-panel",designer:"designer",moveDown:"move-down"};var r=40,o=22,a=document.createElement("style");a.type="text/css",a.setAttribute("data-name","jueying"),a.innerHTML="\n            .".concat(t.classNames.componentSelected," {\n                border: solid 1px #337ab7!important;\n            }\n            .").concat(t.classNames.componentSelected," > :first-child {\n                border-color: blue;\n              }\n              .").concat(t.classNames.componentSelected," .resize_handle {\n                position: absolute;\n                height: 6px;\n                width: 6px;\n                border: 1px solid #89B;\n                background: #9AC;\n              }\n              .").concat(t.classNames.componentSelected," .move_handle {\n                height: 12px;\n                width: 12px;\n                top: 6px;\n                left: 8px;\n                border: solid 1px black;\n                position: relative;\n                margin-top: -12px;\n              }\n              .").concat(t.classNames.componentSelected," .NW,\n              .").concat(t.classNames.componentSelected," .NN,\n              .").concat(t.classNames.componentSelected," .NE {\n                top: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .NE,\n              .").concat(t.classNames.componentSelected," .EE,\n              .").concat(t.classNames.componentSelected," .SE {\n                right: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .SW,\n              .").concat(t.classNames.componentSelected,".SS,\n              .").concat(t.classNames.componentSelected," .SE {\n                bottom: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .NW,\n              .").concat(t.classNames.componentSelected," .WW,\n              .").concat(t.classNames.componentSelected," .SW {\n                left: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .SE,\n              .").concat(t.classNames.componentSelected," .NW {\n                cursor: nw-resize;\n              }\n              .").concat(t.classNames.componentSelected," .SW,\n              .").concat(t.classNames.componentSelected," .NE {\n                cursor: ne-resize;\n              }\n              .").concat(t.classNames.componentSelected," .NN,\n              .").concat(t.classNames.componentSelected," .SS {\n                cursor: n-resize;\n                left: 50%;\n                margin-left: -4px;\n              }\n              .").concat(t.classNames.componentSelected," .EE,\n              .").concat(t.classNames.componentSelected," .WW {\n                cursor: e-resize;\n                top: 50%;\n                margin-top: -4px;\n              }\n            .").concat(t.classNames.emptyTemplates," {\n                padding:50px 0;\n                text-align: center;\n            }\n            .").concat(t.classNames.loadingTemplates," {\n                padding:50px 0;\n                text-align: center;\n            }\n            .").concat(t.classNames.templateSelected," .page-view {\n                border: solid 1px #337ab7!important;\n            }\n            .").concat(t.classNames.templateDialog," .name {\n                margin-top: -").concat(r,"px;\n                height: ").concat(r,"px;\n                font-size: ").concat(o,"px;\n                text-align: center;\n                padding-top: 6px;\n                background-color: black;\n                opacity: 0.5;\n            }\n            .").concat(t.classNames.templateDialog," .name span {\n                color: white;\n            }\n            .").concat(t.classNames.emptyDocument," {\n                text-align: center;\n                padding: 100px 0;\n            }\n            .").concat(t.classNames.component," > .NW,\n            .").concat(t.classNames.component," > .NN,\n            .").concat(t.classNames.component," > .NE,\n            .").concat(t.classNames.component," > .EE,\n            .").concat(t.classNames.component," > .SE,\n            .").concat(t.classNames.component," > .SW,\n            .").concat(t.classNames.component," > .SS,\n            .").concat(t.classNames.component," > .WW {\n                display: none;\n            }\n            .").concat(t.classNames.componentSelected,".component > .NW,\n            .").concat(t.classNames.componentSelected,".component > .NN,\n            .").concat(t.classNames.componentSelected,".component > .NE,\n            .").concat(t.classNames.componentSelected,".component > .EE,\n            .").concat(t.classNames.componentSelected,".component > .SE,\n            .").concat(t.classNames.componentSelected,".component > .SW,\n            .").concat(t.classNames.componentSelected,".component > .SS,\n            .").concat(t.classNames.componentSelected,".component > .WW {\n                display: block;\n            }\n            .").concat(t.classNames.placeholder," {\n                min-height: 40px;\n                width: 100%;\n            }\n            .").concat(t.classNames.placeholder,".active,\n            .").concat(t.classNames.componentWrapper,".active,\n            .").concat(t.classNames.componentWrapper,".").concat(t.classNames.componentSelected,".active {\n                border: 1px solid green;\n            }\n            .").concat(t.classNames.editorPanel," {\n                width: 300px;\n                background: white;\n                color: black;\n                margin: 0;\n                font-size: 14px;\n                z-index: 100;\n                overflow: auto;\n            }\n            .").concat(t.classNames.editorPanel," label {\n                width: 80px;\n                float: left;\n                padding: 4px;\n                text-overflow: ellipsis;\n                overflow: hidden;\n            }\n            .").concat(t.classNames.editorPanel," .control {\n                padding-left: 90px;\n            }\n            .").concat(t.classNames.editorPanel," .empty {\n                padding-top: 200px;\n                text-align: center;\n            }\n            .").concat(t.classNames.designer," .error,\n            .").concat(t.classNames.editorPanel," .error {\n                color: red;\n            }\n            .").concat(t.classNames.componentPanel," {\n                background: white;\n                color: black;\n                font-size: 14px;\n                z-index: 100;\n                list-style: none;\n                padding: 0;\n                text-align: center\n            }\n            .").concat(t.classNames.componentPanel," .panel-heading {\n                text-align: center;\n            }\n            .").concat(t.classNames.componentPanel," li {\n                text-align: center;\n                padding: 8px;\n            }\n            .").concat(t.classNames.componentWrapper,".").concat(t.classNames.moveDown," {\n         \n            }\n        "),document.head.appendChild(a),t.appendClassName=function(e,t){if(null==e)throw n.Errors.argumentNull("element");if(!t)throw n.Errors.argumentNull("addonClassName");var r;if(r=(r="string"==typeof e?e:e.className)||"",console.assert(t),r.indexOf(t)>=0)return r;var o="".concat(r," ").concat(t);return"string"!=typeof e&&(e.className=o),o},t.removeClassName=function(e,t){var n;return(n="string"==typeof e?e:e.className||"").indexOf(t)<0?n:(n=(n=(n=n||"").replace(new RegExp(t,"g"),"")).trim(),"string"!=typeof e&&(e.className=n),n)}}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";var r,o;function a(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}r=[n,t,n(0),n(6),n(4),n(2),n(1),n(5)],void 0===(o=function(e,t,n,r,o,l,d,m){Object.defineProperty(t,"__esModule",{value:!0}),t.DesignerContext=n.createContext({designer:null}),t.ComponentWrapperContext=n.createContext(null),t.component=function(e){return function(t){return r.PageDesigner&&h.setAttribute(t.name,e),h.register(t.name,t),t}};var h=function(){function e(){u(this,e)}return f(e,null,[{key:"setAttribute",value:function(t,n){e.componentAttributes[t]=n}},{key:"getAttribute",value:function(t){var n="string"==typeof t?t:t.name,r=e.componentAttributes[n];return Object.assign({type:t},e.defaultComponentAttribute,r||{})}},{key:"getPropEditors",value:function(t){for(var n=t.type,r=[],o=this.componentPropEditors[n]||[],a=0;a<o.length;a++){var i=o[a].propName,s=e.componentPropEditorDisplay["".concat(n,".").concat(i)];null!=s&&0==s(t)||r.push(o[a])}return r}},{key:"getPropEditor",value:function(e,t){return this.getPropEditorByArray(e,t)}},{key:"getPropEditorByArray",value:function(e,t){return(this.componentPropEditors[e]||[]).filter(function(e){return e.propName==t})[0]}},{key:"setPropEditor",value:function(t,n,r,o){var a,i;if("object"==p(t)){var s=t;a=s.componentType,n=s.propName,r=s.editorType,o=s.group,i=s.display,null!=s.displayName&&(d.proptDisplayNames[n]=s.displayName)}else a=t;o=o||"";var l=n.split("."),c="string"==typeof a?a:a.prototype.typename||a.name;e.componentPropEditorDisplay["".concat(c,".").concat(n)]=i;for(var u=e.componentPropEditors[c]=e.componentPropEditors[c]||[],f=0;f<u.length;f++){if(u[f].propName==l.join("."))return void(u[f].editorType=r)}u.push({propName:n,editorType:r,group:o})}},{key:"createElement",value:function(t,n){return e._createElement(t,{components:[],componentTypes:[]},n)}},{key:"_createElement",value:function(t,r,a){if(!t)throw o.Errors.argumentNull("componentData");a=a||n.createElement;try{var i=t.type,s=t.type,l=e.componentTypes[s];l&&(i=l);var p,u=t.children?t.children.map(function(t){return e._createElement(t,r,a)}):[],d=null==t.props?{}:Object.assign({},t.props);null!=l&&l.defaultProps&&(d=Object.assign({},l.defaultProps,d)),"string"==typeof i&&(d.text&&u.push(d.text),delete d.text,a==n.createElement&&delete d.attr),i=i==e.Fragment?n.Fragment:i;var f=d.ref;return d.ref=function(e){if("function"==typeof f&&f(e),e instanceof y){p=e;for(var t=0;t<r.componentTypes.length;t++){var n=r.componentTypes[t];(p.childComponents[n]=p.childComponents[n]||[]).push(r.components[t])}}else null!=e&&(r.components.push(e),r.componentTypes.push("string"==typeof i?i:i.name))},a.apply(void 0,[i,d].concat(c(u)))}catch(e){return console.error(e),null}}},{key:"register",value:function(t,n,r){if(null==n&&"function"==typeof t&&(t=(n=t).name,n.componentName=t),!t)throw o.Errors.argumentNull("componentName");if(!n)throw o.Errors.argumentNull("componentType");e.componentTypes[t]=n,r&&e.setAttribute(t,r)}}]),e}();h.Fragment="",h.defaultComponentAttribute={container:!1,movable:!1,showHandler:!1,resize:!1},h.componentAttributes={div:{container:!0,movable:!0,showHandler:!0,resize:!0},img:{container:!1,movable:!0,resize:!0},label:{movable:!0},ul:{container:!1,movable:!0,showHandler:!0,resize:!1},li:{container:!0,movable:!1},table:{container:!1,movable:!0,showHandler:!0,resize:!0},thead:{container:!1,movable:!1},tbody:{container:!1,movable:!1},tfoot:{container:!1,movable:!1},tr:{container:!1,movable:!1},td:{container:!0,movable:!1}},h.componentPropEditors={},h.componentPropEditorDisplay={},h.componentTypes={},t.Component=h,t.MasterPageName="MasterPage",t.MasterPageContext=n.createContext({master:null});var y=function(e){function r(e){var t;u(this,r),(t=a(this,i(r).call(this,e))).childComponents={};var n=r.children(e);return t.state={children:n},t}return s(r,n.Component),f(r,[{key:"render",value:function(){var e={};for(var r in this.props)"ref"!=r&&"id"!=r&&(e[r]=this.props[r]);e.style=Object.assign({minHeight:40},e.style);var o=this.state.children.filter(function(e){return null==e.props.parentId});return console.assert(null!=this),n.createElement(t.MasterPageContext.Provider,{value:{master:this}},o)}}],[{key:"children",value:function(e){var t=null==e.children?[]:Array.isArray(e.children)?e.children:[e.children],r=[];return t.forEach(function(e){n.isValidElement(e)&&r.push(e)}),r}},{key:"getDerivedStateFromProps",value:function(e){return{children:r.children(e)}}}]),r}();t.MasterPage=y,h.register(t.MasterPageName,y,{container:!1});var g=function(e){function r(e){var t;if(u(this,r),!(t=a(this,i(r).call(this,e))).props.id)throw o.Errors.placeHolderIdNull();return t}return s(r,n.Component),f(r,[{key:"enableAppendDroppable",value:function(e,t){var n=this;if(!e.getAttribute("enable-append-droppable")){e.setAttribute("enable-append-droppable","true"),console.assert(null!=e),e.addEventListener("dragover",function(t){t.preventDefault(),t.stopPropagation(),e.className=l.appendClassName(e.className||"","active");var n=t.dataTransfer.getData(d.constants.componentData);t.dataTransfer.dropEffect=n?"copy":"move",console.log("dragover: left:".concat(t.layerX," top:").concat(t.layerX))});var r=function(t){t.preventDefault(),t.stopPropagation(),e.className=l.removeClassName(e.className,"active")};e.addEventListener("dragleave",r),e.addEventListener("dragend",r),e.addEventListener("dragexit",r),e.ondrop=function(r){var o;r.preventDefault(),r.stopPropagation(),e.className=l.removeClassName(e.className,"active"),r.dataTransfer&&(o=m.ComponentPanel.getComponentData(r.dataTransfer)),o&&(console.assert(null!=n.props.id),console.assert(null!=n.designer),o.props.parentId=n.props.id,console.assert(null!=t,"host is null"),n.designer.appendComponent(t.props.id,o))}}}},{key:"enableMoveDroppable",value:function(e,t){var n=this;e.getAttribute("enable-move-droppable")||(e.setAttribute("enable-move-droppable","true"),$(e).drop("start",function(t,r){r.sourceElement.id!=n.wraper.props.source.props.id&&l.appendClassName(e,"active")}).drop("drop",function(e,r){if(r.sourceElement.id!=n.wraper.props.source.props.id){var o=n.designer.findComponentData(r.sourceElement.id);console.assert(null!=o);n.designer.moveComponent(r.sourceElement.id,t.props.id),n.designer.updateComponentProps({componentId:"string",propName:"string",value:"any"})}}).drop("end",function(t,r){r.sourceElement.id!=n.wraper.props.source.props.id&&l.removeClassName(e,"active")}))}},{key:"render",value:function(){var e=this,r=this.props.empty||n.createElement("div",{key:d.guid(),className:"empty"},"可以拖拉控件到这里");return n.createElement(t.MasterPageContext.Consumer,null,function(a){var i=a.master;if(null==i)throw o.Errors.canntFindMasterPage(e.props.id);var s,c=[];i.props&&i.props.children&&(s=Array.isArray(i.props.children)?i.props.children:[i.props.children],c=s.filter(function(t){return null!=t.props.parentId&&t.props.parentId==e.props.id}));return n.createElement(t.DesignerContext.Consumer,null,function(o){return n.createElement(t.ComponentWrapperContext.Consumer,null,function(t){e.wraper=t,console.assert(null!=e.wraper),null!=o.designer&&0==c.length&&(c=[r]);var a=n.createElement(n.Fragment,null,e.props.children,c);return o.designer&&(e.designer=o.designer,a=n.createElement("div",{key:d.guid(),className:l.classNames.placeholder,ref:function(t){t&&(e.element=t,e.enableAppendDroppable(t,i),e.enableMoveDroppable(t,i))}},a)),a})})})}}]),r}();t.PlaceHolder=g,h.register("PlaceHolder",g);var v=function(e){function t(e){var n;if(u(this,t),!(n=a(this,i(t).call(this,e))).props.pageData)throw o.Errors.propCanntNull(t.name,"pageData");return n}return s(t,n.Component),f(t,[{key:"render",value:function(){return h.createElement(this.props.pageData)}}]),t}();t.PageView=v;var b=function(e){function t(e){var n;return u(this,t),(n=a(this,i(t).call(this,e))).state={},n}return s(t,n.Component),f(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e})}},{key:"render",value:function(){var e=(this.state||{}).error;return e?n.createElement("div",{className:"error"},n.createElement("div",null,e.message),n.createElement("div",null,e.stack)):this.props.children}}]),t}();t.ErrorBoundary=b}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";var r;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"placeHolderIdNull",value:function(){return new Error("Place holder property id cannt be null or empty.")}},{key:"fileNotExists",value:function(e){return new Error("File '".concat(e,"' is not exists."))}},{key:"argumentNull",value:function(e){return new Error("Argument ".concat(e," is null or empty."))}},{key:"argumentRangeError",value:function(e){return new Error("Argument ".concat(e," range error."))}},{key:"pageDataIsNull",value:function(){return new Error("Page data is null.")}},{key:"toolbarRequiredKey",value:function(){return new Error("Toolbar has not a key prop.")}},{key:"loadPluginFail",value:function(e){return new Error("Load plugin '".concat(e,"' fail."))}},{key:"idRequired",value:function(){return new Error("Property id is required.")}},{key:"canntFindMasterPage",value:function(e){return new Error("Can not find master page for component container ".concat(e,"."))}},{key:"propCanntNull",value:function(e,t){var n="".concat(e," property ").concat(t," cannt be null or empty.");return new Error(n)}},{key:"argumentFieldCanntNull",value:function(e,t){var n="".concat(e," of argument ").concat(t," cannt be null or empty.");return new Error(n)}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();t.Errors=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){"use strict";var r,o;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r=[n,t,n(0),n(1),n(3),n(2)],void 0===(o=function(e,t,n,r,o,a){Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=s(this,l(t).call(this,e))).state={componets:[]},n}var p,u,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,n.Component),p=t,d=[{key:"getComponentData",value:function(e){var t=e.getData(r.constants.componentData);if(t)return JSON.parse(t)}},{key:"mouseInnerPosition",value:function(e){var t=e.getData("mousePosition");if(t)return JSON.parse(t)}}],(u=[{key:"componentDraggable",value:function(e,t){console.assert(null!=e),e.draggable=!0,e.addEventListener("dragstart",function(e){t.props=t.props||{},e.dataTransfer.setData(r.constants.componentData,JSON.stringify(t)),e.dataTransfer.setData("mousePosition",JSON.stringify({x:e.offsetX,y:e.offsetY}))})}},{key:"setComponets",value:function(e){this.setState({componets:e})}},{key:"render",value:function(){var e=this,r=this.props.empty||n.createElement("div",{className:"empty"},"暂无可用组件"),i=Object.assign({},this.props),s=this.state.componets||[];return n.createElement(o.DesignerContext.Consumer,null,function(o){return e.designer=o.designer,n.createElement("ul",Object.assign({},i,{className:"".concat(a.classNames.componentPanel," ").concat(e.props.className||""),ref:function(t){return e.toolbarElement=e.toolbarElement||t}}),0==s.length?r:s.map(function(r,o){var i={key:o};return i[t.componentIndexName]="".concat(o),n.createElement("li",Object.assign({},i,{className:a.classNames.componentIcon}),n.createElement("div",{className:"btn-link"},n.createElement("i",{className:r.icon,style:{fontSize:44,color:"black"},ref:function(t){if(t){var n=r.componentData;e.componentDraggable(t,n)}}})),n.createElement("div",null,r.displayName))}))})}},{key:"element",get:function(){return this.toolbarElement}}])&&i(p.prototype,u),d&&i(p,d),t}();p.componentIndexName="data-component-index",t.ComponentPanel=p}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";var r,o;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r=[n,t,n(0),n(1),n(4),n(3),n(2),n(8)],void 0===(o=function(e,t,n,r,o,u,d,f){Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=l(this,c(t).call(this,e))).componentSelected=r.Callback.create(),n.componentRemoved=r.Callback.create(),n.componentAppend=r.Callback.create(),n.componentUpdated=r.Callback.create(),n.designtimeComponentDidMount=r.Callback.create();var o={};return t.initPageData(e.pageData,o),n.state={pageData:e.pageData,components:o},n.designtimeComponentDidMount.add(function(e){console.log("this:designer event:controlComponentDidMount")}),n}var m,h,y;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,n.Component),m=t,y=[{key:"setComponetRefProp",value:function(e,n){var r={};t.travelComponentData(e).forEach(function(e){console.assert(null!=e.props&&null!=e.props.id),r[e.type]=r[e.type]||[],r[e.type].push(e.props.id);var t=e.props.ref;e.props.ref=function(r){null!=r&&(n[e.type]=n[e.type]||[],n[e.type].push(r)),"function"==typeof t&&t(r)}});for(var o=Object.getOwnPropertyNames(n),a=function(e){var t=o[e],a=r[t]||[];n[t]=(n[t]||[]).filter(function(e){return a.indexOf(e.id||e.props.id)>=0})},i=0;i<o.length;i++)a(i)}},{key:"initPageData",value:function(e,n){null!=e&&(e.children=e.children||[],t.nameComponent(e),t.setComponetRefProp(e,n))}},{key:"nameComponent",value:function(e){var n={},o=e.props=e.props||{};if(!o.name){var a,i=0;do{i+=1,a="".concat(e.type).concat(i)}while(n[a]);n[a]=e,o.name=a}if(o.id||(o.id=r.guid()),e.children&&0!=e.children.length)for(var s=0;s<e.children.length;s++)t.nameComponent(e.children[s])}},{key:"travelComponentData",value:function(e,t){var n=new Array;n.push(e);var r=[];for(t=t||function(){return!0};n.length>0;){var o=n.shift();t(o)&&r.push(o);var s=(o.children||[]).filter(function(e){return"object"==a(e)});n.push.apply(n,i(s))}return r}},{key:"getDerivedStateFromProps",value:function(e,n){return t.initPageData(e.pageData,n.components),{pageData:e.pageData}}}],(h=[{key:"allComponents",value:function(){var e=[];for(var t in this.state.components)e.push.apply(e,i(this.state.components[t]));return e}},{key:"updateComponentProp",value:function(e,t,n){return this.updateComponentProps({componentId:e,propName:t,value:n})}},{key:"updateComponentProps",value:function(){for(var e=[],t=0;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t],r=n.componentId,o=n.propName,a=n.value,i=this.findComponentData(r);if(null!=i){var s=o.split(".");console.assert(null!=i),console.assert(null!=s,"props is null"),i.props=i.props||{};for(var l=i.props,c=0;c<s.length-1;c++)l=l[s[c]]=l[s[c]]||{};l[s[s.length-1]]=a,e.push(i)}}this.setState(this.state),this.componentUpdated.fire(e)}},{key:"sortChildren",value:function(e,t){if(!e)throw o.Errors.argumentNull("parentId");if(!t)throw o.Errors.argumentNull("childIds");var n=this.state.pageData,r=this.findComponentData(e);if(null==r)throw new Error("Parent is not exists");console.assert(null!=r),console.assert(null!=r.children),console.assert((r.children||[]).length==t.length);var a=r;r.children=t.map(function(e){var t=a.children.filter(function(t){return t.props.id==e})[0];return console.assert(null!=t,"child ".concat(e," is null")),t}),this.setState({pageData:n})}},{key:"appendComponent",value:function(e,n,r){if(!e)throw o.Errors.argumentNull("parentId");if(!n)throw o.Errors.argumentNull("childComponent");t.nameComponent(n);var a=this.findComponentData(e);if(null==a)throw new Error("Parent is not exists");console.assert(null!=a),a.children=a.children||[],null!=r?a.children.splice(r,0,n):a.children.push(n);var i=this.state.pageData;this.setState({pageData:i}),this.selectComponent(n.props.id),this.componentAppend.fire(this)}},{key:"setComponentPosition",value:function(e,t){return this.setComponentsPosition([{componentId:e,position:t}])}},{key:"setComponentSize",value:function(e,t){console.assert(null!=e),console.assert(null!=t);var n=this.findComponentData(e);if(!n)throw new Error("Control ".concat(e," is not exits."));var r=n.props.style=n.props.style||{};t.height&&(r.height=t.height),t.width&&(r.width=t.width);var o=this.state.pageData;this.setState({pageData:o}),this.componentUpdated.fire([n])}},{key:"setComponentsPosition",value:function(e){var t=this,n=new Array;e.forEach(function(e){var r=e.componentId,o=e.position,a=o.left,i=o.top,s=t.findComponentData(r);if(!s)throw new Error("Control ".concat(r," is not exits."));var l=s.props.style=s.props.style||{};a&&(l.left=a),i&&(l.top=i);var c=t.state.pageData;t.setState({pageData:c}),n.push(s)}),this.componentUpdated.fire(n)}},{key:"selectComponent",value:function(e){"string"==typeof e&&(e=[e]);var t=[];for(t.push(this.pageData);t.length>0;){var n=t.pop(),r=e.indexOf(n.props.id)>=0;n.props.selected=r;for(var o=n.children||[],a=0;a<o.length;a++)t.push(o[a])}this.setState({pageData:this.pageData}),this.componentSelected.fire(this.selectedComponentIds),this.element.focus()}},{key:"removeComponent",value:function(){var e=this,t=this.state.pageData;if(t&&t.children&&0!=t.children.length){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];r.forEach(function(n){e.removeComponentFrom(n,t.children)}),this.setState({pageData:t}),this.componentRemoved.fire(r)}}},{key:"moveComponent",value:function(e,t,n){var r=this.findComponentData(e);if(null==r)throw new Error("Cannt find component by id ".concat(e));console.assert(null!=r,"Cannt find component by id ".concat(e));var o=this.state.pageData;console.assert(null!=o.children),this.removeComponentFrom(e,o.children),this.appendComponent(t,r,n)}},{key:"removeComponentFrom",value:function(e,t){for(var n=null,r=0;r<t.length;r++)if(e==t[r].props.id){n=r;break}if(null==n){for(var o=0;o<t.length;o++){var a=t[o];if(a.children&&a.children.length>0)if(this.removeComponentFrom(e,a.children))return!0}return!1}return 0==n?t.shift():n==t.length-1?t.pop():t.splice(n,1),!0}},{key:"findComponetsByTypeName",value:function(e){return this.state.components[e]}},{key:"findComponentData",value:function(e){var n=this.state.pageData;if(!n)throw o.Errors.pageDataIsNull();return t.travelComponentData(n,function(t){return t.props.id==e})[0]}},{key:"onKeyDown",value:function(e){if(46==e.keyCode){if(0==this.selectedComponents.length)return;this.removeComponent.apply(this,i(this.selectedComponentIds))}}},{key:"createDesignTimeElement",value:function(e,t){if(null==e)throw o.Errors.argumentNull("type");if(null==t)throw o.Errors.argumentNull("props");if(null==t.id)throw o.Errors.argumentFieldCanntNull("id","props");console.assert(null!=t.id),null!=t.id&&(t.key=t.id);var r=u.Component.getAttribute(e);console.assert(null!=r);var a=t.attr||{},i=Object.assign({},r,a);delete t.attr;var s=t.selected?d.appendClassName(t.className||"",d.classNames.componentSelected):t.className,l=Object.assign({},t);delete l.ref,l.className=s;for(var c=arguments.length,p=new Array(c>2?c-2:0),m=2;m<c;m++)p[m-2]=arguments[m];return n.createElement(f.ComponentWrapper,Object.assign({},l,{designer:this,source:{type:e,attr:i,props:t,children:p}}))}},{key:"render",value:function(){var e=this,t=this.state.pageData,r=this.props.style;return n.createElement("div",{className:d.classNames.designer,tabIndex:1,style:r,ref:function(t){return e.element=t||e.element},onKeyDown:function(t){return e.onKeyDown(t)}},n.createElement(u.DesignerContext.Provider,{value:{designer:this}},t?u.Component.createElement(t,e.createDesignTimeElement.bind(e)):null))}},{key:"pageData",get:function(){return this.state.pageData}},{key:"selectedComponentIds",get:function(){return this.selectedComponents.map(function(e){return e.props.id})}},{key:"selectedComponents",get:function(){var e=new Array,t=new Array;for(t.push(this.pageData);t.length>0;){var n=t.pop();null!=n.props&&1==n.props.selected&&e.push(n);for(var r=n.children||[],o=0;o<r.length;o++)t.push(r[o])}return e}}])&&s(m.prototype,h),y&&s(m,y),t}();m.defaultProps={pageData:null,wrapDesignTimeElement:!0},t.PageDesigner=m}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";var r,o;r=[n,t,n(1),n(3),n(5),n(9),n(6),n(11),n(2),n(12),n(14),n(15),n(16),n(17)],void 0===(o=function(e,t,n,r,o,a,i,s,l){Object.defineProperty(t,"__esModule",{value:!0}),t.strings=n.proptDisplayNames,t.proptDisplayNames=n.proptDisplayNames,t.Component=r.Component,t.DesignerContext=r.DesignerContext,t.MasterPage=r.MasterPage,t.MasterPageContext=r.MasterPageContext,t.ComponentPanel=o.ComponentPanel,t.EditorPanel=a.EditorPanel,t.PageDesigner=i.PageDesigner,t.PropEditor=s.PropEditor,t.TextInput=s.TextInput,t.classNames=l.classNames}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";var r,o;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r=[n,t,n(0),n(4),n(1),n(5),n(2),n(3)],void 0===(o=function(e,t,n,r,o,a,u,d){Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,c(t).call(this,e))}var f,m,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,n.Component),f=t,h=[{key:"enableAppendDroppable",value:function(e,t){console.assert(null!=e),e.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation();var t=e.dataTransfer.getData(o.constants.componentData);e.dataTransfer.dropEffect=t?"copy":"move",console.log("dragover: left:".concat(e.layerX," top:").concat(e.layerX))}),e.addEventListener("drop",function(n){n.preventDefault(),n.stopPropagation();arguments[1];if(n.dataTransfer){var r=a.ComponentPanel.getComponentData(n.dataTransfer);if(r){r.props.style=r.props.style||{},t.pageData.props.style=t.pageData.props.style||{},r.props.style.position||(r.props.style.position=t.pageData.props.style.position);var o=a.ComponentPanel.mouseInnerPosition(n.dataTransfer);console.assert(null!=o),"absolute"==r.props.style.position&&(r.props.style.left=n.layerX-o.x,r.props.style.top=n.layerY-o.y),t.appendComponent(e.id,r)}}})}},{key:"isResizeHandleClassName",value:function(e){return["resize_handle NE","resize_handle NN","resize_handle NW","resize_handle WW","resize_handle EE","resize_handle SW","resize_handle SS","resize_handle SE"].indexOf(e)>=0}},{key:"draggable",value:function(e,n,o){if(!e)throw r.Errors.argumentNull("designer");if(!n)throw r.Errors.argumentNull("element");console.assert(""!=n.id),o=o||n;var a,i,s,l=n.id;console.assert(""!=l),$(o).drag("init",function(e){if(a=$(n).position(),$(this).is(".".concat(u.classNames.componentSelected)))return $(".".concat(u.classNames.componentSelected))}).drag("start",function(e,t){t.attr=$(e.target).prop("className"),t.width=$(this).width(),t.height=$(this).height(),t.sourceElement=n,s=Date.now()}).drag(function(e,n){e.preventDefault(),e.stopPropagation(),console.log("drop:"),console.log(n.drop),i={},n.attr.indexOf("E")>-1&&(i.width=Math.max(32,n.width+n.deltaX)),n.attr.indexOf("S")>-1&&(i.height=Math.max(32,n.height+n.deltaY)),n.attr.indexOf("W")>-1&&(i.width=Math.max(32,n.width-n.deltaX),d(n)),n.attr.indexOf("N")>-1&&(i.height=Math.max(32,n.height-n.deltaY),p(n)),n.attr.indexOf("WW")>=0&&d(n),(n.attr.indexOf("NE")>=0||n.attr.indexOf("NW")>=0||n.attr.indexOf("SW")>=0)&&c(n),n.attr.indexOf("NN")>=0&&p(n),n.attr.indexOf("drag")>-1&&(i.top=n.offsetY,i.left=n.offsetX),t.isResizeHandleClassName(n.attr)||c(n),n.attr&&$(this).css(i)},{click:!0}).drag("end",function(r,o){var c=Date.now()-s;if(t.isDrag=c>=300,t.isResizeHandleClassName(o.attr)){var p,u;o.attr.indexOf("W")>-1&&(p=a.left+o.deltaX),o.attr.indexOf("N")>-1&&(u=a.top+o.deltaY),n.style.transform="",e.setComponentPosition(n.id,{left:p,top:u}),e.setComponentSize(l,i)}else{var d=a.left+o.deltaX,f=a.top+o.deltaY;e.setComponentPosition(n.id,{left:d,top:f}),n.style.transform=""}}).click(function(r){t.invokeOnClick(r,e,n)});var c=function(e){console.log(["dd.offsetX, dd.offsetY",e.offsetX,e.offsetY]),console.log(e),n.style.transform="translate(".concat(e.deltaX,"px,").concat(e.deltaY,"px)")},p=function(e){n.style.transform="translateY(".concat(e.deltaY,"px)")},d=function(e){n.style.transform="translateX(".concat(e.deltaX,"px)")}}},{key:"invokeOnClick",value:function(e,n,r){if(e.preventDefault(),e.stopPropagation(),t.isDrag)t.isDrag=!1;else{var o=r.id;if(e.ctrlKey){var a=n.selectedComponentIds;console.assert(""!=o),a.indexOf(o)>=0?a=a.filter(function(e){return e!=o}):a.push(o),n.selectComponent(a)}else n.selectComponent(r.id)}}}],(m=[{key:"componentDidCatch",value:function(e,t){this.setState({error:e})}},{key:"designtimeBehavior",value:function(e,n){if(!e)throw r.Errors.argumentNull("element");if(!n)throw r.Errors.argumentNull("args");if(!e.getAttribute("data-behavior")){e.setAttribute("data-behavior","behavior");var o=this.props.designer;console.assert(null!=n.container),console.assert(null!=n.movable),n.container&&t.enableAppendDroppable(e,o),n.movable?(console.assert(null!=e),t.draggable(o,e),null!=this.handler&&t.draggable(o,e,this.handler)):e.onclick=function(n){return t.invokeOnClick(n,o,e)}}}},{key:"componentDidMount",value:function(){if(this.element){var e=this.props.source.attr;this.designtimeBehavior(this.element,e)}}},{key:"render",value:function(){var e=this,t=(this.state||{}).error;if(t)return n.createElement("div",{className:"error"},n.createElement("div",null,t.message),n.createElement("div",null,t.stack));var r=this.props.source.attr;if(!(r.resize||"string"!=typeof this.props.source.type&&this.props.source.type!=d.MasterPage))return this.renderWidthoutWrapper();var o=this.props.source.props,a=o.style=JSON.parse(JSON.stringify(o.style||{})),i=a.top,s=a.left,l=a.position,c=a.width,p=a.height,f=a.display,m=a.visibility,h=u.appendClassName(o.className||"",u.classNames.componentWrapper);h=o.selected?u.appendClassName(h,u.classNames.componentSelected):h;var y={id:o.id,className:h,style:{top:i,left:s,position:l,width:c,height:p,display:f,visibility:m},ref:function(t){return e.element=t||e.element}},g=o.selected&&r.showHandler?n.createElement("div",{className:"move_handle",style:{},ref:function(t){return e.handler=t||e.handler}}):null,v=r.resize&&"absolute"==o.style.position&&o.selected,b=this.props.source;return o.style&&(delete o.style.left,delete o.style.top,delete o.style.position,y.style.width&&"unset"!=y.style.width&&(o.style.width="100%"),y.style.height&&"unset"!=y.style.height&&(o.style.height="100%")),n.createElement(d.ComponentWrapperContext.Provider,{value:this},n.createElement("div",Object.assign({},y),g,v?n.createElement(n.Fragment,null,n.createElement("div",{className:"resize_handle NE"}),n.createElement("div",{className:"resize_handle NN"}),n.createElement("div",{className:"resize_handle NW"}),n.createElement("div",{className:"resize_handle WW"}),n.createElement("div",{className:"resize_handle EE"}),n.createElement("div",{className:"resize_handle SW"}),n.createElement("div",{className:"resize_handle SS"}),n.createElement("div",{className:"resize_handle SE"})):null,this.createRawElement(b.type,b.props,b.children)))}},{key:"renderWidthoutWrapper",value:function(){var e=this,t=this.props.source,r=t.type,o=t.props,a=t.children,i=o.ref;o.ref=function(t){if("function"==typeof i&&i(t),t)if(t.tagName){var n=e.props.source.attr;e.designtimeBehavior(t,n)}else;},o.selected&&(o.className=u.appendClassName(o.className||"",u.classNames.componentSelected));var s=this.createRawElement(r,o,a);return n.createElement(d.ComponentWrapperContext.Provider,{value:this},s)}},{key:"createRawElement",value:function(e,t,r){if(0==(r||[]).length){var o=this.designTimeEmptyElement(e,t);null!=o&&(r=[o])}return n.createElement.apply(n,[e,t].concat(i(r)))}},{key:"designTimeEmptyElement",value:function(e,t){if("input"==e||"img"==e||"meta"==e||"link"==e)return null;var n="string"==typeof e?e:e.name;return this.designTimeText(n,t)}},{key:"designTimeText",value:function(e,t){var n=t.text;return n||(n=n||t.name||e)}}])&&s(f.prototype,m),h&&s(f,h),t}();f.isDrag=!1,t.ComponentWrapper=f}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";var r,o;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r=[n,t,n(0),n(10),n(2)],void 0===(o=function(e,t,n,r,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=s(this,l(t).call(this,e))).state={componentDatas:[],designer:null},n.designerComponentChanged=function(){console.assert(null!=n.designer),n.setState({designer:n.designer})},n}var a,p,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,n.Component),a=t,(p=[{key:"render",value:function(){var e=this,t=this.props.empty;t=t||n.createElement("div",{className:"empty"},"暂无可用的属性");var a=this.state.designer;return n.createElement("div",{className:"".concat(o.classNames.editorPanel," ").concat(this.props.className||""),ref:function(t){return e.element=t||e.element}},n.createElement(r.PropertyEditor,{designer:a,ref:function(t){return e.editor=t||e.editor},empty:t,customRender:this.props.customRender}))}},{key:"designer",get:function(){return this._designer},set:function(e){this._designer&&(this._designer.componentRemoved.remove(this.designerComponentChanged),this._designer.componentAppend.remove(this.designerComponentChanged),this._designer.componentUpdated.remove(this.designerComponentChanged),this._designer.componentSelected.remove(this.designerComponentChanged)),e&&(e.componentRemoved.add(this.designerComponentChanged),e.componentAppend.add(this.designerComponentChanged),e.componentUpdated.add(this.designerComponentChanged),e.componentSelected.add(this.designerComponentChanged)),this._designer=e,this.setState({designer:e})}}])&&i(a.prototype,p),u&&i(a,u),t}();t.EditorPanel=a}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";var r,o;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r=[n,t,n(0),n(3),n(1),n(4)],void 0===(o=function(e,t,n,r,o,a){Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=l(this,c(t).call(this,e)))._element=null,n.state={designer:n.props.designer},n}var u,d,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,n.Component),u=t,f=[{key:"getDerivedStateFromProps",value:function(e,t){return{designer:e.designer}}}],(d=[{key:"getEditors",value:function(e){var t=this;if(null==e)return[];for(var o,a=[],s=e.selectedComponents,l=function(e){var t=s[e],n=r.Component.getPropEditors(t);if(0==e)a=n||[];else{var o=[];a.forEach(function(e){n.forEach(function(t){var n=e.propName,r=t.propName;e.editorType==t.editorType&&n==r&&o.push(e)})}),a=o}},c=0;c<s.length;c++)l(c);for(c=0;c<s.length;c++){var p=s[c],u=Object.assign({},p.props);if(delete u.children,0==c)o=u;else{var d={};for(var f in o)o[f]==u[f]&&(d[f]=u[f]);o=d}}for(var m=[],h=function(r){var l=a[r],c=l.propName,p=l.editorType,u={value:t.propValue(c,o),editComponents:s,updateComponentProp:function(t){var n=s.map(function(e){return{componentId:e.props.id,propName:l.propName,value:t}});e.updateComponentProps.apply(e,i(n))}},d=n.createElement(p,u);m.push({prop:l.propName,editor:d,group:l.group})},y=0;y<a.length;y++)h(y);return m}},{key:"propValue",value:function(e,t){if(!e)throw a.Errors.argumentNull("propName");if(!t)throw a.Errors.argumentNull("props");for(var n=e.split("."),r=t,o=0;o<n.length;o++)if(null==(r=r[n[o]]))return null;return r}},{key:"render",value:function(){var e=this.state.designer,t=this.getEditors(e);if(0==t.length){var a=this.props.empty;return n.createElement("div",{className:"text-center"},a)}if(this.props.customRender){var i=t.map(function(e){return Object.assign({displayName:o.proptDisplayNames[e.prop]||e.prop},e)}),s=this.props.customRender(e.selectedComponents,i);if(null!=s)return s}for(var l=[],c=function(e){var n=t[e].group||"",r=l.filter(function(e){return e.group==n})[0];null==r&&(r={group:t[e].group,editors:[]},l.push(r)),r.editors.push({prop:t[e].prop,editor:t[e].editor})},p=0;p<t.length;p++)c(p);return n.createElement(n.Fragment,null,l.map(function(e){return n.createElement("div",{key:e.group,className:"panel panel-default"},e.group?n.createElement("div",{className:"panel-heading"},o.proptDisplayNames[e.group]||e.group):null,n.createElement("div",{className:"panel-body"},e.editors.map(function(e,t){return n.createElement("div",{key:e.prop,className:"form-group clearfix"},n.createElement("label",null,o.proptDisplayNames[e.prop]||e.prop),n.createElement("div",{className:"control"},n.createElement(r.ErrorBoundary,null,e.editor)))})))}))}},{key:"element",get:function(){return this._element}}])&&s(u.prototype,d),f&&s(u,f),t}();t.PropertyEditor=u}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";var r,o;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function c(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}l((r=r.apply(e,t||[])).next())})};r=[n,t,n(0)],void 0===(o=function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(e){return i(this,t),c(this,p(t).call(this,e))}return u(t,n.Component),l(t,null,[{key:"dropdown",value:function(e,t){return a(e,t)}},{key:"textInput",value:function(){return o}}]),t}();t.PropEditor=r;var o=function(e){function t(){return i(this,t),c(this,p(t).apply(this,arguments))}return u(t,r),l(t,[{key:"render",value:function(){var e=this,t=this.props.value;return n.createElement("input",{className:"form-control",value:t||"",onChange:function(t){e.props.updateComponentProp(t.target.value)}})}}]),t}();function a(e,t){var o,a=[];if(null==t&&Array.isArray(e)){t=e.length>0&&"number"==typeof e[0]?"number":"string";for(var s=0;s<e.length;s++)a[s]={text:e[s],value:e[s]}}else if(null==t){t="string";for(var d=Object.getOwnPropertyNames(e),m=0;m<d.length;m++)a[m]={text:e[d[m]],value:d[m]}}else Array.isArray(e)?a=e:o=e;return function(e){function s(e){var t;return i(this,s),(t=c(this,p(s).call(this,e))).state={},t}return u(s,r),l(s,[{key:"componentDidMount",value:function(){return f(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=5;break}return e.next=3,o;case 3:t=e.sent,this.setState({items:t});case 5:case"end":return e.stop()}},e,this)}))}},{key:"render",value:function(){var e=this,r=this.state.items,o=this.props.value;return r=r||a,n.createElement("select",{className:"form-control",value:null==o?"":o,onChange:function(n){var r=n.target.value;if("number"==t){o=/^\d+$/.test(r)?parseInt(r):/^[+-]?\d+(\.\d+)?$/.test(r)?parseFloat(r):null}else o=r;e.props.updateComponentProp(o)}},r.map(function(e){return n.createElement("option",{key:e.value,value:e.value},e.text)}))}}]),s}()}t.TextInput=o}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";var r,o;r=[n,t,n(13)],void 0===(o=function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),null==(window.$||window.jQuery)&&(window.$=window.jQuery=n)}.apply(t,r))||(e.exports=o)},function(e,n){e.exports=t},function(e,t){!function(e){e.fn.drag=function(t,n,r){var o="string"==typeof t?t:"",a=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==o.indexOf("drag")&&(o="drag"+o),r=(t==a?n:r)||{},a?this.bind(o,r,a):this.trigger(o)};var t=e.event,n=t.special,r=n.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var n=e.data(this,r.datakey),o=t.data||{};n.related+=1,e.each(r.defaults,function(e,t){void 0!==o[e]&&(n[e]=o[e])})},remove:function(){e.data(this,r.datakey).related-=1},setup:function(){if(!e.data(this,r.datakey)){var n=e.extend({related:0},r.defaults);e.data(this,r.datakey,n),t.add(this,"touchstart mousedown",r.init,n),this.attachEvent&&this.attachEvent("ondragstart",r.dontstart)}},teardown:function(){(e.data(this,r.datakey)||{}).related||(e.removeData(this,r.datakey),t.remove(this,"touchstart mousedown",r.init),r.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",r.dontstart))},init:function(o){if(!r.touched){var a,i=o.data;if(!(0!=o.which&&i.which>0&&o.which!=i.which)&&!e(o.target).is(i.not)&&(!i.handle||e(o.target).closest(i.handle,o.currentTarget).length)&&(r.touched="touchstart"==o.type?this:null,i.propagates=1,i.mousedown=this,i.interactions=[r.interaction(this,i)],i.target=o.target,i.pageX=o.pageX,i.pageY=o.pageY,i.dragging=null,a=r.hijack(o,"draginit",i),i.propagates))return(a=r.flatten(a))&&a.length&&(i.interactions=[],e.each(a,function(){i.interactions.push(r.interaction(this,i))})),i.propagates=i.interactions.length,!1!==i.drop&&n.drop&&n.drop.handler(o,i),r.textselect(!1),r.touched?t.add(r.touched,"touchmove touchend",r.handler,i):t.add(document,"mousemove mouseup",r.handler,i),!(!r.touched||i.live)&&void 0}},interaction:function(t,n){var o=e(t)[n.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new r.callback,droppable:[],offset:o}},handler:function(o){var a=o.data;switch(o.type){case!a.dragging&&"touchmove":o.preventDefault();case!a.dragging&&"mousemove":if(Math.pow(o.pageX-a.pageX,2)+Math.pow(o.pageY-a.pageY,2)<Math.pow(a.distance,2))break;o.target=a.target,r.hijack(o,"dragstart",a),a.propagates&&(a.dragging=!0);case"touchmove":o.preventDefault();case"mousemove":if(a.dragging){if(r.hijack(o,"drag",a),a.propagates){!1!==a.drop&&n.drop&&n.drop.handler(o,a);break}o.type="mouseup"}case"touchend":case"mouseup":default:r.touched?t.remove(r.touched,"touchmove touchend",r.handler):t.remove(document,"mousemove mouseup",r.handler),a.dragging&&(!1!==a.drop&&n.drop&&n.drop.handler(o,a),r.hijack(o,"dragend",a)),r.textselect(!0),!1===a.click&&a.dragging&&e.data(a.mousedown,"suppress.click",(new Date).getTime()+5),a.dragging=r.touched=!1}},hijack:function(n,o,a,i,s){if(a){var l,c,p,u={event:n.originalEvent,type:n.type},d=o.indexOf("drop")?"drag":"drop",f=i||0,m=isNaN(i)?a.interactions.length:i;n.type=o,n.originalEvent=null,a.results=[];do{if(c=a.interactions[f]){if("dragend"!==o&&c.cancelled)continue;p=r.properties(n,a,c),c.results=[],e(s||c[d]||a.droppable).each(function(i,s){if(p.target=s,n.isPropagationStopped=function(){return!1},!1===(l=s?t.dispatch.call(s,n,p):null)?("drag"==d&&(c.cancelled=!0,a.propagates-=1),"drop"==o&&(c[d][i]=null)):"dropinit"==o&&c.droppable.push(r.element(l)||s),"dragstart"==o&&(c.proxy=e(r.element(l)||c.drag)[0]),c.results.push(l),delete n.result,"dropinit"!==o)return l}),a.results[f]=r.flatten(c.results),"dropinit"==o&&(c.droppable=r.flatten(c.droppable)),"dragstart"!=o||c.cancelled||p.update()}}while(++f<m);return n.type=u.type,n.originalEvent=u.event,r.flatten(a.results)}},properties:function(e,t,n){var o=n.callback;return o.drag=n.drag,o.proxy=n.proxy||n.drag,o.startX=t.pageX,o.startY=t.pageY,o.deltaX=e.pageX-t.pageX,o.deltaY=e.pageY-t.pageY,o.originalX=n.offset.left,o.originalY=n.offset.top,o.offsetX=o.originalX+o.deltaX,o.offsetY=o.originalY+o.deltaY,o.drop=r.flatten((n.drop||[]).slice()),o.available=r.flatten((n.droppable||[]).slice()),o},element:function(e){if(e&&(e.jquery||1==e.nodeType))return e},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?r.flatten(t):t})},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",r.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};r.callback.prototype={update:function(){n.drop&&this.available.length&&e.each(this.available,function(e){n.drop.locate(this,e)})}};var o=t.dispatch;t.dispatch=function(t){if(!(e.data(this,"suppress."+t.type)-(new Date).getTime()>0))return o.apply(this,arguments);e.removeData(this,"suppress."+t.type)};var a=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,n){if(n){var r=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0]||null;r&&e.each(a.props,function(e,n){t[n]=r[n]})}return t}};n.draginit=n.dragstart=n.dragend=r}(jQuery)},function(e,t){var n,r,o,a,i;n=jQuery,r=n.event,o=r.special.drag,a=o.add,i=o.teardown,o.noBubble=!1,o.livekey="livedrag",o.add=function(e){a.apply(this,arguments);var t=n.data(this,o.datakey);!t.live&&e.selector&&(t.live=!0,r.add(this,"draginit."+o.livekey,o.delegate))},o.teardown=function(){i.apply(this,arguments);var e=n.data(this,o.datakey)||{};e.live&&(r.remove(this,"draginit."+o.livekey,o.delegate),e.live=!1)},o.delegate=function(e){var t,a=[],i=n.data(this,"events")||{};return n.each(i||[],function(i,s){0===i.indexOf("drag")&&n.each(s||[],function(i,s){(t=n(e.target).closest(s.selector,e.currentTarget)[0])&&(r.add(t,s.origType+"."+o.livekey,s.origHandler||s.handler,s.data),n.inArray(t,a)<0&&a.push(t))})}),!!a.length&&n(a).bind("dragend."+o.livekey,function(){r.remove(this,"."+o.livekey)})}},function(e,t){!function(e){e.fn.drop=function(t,n,r){var o="string"==typeof t?t:"",a=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==o.indexOf("drop")&&(o="drop"+o),r=(t==a?n:r)||{},a?this.bind(o,r,a):this.trigger(o)},e.drop=function(t){t=t||{},n.multi=!0===t.multi?1/0:!1===t.multi?1:isNaN(t.multi)?n.multi:t.multi,n.delay=t.delay||n.delay,n.tolerance=e.isFunction(t.tolerance)?t.tolerance:null===t.tolerance?null:n.tolerance,n.mode=t.mode||n.mode||"intersect"};var t=e.event.special,n=e.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(t){e.data(this,n.datakey).related+=1},remove:function(){e.data(this,n.datakey).related-=1},setup:function(){if(!e.data(this,n.datakey)){e.data(this,n.datakey,{related:0,active:[],anyactive:0,winner:0,location:{}}),n.targets.push(this)}},teardown:function(){if(!(e.data(this,n.datakey)||{}).related){e.removeData(this,n.datakey);var t=this;n.targets=e.grep(n.targets,function(e){return e!==t})}},handler:function(r,o){var a;if(o)switch(r.type){case"mousedown":case"touchstart":a=e(n.targets),"string"==typeof o.drop&&(a=a.filter(o.drop)),a.each(function(){var t=e.data(this,n.datakey);t.active=[],t.anyactive=0,t.winner=0}),o.droppable=a,t.drag.hijack(r,"dropinit",o);break;case"mousemove":case"touchmove":n.event=r,n.timer||n.tolerate(o);break;case"mouseup":case"touchend":n.timer=clearTimeout(n.timer),o.propagates&&(t.drag.hijack(r,"drop",o),t.drag.hijack(r,"dropend",o))}},locate:function(t,r){var o=e.data(t,n.datakey),a=e(t),i=a.offset()||{},s=a.outerHeight(),l=a.outerWidth(),c={elem:t,width:l,height:s,top:i.top,left:i.left,right:i.left+l,bottom:i.top+s};return o&&(o.location=c,o.index=r,o.elem=t),c},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,n){return this.contains(n,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,n){return Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top))*Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left))},fit:function(e,t,n){return this.contains(n,t)?1:0},middle:function(e,t,n){return this.contains(n,[t.left+.5*t.width,t.top+.5*t.height])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(r){var o,a,i,s,l,c,p,u,d=0,f=r.interactions.length,m=[n.event.pageX,n.event.pageY],h=n.tolerance||n.modes[n.mode];do{if(u=r.interactions[d]){if(!u)return;u.drop=[],l=[],c=u.droppable.length,h&&(i=n.locate(u.proxy)),o=0;do{if(p=u.droppable[o]){if(!(a=(s=e.data(p,n.datakey)).location))continue;s.winner=h?h.call(n,n.event,i,a):n.contains(a,m)?1:0,l.push(s)}}while(++o<c);l.sort(n.sort),o=0;do{(s=l[o])&&(s.winner&&u.drop.length<n.multi?(s.active[d]||s.anyactive||(!1!==t.drag.hijack(n.event,"dropstart",r,d,s.elem)[0]?(s.active[d]=1,s.anyactive+=1):s.winner=0),s.winner&&u.drop.push(s.elem)):s.active[d]&&1==s.anyactive&&(t.drag.hijack(n.event,"dropend",r,d,s.elem),s.active[d]=0,s.anyactive-=1))}while(++o<c)}}while(++d<f);n.last&&m[0]==n.last.pageX&&m[1]==n.last.pageY?delete n.timer:n.timer=setTimeout(function(){n.tolerate(r)},n.delay),n.last=n.event}};t.dropinit=t.dropstart=t.dropend=n}(jQuery)},function(e,t){var n,r,o,a,i;n=jQuery,r=n.event,o=r.special.drop,a=o.add,i=o.teardown,o.noBubble=!1,o.livekey="livedrop",o.add=function(e){a.apply(this,arguments);var t=n.data(this,o.datakey);!t.live&&e.selector&&(t.live=!0,r.add(this,"dropinit."+o.livekey,o.delegate))},o.teardown=function(){i.apply(this,arguments);var e=n.data(this,o.datakey)||{};e.live&&(r.remove(this,"dropinit",o.delegate),e.live=!1)},o.delegate=function(e,t){var a,i=[],s=n.data(this,"events")||{};return n.each(s||[],function(t,s){0===t.indexOf("drop")&&n.each(s,function(t,s){(a=n(e.currentTarget).find(s.selector)).length&&a.each(function(){r.add(this,s.origType+"."+o.livekey,s.origHandler||s.handler,s.data),n.inArray(this,i)<0&&i.push(this)})})}),t&&r.add(t.drag,"dragend."+o.livekey,function(){n.each(i.concat(this),function(){r.remove(this,"."+o.livekey)})}),!!i.length&&n(i)}}])});
//# sourceMappingURL=index.es5.min.js.map